!function(g,R,v){"use strict";var l="px",W="0",e="innerHTML",H="className",c=ht.Default,C=ht.Color,D=ht.Node,i="position",o="top",p="left",Q=c.animate,q=c.getInternal(),r="width",W="0",A="none",I="max-height",y="font",Y="background",n="border-box",L="user-select",t="box-sizing",h="overflow",f=c.isTouchable,q=c.getInternal(),O=C.titleIconBackground,s=c.scrollBarInteractiveSize,b=/msie 9/.test(g.navigator?g.navigator.userAgent.toLowerCase():""),S=null,J=function(){return document},E=function(H){return J().createElement(H)},_=function(){return E("div")},x=function(){var a=_(),w=a.style;return w.msTouchAction=A,w.cursor="default",f&&w.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",S),w.position="absolute",w.left=W,w.top=W,a},w=function(){return E("canvas")},T=function(){return document.body},a=function(f,O,H){f.style.setProperty(O,H,S)},G=function(Y,P){Y.style.removeProperty(P)},B=function(w,G,u){c.def(ht.widget[w],G,u)},k=function(M,n){M.appendChild(n)},z=function(S,N){S.removeChild(N)},M=function(w,E,B,S){w.addEventListener(E,B,!!S)};q.addMethod(c,{paletteExpandIcon:{width:16,height:16,comps:[{type:"triangle",rect:[4,4,10,8],background:O,rotation:3.14}]},paletteCollapseIcon:{width:16,height:16,comps:[{type:"triangle",rect:[4,4,10,8],background:O}]},paletteTitleLabelColor:c.labelSelectColor,paletteTitleLabelFont:c.labelFont,paletteContentLabelFont:c.labelFont,paletteContentLabelColor:"#777",paletteContentBackground:"#fff",paletteTitleHeight:c.widgetTitleHeight,paletteTitleBackground:C.titleBackground,paletteTitleHoverBackground:C.titleBackground,paletteSeparatorWidth:1,paletteSeparatorColor:v,paletteItemHoverBorderColor:C.highlight,paletteItemSelectBackground:C.highlight},!0);var P=".palette-item:hover{border: 1px solid "+c.paletteItemHoverBorderColor+" !important}"+" .palette-header:hover{background: "+c.paletteTitleHoverBackground+" !important}",V=document.createElement("style");f||(V.styleSheet?V.styleSheet.cssText=P:V.appendChild(J().createTextNode(P))),J().getElementsByTagName("head")[0].appendChild(V);var N=function(P){var r=this;r.$22h=P,r.addListeners()};c.def(N,R,{ms_listener:1,getView:function(){return this.$22h.getView()},$26h:function(){var u=this;u.$36h&&T().removeChild(u.$36h),u.$23h=u.$24h=u.$25h=u.$35h=u.$36h=S},handle_touchstart:function(C){for(var g,o=this,O=o.$22h,D=C.target,n=O.sm(),w=O.dm(),M="palette-header",U="palette-header-tool",q="palette-item",u=!1,J=!1,E=!1;D&&(D[H]||"").indexOf(M)<0&&(D[H]||"").indexOf(q)<0;)D=D.parentNode;if(D&&D[H].indexOf(U)>=0?u=!0:D&&D[H].indexOf(M)>=0?E=!0:D&&D[H].indexOf(q)>=0&&(J=!0),c.isLeftButton(C))if(o.$27h(C))o.$24h=c.getClientPoint(C),o.$25h=O.ty();else if(u){c.preventDefault(C),g=D.parentNode.$11h;var W=w.getDataById(g),G=W.s("tools")[D.toolIndex];G.action&&G.action.call(O)}else if(E){c.preventDefault(C),g=D.$11h;var W=w.getDataById(g);W.isExpanded()?W.setExpanded(!1):W.setExpanded(!0)}else if(J){g=D.$11h;var z=w.getDataById(g);n.ss(z),O.handleDragAndDrop&&(c.preventDefault(C),z.s("draggable")&&(O.handleDragAndDrop(C,"prepare"),o.$35h=0)),z.s("draggable")||(c.preventDefault(C),o.$24h=c.getClientPoint(C),o.$25h=O.ty())}else c.preventDefault(C),o.$24h=c.getClientPoint(C),o.$25h=O.ty();else o.$26h(C)},handle_mousedown:function(c){this.handle_touchstart(c)},handle_mousewheel:function(g){this.handleScroll(g,g.wheelDelta/40,g.wheelDelta!==g.wheelDeltaX)},handle_DOMMouseScroll:function(z){this.handleScroll(z,-z.detail,1)},handleScroll:function(U,d,u){var g=this.$22h;c.preventDefault(U),u&&g._41o()&&g.ty(g.ty()+20*d)},handle_mouseup:function(J){this.handle_touchend(J)},handle_touchend:function(d){var Y=this;Y.$37h(d),Y.$26h(d)},handleWindowMouseUp:function(n){this.handleWindowTouchEnd(n)},handleWindowTouchEnd:function(L){var J=this;J.$37h(L),J.$26h(L)},$37h:function(p){var D=this,P=D.$22h;2===D.$35h&&(D.$35h=3,P.handleDragAndDrop(p,"end"))},handleWindowMouseMove:function(l){this.handleWindowTouchMove(l)},handleWindowTouchMove:function(n){var j=this,g=j.$22h,x=j.$23h,R=j.$24h,Y=j.$25h,v=c.getClientPoint(n),A=g._29I,o=j.$36h;if(1===j.$35h||2===j.$35h){if(j.$35h=2,g.handleDragAndDrop(n,"between"),f){var d=n.touches[0];n=d?d:n.changedTouches[0]}o.style.left=n.pageX-parseInt(o.width)/2+l,o.style.top=n.pageY-parseInt(o.height)/2+l}else"p"===x?g.ty(Y+v.y-R.y):"v"===x&&g.ty(Y+(R.y-v.y)/A.height*g._59I)},handle_mousemove:function(V){this.handle_touchmove(V)},handle_touchmove:function(I){if(!c.isDragging()&&c.isLeftButton(I)){var U=this,$=U.$22h,t=U.$27h(I);if(U.$24h){if(!U.$23h){if(c.getDistance(c.getClientPoint(I),U.$24h)<2)return;U.$23h=t?"v":"p",c.startDragging(U)}}else if(t)$._43o();else if(0===U.$35h){if(U.$35h=1,$.handleDragAndDrop(I,"begin"),f){var o=I.touches[0];I=o?o:I.changedTouches[0]}var x=U.$36h=new Image,q=$.$10h[$.sm().ld().getId()].querySelector(".image-box"),v=parseInt(q.style.width),K=parseInt(q.style.height);x.draggable=!1,x.src=q.toDataURL(),x.width=v,x.height=K,x.style.position="absolute",x.style.left=I.pageX-v/2+l,x.style.top=I.pageY-K/2+l,T().appendChild(x),c.startDragging(U)}}},$27h:function(S){var g=this.$22h,A=g.getView(),z=A.getBoundingClientRect(),r=g._29I,M=S.clientX-z.left+A.scrollLeft;return g._41o()&&r.x+r.width-M<s}}),ht.widget.Palette=function(e){var S=this,F=S._view=q.createView(null,S);S.$9h={},S.$10h={},S.$4h={},S._29I={x:0,y:0,width:0,height:0},S._59I=0,S.dm(e?e:new ht.DataModel),F[H]="ht-widget-palette",S.$29h=new N(S),a(F,Y,c.paletteContentBackground),a(F,h,"auto"),a(F,t,n),a(F,"-moz-"+t,n),a(F,"-webkit-"+L,A),a(F,"-moz-"+L,A),a(F,"-ms-"+L,A),a(F,L,A),a(F,"position","absolute"),a(F,"overflow","hidden"),k(F,S._79O=x()),M(F,"dragstart",function(Z){Z.dataTransfer&&(Z.dataTransfer.setData("Text","nodeid:"+Z.target.$11h),Z.dataTransfer.effectAllowed="all",S.$29h.$26h())})},B("Palette",R,{ms_v:1,ms_fire:1,ms_dm:1,ms_sm:1,ms_vs:1,ms_ac:["itemImageWidth","itemImageHeight","itemImagePadding","itemMargin","layout","autoHideScrollBar","scrollBarSize","scrollBarColor"],$30h:0,_itemImagePadding:4,_itemImageWidth:70,_itemImageHeight:50,_itemMargin:10,_layout:"largeicons",_autoHideScrollBar:c.autoHideScrollBar,_scrollBarSize:c.scrollBarSize,_scrollBarColor:c.scrollBarColor,getViewRect:function(){return this._29I},ty:function(B){return B==S?this.getTranslateY():(this.setTranslateY(B),void 0)},setTranslateY:function(I){if(this.$32h==S){var k=this,l=k.$33h(I),m=k.$30h;k.$30h=l,k.fp("translateY",m,l)}},getTranslateY:function(){return this.$30h},setLayout:function(p){var Z,n,k=this,j=k._layout;k._layout=p,"smallicons"===p?Z=n=20:"iconsonly"===p?Z=n=50:(Z=70,n=50),k.setItemImageWidth(Z),k.setItemImageHeight(n),k.setItemImagePadding(4),k.fp("layout",j,p)},getDataAt:function(T){for(var w=T.target;w&&w.$11h==S;)w=w.parentNode;return w&&w.$11h!=S?this.getDataModel().getDataById(w.$11h):void 0},$20h:function(){var j=16;return f&&(j*=1.2),j},$19h:function(){return c.paletteTitleHeight},$18h:function(){var U=c.paletteSeparatorWidth,G=c.paletteTitleBackground,s=c.paletteSeparatorColor||c.brighter(G);return U+l+" solid "+s},$17h:function(J){a(J,"cursor","pointer"),a(J,"display","inline-block"),a(J,"margin-right",(f?8:4)+l),a(J,"vertical-align",o)},$1h:function(Q){var C=this,u=_(),P=_(),x=E("span");u[H]="palette-header",a(u,i,"relative"),a(u,Y,c.paletteTitleBackground),a(u,"color",c.paletteTitleLabelColor),a(u,o,W),a(u,t,n),a(u,"-moz-"+t,n),a(u,"padding","0 5px 0 0"),a(u,"border-top",C.$18h()),a(u,r,"100%"),a(u,"cursor","pointer"),a(u,"white-space","nowrap"),a(u,h,"hidden"),a(u,y,c.paletteTitleLabelFont),a(u,"line-height",C.$19h()+l),u.$11h=Q.getId();var M=w(),V=C.$19h(),R=C.$20h();C.$17h(M),q.setCanvas(M,R,V),k(u,M);var p=Q.s("tools");if(p)for(var Z=0;Z<p.length;Z++){var B=w();C.$17h(B),q.setCanvas(B,R,V),B[H]="palette-header-tool palette-header-tool"+Q.getId()+"-"+Z,B.style.position="absolute",B.style.right=(R+10)*Z+"px",B.toolIndex=Z,k(u,B)}return M[H]="palette-toggle-icon-"+Q.getId(),P[H]="palette-content",a(P,"max-height",0+l),a(P,y,c.paletteContentLabelFont),a(P,h,"hidden"),P.$11h=Q.getId(),C.$9h[Q.getId()]=P,x[e]=Q.getName(),a(x,y,c.paletteTitleLabelFont),k(u,M),k(u,x),[u,P]},$2h:function(D){var L=this,U=L._layout,V=b&&D.s("draggable")?E("a"):_(),x=w(),M=_(),z=D.getName()||"",J=D.s("title")||D.getToolTip()||z,n=L._itemMargin;x[H]="image-box";var r=L.getItemImageWidth(),F=L.getItemImageHeight();return q.setCanvas(x,r,F),k(V,x),M[e]=z,M[H]="label-box","iconsonly"!==U&&k(V,M),V[H]="palette-item",a(V,"vertical-align",o),a(V,"cursor","pointer"),a(V,"border-radius",5+l),a(V,"border","1px solid transparent"),a(V,"text-align","center"),a(V,"display","inline-block"),a(V,"margin-left",n+l),a(V,"margin-top",n+l),a(V,"color",c.paletteContentLabelColor),"smallicons"===U?(a(x,"vertical-align","middle"),a(V,"margin-left",2+l),a(V,"margin-top",2+l),a(V,"padding",2+l),a(V,"text-align",p),a(M,"display","inline-block"),a(M,"min-width",L.$21h+L._itemMargin+l)):"largeicons"===U&&(a(M,"max-width",r+l),a(M,"overflow","hidden")),V.$11h=D.getId(),J&&(V.title=J),D.s("draggable")&&!L.handleDragAndDrop&&(b?(V.href="#",a(V,"text-decoration",A)):V.draggable="true"),V},$16h:function(w,d,t,i){var r=q.initContext(w);q.translateAndScale(r,0,0,1),r.clearRect(0,0,t,t);var P=(t-i)/2;c.drawStretchImage(r,c.getImage(d),"fill",0,P,i,i),r.restore()},$15h:function(t){var E=this,q=t.getId(),r=E._view.querySelector(".palette-toggle-icon-"+q),e=t.isExpanded()?c.paletteCollapseIcon:c.paletteExpandIcon;if(r&&e){var J=E.$19h(),$=E.$20h();E.$16h(r,e,J,$)}},_drawToolsIcon:function(K){var J=this,I=K.s("tools");if(I)for(var C=0;C<I.length;C++){var z=J._view.querySelector(".palette-header-tool"+K.getId()+"-"+C),r=I[C].icon,v=J.$19h(),y=J.$20h();J.$16h(z,r,v,y)}},$14h:function(d){var z=this,J=d.getId(),K=z.$10h[J].querySelector(".image-box"),t=d.getImage(),Q=d.s("image.stretch");if(K&&t){var R=q.initContext(K),X=z.getItemImagePadding();X="smallicons"===z._layout?X/2:X;var a=z.getItemImageWidth()-2*X,I=z.getItemImageHeight()-2*X;q.translateAndScale(R,0,0,1),R.clearRect(0,0,a,I),c.drawStretchImage(R,c.getImage(t),Q,X,X,a,I,d,z),R.restore()}},validateImpl:function(){var n,Y,f,B=this,m=B.$9h,q=B._layout,$=B.$10h,H=B.$4h,w=B._view,a=B.dm();if(B.$13h&&(delete B.$13h,H={},a.each(function(z){H[z.getId()]=z})),"smallicons"===q)for(var X in H){var U=H[X];if(U instanceof D){var G=U.getName()||"",v=c.getTextSize(c.paletteContentLabelFont,G).width;B.$21h!=S&&B.$21h>v||(B.$21h=v)}}for(var X in H){f=H[X];var Z,L;if(a.contains(f)){if(f instanceof ht.Group){var h,r=B.$1h(f),p=$[f.getId()];p&&(h=p.nextSibling,z(w,h),z(w,p)),Y=a.getSiblings(f).indexOf(f);var _=w.children[2*Y]||B._79O;_&&_.parentNode?(w.insertBefore(r[0],_),w.insertBefore(h||r[1],_)):(w.appendChild(r[0]),w.appendChild(h||r[1])),$[f.getId()]=r[0],n=m[f.getId()]=h||r[1],L=f.$12h;var o=f.s("promptText");L||(f.$12h=E("div"),f.$12h[e]=o||"",L=f.$12h),0===f.getChildren().size()?n.contains(L)||k(n,L):n.contains(L)&&z(n,L)}else if(Z=f.getParent()){var A=B.$2h(f),V=$[f.getId()];n=m[Z.getId()],V&&z(V.parentNode,V),Y=a.getSiblings(f).indexOf(f);var x=n.children[Y];x?n.insertBefore(A,x):k(n,A),$[f.getId()]=A,B.$14h(f)}}else{var N=$[f.getId()],P=N.parentNode;if(f instanceof ht.Group){var u=N.nextSibling;z(w,N),z(w,u),delete m[f.getId()]}else z(P,N),0===P.children.length&&(Z=a.getDataById(P.$11h),L=Z.$12h,L&&!P.contains(L)&&k(P,L));delete $[f.getId()]}}B.$4h={};var J=function(){var M=B._59I,i=0;B.$32h!=S&&(clearInterval(B.$32h),i=0,delete B.$32h),B.$32h=setInterval(function(){B.$31h(),M===B._59I?(i++,i>=2&&(clearInterval(B.$32h),delete B.$32h)):(i=0,M=B._59I)},30)};for(var y in m)if(n=m[y],f=a.getDataById(m[y].$11h),B.$15h(f),B._drawToolsIcon(f),f.isExpanded()){if(n.style.maxHeight===0+l){var T=n.scrollHeight+B._itemMargin+l;Q(n).duration(200).set(I,T).set("padding-bottom",B._itemMargin+l).end(function(){return function(){J()}}(T))}else n.style.maxHeight=n.scrollHeight+l;n.style.paddingBottom=B._itemMargin+l}else n.style.maxHeight!==0+l&&Q(n).duration(200).set(I,W).set("padding-bottom",W).end(function(){return function(){J()}}(n));B.$28h(),B.$31h()},$31h:function(){for(var j=this,u=j._view,z=0,n=u.children,b=0;b<n.length;b++){var X=n[b];X.className&&X.className.indexOf("palette-")>=0&&(z+=X.offsetHeight)}j._59I=z,j.$30h=j.$33h(j.ty());var P=j.ty();u.scrollTop=-P,j._29I={x:0,y:-P,width:u.clientWidth,height:u.clientHeight},a(j._79O,o,-P+l),j._93I()},$33h:function(K){var S=this,U=S._29I.height-S._59I;return U>K&&(K=U),K>0?0:Math.round(K)},redraw:function(){this.$13h||(this.$13h=1,this.iv())},onPropertyChanged:function(T){["autoHideScrollBar","scrollBarSize","scrollBarColor","translateY"].indexOf(T.property)<0&&this.redraw(),"translateY"===T.property&&(this.iv(),this._43o())},findDataByName:function(z){for(var w=this.dm().getDatas(),N=0;N<w.size();N++){var q=w.get(N);if(q.getName()===z)return q}},setDataModel:function(W){var g=this,m=g._dataModel,x=g._selectionModel;m!==W&&(m&&(m.umm(g.$6h,g),m.umd(g.$8h,g),m.umh(g.$7h,g),x||m.sm().ums(g.$28h,g)),g._dataModel=W,W.mm(g.$6h,g),W.md(g.$8h,g),W.mh(g.$7h,g),x?x._21I(W):W.sm().ms(g.$28h,g),g.sm().setSelectionMode("single"),g.fp("dataModel",m,W))},$6h:function($){var N=this,H=N._view,u=$.data,m=N.$4h;"add"===$.kind?m[u.getId()]=u:"remove"===$.kind?m[u.getId()]=u:"clear"===$.kind&&(N.$10h={},N.$9h={},N.$4h={},H[e]=""),N.iv()},$7h:function(W){var G=this,L=W.data;G.$4h[L.getId()]=L,G.iv()},$8h:function(_){var E=this,C=_.data,j=_.property;"expanded"===j?E.iv():(E.$4h[C.getId()]=C,E.iv())},$28h:function(){var v,O=this,w=O.sm(),C="palette-item",h=w.ld();this.dm().each(function(n){v=O.$10h[n.getId()],v&&v[H].indexOf(C)>=0&&(n===h?a(v,Y,c.paletteItemSelectBackground):G(v,Y))})}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);