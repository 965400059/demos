!function(X,C){"use strict";var M="position",d="absolute",S="relative",l="px",o="left",u="right",k="top",K="bottom",z="display",t="none",G="block",c=ht.Default,e=c.getInternal(),$=Math.floor,L=Math.ceil,q=Math.PI,T=null,V=X.parseInt,I=function(D){return D.getContext("2d")},b=function(){return document},E=function(k){return b().createElement(k)},B=function(){return E("canvas")},_=function(_,r,O){_.style.setProperty(r,O,T)},J=function(w,L,O){c.def(ht.widget[w],L,O)},n=function(J,M){J.appendChild(M)},R=function(b,h){b.removeChild(h)},x=function(f,G,g,W){f.addEventListener(G,g,!!W)},g=function(d,e,g,a){d.removeEventListener(e,g,!!a)};ht.widget.RulerFrame=function(X){var F=this,r=F._view=e.createView(null,F),x=F.$1k=B(),k=F.$2k=B(),s=F.$3k=B(),z=F.$4k=B();F._defaultRulerConfig={size:20,borderWidth:1,borderStyle:"solid",borderColor:"#888",defaultMajorTickSpacing:50,minMajorTickSpacing:10,minPhysicalMajorTickSpacing:40,maxPhysicalMajorTickSpacing:100,tickSpacingAdaptable:!0,majorTickTextFont:"12px Arial",majorTickTextColor:"#666",majorTickColor:"#888",minorTickColor:"#ccc",background:"rgba(0,0,0,0)",guideColor:"rgb(0, 173, 239)",guideWidth:2,guideVisible:!1,guideTipVisible:!1,guideTipBorderColor:"#666",guideTipTextColor:"#666",guideTipTextFont:"12px Arial",guideTipBackground:"#fff"},F._topRulerConfig={visible:!0},F._rightRulerConfig={visible:!1},F._bottomRulerConfig={visible:!1},F._leftRulerConfig={visible:!0},n(r,x),n(r,s),n(r,k),n(r,z),_(r,M,S),_(r,"box-sizing","border-box"),_(r,"-moz-box-sizing","border-box"),_(x,M,d),_(k,M,d),_(s,M,d),_(z,M,d),F.$14k=function(){F.$13k=1,F.iv()},F.$15k=function(V){if(F._topRulerConfig.guideVisible||F._rightRulerConfig.guideVisible||F._bottomRulerConfig.guideVisible||F._leftRulerConfig.guideVisible||F._defaultRulerConfig.guideVisible||(F._topRulerConfig.guideTipVisible||F._rightRulerConfig.guideTipVisible||F._bottomRulerConfig.guideTipVisible||F._leftRulerConfig.guideTipVisible||F._defaultRulerConfig.guideTipVisible)&&F._component){var o=r.getBoundingClientRect();F.$16k={x:V.clientX-o.left,y:V.clientY-o.top},F.$5k()}},F.setComponent(X)},J("RulerFrame",C,{ms_v:1,ms_fire:1,ms_ac:["defaultRulerConfig","topRulerConfig","rightRulerConfig","bottomRulerConfig","leftRulerConfig","component"],setComponent:function(V){var X=this,m=X._component,f=X.getView();if(f){if(X._component=V,X.fp("component",m,V),m){var q=X.getComponentView(m);R(f,q),g(f,"mousemove",X.$15k),X.removeComponentPropertyChangeListener(m,X.$14k)}if(V){var r=X.getComponentView(V);n(f,r),_(r,M,d),x(f,"mousemove",X.$15k),X.addComponentPropertyChangeListener(V,X.$14k)}}},addComponentPropertyChangeListener:function(f,d){f&&f.mp&&f.mp(d)},removeComponentPropertyChangeListener:function(D,E){D&&D.ump&&D.ump(E)},getComponentHZoom:function(O){return O&&O.getZoom?O.getZoom():1},getComponentVZoom:function(l){return l&&l.getZoom?l.getZoom():1},getComponentViewRect:function(e){return e&&e.getViewRect?e.getViewRect():void 0},getComponentView:function(C){return C&&C.getView?C.getView():C},invalidateComponent:function(H){H&&H.iv&&H.iv()},validateComponent:function(m){m&&m.validate&&m.validate()},$7k:function(x,X,K,U,L,j,P,$,W,F,J,M){if(X.visible){var s=this._defaultRulerConfig,u="borderStyle",N="borderColor",B="borderWidth",S="background",m=X[u]||s[u],c=X[N]||s[N],f=X[B]||s[B],o=X.size!=T?X.size:s.size,r=X[S]||s[S],Z=o+f,Y=this.$6k(f,m,c,x,K,L,Z,P,$,W,F,J,M);_(x,L,"0px"),j?e.setCanvas(x,U-Y,o):e.setCanvas(x,o,U-Y),_(x,"background",r),_(x,z,G)}else _(x,z,t),_(this.getComponentView(this._component),L,"0px")},$6k:function(v,D,f,Z,j,p,L,y,u,G,W,i,h){var S=0;return _(Z,j,v+"px "+D+" "+f),_(this.getComponentView(this._component),p,L+l),y?(_(Z,u,G+l),S+=G):_(Z,u,"0px"),W?(_(Z,i,h+l),S+=h):_(Z,i,"0px"),S},validateImpl:function(){var h=this,D=h._component,W=h.$1k,p=h.$2k,I=h.$3k,f=h.$4k,G=h._view,P=h._defaultRulerConfig,U=h._topRulerConfig,y=h._rightRulerConfig,l=h._bottomRulerConfig,_=h._leftRulerConfig,J=P.size;if(G&&D){var Q=U.size!=T?U.size:J,H=y.size!=T?y.size:J,c=l.size!=T?l.size:J,m=_.size!=T?_.size:J;h.$7k(W,U,"border-bottom",G.offsetWidth,k,!0,_.visible,o,m,y.visible,u,H),h.$7k(p,y,"border-left",G.offsetHeight,u,!1,U.visible,k,Q,l.visible,K,c),h.$7k(I,l,"border-top",G.offsetWidth,K,!0,_.visible,o,m,y.visible,u,H),h.$7k(f,_,"border-right",G.offsetHeight,o,!1,U.visible,k,Q,l.visible,K,c),h.$13k?delete h.$13k:h.invalidateComponent(D),h.validateComponent(D),h.$5k()}},$5k:function(){function Z(Z,c,r,M,s,e){if(c.visible){var n=I(Z),O=c[d]||b,N=c[D]!=T?c[D]:v,p=c[E]||W,j=c[x]||U,q=c.size!=T?c.size:F,Zi=c[Q]||B,wl=c[z]||h,pq=c[A]||t,gl=c[g]!=T?c[g]:V,Jq=c[R]!=T?c[R]:$,Dq=c[k]!=T?c[k]:C,un=c[K]!=T?c[K]:l,Sr=c[G]!=T?c[G]:u,Hp=c[w]!=T?c[w]:a,xq=c[H]||Sl,Un=c[m]||zq;N&&(O=y[e]=y.$8k(y[e]||O,c[o]||i,c[J]||Y,M?X:P,wl)),r.call(y,n,f,L,S,_,q,M?X:P,O,p,j,s,Zi,pq);var rj=y.$16k;(gl||Jq)&&rj&&(M?y.$9k(n,rj.x,q,xq,Un,gl,Jq,Dq,un,Sr,Hp):y.$10k(n,rj.y,q,xq,Un,gl,Jq,Dq,un,Sr,Hp,s))}}var y=this,r=y.$1k,j=y.$2k,M=y.$3k,q=y.$4k,n=y._topRulerConfig,e=y._rightRulerConfig,p=y._bottomRulerConfig,s=y._leftRulerConfig,c=y._defaultRulerConfig,O=y._component,N=y.getComponentViewRect(O),X=y.getComponentHZoom(O),P=y.getComponentVZoom(O),f=N.x*X,S=f+N.width*X,L=N.y*P,_=L+N.height*P,F=y._defaultRulerConfig.size,d="defaultMajorTickSpacing",o="maxPhysicalMajorTickSpacing",J="minPhysicalMajorTickSpacing",D="tickSpacingAdaptable",E="majorTickTextFont",x="majorTickTextColor",Q="majorTickColor",A="minorTickColor",g="guideVisible",R="guideTipVisible",k="guideTipBorderColor",K="guideTipTextColor",G="guideTipTextFont",w="guideTipBackground",H="guideColor",m="guideWidth",z="minMajorTickSpacing",b=c[d],i=c[o],Y=c[J],v=c[D],W=c[E],U=c[x],B=c[Q],h=c[z],t=c[A],V=c[g],$=c[R],C=c[k],l=c[K],u=c[G],a=c[w],Sl=c[H],zq=c[m];y._view&&O&&(Z(r,n,y.$11k,!0,!1,"_currentTopMajorTickSpacing"),Z(j,e,y.$12k,!1,!0,"_currentRightMajorTickSpacing"),Z(M,p,y.$11k,!0,!0,"_currentBottomMajorTickSpacing"),Z(q,s,y.$12k,!1,!1,"_currenLeftMajorTickSpacing"))},$8k:function(R,S,K,U,n){return K>R*U?R=$(S/U/n)*n:R*U>S&&(R=L(K/U/n)*n),R},getHTipText:function(o){var T=this,Q=T._component,U=0,g=T._view.getBoundingClientRect();return Q.lp?U=V(Q.lp({x:o.x+g.left,y:o.y}).x):U-=V(this.getComponentView(Q).style.left)||0,U},$9k:function(n,C,J,Y,q,o,L,Z,G,$,O){var p=this,M=p._component;n.save(),e.translateAndScale(n,0,0,1);var k=C-(V(this.getComponentView(M).style.left)||0),x=0;if(C=p.getHTipText(p.$16k),o&&(n.beginPath(),n.fillStyle=Y,n.rect(k,x,q,J),n.fill()),L){n.beginPath(),n.textAlign="center",n.textBaseline="middle",n.font=$;var h=n.measureText(C).width+6;n.fillStyle=O,n.rect(k-h/2,x,h,J),n.fill(),n.strokeStyle=Z,n.stroke(),n.beginPath(),n.fillStyle=G,n.fillText(C,k,x+J/2)}n.restore()},getVTipText:function(o){var T=this,M=T._component,A=0,H=T._view.getBoundingClientRect();return M.lp?A=V(M.lp({x:o.x,y:o.y+H.top}).y):A-=V(this.getComponentView(M).style.top)||0,A},formatScaleText:function(a){return Math.round(a)},$10k:function(u,K,W,x,I,N,n,r,G,U,Y,j){var c=this,p=c._component;u.save(),e.translateAndScale(u,0,0,1);var y=W/2,k=K-(V(this.getComponentView(p).style.top)||0);if(K=c.getVTipText(c.$16k),N&&(u.beginPath(),u.fillStyle=x,u.rect(y-W/2,k,W,I),u.fill()),n){u.translate(y,k),u.rotate((j?90:-90)*q/180),u.translate(-y,-k),u.beginPath(),u.textAlign="center",u.textBaseline="middle",u.font=U;var J=u.measureText(K).width+6;u.fillStyle=Y,u.rect(y-J/2,k-W/2,J,W),u.fill(),u.strokeStyle=r,u.stroke(),u.fillStyle=G,u.fillText(K,y,k)}u.restore()},$11k:function(h,_,a,z,y,m,Z,x,f,b,J,l,v){h.save(),a=0;var U=_,E=z,n=(U+E)/2;_=0,z=E-U,e.translateAndScale(h,0,0,1);var X=0,F=0,Y=V(m/2),i=m-Y,C=J?0:Y,q=x*Z,g=q/10;_-=q,z+=q,h.clearRect(_,0,z-_,m),h.beginPath(),h.fillStyle=v;var O=$(n/g)*g-U;for(X=O;z>X;X+=g)h.rect(X,a+C,1,i);for(X=O;X>_;X-=g)h.rect(X,a+C,1,i);for(h.fill(),C=J?0:1,h.beginPath(),h.fillStyle=l,O=$(n/q)*q-U,X=O;z>X;X+=q)h.rect(X,a+C,1,m-1);for(X=O;X>_;X-=q)h.rect(X,a+C,1,m-1);h.fill();var W=V(/\d+px/.exec(f)[0]),r=(W||10)/2;h.textBaseline="middle",C=J?m-r-2:r+2,h.beginPath(),h.fillStyle=b,h.font=f;var H=$(n/q)*q/Z;for(X=O,F=H;z>X;X+=q,F+=x){var G=this.getHScaleText?this.getHScaleText(X):F;h.fillText(this.formatScaleText(G),X+2,a+C)}for(X=O,F=H;X>_;X-=q,F-=x){var G=this.getHScaleText?this.getHScaleText(X):F;h.fillText(this.formatScaleText(G),X+2,a+C)}h.restore()},$12k:function(Q,b,Y,G,u,x,X,m,p,w,o,F,y){function M(J,x,M,z,X,d){X=E.getVScaleText?E.getVScaleText(M):X,X=E.formatScaleText(X),Q.translate(J+x,M),Q.rotate(-z),Q.translate(-J-x,-M),Q.fillText(X,J+x+(d?2:1),M),Q.translate(J+x,M),Q.rotate(z),Q.translate(-J-x,-M)}Q.save(),b=0;var z=Y,g=u,U=(z+g)/2;Y=0,u=g-z,e.translateAndScale(Q,0,0,1);var W=0,E=this,n=0,D=V(x/2),s=x-D,H=o?0:D,Z=m*X,c=Z/10;Y-=Z,u+=Z,Q.clearRect(b,0,x,u-Y),Q.beginPath(),Q.fillStyle=y;var k=$(U/c)*c-z;for(W=k;u>W;W+=c)Q.rect(b+H,W,s,1);for(W=k;W>Y;W-=c)Q.rect(b+H,W,s,1);for(Q.fill(),H=o?0:1,Q.beginPath(),Q.fillStyle=F,k=$(U/Z)*Z-z,W=k;u>W;W+=Z)Q.rect(b+H,W,x-1,1);for(W=k;W>Y;W-=Z)Q.rect(b+H,W,x-1,1);Q.fill();var I=V(/\d+px/.exec(p)[0]),a=(I||10)/2,v=90*q/180;Q.textBaseline="middle",H=o?x-a:a+2,v=o?-v:v,Q.beginPath(),Q.fillStyle=w,Q.font=p;var T=$(U/Z)*Z/X;for(W=k,n=T;u>W;W+=Z,n+=m)M(b,H,W,v,n,o);for(W=k,n=T;W>Y;W-=Z,n-=m)M(b,H,W,v,n,o);Q.restore()},onPropertyChanged:function(){this.iv()},dispose:function(){var I=this,j=I._component,i=I._view;j&&I.removeComponentPropertyChangeListener(j,I.$14k),i&&(g(i,"mousemove",I.$15k),R(i.parentNode,i),I._view=null)}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);