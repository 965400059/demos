!function($,E,D){"use strict";var y="ht",N=$[y],F=N.Default,e=N.graph,U=F.getInternal(),T=U.ui(),c=T.NodeUI.prototype,J=T.ShapeUI.prototype,C=e.GraphView,B=C.prototype,b=T.EdgeUI.prototype,I=N.Node,S=N.Shape,W=N.Edge,P=N.Group,X=F.isTouchable,A=F.preventDefault,n=$.setTimeout,M=F.grow,d=F.isDragging,a=F.getDistance,t=null,s=N.List,l="undefined"!=typeof Float32Array?Float32Array:Array,m=Math,q=m.PI,p="Crossing",L="No Crossing",Y=q/2,Q=2*q,_=m.atan2,z=m.sqrt,H=m.pow,V=m.sin,i=m.cos,O=m.min,v=m.max,o=m.abs,w=m.ceil,u=m.round,k=F.unionPoint,r=F.unionRect,G=F.containsPoint,x=F.clone,j="rgb(52, 152, 219)",K="red",h={northwest:0,north:1,northeast:2,west:7,east:3,southwest:6,south:5,southeast:4},R={width:400,height:100,comps:[{type:"shape",points:{func:function(){for(var O=[10,8,162,36,314,37,269,2,398,49,268,98,314,58,161,60,9,91,103,49,10,8],c=0;c<O.length;c++){var C=O[c];C=0===c%2?C/400*R.width:C/100*R.height,O[c]=C}return R.width>120&&(O[4]=R.width-26,O[6]=R.width-40,O[10]=R.width-40,O[12]=R.width-26,O[18]=33),O}},segments:[1,3,2,2,2,2,3,2,2],background:"white",gradient:"linear.east",gradientColor:"red"}]},g={width:300,height:300,comps:[{type:"circle",rect:[20,0,120,120],background:j,rotation:.61},{type:"circle",rect:[200,120,70,70],background:j,rotation:.61},{type:"circle",rect:[200,220,70,70],background:j,rotation:.61},{type:"shape",points:[80,60,80,155,200,155],borderWidth:20,borderColor:j},{type:"shape",points:[80,60,80,255,200,255],borderWidth:20,borderColor:j}]},Z={width:300,height:300,comps:[{type:"shape",points:[114,239,115,106,112,73,149,73,149,73,175,73,177,105,179,261,178,302,147,307,98,308,83,307,72,276,73,260,72,81,74,29,115,21,191,21,221,22,224,53,223,238],segments:[1,2,3,2,3,2,3,2,4,2,3,2,3,2],borderWidth:20,borderColor:K,rotation:.61}]},f={width:300,height:300,comps:[{type:"circle",rect:[210,0,90,90],background:j},{type:"circle",rect:[0,210,90,90],background:j},{type:"shape",points:[255,45,45,255],borderWidth:20,borderColor:j}]},Bd={width:300,height:300,comps:[{type:"shape",points:[20,20,280,280],borderWidth:30,borderColor:K},{type:"shape",points:[280,20,20,280],borderWidth:30,borderColor:K}]},nn={width:300,height:300,comps:[{type:"shape",points:[270,30,30,150,270,270],borderWidth:40,borderColor:j}]},ws={width:300,height:300,comps:[{type:"shape",points:[30,30,270,150,30,270],borderWidth:40,borderColor:K}]},_f={width:300,height:300,comps:[{type:"rect",rect:[125.58,52.76,40,231.96],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[27.87,61.06,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:5.5},{type:"rect",rect:[113.36,61,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:.79}]},de={width:300,height:300,author:"",note:"",comps:[{type:"rect",rect:[135.15,38.76,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,2.35,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,115.72,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,167.62,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[135.15,177.33,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,251.39,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:3.14}]},wj=function(v){var Q=v.touches[0];return Q?Q:v.changedTouches[0]},qi=function(r,K,w,y){return _(y-K,w-r)},Pp=function(w,s){return{x:w.x*s,y:w.y*s}},ck=function(b,I){b.each(function(A){return b.isSelected(A)?I(A):void 0})},jo=function(A,H){A.reverseEach(function(k){return A.isSelected(k)?H(k):void 0})},oi=function(T,H,v){var b,j,Y,R,u,A=this,k=H,_=A.gv;if(T instanceof S){Y=T.getSegments();var P=_.getDataUI(T);u=P._55O.$15l,Y&&Y.size()||(Y=Wq(u)),T.isClosePath()&&Y.indexOf(5)<0&&(Y=new s(Y._as),Y.add(5)),b=An(T,P,k),j=u[b]}else{var Q=_.getDataUI(T);u=Hl(Q,T.s("edge.points")),Y=T.s("edge.segments"),Y&&Y.size()||(Y=Wq(u)),u=u._as,b=An(T,Q,k),j=u[b]}if(Y&&(R=Y.get(k)),2===R||1===R||5===R){var B=u[b+1];5===R&&(B=u[0]);var m=xe(j,v,B);return m}return v},Tp=function(x,$,i,h){var c=$/2,N=i/2,n=hf(x,-c,-N,h),v=hf(x,c,-N,h),Y=hf(x,-c,N,h),g=hf(x,c,N,h),J=hf(x,0,-N,h),O=hf(x,c,0,h),U=hf(x,0,N,h),d=hf(x,-c,0,h);return[n,v,Y,g,J,O,U,d]},xe=function(I,p,E){var P={x:p.x-I.x,y:p.y-I.y},$={x:E.x-I.x,y:E.y-I.y},o=z(H(E.x-I.x,2)+H(E.y-I.y,2)),C={x:$.x/o,y:$.y/o},X=P.x*C.x+P.y*C.y,u={x:C.x*X,y:C.y*X};return{x:I.x+u.x,y:I.y+u.y}},hf=function(B,T,O,L){var F=i(L)*T-V(L)*O,v=V(L)*T+i(L)*O;return B?{x:B.x+F,y:B.y+v}:{x:F,y:v}},Pl=function(R,u){return u>2*R?R:u/2},pd=function(m,R,M,o){var P=a(m,R);return M=o?O(M,P):Pl(M,P),P?M/=P:M=0,{x:m.x+(R.x-m.x)*M,y:m.y+(R.y-m.y)*M}},eh=function(v,H){var p,b,Q=v.gv,m=v._data,x=m._40I,W=m._41I,V=m.s("edge.offset"),M=m.s("edge.source.position"),D=m.s("edge.target.position"),u=m.s("edge.source.offset.x"),G=m.s("edge.source.offset.y"),E=m.s("edge.target.offset.x"),A=m.s("edge.target.offset.y"),i=m.s("edge.source.anchor.x"),n=m.s("edge.source.anchor.y"),o=m.s("edge.target.anchor.x"),t=m.s("edge.target.anchor.y");if(H?(p=U.getEdgeAgentPosition(Q,x,M,u,G,i,n),b=U.getEdgeAgentPosition(Q,W,D,E,A,o,t)):(p=U.getEdgeAgentPosition(Q,x,M,0,0,i,n),b=U.getEdgeAgentPosition(Q,W,D,0,0,o,t)),"points"===m.s("edge.type")&&V&&!m.s("edge.center")&&p){var B=m.s("edge.points")||new s,c=B.size(),N=pd(p,c?B.get(0):b,V,c),g=pd(b,c?B.get(c-1):p,V,c);p=N,b=g}return[p,b]},Hl=function(r,u,W){var M=r._78o,o=r._data,T=o.s("edge.type"),R=[M.sourcePoint,M.targetPoint];return"points"===T?W&&(R=eh(r)):R=M.center?T?W?eh(r):eh(r,!0):W?eh(r):[M.c1,M.c2]:W?eh(r):eh(r,!0),u=new s(u?u._as:t),u.add(R[0],0),u.add(R[1]),u},ic=function(h){return h=new s(h._as),h.removeAt(0),h.removeAt(h.size()-1),h},Wq=function(F){F._as||(F=new s(F));var y=new s;y.add(1);for(var X=1;X<F.size();X++)y.add(2);return y},Og=function(U,C){return{x:(U.x+C.x)/2,y:(U.y+C.y)/2}},hc=function(j,F){return{x:j.x+1*(F.x-j.x)/4,y:j.y+1*(F.y-j.y)/4}},Nf=function(y,q){return{x:y.x+3*(q.x-y.x)/4,y:y.y+3*(q.y-y.y)/4}},jm=function(R,b,N,Q){var s=b.x+b.width/2,M=b.y+b.height/2,A=z(s*s+M*M),W=_(M,s)+N;return{x:Q.x+A*i(W),y:Q.y+A*V(W)}},Vo=B.validateImpl,mi=B.isRectEditable,Yd=B.isPointEditable,Fe=B._42,hk=J._79o,Of=b._79o,nf=J._48O,Nq=J._47O,ge=c._48O,Tr=c._80o,xf=J._80o,ii=c.getSelectWidth,Ae=c._47O,Yn=b._47O,xr=B.isEditable,Ag=["northwest","north","northeast","east","southeast","south","southwest","west"],Fn=function(I,d,s,i,X,z,m,b,N,f){var r=I.x,Z=I.y,J=I.width,h=I.height,v={x:r+J/2,y:Z+h/2};i=i||0,d=hf(v,d.x-v.x,d.y-v.y,-i),m&&!b&&(d.x+=N,d.y+=f);var L=.01;if("northwest"===s?(d.x+X>r+J-L&&(d.x=r+J-X-L),d.y+X>Z+h-L&&(d.y=Z+h-X-L),I=k(d,{x:r+J,y:Z+h})):"north"===s?(d.y+X>Z+h-L&&(d.y=Z+h-X-L),I=k({x:r,y:d.y},{x:r+J,y:Z+h})):"northeast"===s?(d.x<r+X+L&&(d.x=r+X+L),d.y+X>Z+h-L&&(d.y=Z+h-X-L),I=k({x:r,y:d.y},{x:d.x,y:Z+h})):"west"===s?(d.x+X>r+J-L&&(d.x=r+J-X-L),I=k({x:d.x,y:Z},{x:r+J,y:Z+h})):"east"===s?(d.x<r+X+L&&(d.x=r+X+L),I=k({x:r,y:Z},{x:d.x,y:Z+h})):"southwest"===s?(d.x+X>r+J-L&&(d.x=r+J-X-L),d.y<Z+X+L&&(d.y=Z+X+L),I=k({x:d.x,y:Z},{x:r+J,y:d.y})):"south"===s?(d.y<Z+X+L&&(d.y=Z+X+L),I=k({x:r,y:Z},{x:r+J,y:d.y})):"southeast"===s&&(d.x<r+X+L&&(d.x=r+X+L),d.y<Z+X+L&&(d.y=Z+X+L),I=k({x:r,y:Z},d)),"keepRatio"===z&&(!m&&b||m&&!b)&&("northeast"===s||"southeast"===s||"northwest"===s||"southwest"===s)){var S=I.width,w=I.height,E=S/J,V=w/h,G=O(E,V);I.width=J*G,I.height=h*G,"northeast"===s?I.y=Z+(h-I.height):"northwest"===s?(I.y=Z+(h-I.height),I.x=r+(J-I.width)):"southwest"===s&&(I.x=r+(J-I.width))}I.x-=v.x,I.y-=v.y;var c=jm(t,I,i,v);return I.x=c.x-I.width/2,I.y=c.y-I.height/2,I},jb=function(Q,A,y,d){var P=Q.getRotation(),H=A,G=H.x,j=H.y,K=H.width,T=H.height,M={x:G+H.width/2,y:j+H.height/2};d=hf(M,d.x-M.x,d.y-M.y,-P),"northwest"===y?H=k(d,{x:G+K,y:j+T}):"north"===y?H=k({x:G,y:d.y},{x:G+K,y:j+T}):"northeast"===y?H=k({x:G,y:d.y},{x:d.x,y:j+T}):"west"===y?H=k({x:d.x,y:j},{x:G+K,y:j+T}):"east"===y?H=k({x:G,y:j},{x:d.x,y:j+T}):"southwest"===y?H=k({x:d.x,y:j},{x:G+K,y:d.y}):"south"===y?H=k({x:G,y:j},{x:G+K,y:d.y}):"southeast"===y&&(H=k({x:G,y:j},d)),Q.setRect(H),H.x-=M.x,H.y-=M.y;var D=jm(Q,H,P,M);Q.p(D.x,D.y)},tn=function(B,v,A,d,J,n,X,q){var a=t;n?(a=hf(t,J.x-v.x,J.y-v.y,-A),a.x-=X.x,a.y-=X.y):a=hf(t,J.x-v.x,J.y-v.y,0);var $={x:v.x+a.x,y:v.y+a.y};q&&($=q($.x,$.y)),$.e=B.getPoints().get(d).e,B.setPoint(d,$);var Y=B.getWidth(),S=B.getHeight(),O=B.p().x-Y/2,T=B.p().y-S/2;O-=v.x,T-=v.y;var u=jm(B,{x:O,y:T,width:Y,height:S},A,v);B.p(u.x,u.y)},An=function(G,C,H){var z,m;if(G instanceof S?(z=G.getPoints(),m=G.getSegments()):G instanceof W&&"points"===G.s("edge.type")&&(z=G.s("edge.points"),m=G.s("edge.segments"),z=Hl(C,z)),m&&m.size()||(m=Wq(z)),G instanceof S&&G.isClosePath()&&m.indexOf(5)<0&&(m=new s(m._as),m.add(5)),m)for(var w=-1,F=0;F<m.size();F++){if(F===H)return w;var d=m.get(F);1===d?w+=1:2===d?w+=1:3===d?w+=2:4===d&&(w+=3)}},Xr=function(j,V,A){var l,e;if(j instanceof S?(l=j.getPoints(),e=j.getSegments()):j instanceof W&&"points"===j.s("edge.type")&&(l=j.s("edge.points"),e=j.s("edge.segments"),l=Hl(V,l)),e&&e.size()||(e=Wq(l)),e)for(var g=-1,O=0;O<e.size();O++){var s=e.get(O);if(1===s?g+=1:2===s?g+=1:3===s?g+=2:4===s&&(g+=3),g===A)return O}},ps=function(N,w){var A=[N[0]-w[0],N[1]-w[1],N[2]-w[2]];return A},ac=function(){var J=new l(16);return J[0]=1,J[1]=0,J[2]=0,J[3]=0,J[4]=0,J[5]=1,J[6]=0,J[7]=0,J[8]=0,J[9]=0,J[10]=1,J[11]=0,J[12]=0,J[13]=0,J[14]=0,J[15]=1,J},Wb=function(m,e){var _=m[0],x=m[1],K=m[2];return m[0]=e[0]*_+e[4]*x+e[8]*K+e[12],m[1]=e[1]*_+e[5]*x+e[9]*K+e[13],m[2]=e[2]*_+e[6]*x+e[10]*K+e[14],m},Ur=function(D,j){if(j){var k=V(j),J=i(j),e=D[0],P=D[1],U=D[2],Y=D[3],F=D[8],l=D[9],w=D[10],N=D[11];D[0]=e*J-F*k,D[1]=P*J-l*k,D[2]=U*J-w*k,D[3]=Y*J-N*k,D[8]=e*k+F*J,D[9]=P*k+l*J,D[10]=U*k+w*J,D[11]=Y*k+N*J}},Ef=function(W,u){for(var v=W.s("grid.row.count"),o=W.s("grid.column.count"),Y=0;v>Y;Y++)for(var L=0;o>L;L++){var h=W.getCellRect(Y,L);if(G(h,u))return{rowIndex:Y,columnIndex:L,rect:h,grid:W}}return null},pm=function(q,i,D,k,w,p){var b={},F=D-q,L=k-i,M=m.sqrt(F*F+L*L),H=F/M,j=L/M,h=(-q+w)*H+(-i+p)*j;return 0>=h?(b.x=q,b.y=i):h>=M?(b.x=D,b.y=k):(b.x=q+h*H,b.y=i+h*j),F=w-b.x,L=p-b.y,b.z=m.sqrt(F*F+L*L),b},Id=function(T,v){var B,g,_,k,i,P,R,Z,h=T.getPoints(),u=T.getSegments(),D=T.p(),p=T.getRotation();if(!u||!(u.indexOf(3)>0||u.indexOf(4)>0)){for(Z=0;Z<=h.size()-1;Z++)if(Z===h.size()-1?(i=h.get(0),k=h.get(Z)):(k=h.get(Z),i=h.get(Z+1)),k=hf(D,k.x-D.x,k.y-D.y,p),i=hf(D,i.x-D.x,i.y-D.y,p),P=pm(k.x,k.y,i.x,i.y,v.x,v.y),R=P.z,R<(T.s("shape.border.width")||10)){g=k,_=i,B=Z;break}if(B!=t){var W=pm(g.x,g.y,_.x,_.y,v.x,v.y),F=a(g,W);return{attachIndex:B,attachOffset:F}}}},$e=function(C){for(var Z=C._data,F=Z.p(),l=Z.getRotation(),j=Z.getPoints(),q=t,g=[],T=0;T<j.size();T++)q=j.get(T),g.push(hf(F,q.x-F.x,q.y-F.y,l));C._55O.$15l=g};F.setImage("xeditinteractor_parentIcon",g),F.setImage("xeditinteractor_hostIcon",Z),F.setImage("xeditinteractor_edgeIcon",f),F.setImage("xeditinteractor_removeIcon",Bd),F.setImage("xeditinteractor_sourceIcon",nn),F.setImage("xeditinteractor_targetIcon",ws),F.setImage("xeditinteractor_elevationIcon",_f),F.setImage("xeditinteractor_tallIcon",de),B._editPointSize=X?24:9,B._edgeHelpers=["parent","remove","source","target"],B._leftTopHelpers=["parent"],B._rightTopHelpers=["host"],B._leftBottomHelpers=["edge"],B._rightBottomHelpers=["remove"],Ag=Ag.concat(Ag).concat(Ag),b._79o=function(){var s=this,p=s.gv,J=p.getZoom(),X=p._editInteractor,n=Of.call(s);if(!n)return null;var j=eh(s,!0),i=j[0],H=j[1],N={x:n.x,y:n.y,width:n.width,height:n.height},z=k(i,H);if(X instanceof e.XEditInteractor){N=r(N,z);var E=s._55O,Q=p.getEditPointSize()/J+2,o=0;E&&E._43O&&(o+=Q/2,M(N,o))}return N},b._47O=function(V){var I=this,q=I.gv,j=q._editInteractor;j instanceof e.XEditInteractor||Yn.call(I,V)},b.rectIntersects=function($){var j=this,M=j._data,I=j.gv,H=I.getZoom(),v=j._55O,x=I._editInteractor;if(x instanceof e.XEditInteractor&&I.isEditable(M)&&v&&v._43O&&"points"===M.s("edge.type")){var r=M.s("edge.points"),f=M.s("edge.segments");r=Hl(j,r),f&&f.size()||(f=Wq(r)),r=r._as;var R=!1,U=X?5:1,A=$.x+U,c=$.y+U,F={x:A,y:c};if(x._edge===M&&x._hoverSegmentIndex>=0){var Z=I._editInteractor._hoverSegmentIndex,s=f.get(Z),h=An(M,j,Z),Y=t;if(h!=t&&h>=0){var o=r[h],E=I.getSegmentHoverWidth()/H;if(2===s||1===s){var P=r[h+1];Y=uf(new Lm(o.x,o.y),new Lm(P.x,P.y),new Lm(F.x-E,F.y-E),new Lm(F.x+2*E,F.y+2*E)),Y.$62l===p&&(R=!0)}else if(3===s){var n=r[h+1],P=r[h+2];Y=uq(new Lm(o.x,o.y),new Lm(n.x,n.y),new Lm(P.x,P.y),new Lm(F.x-E,F.y-E),new Lm(F.x+2*E,F.y+2*E)),Y.$62l===p&&(R=!0)}else if(4===s){var J=r[h+1],L=r[h+2];P=r[h+3],Y=Pq(new Lm(o.x,o.y),new Lm(J.x,J.y),new Lm(L.x,L.y),new Lm(P.x,P.y),new Lm(F.x-E,F.y-E),new Lm(F.x+2*E,F.y+2*E)),Y.$62l===p&&(R=!0)}}}if(R)return!0}return t},J._47O=function(J){var d=this,f=d.gv,L=f._editInteractor;L instanceof e.XEditInteractor||Nq.call(d,J)},J.rectIntersects=function(W){var H=this,N=H._data,P=H.gv,a=P.getZoom(),_=H._55O,z=P._editInteractor;if(z instanceof e.XEditInteractor&&P.isEditable(N)&&_&&_._43O){var u=_.$15l,d=!1,O=X?5:1,I=W.x+O,y=W.y+O,m={x:I,y:y};if(u&&u.length===N.getPoints().size()||($e(H),u=_.$15l),z._shape===N&&z._hoverSegmentIndex>=0){var j=N.getSegments();j&&j.size()||(j=Wq(u));var Y=P._editInteractor._hoverSegmentIndex,G=j.get(Y),S=An(N,H,Y),h=t;if(S!=t&&S>=0){var L=u[S],$=P.getSegmentHoverWidth()/a;if(2===G||1===G){var q=u[S+1];h=uf(new Lm(L.x,L.y),new Lm(q.x,q.y),new Lm(m.x-$,m.y-$),new Lm(m.x+2*$,m.y+2*$)),h.$62l===p&&(d=!0)}else if(3===G){var Z=u[S+1],q=u[S+2];h=uq(new Lm(L.x,L.y),new Lm(Z.x,Z.y),new Lm(q.x,q.y),new Lm(m.x-$,m.y-$),new Lm(m.x+2*$,m.y+2*$)),h.$62l===p&&(d=!0)}else if(4===G){var V=u[S+1],i=u[S+2];q=u[S+3],h=Pq(new Lm(L.x,L.y),new Lm(V.x,V.y),new Lm(i.x,i.y),new Lm(q.x,q.y),new Lm(m.x-$,m.y-$),new Lm(m.x+2*$,m.y+2*$)),h.$62l===p&&(d=!0)}}}if(d)return!0}return t},J._48O=function(){var V=this,r=V.gv,L=r._editInteractor;L instanceof e.XEditInteractor?(c._48O.call(V),V._55O._43O&&$e(V)):nf.call(V)},J._79o=function(){var k=this,Q=k.gv,r=Q.getZoom(),q=Q._editInteractor,O=hk.call(k);if(O){var l={x:O.x,y:O.y,width:O.width,height:O.height};if(q instanceof e.XEditInteractor){var A=k._55O,B=Q.getEditPointSize()/r+2,V=0;A&&A._43O&&(V+=B/2,M(l,V))}return l}},c._47O=function(B){var G=this,m=G.gv,v=m._editInteractor;if(v instanceof e.XEditInteractor);else{var T=G._55O;T&&T._98o&&Ae.call(G,B)}},c.getSelectWidth=function(){var K=this,Y=K.gv,$=Y._editInteractor,L=K._data;return Y.isEditable(L)&&$ instanceof e.XEditInteractor?0:ii.call(K)},c._80o=function(Y){var d=this,J=d.gv._editInteractor;if(Tr.call(d,Y),J&&J._debug){Y.save(),Y.beginPath(),Y.lineWidth=1,Y.strokeStyle="green";var w=d._79o();w&&(Y.rect(w.x,w.y,w.width,w.height),Y.stroke()),Y.restore()}},J._80o=function(F){var b=this,O=b.gv._editInteractor;if(xf.call(b,F),O&&O._debug){F.save(),F.beginPath(),F.lineWidth=1,F.strokeStyle="green";var M=b._79o();F.rect(M.x,M.y,M.width,M.height),F.stroke(),F.restore()}},c._48O=function(){var B=this,j=B.gv,Q=B._data,C=j._editInteractor,A=B._55O,L=Q.p(),T=Q.getRotation();if(C instanceof e.XEditInteractor){if(A._42O){var x=Tp(L,Q.getWidth(),Q.getHeight(),T),U=x[0],E=x[1],q=x[2],d=x[3],Y=x[4],O=x[5],c=x[6],R=x[7];A.$45l=[U,Y,E,O,d,c,q,R]}}else ge.call(B)},B.getResizeMode=function(){return this.$25l||"normal"},B.setResizeMode=function(p){var i=this.$25l;this.$25l=p,this.fp("resizeMode",i,p)},B.getSnapAngle=function(){return this.$26l||Math.PI/36},B.setSnapAngle=function(T){var K=this.$26l;this.$26l=T,this.fp("snapAngle",K,T)},B.getSnapSpacing=function(){return this.$27l},B.setSnapSpacing=function(X){var G=this.$27l;this.$27l=X,this.fp("snapSpacing",G,X)},B.getPointSnapSpacing=function(){return this._pointSnapSpacing},B.setPointSnapSpacing=function(r){var L=this._pointSnapSpacing;this._pointSnapSpacing=r,this.fp("pointSnapSpacing",L,r)},B.setHelperEditableFunc=function(h){var E=this._helperEditableFunc;this._helperEditableFunc=h,this.fp("helperEditableFunc",E,h)},B.getHelperEditableFunc=function(){return this._helperEditableFunc},B.setLeftTopHelpers=function(e){var c=this._leftTopHelpers;this._leftTopHelpers=e,this.fp("leftTopHelpers",c,e)},B.getLeftTopHelpers=function(){return this._leftTopHelpers},B.setLeftTopHelpersAlign=function(P){var g=this._leftTopHelpersAlign;this._leftTopHelpersAlign=P,this.fp("leftTopHelpersAlign",g,P)},B.getLeftTopHelpersAlign=function(){return this._leftTopHelpersAlign},B.setRightTopHelpers=function(R){var E=this._rightTopHelpers;this._rightTopHelpers=R,this.fp("rightTopHelpers",E,R)},B.getRightTopHelpers=function(){return this._rightTopHelpers},B.setRightTopHelpersAlign=function(F){var Y=this._rightTopHelpersAlign;this._rightTopHelpersAlign=F,this.fp("rightTopHelpersAlign",Y,F)},B.getRightTopHelpersAlign=function(){return this._rightTopHelpersAlign},B.setLeftBottomHelpers=function(E){var _=this._leftBottomHelpers;this._leftBottomHelpers=E,this.fp("leftBottomHelpers",_,E)},B.getLeftBottomHelpers=function(){return this._leftBottomHelpers},B.setLeftBottomHelpersAlign=function(L){var U=this._leftBottomHelpersAlign;this._leftBottomHelpersAlign=L,this.fp("leftBottomHelpersAlign",U,L)},B.getLeftBottomHelpersAlign=function(){return this._leftBottomHelpersAlign},B.setRightBottomHelpers=function(p){var m=this._rightBottomHelpers;this._rightBottomHelpers=p,this.fp("rightBottomHelpers",m,p)},B.getRightBottomHelpers=function(){return this._rightBottomHelpers},B.setRightBottomHelpersAlign=function(k){var c=this._rightBottomHelpersAlign;this._rightBottomHelpersAlign=k,this.fp("rightBottomHelpersAlign",c,k)},B.getRightBottomHelpersAlign=function(){return this._rightBottomHelpersAlign},B.setEdgeHelpers=function(c){var I=this._edgeHelpers;this._edgeHelpers=c,this.fp("edgeHelpers",I,c)},B.getEdgeHelpers=function(){return this._edgeHelpers},B.isHelperEditable=function(w,N){return w instanceof W&&("host"===N||"edge"===N||"elevation"===N||"tall"===N)?!1:w instanceof I&&("source"===N||"target"===N)?!1:"pointElevation"===N?this._helperEditableFunc?this._helperEditableFunc(w,N):!1:this._helperEditableFunc?this._helperEditableFunc(w,N):!0},B.getEditHelperSize=function(){return this._editHelperSize||(X?28:16)},B.setEditHelperSize=function(n){var T=this._editHelperSize;this._editHelperSize=n,this.fp("editHelperSize",T,n)},B.getEditRectBorderColor=function(){return this.$28l||"rgb(0, 168, 255)"},B.setEditRectBorderColor=function(M){var b=this.$28l;this.$28l=M,this.fp("editRectBorderColor",b,M)},B.getNodeBorderColor=function(){return this.$29l||"#1ABC9C"},B.setNodeBorderColor=function(J){var V=this.$29l;this.$29l=J,this.fp("nodeBorderColor",V,J)},B.getEditRectBorderStyle=function(){return this.$30l||"dashed"},B.setEditRectBorderStyle=function($){var l=this.$30l;this.$30l=$,this.fp("editRectBorderStyle",l,$)},B.getControlPointBackground=function(){return this.$31l||"#ff0"},B.setControlPointBackground=function(b){var o=this.$31l;this.$31l=b,this.fp("controlPointBackground",o,b)},B.getControlPointBorderColor=function(){return this.$32l||this._editPointBorderColor},B.setControlPointBorderColor=function(g){var j=this.$32l;this.$32l=g,this.fp("controlPointBorderColor",j,g)},B.getJoinPointBackground=function(){return this.$33l||this._editPointBackground},B.setJoinPointBackground=function(r){var U=this.$33l;this.$33l=r,this.fp("joinPointBackground",U,r)},B.getJoinPointBorderColor=function(){return this.$34l||this._editPointBorderColor},B.setJoinPointBorderColor=function(K){var O=this.$34l;this.$34l=K,this.fp("joinPointBorderColor",O,K)},B.getDirectionLineColor=function(){return this.$35l||"#888"},B.setDirectionLineColor=function(d){var W=this.$35l;this.$35l=d,this.fp("directionLineColor",W,d)},B.getSegmentHoverColor=function(){return this.$36l||"rgba(255, 0, 0, 0.3)"},B.setSegmentHoverColor=function(S){var V=this.$36l;this.$36l=S,this.fp("segmentHoverColor",V,S)},B.getSegmentHoverWidth=function(){return this.$22l||(X?16:8)},B.setSegmentHoverWidth=function(M){var p=this.$22l;this.$22l=M,this.fp("segmentHoverWidth",p,M)},B.getSnapPointBorderColor=function(){return this.$38l||"#f00"},B.setSnapPointBorderColor=function(T){var J=this.$38l;this.$38l=T,this.fp("snapPointBorderColor",J,T)},B.getEditRectPadding=function(){return this.$39l!=t?this.$39l:6},B.setEditRectPadding=function(z){var Q=this.$39l;this.$39l=z,this.fp("editRectPading",Q,z)},B.isRectEditable=function(M){var Y=this,c=Y._editInteractor;return c instanceof e.XEditInteractor?Y._rectEditableFunc?Y._rectEditableFunc(M):!0:mi.call(Y,M)},B.isPointEditable=function(E){var t=this,M=t._editInteractor;return M instanceof e.XEditInteractor?t._pointEditableFunc?t._pointEditableFunc(E):!0:Yd.call(t,E)},B.validateImpl=function(){var i=this,X=i.$14l,k=i._editInteractor;if(X){var E=i.getWidth(),C=i.getHeight();(E!==X.clientWidth||C!==X.clientHeight)&&(k&&(k._68I=1),U.setCanvas(X,E,C),i._32I=1)}Vo.call(this)},B.isEditable=function(G){var S=xr.call(this,G),H=this._editInteractor;if(H instanceof e.XEditInteractor&&G instanceof W){if(!G.s("2d.editable"))return!1;var s=this.getEditableFunc();S=s?s(G):!0}return S},B._42=function(v,x){var O=this,n=O._editInteractor;Fe.call(O,v,x),n instanceof e.XEditInteractor&&n._68I&&n._42()},B.isSnapPoint=function(){return!0};var hh=function(B){arguments.length>0&&this.$58l(B)},np=hh.prototype;np.$58l=function(A){this.$62l=A,this.points=new Array},np.$56l=function(d){this.points.push(d)},np.$57l=function(t){this.points=this.points.concat(t)};var Lm=function(N,y){arguments.length>0&&this.$58l(N,y)},Mn=Lm.prototype;Mn.$58l=function(o,x){this.x=o,this.y=x},Mn.add=function(Z){return new Lm(this.x+Z.x,this.y+Z.y)},Mn.addEquals=function(v){return this.x+=v.x,this.y+=v.y,this},Mn.$55l=function(z){return new Lm(this.x*z,this.y*z)},Mn.eq=function(N){return this.x==N.x&&this.y==N.y},Mn.lt=function($){return this.x<$.x&&this.y<$.y},Mn.lte=function(G){return this.x<=G.x&&this.y<=G.y},Mn.gt=function(M){return this.x>M.x&&this.y>M.y},Mn.gte=function(n){return this.x>=n.x&&this.y>=n.y},Mn.lerp=function(S,_){return new Lm(this.x+(S.x-this.x)*_,this.y+(S.y-this.y)*_)},Mn.distanceFrom=function(Z){var r=this.x-Z.x,T=this.y-Z.y;return z(r*r+T*T)},Mn.min=function(H){return new Lm(O(this.x,H.x),O(this.y,H.y))},Mn.max=function(u){return new Lm(v(this.x,u.x),v(this.y,u.y))},Mn.toString=function(){return this.x+","+this.y};var Lj=function(){this.$58l(arguments)},ng=Lj.prototype;Lj.TO=1e-6,Lj.AC=6,ng.$58l=function(c){this.co=new Array;for(var r=c.length-1;r>=0;r--)this.co.push(c[r])},ng.$55l=function(t){for(var A=new Lj,O=0;O<=this.$50l()+t.$50l();O++)A.co.push(0);for(var O=0;O<=this.$50l();O++)for(var $=0;$<=t.$50l();$++)A.co[O+$]+=this.co[O]*t.co[$];return A},ng.$59l=function(){for(var g=this.$50l();g>=0&&o(this.co[g])<=Lj.TO;g--)this.co.pop()},ng.$50l=function(){return this.co.length-1},ng.$51l=function(){var t;switch(this.$59l(),this.$50l()){case 0:t=new Array;break;case 1:t=this.$52l();break;case 2:t=this.$53l();break;case 3:t=this.$54l();break;case 4:t=this.$63l();break;default:t=new Array}return t},ng.$52l=function(){var S=new Array,w=this.co[1];return 0!=w&&S.push(-this.co[0]/w),S},ng.$53l=function(){var o=new Array;if(2==this.$50l()){var L=this.co[2],H=this.co[1]/L,I=this.co[0]/L,F=H*H-4*I;if(F>0){var k=z(F);o.push(.5*(-H+k)),o.push(.5*(-H-k))}else 0==F&&o.push(.5*-H)}return o},ng.$63l=function(){var A=new Array;if(4==this.$50l()){var M=this.co[4],Z=this.co[3]/M,N=this.co[2]/M,c=this.co[1]/M,b=this.co[0]/M,r=new Lj(1,-N,Z*c-4*b,-Z*Z*b+4*N*b-c*c).$54l(),B=r[0],d=Z*Z/4-N+B;if(o(d)<=Lj.TO&&(d=0),d>0){var Y=z(d),W=3*Z*Z/4-Y*Y-2*N,e=(4*Z*N-8*c-Z*Z*Z)/(4*Y),k=W+e,C=W-e;if(o(k)<=Lj.TO&&(k=0),o(C)<=Lj.TO&&(C=0),k>=0){var I=z(k);A.push(-Z/4+(Y+I)/2),A.push(-Z/4+(Y-I)/2)}if(C>=0){var I=z(C);A.push(-Z/4+(I-Y)/2),A.push(-Z/4-(I+Y)/2)}}else if(0>d);else{var e=B*B-4*b;if(e>=-Lj.TO){if(0>e&&(e=0),e=2*z(e),W=3*Z*Z/4-2*N,W+e>=Lj.TO){var G=z(W+e);A.push(-Z/4+G/2),A.push(-Z/4-G/2)}if(W-e>=Lj.TO){var G=z(W-e);A.push(-Z/4+G/2),A.push(-Z/4-G/2)}}}}return A},ng.$54l=function(){var L=new Array;if(3==this.$50l()){var n=this.co[3],y=this.co[2]/n,N=this.co[1]/n,v=this.co[0]/n,t=(3*N-y*y)/3,a=(2*y*y*y-9*N*y+27*v)/27,j=y/3,q=a*a/4+t*t*t/27,m=a/2;if(o(q)<=Lj.TO&&(q=0),q>0){var E,T,p=z(q);E=-m+p,T=E>=0?H(E,1/3):-H(-E,1/3),E=-m-p,E>=0?T+=H(E,1/3):T-=H(-E,1/3),L.push(T-j)}else if(0>q){var Q=z(-t/3),h=_(z(-q),-m)/3,F=i(h),g=V(h),I=z(3);L.push(2*Q*F-j),L.push(-Q*(F+I*g)-j),L.push(-Q*(F-I*g)-j)}else{var E;E=m>=0?-H(m,1/3):H(-m,1/3),L.push(2*E-j),L.push(-E-j)}}return L};var aj=function(F,u){arguments.length>0&&this.$58l(F,u)},ne=aj.prototype;ne.$58l=function(Q,i){this.x=Q,this.y=i},ne.length=function(){return z(this.x*this.x+this.y*this.y)},ne.$60l=function(m){return this.x*m.x+this.y*m.y};var Li=function(Y,X,K,V){var q,M=(V.x-K.x)*(Y.y-K.y)-(V.y-K.y)*(Y.x-K.x),m=(X.x-Y.x)*(Y.y-K.y)-(X.y-Y.y)*(Y.x-K.x),w=(V.y-K.y)*(X.x-Y.x)-(V.x-K.x)*(X.y-Y.y);if(0!=w){var i=M/w,C=m/w;i>=0&&1>=i&&C>=0&&1>=C?(q=new hh(p),q.points.push(new Lm(Y.x+i*(X.x-Y.x),Y.y+i*(X.y-Y.y)))):q=new hh(L)}else q=0==M||0==m?new hh("C"):new hh("P");return q},bl=function(u,$,x,M,m){var k,C,j,a,Y,s,K,V=M.min(m),e=M.max(m),H=new hh(L);k=$.$55l(-2),j=u.add(k.add(x)),k=u.$55l(-2),C=$.$55l(2),a=k.add(C),Y=new Lm(u.x,u.y),K=new aj(M.y-m.y,m.x-M.x),s=M.x*m.y-m.x*M.y;for(var f=new Lj(K.$60l(j),K.$60l(a),K.$60l(Y)+s).$51l(),v=0;v<f.length;v++){var q=f[v];if(q>=0&&1>=q){var h=u.lerp($,q),P=$.lerp(x,q),X=h.lerp(P,q);M.x==m.x?V.y<=X.y&&X.y<=e.y&&(H.$62l=p,H.$56l(X)):M.y==m.y?V.x<=X.x&&X.x<=e.x&&(H.$62l=p,H.$56l(X)):X.gte(V)&&X.lte(e)&&(H.$62l=p,H.$56l(X))}}return H},uq=function(A,X,P,_,u){var s=_.min(u),S=_.max(u),H=new Lm(S.x,s.y),B=new Lm(s.x,S.y),C=bl(A,X,P,s,H),n=bl(A,X,P,H,S),v=bl(A,X,P,S,B),R=bl(A,X,P,B,s),J=new hh(L);return J.$57l(C.points),J.$57l(n.points),J.$57l(v.points),J.$57l(R.points),J.points.length>0&&(J.$62l=p),J},eq=function(M,e,Z,w,o,B){var W,R,s,O,v,$,S,H,h,m,j=o.min(B),b=o.max(B),U=new hh(L);W=M.$55l(-1),R=e.$55l(3),s=Z.$55l(-3),O=W.add(R.add(s.add(w))),v=new aj(O.x,O.y),W=M.$55l(3),R=e.$55l(-6),s=Z.$55l(3),O=W.add(R.add(s)),$=new aj(O.x,O.y),W=M.$55l(-3),R=e.$55l(3),s=W.add(R),S=new aj(s.x,s.y),H=new aj(M.x,M.y),m=new aj(o.y-B.y,B.x-o.x),h=o.x*B.y-B.x*o.y;for(var J=new Lj(m.$60l(v),m.$60l($),m.$60l(S),m.$60l(H)+h).$51l(),r=0;r<J.length;r++){var D=J[r];if(D>=0&&1>=D){var E=M.lerp(e,D),T=e.lerp(Z,D),u=Z.lerp(w,D),i=E.lerp(T,D),t=T.lerp(u,D),q=i.lerp(t,D);o.x==B.x?j.y<=q.y&&q.y<=b.y&&(U.$62l=p,U.$56l(q)):o.y==B.y?j.x<=q.x&&q.x<=b.x&&(U.$62l=p,U.$56l(q)):q.gte(j)&&q.lte(b)&&(U.$62l=p,U.$56l(q))}}return U},Pq=function(g,y,u,M,q,G){var T=q.min(G),_=q.max(G),s=new Lm(_.x,T.y),J=new Lm(T.x,_.y),j=eq(g,y,u,M,T,s),B=eq(g,y,u,M,s,_),V=eq(g,y,u,M,_,J),A=eq(g,y,u,M,J,T),l=new hh(L);return l.$57l(j.points),l.$57l(B.points),l.$57l(V.points),l.$57l(A.points),l.points.length>0&&(l.$62l=p),l},uf=function(g,Q,N,_){var i=N.min(_),s=N.max(_),Y=new Lm(s.x,i.y),X=new Lm(i.x,s.y),H=Li(i,Y,g,Q),J=Li(Y,s,g,Q),c=Li(s,X,g,Q),T=Li(X,i,g,Q),t=new hh(L);return t.$57l(H.points),t.$57l(J.points),t.$57l(c.points),t.$57l(T.points),t.points.length>0&&(t.$62l=p),t},Pj=e.XEditInteractor=function(q){var O=this,B=O._view=document.createElement("canvas");B.className="editCanvas",B.style.position="absolute",Pj.superClass.constructor.call(O,q)};F.def(Pj,e.Interactor,{ms_edit:1,setUp:function(){var k=this,$=k.gv,l=$.getView(),q=k._view;Pj.superClass.setUp.call(k),$.setEditInteractor(k),$.$14l=q,$._79O?l.insertBefore(q,$._79O):l.appendChild(q);var I=k.$49l=k.$11l.bind(k);$.dm().md(I),$.sm().ms(I),$.mp(I)},tearDown:function(){var O=this,b=O.gv,v=b.getView(),F=O.$49l;Pj.superClass.tearDown.call(O),b.setEditInteractor(t),b.$14l=t,v.removeChild(O._view),b.dm().umd(F),b.sm().ums(F),b.ump(F)},clear:function(){var R=this,T=R.gv;delete R._hoverSegmentIndex,delete R._edge,delete R._shape,delete T._editing,delete R.$10l,delete R.$13l,delete R.$9l,delete R._removePointIndex,delete R._lp,R.$12l="",delete R.$40l,delete R.$67l,delete R.$72l,delete R.$73l,delete R.$75l,delete R.$1l,delete R.$3l,delete R.$2l,delete R.$92l,delete R.$93l,delete R.$94l,R.clearDragging()},handle_keydown:function(t){this.$48l!==t.shiftKey&&(this.$48l=t.shiftKey,this.handle_mousemove(t,D,!0))},handle_keyup:function(U){this.$48l!==U.shiftKey&&(this.$48l=U.shiftKey,this.handle_mousemove(U,D,!0))},handle_touchstart:function(d){this.handle_mousemove(d),this.handle_mousedown(d)},handle_mousedown:function(O){A(O);var N=this,R=N.$13l,S=N.gv,c=S.dm(),K=S.sm(),g=S.getZoom(),$=S.lp(O),B=F.isDoubleClick(O),w=F.isLeftButton(O),M=N.$7l,k=N._shape,z=N._hoverSegmentIndex,l=N._edge,L=N.$87l,D=N.$88l,G=function(){N._68I||L===N.$87l&&D===N.$88l||N.$43l()};if(7!==N.$67l&&(delete N.$87l,delete N.$88l),w&&(k||l)&&z>=0&&B&&(k&&K.contains(k)||l&&K.contains(l))){var u=oi.call(N,k||l,z,$);return N.addShapePoint(k||l,z,u),n(function(){N.handle_mousemove(O)},40),void 0}if(w&&(k||l)&&N._removePointIndex>=0&&B)return N.removeShapePoint(),N.$5l=1,n(function(){N.handle_mousemove(O)},40),void 0;if(!w||!S._editing)return G(),void 0;if(k&&R>=0){var W=k.getPoints().get(R),Y=k.p(),t=hf(Y,W.x-Y.x,W.y-Y.y,-M+k.getRotation());f=hf(Y,$.x-Y.x,$.y-Y.y,-M),N.$24l={x:f.x-t.x,y:f.y-t.y},N.startDragging(O),c.beginTransaction(),N.fi({kind:"beginEditPoint",event:O,data:k,index:R}),N.$88l=R,N.$87l=k}else if(N.$10l){var P=S.sm().getSelection(),i=N.$6l,J=N.$1l={},j=N.$3l={},T=N.$16l[h[N.$10l]],X={x:i.x,y:i.y},s={x:i.x+i.width/2,y:i.y+i.height/2};N.$24l={x:$.x-T.x/g,y:$.y-T.y/g},N.$2l=x(N.$8l),N.$4l=x(i),P.each(function(P){if(P instanceof I){var o=P.p(),Q=P.getWidth(),O=P.getHeight(),K=hf(s,o.x-s.x,o.y-s.y,-M);J[P.getId()]={x:o.x-Q/2,y:o.y-O/2,width:Q,height:O},j[P.getId()]={x:(K.x-X.x)/i.width,y:(K.y-X.y)/i.height}}}),N.startDragging(O),c.beginTransaction(),N.fi({kind:"beginEditRect",event:O,direction:N.$10l})}else if(l&&R>=0){var v=Hl(S.getDataUI(l),l.s("edge.points")),W=v.get(R);N.$24l={x:$.x-W.x,y:$.y-W.y},N.startDragging(O),c.beginTransaction(),N.fi({kind:"beginEditPoint",event:O,data:l,index:R}),N.$88l=R,N.$87l=l}else if(N.$40l){var i=N.$6l,s={x:i.x+i.width/2,y:i.y+i.height/2},p=x(N.$23l);p.x/=g,p.y/=g;var Q=hf(s,p.x-s.x,p.y-s.y,-M),f=hf(s,$.x-s.x,$.y-s.y,-M);N.$24l={x:f.x-Q.x,y:f.y-Q.y},N.startDragging(O),c.beginTransaction(),N.fi({kind:"beginEditRotation",event:O,data:N._rotationNode})}else if([1,2,3,5,6,7,8,9].indexOf(N.$67l)>=0){var o=N.$67l;(7===o||8===o||9===o)&&c.beginTransaction(),N.startDragging(O)}else if(N.$71l&&B&&N.$79l(N.$71l,$)){var V=K.toSelection();c.beginTransaction(),V.each(function(J){c.remove(J)}),c.endTransaction()}G()},$11l:function(){var z=this,o=z.gv;o._editing&&(z.$13l==t||z._shape==t&&z._edge==t)&&(z.$73l==t||1!==z.$67l&&5!==z.$67l&&6!==z.$67l)||(z.$5l=1),z._68I=1},$46l:function(B){var b=this,N=b.gv,A=N.lp(B),C=[];return jo(N,function(i){var k=N.getDataUI(i);if(k){var s=k._79o();G(s,A)&&C.push(i)}}),C},$47l:function(n){var R=this,X=R.$13l,u=R.gv.dm();R.$10l?(R.fi({kind:"endEditRect",event:n,direction:R.$10l}),u.endTransaction()):R._shape&&X>=0?(R.fi({kind:"endEditPoint",event:n,data:R._shape,index:X}),u.endTransaction()):R._edge&&X>=0?(R.fi({kind:"endEditPoint",event:n,data:R._edge,index:X}),u.endTransaction()):R.$23l&&R.$40l&&(R.fi({kind:"endEditRotation",event:n}),u.endTransaction())},handleWindowTouchEnd:function(n){this.handleWindowMouseUp(n)},handleWindowMouseUp:function(L){var o=this,Z=o.gv,x=Z.dm(),K=o._shape,p=o._edge,n=o.$13l,d=o.$40l,_=o.$9l,y=o.$10l,B=o.$67l;if((K||p)&&n>=0&&_>=0){var r,V;if(K){var J=K.p(),e=K.getRotation();r=K.getPoints(),V=r.get(_),tn(K,J,e,n,V,!1)}else if(r=Hl(Z.getDataUI(p),p.s("edge.points"),!0),V=r.get(_),0===n){var g=r.get(0);p.s("edge.source.offset.x",V.x-g.x),p.s("edge.source.offset.y",V.y-g.y)}else if(n===r.size()-1){var P=r.get(r.size()-1);p.s("edge.target.offset.x",V.x-P.x),p.s("edge.target.offset.y",V.y-P.y)}else"points"===p.s("edge.type")&&(r.set(n,V),p.s("edge.points",ic(r)))}o.$47l(L);var v=o.$73l;1===B?(x.beginTransaction(),v?Z.sm().each(function(k){if(k.setHost&&Z.isHelperEditable(k,"host")){k.setHost(v);
var T=o.$75l,p=o.$74l;T&&(k.s("attach.row.index",T.rowIndex),k.s("attach.column.index",T.columnIndex)),p&&(k.s("attach.index",p.attachIndex),k.s("attach.offset",p.attachOffset),k.s("attach.offset.relative",!1),k.s("attach.offset.opposite",!1))}}):Z.sm().each(function(c){c.setHost&&Z.isHelperEditable(c,"host")&&(c.setHost(t),c.s("attach.row.index",D),c.s("attach.column.index",D),c.s("attach.index",D),c.s("attach.offset",D),c.s("attach.offset.relative",!1),c.s("attach.offset.opposite",!1))}),x.endTransaction()):2===B?(x.beginTransaction(),v?Z.sm().each(function(X){X.setParent&&Z.isHelperEditable(X,"parent")&&X.setParent(v)}):Z.sm().each(function(p){p.setParent&&Z.isHelperEditable(p,"parent")&&p.setParent(t)}),x.endTransaction()):3===B?v&&(x.beginTransaction(),Z.sm().each(function(h){if(Z.isHelperEditable(h,"edge")&&h instanceof I&&v instanceof I){var j=new N.Edge;x.add(j),j.setSource(h),j.setTarget(v),o.onEdgeCreated&&o.onEdgeCreated(L,j)}}),x.endTransaction()):5===B||6===B?v&&(x.beginTransaction(),Z.sm().each(function(K){K instanceof W&&v instanceof I&&(5===B&&Z.isHelperEditable(K,"source")?K.setSource(v):6===B&&Z.isHelperEditable(K,"source")&&K.setTarget(v))}),x.endTransaction()):(7===B||8===B||9===B)&&x.endTransaction(),(y||d)&&o.$43l(!0),X?(o.clear(),delete o.$64l,o._68I||o.$43l()):(o.handle_mousemove(L,!0),B&&!o._68I&&o.$43l())},handleWindowTouchMove:function(v){this.handleWindowMouseMove(v)},handleWindowMouseMove:function(t){this._78I(t)},handle_mousemove:function(C,m,N){if(!this._pause){if(!N){var p=X?wj(C):C;this.$61l={clientX:p.clientX,clientY:p.clientY}}if(m===!0||!d()){var c=this,j=c.gv,P=!1,a=t;c.clear(),j.sm().size()>0&&(a=j.lp(N?c.$61l:C),P=c._79I(C,a)),P&&(j._editing=1),c.$12l!==c.$65l&&(c.$65l=c.$12l,c.setCursor(c.$12l)),c.$40l!==c.$64l&&(c.$64l=c.$40l,c._68I||c.$43l()),c._hoverSegmentIndex!==c.$66l&&(c.$66l=c._hoverSegmentIndex,c._68I||c.$43l())}}},_78I:function(p){this.autoScroll(p);var g=this,C=g.gv,x=C.lp(p),s=C.getZoom(),V=g.$13l;if((g._shape||g._edge)&&V>=0){var Z,A,D,U=g._shape,J=g._edge,b=g.$24l,m=C.getPointSnapSpacing(),L=function(I,q){return m==t||isNaN(m)?{x:I,y:q}:{x:u(I/m)*m,y:u(q/m)*m}};if(U){Z=U.getPoints();var X=U.p(),v=U.getRotation(),N=0;A=hf(X,x.x-X.x,x.y-X.y,-v),tn(U,X,v,V,x,!0,b,L),g.fi({kind:"betweenEditPoint",event:p,data:U,index:V})}else if(J){Z=Hl(C.getDataUI(J),J.s("edge.points"),!0),x.x-=b.x,x.y-=b.y,A=x;var E,j,i=J.s("edge.offset"),O=Z.size(),K=O>2;if(0===V){var l=Z.get(0);i&&(l=pd(l,Z.get(1),-i,K),x=pd(x,Z.get(1),-i,K)),E=x.x-l.x,j=x.y-l.y,D=L(E,j),J.s("edge.source.offset.x",D.x),J.s("edge.source.offset.y",D.y)}else if(V===O-1){var w=Z.get(O-1);i&&(w=pd(w,Z.get(O-2),-i,K),x=pd(x,Z.get(O-2),-i,K)),E=x.x-w.x,j=x.y-w.y,D=L(E,j),J.s("edge.target.offset.x",D.x),J.s("edge.target.offset.y",D.y)}else"points"===J.s("edge.type")&&(D=L(x.x,x.y),D.e=Z.get(V).e,Z.set(V,D),J.s("edge.points",ic(Z)));g.fi({kind:"betweenEditPoint",event:p,data:J,index:V})}if(delete g.$9l,C.isSnapPoint(U)||C.isSnapPoint(J))for(N=0;N<Z.size();N++)if(N!==V){var e=Z.get(N);if(a(e,A)<C.getEditPointSize()/s){g.$9l=N;break}}}else if(g.$10l){var b=g.$24l;x.x-=b.x,x.y-=b.y;var T=C.sm().getSelection(),M=g.$1l,k=g.$7l,H=g.$10l,h=g.$4l,P=g.$2l,y=C.getEditRectPadding()/s,$=2*y,d=C.getSnapSpacing(),B=d!=t&&!isNaN(d),f=Fn(P,x,H,k,2*y,C.getResizeMode(),B,!0),G=g.$6l;if(B){var c=f.width-$,R=f.height-$,r=u(c/d)*d,Ld=u(R/d)*d,Po=r-c,Ck=Ld-R;("west"===H||"northwest"===H||"southwest"===H)&&(Po=-Po),("north"===H||"northwest"===H||"northeast"===H)&&(Ck=-Ck),f=Fn(P,x,H,k,2*y,C.getResizeMode(),B,!1,Po,Ck)}g.$8l=f,G.x=f.x+y,G.y=f.y+y,G.width=f.width-$,G.height=f.height-$;var Fm=f.x+f.width/2,Gf=f.y+f.height/2,wf=G.x,Rb=G.y,Ll=G.width/h.width,_k=G.height/h.height;T.each(function(x){if(x instanceof I&&C.isEditable(x)&&C.isRectEditable(x)){var s=M[x.getId()],E=g.$3l[x.getId()],L={x:s.x+s.width/2,y:s.y+s.height/2},u=0,a=0,l=H,n=180*o(k-x.getRotation())/q;"northeast"===H?n>=315||45>n?(u=s.width*Ll+s.x,a=s.height*(1-_k)+s.y,l="northeast"):n>=45&&135>n?(u=s.width*(1-_k)+s.x,a=s.height*(1-Ll)+s.y,l="northwest"):n>=135&&225>n?(u=s.width*(1-Ll)+s.x,a=s.height*_k+s.y,l="southwest"):(u=s.width*_k+s.x,a=s.height*Ll+s.y,l="southeast"):"north"===H?n>=315||45>n?(a=s.height*(1-_k)+s.y,l="north"):n>=45&&135>n?(u=s.width*(1-_k)+s.x,l="west"):n>=135&&225>n?(a=s.height*_k+s.y,l="south"):(u=s.width*_k+s.x,l="east"):"northwest"===H?n>=315||45>n?(u=s.width*(1-Ll)+s.x,a=s.height*(1-_k)+s.y,l="northwest"):n>=45&&135>n?(u=s.width*(1-_k)+s.x,a=s.height*Ll+s.y,l="southwest"):n>=135&&225>n?(u=s.width*Ll+s.x,a=s.height*_k+s.y,l="southeast"):(u=s.width*_k+s.x,a=s.height*(1-Ll)+s.y,l="northeast"):"west"===H?n>=315||45>n?(u=s.width*(1-Ll)+s.x,l="west"):n>=45&&135>n?(a=s.height*Ll+s.y,l="south"):n>=135&&225>n?(u=s.width*Ll+s.x,l="east"):(a=s.height*(1-Ll)+s.y,l="north"):"southwest"===H?n>=315||45>n?(u=s.width*(1-Ll)+s.x,a=s.height*_k+s.y,l="southwest"):n>=45&&135>n?(u=s.width*_k+s.x,a=s.height*Ll+s.y,l="southeast"):n>=135&&225>n?(u=s.width*Ll+s.x,a=s.height*(1-_k)+s.y,l="northeast"):(u=s.width*(1-_k)+s.x,a=s.height*(1-Ll)+s.y,l="northwest"):"east"===H?n>=315||45>n?(u=s.width*Ll+s.x,l="east"):n>=45&&135>n?(a=s.height*(1-Ll)+s.y,l="north"):n>=135&&225>n?(u=s.width*(1-Ll)+s.x,l="west"):(a=s.height*Ll+s.y,l="south"):"south"===H?n>=315||45>n?(a=s.height*_k+s.y,l="south"):n>=45&&135>n?(u=s.width*_k+s.x,l="east"):n>=135&&225>n?(a=s.height*(1-_k)+s.y,l="north"):(u=s.width*(1-_k)+s.x,l="west"):"southeast"===H&&(n>=315||45>n?(u=s.width*Ll+s.x,a=s.height*_k+s.y,l="southeast"):n>=45&&135>n?(u=s.width*_k+s.x,a=s.height*(1-Ll)+s.y,l="northeast"):n>=135&&225>n?(u=s.width*(1-Ll)+s.x,a=s.height*(1-_k)+s.y,l="northwest"):(u=s.width*(1-_k)+s.x,a=s.height*Ll+s.y,l="southwest"));var V=hf(L,u-L.x,a-L.y,x.getRotation());jb(x,s,l,{x:V.x,y:V.y});var i=wf+G.width*E.x,f=Rb+G.height*E.y,W={x:i,y:f};W=hf({x:Fm,y:Gf},W.x-Fm,W.y-Gf,k),x.p(W.x,W.y)}}),g.fi({kind:"betweenEditRect",event:p,direction:H})}else if(g.$23l&&g.$40l){var wp=g.$8l,Up=wp.width,ur=wp.height,X={x:wp.x+Up/2,y:wp.y+ur/2},b=g.$24l,Je=g.$23l,Im=Je.x/s-X.x,nn=Je.y/s-X.y,Qm=z(Im*Im+nn*nn),je=Math.asin(b.x/Qm),Eh=C.sm().getSelection(),Cg=Y+_(x.y-X.y,x.x-X.x)-je,io=C.getSnapAngle(),Cg=u(Cg/io)*io;0>Cg&&(Cg+=Q);var mb=Cg-g.$7l,Lc=[X.x,0,X.y];Eh.each(function(u){if(C.isEditable(u)&&C.isRotationEditable(u)&&C.isVisible(u)){var y=ps(u.p3(),Lc),E=ac();Ur(E,-mb),u.setRotation(u.getRotation()+mb),Wb(y,E),u.p3(Lc[0]+y[0],Lc[1]+y[1],Lc[2]+y[2])}}),g.$7l=Cg,g.fi({kind:"betweenEditRotation",event:p})}else if([1,2,3,5,6].indexOf(g.$67l)>=0)g.$72l=p,g.$78l||(g.$78l=1,n(function(){F.isDragging()&&g.$43l(),delete g.$78l},12));else if(7===g.$67l){if(g.$87l instanceof S){var U=g.$87l,Yi=g.$88l,Qo=F.clone(U.getPoints().get(Yi)),vn=x.y-Qo.y;Qo.e||(Qo.e=0),g.$92l||(g.$92l=Qo.e),Qo.e=g.$92l-vn,U.setPoint(Yi,Qo)}else if(g.$87l instanceof W){var J=g.$87l,Yi=g.$88l,Z=Hl(C.getDataUI(J),J.s("edge.points")),Qo=Z.get(Yi),vn=x.y-Qo.y;Qo.e||(Qo.e=0),g.$92l||(g.$92l=Qo.e),Qo.e=g.$92l-vn,Z.set(Yi,Qo),J.s("edge.points",ic(Z))}}else if(8===g.$67l){var Eh=C.sm().getSelection(),gf=g.$93l;gf||(gf=g.$93l={}),Eh.each(function(J){if(J.p3){var r=J.p3(),W=gf[J.getId()];W==t&&(W=gf[J.getId()]=r[1]),J.p3([r[0],W-(x.y-g.$90l.y/s),r[2]])}})}else if(9===g.$67l){var Eh=C.sm().getSelection(),un=g.$94l;un||(un=g.$94l={}),Eh.each(function(X){if(X.s3){var G=X.s3(),e=un[X.getId()];e==t&&(e=un[X.getId()]=G[1]);var j=e-(x.y-g.$91l.y/s);0>j&&(j=.01),X.s3([G[0],j,G[2]])}})}},$79l:function(q,y){var P=this,b=P.gv,D=b.getZoom(),I=b.getEditHelperSize(),Z=q.x/D,w=q.y/D,A=I/D,j=A/2;return G({x:Z-j,y:w-j,width:A,height:A},y)?!0:void 0},getHelperCursor:function(){return"crosshair"},_79I:function(J,y){for(var h=this,B=h.gv,I=B.getZoom(),l=B.getEditPointSize(),C=l/I,r=C/2,M=h.$46l(J),Y=0;Y<M.length;Y++){var k,K,o=M[Y],U=B.getDataUI(o);if(U&&U._55O){var F=U._55O;if(F._43O&&o instanceof W){if(k=o.s("edge.points"),k=Hl(U,k),K=o.s("edge.segments"),K&&K.size()||(K=Wq(k)),h.$42l(o,y,k._as,K,"edge"))return!0;if("points"===o.s("edge.type"))return h.$41l(o,y,k._as,K,"edge"),void 0}if(F._43O&&o instanceof S&&F.$15l&&F.$15l.length===o.getPoints().size()){if(k=F.$15l,K=o.getSegments(),K&&K.size()||(K=Wq(k)),h.$42l(o,y,k,K,"shape"))return!0;if(h.$41l(o,y,k,K,"shape"))return}}}if(h.$16l){var k,v=h.$16l,R=v[3].x-v[7].x,N=v[3].y-v[7].y,m=z(R*R+N*N),X=v[1].x-v[5].x,g=v[1].y-v[5].y,P=z(X*X+g*g),$={x:y.x*I,y:y.y*I};if(h._80I($,0,v[0],"northwest",m,P)||h._80I($,1,v[1],"north",m,P)||h._80I($,2,v[2],"northeast",m,P)||h._80I($,7,v[7],"west",m,P)||h._80I($,3,v[3],"east",m,P)||h._80I($,6,v[6],"southwest",m,P)||h._80I($,5,v[5],"south",m,P)||h._80I($,4,v[4],"southeast",m,P))return!0}if(h.$23l){var p=h.$23l,f=p.x/I,q=p.y/I;if(G({x:f-r,y:q-r,width:C,height:C},y))return h.$40l=1,h.$12l=h.getHelperCursor("rotation")||"crosshair",!0}return h.$68l&&h.$79l(h.$68l,y)?(h.$67l=1,h.$12l=h.getHelperCursor("host")||"crosshair",!0):h.$69l&&h.$79l(h.$69l,y)?(h.$67l=2,h.$12l=h.getHelperCursor("parent")||"crosshair",!0):h.$70l&&h.$79l(h.$70l,y)?(h.$67l=3,h.$12l=h.getHelperCursor("edge")||"crosshair",!0):h.$71l&&h.$79l(h.$71l,y)?(h.$67l=4,h.$12l=h.getHelperCursor("remove")||"crosshair",!0):h.$82l&&h.$79l(h.$82l,y)?(h.$67l=5,h.$12l=h.getHelperCursor("source")||"crosshair",!0):h.$83l&&h.$79l(h.$83l,y)?(h.$67l=6,h.$12l=h.getHelperCursor("target")||"crosshair",!0):h._pointElevationHelperPoint&&h.$79l(h._pointElevationHelperPoint,y)?(h.$67l=7,h.$12l=h.getHelperCursor("pointElevation")||"crosshair",!0):h.$90l&&h.$79l(h.$90l,y)?(h.$67l=8,h.$12l=h.getHelperCursor("elevation")||"crosshair",!0):h.$91l&&h.$79l(h.$91l,y)?(h.$67l=9,h.$12l=h.getHelperCursor("tall")||"crosshair",!0):!1},_80I:function(S,d,D,v,y,W){var E=this,j=E.gv,x=j.getEditPointSize(),m=x/2,b=j.sm(),K=j.isDirectionEditable;if(K&&1===b.size()){var e=b.ld();if(K=K.bind(j),e instanceof I){if(!K(e,v))return!1;if("east"===v){if(K(e,"northeast")&&K(e,"southeast")&&2*x>=W)return!1}else if("west"===v){if(K(e,"northwest")&&K(e,"southwest")&&2*x>=W)return!1}else if("north"===v){if(K(e,"northwest")&&K(e,"northeast")&&2*x>=y)return!1}else if("south"===v&&K(e,"southwest")&&K(e,"southeast")&&2*x>=y)return!1}}else{if(2*x>=y&&("north"===v||"south"===v))return!1;if(2*x>=W&&("east"===v||"west"===v))return!1}if(G({x:D.x-m,y:D.y-m,width:x,height:x},S)){if(E.$10l!==v){var F=180*E.$7l/q,$="";F>=337.5||22.5>F?$="north":F>=22.5&&67.5>F?$="northeast":F>=67.5&&112.5>F?$="east":F>=112.5&&157.5>F?$="southeast":F>=157.5&&202.5>F?$="south":F>=202.5&&247.5>F?$="southwest":F>=247.5&&292.5>F?$="west":F>=292.5&&337.5>F&&($="northwest");var J=Ag.indexOf($),$=Ag[d-(1-J)+8];switch($){case"northwest":E.$12l="nwse-resize";break;case"northeast":E.$12l="nesw-resize";break;case"southwest":E.$12l="nesw-resize";break;case"southeast":E.$12l="nwse-resize";break;case"north":E.$12l="ns-resize";break;case"east":E.$12l="ew-resize";break;case"south":E.$12l="ns-resize";break;case"west":E.$12l="ew-resize"}E.$10l=v}return!0}return!1},$42l:function(s,w,B,J,D){var y,_=this,g=_.gv,O=g.getEditPointSize(),v=O/g.getZoom(),Z=-1,j={x:w.x,y:w.y,width:0,height:0},A=function(p){"shape"===D?_._shape=s:_._edge=s,_._removePointIndex=p},S=function(f){"shape"===D?_._shape=s:_._edge=s,_.$13l=f,_.$12l="crosshair"};for(M(j,v/2),Z=B.length-1,y=J.size()-1;y>=0;y--){var H=J.get(y);if(1===H||2===H)Z-=1;else if(3===H){var I=B[Z-1];if(G(j,I))return S(Z-1),!0;Z-=2}else if(4===H){var r=B[Z-1],F=B[Z-2];if(G(j,r))return S(Z-1),!0;if(G(j,F))return S(Z-2),!0;Z-=3}}for(Z=B.length-1,y=J.size()-1;y>=0;y--){var H=J.get(y),P=B[Z];if(G(j,P))return A(Z),S(Z),!0;1===H||2===H?Z-=1:3===H?Z-=2:4===H&&(Z-=3)}return!1},$41l:function(q,g,C,W,y){var o=this,A=o.gv,I=-1,X=0,Z={x:g.x,y:g.y,width:0,height:0},t=function(K,A){o._hoverSegmentIndex=A,o._lp=g,"shape"===y?o._shape=q:o._edge=q};for(M(Z,A.getSegmentHoverWidth()/2/A.getZoom()),q instanceof S&&q.isClosePath()&&W.indexOf(5)<0&&(W=new s(W._as),W.add(5));X<W.size();X++){var O=W.get(X);if(1===O){var T=C[I],j=C[I+1];if(T){var D=uf(new Lm(T.x,T.y),new Lm(j.x,j.y),new Lm(Z.x,Z.y),new Lm(Z.x+Z.width,Z.y+Z.height));if(D.$62l===p&&D.points.length>0)return t(D,X),!0}I+=1}else if(2===O){var T=C[I],j=C[I+1],D=uf(new Lm(T.x,T.y),new Lm(j.x,j.y),new Lm(Z.x,Z.y),new Lm(Z.x+Z.width,Z.y+Z.height));if(D.$62l===p&&D.points.length>0)return t(D,X),!0;I+=1}else if(3===O){var T=C[I],m=C[I+1],G=C[I+2],D=uq(new Lm(T.x,T.y),new Lm(m.x,m.y),new Lm(G.x,G.y),new Lm(Z.x,Z.y),new Lm(Z.x+Z.width,Z.y+Z.height));if(D.$62l===p)return t(D,X),!0;I+=2}else if(4===O){var T=C[I],n=C[I+1],w=C[I+2],G=C[I+3],D=Pq(new Lm(T.x,T.y),new Lm(n.x,n.y),new Lm(w.x,w.y),new Lm(G.x,G.y),new Lm(Z.x,Z.y),new Lm(Z.x+Z.width,Z.y+Z.height));if(D.$62l===p)return t(D,X),!0;I+=3}else if(5===O){var T=C[I],j=C[0];if(T){var D=uf(new Lm(T.x,T.y),new Lm(j.x,j.y),new Lm(Z.x,Z.y),new Lm(Z.x+Z.width,Z.y+Z.height));if(D.$62l===p&&D.points.length>0)return t(D,X),!0}}}return!1},addShapePoint:function(A,n,q){var L=this,D=L.gv,p=D.dm();if(p.beginTransaction(),0===arguments.length&&(A=L._shape||L._edge,n=L._hoverSegmentIndex,q=L._lp),A instanceof S||A instanceof W){var l=An(A,D.getDataUI(A),n);if(!isNaN(n)&&q&&!isNaN(l)){var I=q;if(A instanceof S){var $=A.p(),t=A.getRotation(),T=A.toSegments();T&&T.size()||(T=Wq(A.getPoints())),A.isClosePath()&&T.indexOf(5)<0&&(T=new s(T._as),T.add(5));var e=T.get(n),X="addPoint",O="removePointAt";if(2===e||1===e){var k={x:I.x,y:I.y};T.add(e,n),k=hf($,k.x-$.x,k.y-$.y,-t),A[X](k,l+1)}else if(3===e){var v=A.getPoints(),x=v.get(l),H=v.get(l+2),k={x:I.x,y:I.y};k=hf($,k.x-$.x,k.y-$.y,-t);var Y=Og(x,k),m=Og(k,H);T.removeAt(n),T.add(3,n),T.add(3,n),A.setPoint(l+1,k),A[X](m,l+2),A[X](Y,l+1)}else if(4===e){var v=A.getPoints(),x=v.get(l),H=v.get(l+3),k={x:I.x,y:I.y};k=hf($,k.x-$.x,k.y-$.y,-t);var Y=hc(x,k),m=Nf(x,k),R=hc(k,H),M=Nf(k,H);T.removeAt(n),T.add(4,n),T.add(4,n),A[O](l+1),A[O](l+1),A[X](k,l+1),A[X](M,l+2),A[X](R,l+2),A[X](m,l+1),A[X](Y,l+1)}else if(5===e){var k={x:I.x,y:I.y};T.add(2,n),k=hf($,k.x-$.x,k.y-$.y,-t),A[X](k,l+1)}A.isClosePath()&&T.remove(5),A.setSegments(T);var y=A.getWidth(),z=A.getHeight(),K=A.p().x-y/2,u=A.p().y-z/2;K-=$.x,u-=$.y;var P=jm(A,{x:K,y:u,width:y,height:z},t,$);A.p(P.x,P.y)}else if(A instanceof W){if("points"!==A.s("edge.type"))return p.endTransaction(),void 0;var v=A.s("edge.points");T=A.s("edge.segments"),v=Hl(D.getDataUI(A),v),T&&T.size()||(T=Wq(v)),T=new s(T._as.slice(0)),v=new s(v._as.slice(0));var e=T.get(n);if(2===e||1===e){var k={x:I.x,y:I.y};T.add(e,n),v.add(k,l+1)}else if(3===e){var x=v.get(l),H=v.get(l+2),k={x:I.x,y:I.y},Y=Og(x,k),m=Og(k,H);T.removeAt(n),T.add(3,n),T.add(3,n),v.set(l+1,k),v.add(m,l+2),v.add(Y,l+1)}else if(4===e){var x=v.get(l),H=v.get(l+3),k={x:I.x,y:I.y},Y=hc(x,k),m=Nf(x,k),R=hc(k,H),M=Nf(k,H);T.removeAt(n),T.add(4,n),T.add(4,n),v.removeAt(l+1),v.removeAt(l+1),v.add(k,l+1),v.add(M,l+2),v.add(R,l+2),v.add(m,l+1),v.add(Y,l+1)}A.s("edge.points",ic(v)),A.s("edge.segments",T)}}}p.endTransaction()},removeShapePoint:function(R,U){var e=this,b="removeAt",H=e.gv,c=H.dm();if(c.beginTransaction(),0===arguments.length&&(R=e._shape||e._edge,U=e._removePointIndex),U>=0&&(R instanceof S||R instanceof W)){var X=Xr(R,e.gv.getDataUI(R),U),m=U;if(R instanceof S){var Y=R.p(),x=R.toSegments();x&&x.size()||(x=Wq(R.getPoints()));var $=x.get(X),V="removePointAt";if(1===$&&0===m)if(R.getPoints().size()>1){var E=x.get(X+1);x[b](X+1),3===E?R[V](m+1):4===E&&(R[V](m+2),R[V](m+1)),R[V](m)}else R.dm().remove(R);else 2===$||1===$?(x[b](X),R[V](m)):3===$?(x[b](X),R[V](m),R[V](m-1)):4===$&&(x[b](X),R[V](m),R[V](m-1),R[V](m-2));R.setSegments(x);var l=R.getWidth(),k=R.getHeight(),v=R.p().x-l/2,f=R.p().y-k/2;v-=Y.x,f-=Y.y;var j=jm(R,{x:v,y:f,width:l,height:k},R.getRotation(),Y);R.p(j.x,j.y)}else if(R instanceof W){if("points"!==R.s("edge.type"))return c.endTransaction(),void 0;var _=R.s("edge.points");if(x=R.s("edge.segments"),_&&(_=Hl(e.gv.getDataUI(R),_),x&&x.size()||(x=Wq(_))),0===U||U===_.size()-1)return c.endTransaction(),void 0;x=new s(x._as.slice(0)),_=new s(_._as.slice(0));var $=x.get(X);2===$||1===$?(x[b](X),_[b](m)):3===$?(x[b](X),_[b](m),_[b](m-1)):4===$&&(x[b](X),_[b](m),_[b](m-1),_[b](m-2)),R.s("edge.segments",x),R.s("edge.points",ic(_))}}c.endTransaction()},changeShapeSegment:function(D,i,h){var R=this,b=R.gv,H=b.dm();if(H.beginTransaction(),1!==arguments.length||isNaN(D)||(h=D,D=R._shape||R._edge,i=R._hoverSegmentIndex),D instanceof S||D instanceof W){var x=An(D,R.gv.getDataUI(D),i);if(!isNaN(i)&&!isNaN(x))if(D instanceof S){var f=D.p(),Y=D.toSegments();Y&&Y.size()||(Y=Wq(D.getPoints()));var u=Y.get(i),z=D.toPoints();if(1===h||2===h)1===u||2===u?Y.set(i,h):3===u?(Y.set(i,h),z.removeAt(x+1)):4===u&&(Y.set(i,h),z.removeAt(x+1),z.removeAt(x+1));else if(3===h){var I=function(){var _=z.get(x),B=z.get(x+1),F=Og(_,B);Y.set(i,3),z.add(F,x+1)};2===u||1===u?I():4===u&&(z.removeAt(x+1),z.removeAt(x+1),I())}else if(4===h){var K=function(){var r=z.get(x),S=z.get(x+1),T=hc(r,S),D=Nf(r,S);Y.set(i,4),z.add(T,x+1),z.add(D,x+2)};2===u||1===u?K():3===u&&(z.removeAt(x+1),K())}D.setSegments(Y),D.setPoints(z);var L=D.getWidth(),v=D.getHeight(),G=D.p().x-L/2,r=D.p().y-v/2;G-=f.x,r-=f.y;var B=new jm(D,{x:G,y:r,width:L,height:v},D.getRotation(),f);D.p(B.x,B.y)}else if(D instanceof W){if("points"!==D.s("edge.type"))return H.endTransaction(),void 0;var z=D.s("edge.points");Y=D.s("edge.segments"),z&&(z=Hl(R.gv.getDataUI(D),z),Y&&Y.size()||(Y=Wq(z))),Y=new s(Y._as.slice(0)),z=new s(z._as.slice(0));var u=Y.get(i);if(1===h||2===h)1===u||2===u?Y.set(i,h):3===u?(Y.set(i,h),z.removeAt(x+1)):4===u&&(Y.set(i,h),z.removeAt(x+1),z.removeAt(x+1));else if(3===h){var I=function(){var a=z.get(x),g=z.get(x+1),w=Og(a,g);Y.set(i,3),z.add(w,x+1)};2===u||1===u?I():4===u&&(z.removeAt(x+1),z.removeAt(x+1),I())}else if(4===h){var K=function(){var I=z.get(x),l=z.get(x+1),f=hc(I,l),V=Nf(I,l);Y.set(i,4),z.add(f,x+1),z.add(V,x+2)};2===u||1===u?K():3===u&&(z.removeAt(x+1),K())}D.s("edge.points",ic(z)),D.s("edge.segments",Y)}}H.endTransaction()},getDefaultSegments:function(U){var d=this.gv,a=d.getDataUI(U);if(U instanceof W){var Q=U.s("edge.points");return Q=Hl(a,Q),Wq(Q)}if(U instanceof S){var Q=U.getPoints(),b=U.getSegments();return b&&b.size()>0?b:Wq(Q)}},$43l:function(l){var F=this;l&&(F.$5l=1),F._68I=1,F._42()},_42:function(){var d=this;if(d._68I){delete d._68I;var A=d.gv,H=d.$5l,g=A.getZoom(),T=A.getEditPointSize(),a=T/2,B=new s,l=d._view,_=d._edge,Z=d._shape,h=l.getContext("2d"),Y=A.tx(),X=A.ty(),n=t,i=A.getEditPointBackground(),p=A.getControlPointBackground(),c=A.getControlPointBorderColor(),q=A.getEditPointBorderColor(),v=A.getEditRectBorderColor(),G=A.getDirectionLineColor(),y=A.getSegmentHoverColor(),m=A.getSnapPointBorderColor(),J=A.getJoinPointBackground(),o=A.getJoinPointBorderColor(),L=A.getSegmentHoverWidth(),f=[5,5],C=A.getEditRectBorderStyle();ck(A,function(Q){A.isSelected(Q)&&A.isVisible(Q)&&B.add(Q)}),h.clearRect(0,0,w(l.width),w(l.height)),h.save(),U.translateAndScale(h,Y,X,1);var E=t,D={x:0,y:0,width:0,height:0},$=0,u=0,b=0,e=0,V=0,O=0,Er=0,af=0,Aj=0,Ik=0,Af=[];if(H?(delete d.$6l,delete d.$8l,delete d.$7l,delete d.$16l,delete d.$23l):(E=d.$6l,n=d.$7l),delete d.$68l,delete d.$69l,delete d.$71l,delete d.$70l,delete d.$82l,delete d.$83l,delete d._pointElevationHelperPoint,delete d.$90l,delete d.$91l,delete d.$75l,delete d.$74l,B.each(function(Z){var U=A.getDataUI(Z);if(U){var J=U._55O;if(A.isEditable(Z))J._56O&&Z instanceof I&&u++,Af.push(Z),J._42O&&Z instanceof I&&$++,A.isHelperEditable(Z,"host")&&e++,A.isHelperEditable(Z,"parent")&&b++,A.isHelperEditable(Z,"remove")&&V++,A.isHelperEditable(Z,"edge")&&O++,A.isHelperEditable(Z,"source")&&Er++,A.isHelperEditable(Z,"target")&&af++,A.isHelperEditable(Z,"elevation")&&Aj++,A.isHelperEditable(Z,"tall")&&Ik++;else if(Z instanceof P&&Z.isExpanded()){var N=!0,w=A.getEditableFunc();w&&(N=w(Z)),N&&(A.isHelperEditable(Z,"host")&&e++,A.isHelperEditable(Z,"parent")&&b++,A.isHelperEditable(Z,"remove")&&V++,A.isHelperEditable(Z,"edge")&&O++,A.isHelperEditable(Z,"source")&&Er++,A.isHelperEditable(Z,"target")&&af++,A.isHelperEditable(Z,"elevation")&&Aj++,A.isHelperEditable(Z,"tall")&&Ik++,Af.push(Z))}}}),h.beginPath(),h.lineWidth=1,h.strokeStyle=A.getNodeBorderColor(),Af.forEach(function(s){var m=A.getDataUI(s),u=m._55O;if(H)if(n==t&&(n=s instanceof W?0:s instanceof P&&s.isExpanded()?0:s.getRotation(),d.$7l=n),E==t){var z,S,f;if(s instanceof P&&s.isExpanded()||s instanceof W){var X=A.getDataUIBounds(s);S=X.width,f=X.height,z={x:X.x+S/2,y:X.y+f/2}}else z=s.p(),S=s.getWidth(),f=s.getHeight();E={x:z.x,y:z.y,width:0,height:0},D.x=z.x-S/2,D.y=z.y-f/2,D.width=S,D.height=f,E=r(E,D)}else{var z,S,f,L,Y=E.x+E.width/2,O=E.y+E.height/2,F={x:Y,y:O};if(s instanceof P&&s.isExpanded()||s instanceof W){L=0;var X=A.getDataUIBounds(s);S=X.width,f=X.height,z={x:X.x+S/2,y:X.y+f/2}}else z=s.p(),S=s.getWidth(),f=s.getHeight(),L=s.getRotation();var K={x:z.x-S/2,y:z.y-f/2,width:S,height:f},V={x:K.x,y:K.y},Z={x:K.x+K.width,y:K.y},l={x:K.x,y:K.y+K.height},w={x:K.x+K.width,y:K.y+K.height},V=hf(z,V.x-z.x,V.y-z.y,L),l=hf(z,l.x-z.x,l.y-z.y,L),w=hf(z,w.x-z.x,w.y-z.y,L),Z=hf(z,Z.x-z.x,Z.y-z.y,L),j=-n,y=hf(F,V.x-F.x,V.y-F.y,j),c=hf(F,Z.x-F.x,Z.y-F.y,j),B=hf(F,l.x-F.x,l.y-F.y,j),M=hf(F,w.x-F.x,w.y-F.y,j),J=k([y,c,B,M]);E=r(E,J),E.x-=Y,E.y-=O;var q=jm(t,E,n,F);E.x=q.x-E.width/2,E.y=q.y-E.height/2}if($>1&&A.isEditable(s)&&A.isRectEditable(s)&&s instanceof I){var i=s.getRect(),Q=u.$45l,_=Pp(Q[0],g),e=Pp(Q[2],g),G=Pp(Q[4],g),p=Pp(Q[6],g);s.getRotation()?(h.moveTo(_.x,_.y),h.lineTo(e.x,e.y),h.lineTo(G.x,G.y),h.lineTo(p.x,p.y),h.lineTo(_.x,_.y)):h.rect(i.x*g,i.y*g,i.width*g,i.height*g)}}),h.stroke(),E){d.$6l=x(E),M(E,A.getEditRectPadding()/g);var cf={x:E.x+E.width/2,y:E.y+E.height/2},Ip=Tp(cf,E.width,E.height,n),ro=Ip[0],dn=Ip[1],yj=Ip[2],mg=Ip[3],yc=Ip[4],Zq=Ip[5],fq=Ip[6],wm=Ip[7];if(ro=Pp(Ip[0],g),dn=Pp(Ip[1],g),yj=Pp(Ip[2],g),mg=Pp(Ip[3],g),yc=Pp(Ip[4],g),Zq=Pp(Ip[5],g),fq=Pp(Ip[6],g),wm=Pp(Ip[7],g),d.$8l=E,$>0&&(d.$16l=[ro,yc,dn,Zq,mg,fq,yj,wm],h.beginPath(),h.lineWidth=1,h.strokeStyle=v,"dashed"===C&&h.setLineDash&&h.setLineDash(f),h.moveTo(ro.x,ro.y),h.lineTo(dn.x,dn.y),h.lineTo(mg.x,mg.y),h.lineTo(yj.x,yj.y),h.lineTo(ro.x,ro.y),h.stroke(),"dashed"===C&&h.setLineDash&&h.setLineDash([])),h.beginPath(),h.lineWidth=1,h.fillStyle=i,h.strokeStyle=q,$>0){var vn=Zq.x-wm.x,Rk=Zq.y-wm.y,ms=z(vn*vn+Rk*Rk),Ed=yc.x-fq.x,lj=yc.y-fq.y,Cq=z(Ed*Ed+lj*lj),Lb=2*T;if(A.isDirectionEditable&&1===Af.length){var gg=Af[0],Qo=A.getDataUI(gg),Zb=Qo._55O,br=A.isDirectionEditable.bind(A);if(Zb._42O){var Gi,xj,Sp,Aq;br(gg,"northwest")&&(Gi=!0,h.rect(ro.x-a,ro.y-a,T,T)),br(gg,"northeast")&&(xj=!0,h.rect(dn.x-a,dn.y-a,T,T)),br(gg,"southwest")&&(Sp=!0,h.rect(yj.x-a,yj.y-a,T,T)),br(gg,"southeast")&&(Aq=!0,h.rect(mg.x-a,mg.y-a,T,T)),br(gg,"north")&&(Gi&&xj?ms>Lb&&h.rect(yc.x-a,yc.y-a,T,T):h.rect(yc.x-a,yc.y-a,T,T)),br(gg,"south")&&(Aq&&Sp?ms>Lb&&h.rect(fq.x-a,fq.y-a,T,T):h.rect(fq.x-a,fq.y-a,T,T)),br(gg,"west")&&(Sp&&Gi?Cq>Lb&&h.rect(wm.x-a,wm.y-a,T,T):h.rect(wm.x-a,wm.y-a,T,T)),br(gg,"east")&&(Aq&&xj?Cq>Lb&&h.rect(Zq.x-a,Zq.y-a,T,T):h.rect(Zq.x-a,Zq.y-a,T,T))}}else ms>Lb&&(h.rect(yc.x-a,yc.y-a,T,T),h.rect(fq.x-a,fq.y-a,T,T)),Cq>Lb&&(h.rect(Zq.x-a,Zq.y-a,T,T),h.rect(wm.x-a,wm.y-a,T,T)),h.rect(ro.x-a,ro.y-a,T,T),h.rect(dn.x-a,dn.y-a,T,T),h.rect(yj.x-a,yj.y-a,T,T),h.rect(mg.x-a,mg.y-a,T,T)}if(u>0){var od=d.$23l=hf(yc,0,2*-T,n);h.moveTo(od.x+a,od.y),h.arc(od.x,od.y,a,0,Q,!1)}h.fill(),h.stroke(),d.$40l&&d.$44l(h,E,n);var _b,wc,li=A.getLeftTopHelpers(),qc=A.getRightTopHelpers(),Ml=A.getLeftBottomHelpers(),eo=A.getRightBottomHelpers(),nr=A.getEdgeHelpers(),Jf=A.getEditHelperSize(),Ae=Jf/2,vl=function(f,q,x,j){"leftTop"===q?(_b=E.x*g-Jf-a-("h"===j?x*(Jf+a):0)-1,wc=E.y*g-Jf-a-("v"===j?x*(Jf+a):0)-1):"rightTop"===q?(_b=(E.x+E.width)*g+a+("h"===j?x*(Jf+a):0)+1,wc=E.y*g-Jf-a-("v"===j?x*(Jf+a):0)-1):"leftBottom"===q?(_b=E.x*g-Jf-a-("h"===j?x*(Jf+a):0)-1,wc=(E.y+E.height)*g+a+("v"===j?x*(Jf+a):0)+1):"rightBottom"===q&&(_b=(E.x+E.width)*g+a+("h"===j?x*(Jf+a):0)+1,wc=(E.y+E.height)*g+a+("v"===j?x*(Jf+a):0)+1);var m=_b+Ae,Z=wc+Ae,R=(E.x+E.width/2)*g,r=(E.y+E.height/2)*g,z=hf({x:R,y:r},m-R,Z-r,n);if("host"===f){if(e>0)return d.$77l(h,n,z),!0}else if("edge"===f){if(O>0)return d.$80l(h,n,z),!0}else if("remove"===f){if(V>0)return Af&&1===Af.length&&Af[0]instanceof W?d.$81l(h,n,{x:R+Jf/2+5,y:r}):d.$81l(h,n,z),!0}else if("parent"===f){if(b>0)return Af&&1===Af.length&&Af[0]instanceof W?d.$76l(h,n,{x:R-Jf/2-5,y:r}):d.$76l(h,n,z),!0}else if("elevation"===f){if(Aj>0)return d.$85l(h,n,z),!0}else if("tall"===f){if(Ik>0)return d.$86l(h,n,z),!0}else if("source"===f||"target"===f){var w=Af[0],t=A.getDataUI(w),H=eh(t,!0),M=H[0],K=H[1];if(Er&&"source"===f)return d.$84l(h,E,M,!0,w.isLooped(),q,x,j),!0;if(af&&"target"===f)return d.$84l(h,E,K,!1,w.isLooped(),q,x,j),!0}};if(li&&li.length>0){var Pc=0;li.forEach(function(Z){vl(Z,"leftTop",Pc,A.getLeftTopHelpersAlign()||"h")&&Pc++})}if(qc&&qc.length>0){var Pc=0;qc.forEach(function(k){vl(k,"rightTop",Pc,A.getRightTopHelpersAlign()||"h")&&Pc++})}if(Ml&&Ml.length>0){var Pc=0;Ml.forEach(function(M){vl(M,"leftBottom",Pc,A.getLeftBottomHelpersAlign()||"h")&&Pc++})}if(eo&&eo.length>0){var Pc=0;eo.forEach(function(E){vl(E,"rightBottom",Pc,A.getRightBottomHelpersAlign()||"h")&&Pc++})}if(nr&&nr.length>0&&((Er||af)&&Af&&1===Af.length&&Af[0]instanceof W?!0:!1)){var Pc=0;nr.forEach(function(x){vl(x,"edge",Pc,"h")&&Pc++})}if(d.$72l){var of,Rf=d.$67l,jo=d.$68l,Yh=d.$69l,Pb=(d.$71l,d.$70l),Po=d.$82l,mr=d.$83l;if(1===Rf?of=jo:2===Rf?of=Yh:3===Rf?of=Pb:5===Rf?of=Po:6===Rf&&(of=mr),of){var Fd=A.lp(d.$72l),vb=A.getDataAt(d.$72l);if(vb&&vb instanceof I){var sd,jg,gl;if(d.$73l=vb,1===Rf)if(vb instanceof N.Grid)sd=d.$75l=Ef(vb,Fd);else if(vb instanceof N.Shape){gl=d.$74l=Id(vb,Fd);var Bn=vb.getPoints();if(gl){var Xl=gl.attachIndex,io=An(vb,A.getDataUI(vb),Xl)+1,le=io+1>=Bn.size()?0:io+1,cl=Bn.get(io),Fb=Bn.get(le),Qb=vb.p(),tn=vb.getRotation();cl=hf(Qb,cl.x-Qb.x,cl.y-Qb.y,tn),Fb=hf(Qb,Fb.x-Qb.x,Fb.y-Qb.y,tn),h.beginPath(),h.strokeStyle=y,h.lineWidth=L,h.moveTo(cl.x*g,cl.y*g),h.lineTo(Fb.x*g,Fb.y*g),h.stroke()}}sd?jg=sd.rect:(jg=F.clone(A.getDataUIBounds(vb)),F.grow(jg,2)),h.beginPath(),h.rect(jg.x*g,jg.y*g,jg.width*g,jg.height*g),h.strokeStyle=1===Rf||4===Rf||6===Rf?K:j,h.lineWidth=2,h.setLineDash&&h.setLineDash([8,8]),h.stroke()}else delete d.$73l;Fd.x=Fd.x*g,Fd.y=Fd.y*g;var er=qi(of.x,of.y,Fd.x,Fd.y),pq=hf(of,Fd.x-of.x,Fd.y-of.y,-er),Di=pq.x-of.x;h.translate(of.x,of.y),h.rotate(er),R.width=Di,R.height=40;var Bj=j;(1===Rf||4===Rf||6===Rf)&&(Bj=K),R.comps[0].gradientColor=Bj,F.drawImage(h,R,0,-20,Di,40)}}}if(B.each(function(r){var D=A.getDataUI(r);if(D){var T,P,F=D._55O,R=D._78o;if(F&&F._43O&&r instanceof S?(T=F.$15l,P=r.getSegments(),P&&P.size()||(P=Wq(T)),r.isClosePath()&&P.indexOf(5)<0&&(P=new s(P._as),P.add(5))):F&&R&&F._43O&&(T=r.s("edge.points"),P=r.s("edge.segments"),T=Hl(D,T),P&&P.size()||(P=Wq(T)),T&&(T=T._as)),T&&P){var W=0,j=P.size(),X=d._hoverSegmentIndex;T=T.slice(0);for(var i=0;i<T.length;i++)T[i]=Pp(T[i],g);h.beginPath(),h.strokeStyle=G,h.lineWidth=1,W=0;for(var i=0;j>i;i++){var H=P.get(i);if(1===H||2===H)W++;else if(3===H){var x=T[W-1],C=T[W],U=T[W+1];h.moveTo(x.x,x.y),h.lineTo(C.x,C.y),h.lineTo(U.x,U.y),W+=2}else if(4===H){var x=T[W-1],k=T[W],l=T[W+1],U=T[W+2];h.moveTo(x.x,x.y),h.lineTo(k.x,k.y),h.moveTo(l.x,l.y),h.lineTo(U.x,U.y),W+=3}}if(h.stroke(),Z===r||_===r&&"points"===_.s("edge.type")){h.beginPath(),W=0,h.strokeStyle=y,h.lineWidth=L;for(var i=0;j>i;i++){var H=P.get(i);if(1===H||2===H){if(X===i){var x=T[W-1],U=T[W];h.moveTo(x.x,x.y),h.lineTo(U.x,U.y);break}W++}else if(3===H){if(X===i){var x=T[W-1],C=T[W],U=T[W+1];h.moveTo(x.x,x.y),h.quadraticCurveTo(C.x,C.y,U.x,U.y);break}W+=2}else if(4===H){if(X===i){var x=T[W-1],k=T[W],l=T[W+1],U=T[W+2];h.moveTo(x.x,x.y),h.bezierCurveTo(k.x,k.y,l.x,l.y,U.x,U.y);break}W+=3}else if(5===H&&X===i){var x=T[W-1],U=T[0];h.moveTo(x.x,x.y),h.lineTo(U.x,U.y);break}}h.stroke()}h.beginPath(),W=0,h.strokeStyle=o,h.lineWidth=1,h.fillStyle=J;for(var i=0;j>i;i++){var H=P.get(i);if(1===H||2===H){var U=T[W];h.moveTo(U.x+a,U.y),h.arc(U.x,U.y,a,0,Q,!0),W++}else if(3===H){var U=T[W+1];h.moveTo(U.x+a,U.y),h.arc(U.x,U.y,a,0,Q,!0),W+=2}else if(4===H){var U=T[W+2];h.moveTo(U.x+a,U.y),h.arc(U.x,U.y,a,0,Q,!0),W+=3}}h.fill(),h.stroke(),h.beginPath(),W=0,h.strokeStyle=c,h.lineWidth=1,h.fillStyle=p;for(var i=0;j>i;i++){var H=P.get(i);if(1===H||2===H)W++;else if(3===H){var C=T[W];h.moveTo(C.x+a,C.y),h.arc(C.x,C.y,a,0,Q,!0),W+=2}else if(4===H){var k=T[W],l=T[W+1];h.moveTo(k.x+a,k.y),h.arc(k.x,k.y,a,0,Q,!0),h.moveTo(l.x+a,l.y),h.arc(l.x,l.y,a,0,Q,!0),W+=3}}if(h.fill(),h.stroke(),h.beginPath(),W=0,h.strokeStyle=m,h.lineWidth=2,(Z===r||_===r)&&d.$9l!=t){var U=T[d.$9l];h.moveTo(U.x+a,U.y),h.arc(U.x,U.y,a,0,Q,!0),h.stroke()}}}}),d.$87l&&A.sm().contains(d.$87l)){var Dp,Nl=d.$87l,dm=d.$88l,Jf=A.getEditHelperSize(),Ae=Jf/2;if(A.isHelperEditable(Nl,"pointElevation"))if(Nl instanceof S){var xp=Nl.getPosition();Dp=F.clone(Nl.getPoints().get(dm)),Dp=hf({x:xp.x,y:xp.y},Dp.x-xp.x,Dp.y-xp.y,Nl.getRotation()),Dp.x*=g,Dp.y*=g,h.translate(Dp.x,Dp.y),F.drawImage(h,F.getImage("xeditinteractor_elevationIcon"),Ae,-Ae,Jf,Jf),h.translate(-Dp.x,-Dp.y),d._pointElevationHelperPoint={x:Dp.x+Jf,y:Dp.y}}else if(Nl instanceof W){var fj=Hl(A.getDataUI(Nl),Nl.s("edge.points")),Dp=F.clone(fj.get(dm));Dp.x*=g,Dp.y*=g,h.translate(Dp.x,Dp.y),F.drawImage(h,F.getImage("xeditinteractor_elevationIcon"),Ae,-Ae,Jf,Jf),h.translate(-Dp.x,-Dp.y),d._pointElevationHelperPoint={x:Dp.x+Jf,y:Dp.y}}}h.restore(),d.$5l=0}},$89l:function(t,W,h,v){t.save();var y=this,Q=y.gv,l=Q.getEditHelperSize(),c=l/2;t.beginPath(),t.translate(h.x,h.y),t.rotate(W),F.drawImage(t,v,-c,-c,l,l),t.restore()},$85l:function(k,J,R){var f=this;f.$90l=R,f.$89l(k,J,R,F.getImage("xeditinteractor_elevationIcon"))},$86l:function(z,P,e){var M=this;M.$91l=e,M.$89l(z,P,e,F.getImage("xeditinteractor_tallIcon"))},$77l:function(y,S,Y){var a=this;a.$68l=Y,a.$89l(y,S,Y,F.getImage("xeditinteractor_hostIcon"))},$80l:function(X,I,c){var z=this;z.$70l=c,z.$89l(X,I,c,F.getImage("xeditinteractor_edgeIcon"))},$81l:function(e,j,V){var d=this;d.$71l=V,d.$89l(e,j,V,F.getImage("xeditinteractor_removeIcon"))},$76l:function(j,q,B){var S=this;S.$69l=B,S.$89l(j,q,B,F.getImage("xeditinteractor_parentIcon"))},$84l:function(l,N,A,D,e){var n,k=this,q=k.gv,u=q.getZoom(),M=q.getEditHelperSize(),Z=M/2;A.x*=u,A.y*=u,e&&(D?A.x-=Z+5:A.x+=Z+5),A.y-=M-2,D?(k.$82l=A,n=F.getImage("xeditinteractor_sourceIcon")):(k.$83l=A,n=F.getImage("xeditinteractor_targetIcon")),l.beginPath(),l.translate(A.x,A.y),F.drawImage(l,n,-Z,-Z,M,M),l.translate(-A.x,-A.y)},$44l:function(Z,x,r){Z.save();var a=this.gv.getZoom(),n=z(H(x.width,2)+H(x.height,2))/2*a+10,g=n,R=g+8,I=g+18,y=r,N=x.x+x.width/2,d=x.y+x.height/2;Z.translate(N*a,d*a),Z.beginPath(),Z.strokeStyle="rgb(150, 150, 150)";for(var e=0,m=0,P=0,O=0,U=0,$=0;360>$;$++)e=$*q/180,0===$%5&&(m=i(e)*g,P=V(e)*g,O=i(e)*R,U=V(e)*R,Z.moveTo(m,P),Z.lineTo(O,U)),0===$%45&&(m=i(e)*g,P=V(e)*g,O=i(e)*I,U=V(e)*I,Z.moveTo(m,P),Z.lineTo(O,U));Z.stroke(),Z.beginPath(),Z.rotate(-Y),Z.beginPath(),Z.fillStyle="rgba(255, 0, 0, 0.1)",Z.strokeStyle="rgb(157, 157, 157)",Z.moveTo(0,0),Z.arc(0,0,I,0,r,!1),Z.fill(),Z.beginPath(),Z.moveTo(0+I,0),Z.arc(0,0,I,0,r,!1),Z.stroke(),Z.rotate(Y),Z.font="bold 12px Verdana, Arial";var A=20*V(y),w=20*i(y),T=u(180*y/q)+"°";Z.textAlign="center",Z.textBaseline="middle",Z.beginPath();var c=Z.measureText("365.°").width;Z.fillStyle="white",Z.rect(A-c/2,-w-10,c,20),Z.fill(),Z.beginPath(),Z.fillStyle="rgb(79,79,79)",Z.fillText(T,A,-w),Z.restore()}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);