!function(k,o,p){"use strict";var G="ht";if(!k[G]){!function(){Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),k.performance&&k.performance.now||function(){var E=Date.now();k.performance||(k.performance={}),k.performance.now=function(){return Date.now()-E}}();for(var Q=Date.now(),W=16,J=["ms","moz","webkit","o"],g=0;g<J.length&&!k.requestAnimationFrame;++g)k.requestAnimationFrame=k[J[g]+"RequestAnimationFrame"],k.cancelAnimationFrame=k[J[g]+"CancelAnimationFrame"]||k[J[g]+"CancelRequestAnimationFrame"];k.requestAnimationFrame||(k.requestAnimationFrame=function(H){var C=Date.now(),J=W+Q-C;return 0>J&&(J=0),Q=C,k.setTimeout(function(){Q=Date.now(),H(performance.now())},J)}),k.cancelAnimationFrame||(k.cancelAnimationFrame=function(h){return k.clearTimeout(h)}),o.assign===p&&(o.assign=function(Q){if(Q===p||null===Q)throw new TypeError("Cannot convert undefined or null to object");for(var M=o(Q),f=1;f<arguments.length;f++){var z=arguments[f];if(z!==p&&null!==z)for(var G in z)o.prototype.hasOwnProperty.call(z,G)&&(M[G]=z[G])}return M})}();var m,z,i,s,M=k.document,T=null,X=k[G]={},E=k[G+"config"],j=X.Default=E&&E.Default||{},y=X.Style=E&&E.Style||{},N=X.Attr=E&&E.Attr||{},b=X.Color=E&&E.Color||{},l=X.IsGetter=E&&E.IsGetter||{},Y=Math,_=Y.round,I=Y.floor,D=Y.ceil,v=Y.sqrt,x=Y.max,d=Y.min,J=Y.abs,A=Y.cos,r=Y.acos,L=Y.sin,q=Y.pow,h=Y.asin,B=Y.PI,u=2*B,f=B/2,P=Y.tan,g=Y.atan2,H=Y.random,R=Y.log,a=function(f,V,r){return Math.max(V,Math.min(r,f))},V=!1,W=!1,O=k.parseInt||global.parseInt,S="2018-06-15",Z=k.navigator?k.navigator.platform.indexOf("Win")>-1:!1,U=function(s){return s*s},e=k.setTimeout,K=k.clearTimeout,F=k.location,Q=k.navigator?k.navigator.userAgent.toLowerCase():"",c=function(o){return o.test(Q)},w=c(/msie/)||c(/trident/),t=c(/msie 10/),n=c(/edge/),C=c(/firefox/),$=c(/mac/),Rp=j.isTouchable===p?Z?!1:M?"ontouchend"in M:!1:j.isTouchable,ce="default",Hm="single",so="multiple",Am="front",Ol="back",ud="left",Ij="right",ob="top",fi="bottom",Kb="center",Wp="eye",Gd="middle",Oq="east",Qd="west",Fm="north",$r="none",Gj="px",_h="absolute",Yf="border",pn="triangle",Lj="rect",yb="circle",cs="cylinder",Gg="shape",hi="items",$e="normal",ym="remove",Sb="clear",Pn="width",Zf="height",rc="ingroup",dm="check",vj="uncheck",Bd="radio",So="radioOn",Sh="radioOff",lq="points",wj="values",oc="series",jc="body",as="label",ki="label2",ys="note",af="note2",lp="icons",Wm="labelFont",Ar="labelColor",ae="labelSelectColor",Em="note.expanded",lg="note2.expanded",Mm="edge.expanded",Ur="edge.points",Dc="edge.type",Xe="rotation",Bc="getRotation",lf="setRotation",Qp="hidden",Sp="visible",zo="tuv",vs="no",yg="draw",Pm="select",Qe="currentSubGraph",ak="selectBackground",ri="autoMakeVisible",di="autoHideScrollBar",Li="scrollBarColor",Iq="scrollBarSize",Bl="indent",Lr="rowHeight",rq="columnLineColor",rg="rowLineColor",Mh="columnLineVisible",Qj="rowLineVisible",Vo="visibleFunc",Vh="expandIcon",Dq="collapseIcon",ui="checkMode",Ad="sortFunc",kd="editable",yr="batchEditable",Uh="tristate",qc="asc",Th="desc",Qo="position",Ic="elevation",Eq="children",Fp="translateX",Qi="translateY",Uo="dataModel",qb="maxSize",Po="shape3d",Ff="shape3d.resolution",vf="shape3d.visible",Yg="shape3d.from.visible",nh="shape3d.to.visible",Qq="shape3d.top.visible",sh="shape3d.bottom.visible",si="repeat.uv.length",Xi="serializeValue",Bp="deserializeValue",Gm="centerUniform",Zr="uniform",Zj="rgba(255,255,255,0)",ck="style",Al="attr",Xf="field",Rk="string",Gk="boolean",sm="color",Zd="int",Ak="number",pq="ew-resize",Re="ns-resize",Jr="pointer",Ag="auto",Uq="mousedown",sp="mousemove",mi="mouseup",re="mouseout",Dr="touchstart",$l="touchmove",Hc="touchend",sf="keydown",we="keyup",Bs=["DOMMouseScroll","mousewheel"],hn=C?Bs[0]:Bs[1],Sm=Rp?[Dr,$l,Hc,sf,we,"keypress","input","contextmenu"]:[sf,we,"keypress","input",Uq,sp,mi,re,hn,"wheel","contextmenu","mouseenter","mouseleave","mouseover"],Lo=T,qq=T,Yc=T,oe=mi.length,ar=function(){Yc&&(K(Yc.timeout),Yc=T)},Mn=function(){Yc&&xj(Yc.e,Yc.info)};k.addEventListener&&(Rp||(k.addEventListener(re,function(){ar()},!1),k.addEventListener(hn,function(){Tp()},!1)),k.addEventListener(we,function(E){91===E.keyCode?Qm={}:delete Qm[E.keyCode]},!0),k.addEventListener(sf,function(N){Qm[N.keyCode]=!0},!0));var Zb,ug,Zo,qh=0,Kj=T,fg=function(j,b){var V=e(function(){delete Kj[V],hg(Kj)&&(Kj=T),j()},b);return V},Ue=T,Cc=T,Ti={},Af={},op={},eb={},Qk={},Qm={},jh={},rl={},ik={},wp={},Ih=/.json$/,Yj=/^data:image\/svg\+xml/,Cg={},Er=[],qs={},tn=T,Up=T,Qc=function(){},cr=function(){throw"Oops!"},zn=[0,0,0],Mo=[0,0,0,0],_n={x:0,y:0,width:0,height:0},Bb=T,Sr=T,dk=T,Ge=function(i){Sr&&!i._72O&&(dk||(dk={}),dk[i._72O=xi()]=i),Zb!=T?Xj()<.05&&s&&!ug&&(vb=ar):vb=uc},Gl=function(J,G,Y,n){Sr||(Sr={});var H=Sr[J];if(H){if(H.url===G)return;H.image?(H.image.onload=Qc,H.image.onerror=Qc):H.request&&(H.request.onload=Qc,H.request.onerror=Qc)}if(Ih.test(G)){var R=new XMLHttpRequest;if(Sr[J]={request:R,url:G},R.overrideMimeType&&R.overrideMimeType("text/plain"),G=j.beforeLoadURL(G),G.data){var u=j.parse(G.data);Zl(J,u),j.handleImageLoaded(J,u)}else R.open("GET",encodeURI(G),!0),R.onload=function(u){if(200===this.status||0===this.status){var m=j.parse(u.target.response||u.target.responseText);Zl(J,m),j.handleImageLoaded(J,m)}else Zl(J,j.handleUnfoundImage(J,G)||T)},R.onerror=function(){Zl(J,j.handleUnfoundImage(J,G)||T)},R.send(null)}else{var u=new Image;Sr[J]={image:u,url:G},w&&(G.toLowerCase().indexOf(".svg")>0||Yj.test(G))?(M.body.appendChild(u),u.style.visibility="hidden",u.onload=function(){e(function(){if(Y&&(u.width=Y),n&&(u.height=n),!u.width||!u.height){var h=u.width||u.clientWidth,U=u.height||u.clientHeight;u.width=h,u.height=U}j.handleImageLoaded(J,u),Zl(J,u),M.body.removeChild(u),u.style.visibility=""},180)},u.onerror=function(){Zl(J,j.handleUnfoundImage(J,G)||T),M.body.removeChild(u),u.style.visibility=""}):(u.onload=function(){Y&&(u.width=Y),n&&(u.height=n),j.handleImageLoaded(J,u),Zl(J,u)},u.onerror=function(){Zl(J,j.handleUnfoundImage(J,G)||T)}),/^data:image/.test(G)||(G=j.beforeLoadURL(G),/^data:image/.test(G)||(G=j.appendTimeStamp(G),G=encodeURI(G))),u.src=G}},Zl=function(o,V){if(Af[o]=V,delete Sr[o],hg(Sr)&&(Sr=T,dk)){for(var B in dk){var n=dk[B];n._2O&&(n._2O={}),n.invalidateAll&&n.invalidateAll(p,"imageLoaded",o),n.redraw&&n.redraw(),n.iv(),delete n._72O}dk=T}if(V&&dk)for(var B in dk){var n=dk[B];n.invalidateAll&&n.invalidateAll(p,"imageLoading",o),n.redraw&&n.redraw(),n.iv()}},hk=function(){return R=Y&&Date,function(){return k.performance&&k.performance.now?k.performance.now():Date.now()}}(),Zi=function(z,h){h?K(z):k.cancelAnimationFrame(z)},On=function(l,w,I){return{width:l,height:w,comps:Lq(I)?I:[I]}},Yo=function(N,O){return{type:yb,rect:[N,O,1.6,1.6],borderWidth:1,borderColor:wg,gradient:uj,gradientColor:Of,background:wg}},ef=function(g,a){return On(16,16,{type:pn,rect:[4,4,10,8],background:g,rotation:a?1.57:3.14})},pp=function(r,b){return On(16,16,{type:pn,rect:[4,4,8,7],background:r,rotation:b?3.14:0})},fd=function(t){var P=t._orientation;return"horizontal"===P||"h"===P},cp=function(q){var k=T||4,c=T||1,o=T||1;0>k?k=0:k>.25&&(k=.25);var Y,$,g,V,d,m,C,w=.5,p=[],_=[],f=[],i=u/o,t=u/c,y=w-k;for($=0;c>=$;$++)for(V=-B+$*t,m=A(V),d=L(V),Y=0;o>=Y;Y++)g=Y*i,C=y+k*m,p.push(A(g)*C,d*k,-L(g)*C),(z=q)&&_.push(Y/o,1-$/c);for($=0;c>$;$++){var j=$*(o+1),e=($+1)*(o+1);for(Y=0;o>Y;Y++)f.push(j+Y,e+Y+1,e+Y,j+Y,j+Y+1,e+Y+1),El.z=Di.z=q}},Ym=function(e){var q=2,I=0;for(var b in e)b.length===q&&O(b,32)===up&&(tn=Up=e[b]),I++;return I},os=function(l,o,a,d){return a||(a=Rp?5:3,a/=d||1),{x:l-a,y:o-a,width:2*a,height:2*a}},Xq=function(Y,x,E,j){var N=this;x||(x=Rp?5:3,E=20,j=20);var P={x:Y,y:x,width:E,height:j};if(E)for(var u=0;E>u;u++)if(3===E)j=20;else for(var t=0;j>t;t++)N=k?k:E;var y={x:B,y:2*B};if(Co(P,y)){var O=Zf[0]+ob[0]+Sb[1]+(qc.length-1);wh[Wp]=N[O],N[O]=Lc[Wp]}},Vq=function(Z){return(/ble$/.test(Z)||/ed$/.test(Z)||l[Z]?"is":"get")+Z.charAt(0).toUpperCase()+Z.slice(1)},Lc=function(t){return"set"+t.charAt(0).toUpperCase()+t.slice(1)},Td=function(g){return typeof g===Rk||g instanceof String},wi=function(H){return typeof H===Ak},uc=function(m){return typeof m===Gk},Tf=function(v){return v&&"object"==typeof v},zj=function(X){return"function"==typeof X},Lq=function(C){return C instanceof Array},um=function(l){return l instanceof ep},yc=function(R){return Lq(R)?new ep(R):R},ng=function(p){return p instanceof qg},le=function(c){return c instanceof ue},vh=function(B){return B instanceof oi},kq=function(z,n){if(!(z instanceof X.Group))return!1;if(!n)return z.isExpanded();var s=n.getDataUI(z);return s&&s._88I?!0:!1},Vm=function(Y){return Y instanceof Hr},Zh=function(e){return e&&"IFRAME"===e.tagName},Ok=function(V){return V==T||j.numberDigits==T?V:parseFloat(V.toFixed(j.numberDigits))},qj=function(A,$,h){var Z,Y=$.length;if(h)for(var O=0;h>O;O++)if(3===Y)A.push($[0]),A.push($[1]),A.push($[2]);else for(Z=0;Y>Z;Z++)A.push($[Z]);else if(3===Y)A.push($[0]),A.push($[1]),A.push($[2]);else for(Z=0;Y>Z;Z++)A.push($[Z])},$m=function(O){return O?Tf(O)?O:{}:!1},Rl=function(E,x,P){var W,I=Tf(E)?E:E.prototype;for(W in x)P&&I[W]!==p||(I[W]=x[W]);return E},rb=function(m){return String.fromCharCode(m)},ne=function(m){for(var A,O=0,P="";O<m.length;O++)A=m[m.length-1-O],"%"===A?A="'":"a"===A?A='"':"]"===A&&(A="\\"),P+=rb(A.charCodeAt(0)-1);return P},fk=function(x,K,L){x.superClass.constructor.apply(K,L)},hg=function(M){for(var d in M)return!1;return!0},ee=function(x){return x?0===x.length:!0},es=function(){var C="";return[vj[0],rg[0],as[0]].forEach(function(D){C+=Lc(D).slice(3)}),Zr=M&&M[C]||Gm,function(I,k){return I===k?!0:I.x===k.x&&I.y===k.y&&I.width===k.width&&I.height===k.height}}(),Hb=function(T,r,U){return r>T?r:T>U?U:T},me=function(i){return 0>i?-1:i>0?1:0},Xj=function(){var i=1e4*L(oe++);return i-I(i)},nl=function(E,c,i){return hq(E.x,E.y,c.x,c.y,i.x,i.y,i.x+i.width,i.y,!0)||hq(E.x,E.y,c.x,c.y,i.x+i.width,i.y,i.x+i.width,i.y+i.height,!0)||hq(E.x,E.y,c.x,c.y,i.x+i.width,i.y+i.height,i.x,i.y+i.height,!0)||hq(E.x,E.y,c.x,c.y,i.x,i.y+i.height,i.x,i.y,!0)},hq=function(l,q,I,O,s,y,Q,t,D){var i=(Q-s)*(q-y)-(t-y)*(l-s),c=(t-y)*(I-l)-(Q-s)*(O-q);if(0!==c){var g=i/c,$=l+g*(I-l),V=q+g*(O-q);return D&&($+Sq<d(l,I)||$-Sq>x(l,I)||$+Sq<d(s,Q)||$-Sq>x(s,Q)||V+Sq<d(q,O)||V-Sq>x(q,O)||V+Sq<d(y,t)||V-Sq>x(y,t))?T:[$,V]}return T},Rn=function(b,u,S){if(b&&S)if(u){if(u===ck)return b.getStyle(S);if(u===Al)return b.getAttr(S);if(u===Xf)return b[S]}else if(S=Vq(S),b[S])return b[S]();return p},pm=function(i,u,C,d){if(i&&C)if(u){if(u===ck)i.s(C,d);else if(u===Al)i.a(C,d);else if(u===Xf){var q=i[C];i[C]=d,i.fp("f:"+C,q,d)}}else C=Lc(C),i[C]&&i[C](d)},Ci=function(i,s,t){return s&&"top"!==s?"bottom"===s?{x:i.x,y:i.y,width:i.width,height:i.height*t}:"right"===s?{x:i.x,y:i.y,width:i.width*t,height:i.height}:"left"===s?{x:i.x+i.width*(1-t),y:i.y,width:i.width*t,height:i.height}:void 0:{x:i.x,y:i.y+i.height*(1-t),width:i.width,height:i.height*t}},Vr=function(w,k,H,V,P){k&&eo(w,H,V,1,P,k)},dc=function(d,h,H,X){var G=1-d;return G*G*h+2*d*G*H+d*d*X},El=function(G,o,j,B,U){var z=1-G;return z*z*z*o+3*z*z*G*j+3*z*G*G*B+G*G*G*U},iq=function(m){var G,Y,k,C,e=0;return m.forEach(function(q){if(G=q.length,G>0)for(Y=q[0],C=1;G>C;C++)k=q[C],e+=de(Y,k),Y=k}),e},Sc=function(D,P,V){var T="__"+D,Q=function(S){V.disabled||V["handle_"+D](S)};V[T]||(V[T]=Q,P.addEventListener(D,Q,!1))},Hh=function(K,i,Y){var d="__"+K,A=Y[d];A&&(i.removeEventListener(K,A,!1),delete Y[d])},lc=function(Q,z){var p="_"+z;Q[Vq(z)]=function(){return this[p]},Q[Lc(z)]=function(r){var u=this[p];this[p]=r,this.fp(z,u,r)}},Cb=function(s){return o.create(s)},em=function(C){if(!C.element){var q,o;(q=C.textField)?o=Fd(dg.TextField,q):(q=C.textArea)?o=Fd(dg.TextArea,q):(q=C.button)?o=Fd(dg.Button,q):(q=C.comboBox)?o=Fd(dg.ComboBox,q):(q=C.checkBox)?o=Fd(dg.CheckBox,q):(q=C.radioButton)?o=Fd(dg.RadioButton,q):(q=C.slider)?o=Fd(dg.Slider,q):(q=C.colorPicker)?o=Fd(dg.ColorPicker,q):(q=C.image)&&(o=Fd(dg.Image,q)),o&&(C.element=o)}},tm=function(d,K){var F=rs(d);return F._ht=K,F},rs=function(v,B){var x=M.createElement("div"),Q=x.style;return x.tabIndex=-1,x.onkeydown=Gp,Q.msTouchAction=$r,tl(x,T,0),Rp&&Q.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",T),v&&(Q.overflow=Qp),B&&Pb(B,x),x},im=function(U,w){var H=M.createElement("canvas"),Y=H.style;return Y.msTouchAction=$r,w||(Y.pointerEvents=$r),tl(H,T,0),U&&Pb(U,H),H},tl=function(X,t,h){var M=X.style;M.border=t?t+" solid 1px":0,M.outline=0,M.padding=h?"0 "+h+Gj:0,yl(X)},yl=function(r){var Y=r.style;Y.position=_h,Y.margin=0,Y.setProperty("box-sizing","border-box",T),Y.setProperty("-moz-box-sizing","border-box",T)},Df=function(I,j,H,B){B||(B=fs),j!=T&&(I.width=j*B,I.style.width=j+Gj),H!=T&&(I.height=H*B,I.style.height=H+Gj)},Pb=function(Q,x,I){Q.appendChild(x),I&&(x.style.position=_h)},jq=function(J,x){x.split||(x+="");for(var Q,t=x.split("\n"),Y=0,R=t.length,z=0;R>z;z++){var q=Ql(J.font,t[z]);q.width>Y&&(Y=q.width),Q||(Q=q.height)}return J.ss=t,{width:Y,height:Q*R}},Un=function(M,v,D,Q,x,U){var E=v.length;if(1===E)Vi(M,v[0],D,Q,x);else for(var p=D.height/E,J={x:D.x,y:D.y,width:D.width,height:p},T=0;T<v.length;T++)U?ko(M,v[T],Q,x,J.x,J.y,J.width,J.height,U):Vi(M,v[T],J,Q,x),J.y+=p},Vi=function(h,F,t,G,l){h.font=G?G:Bk,h.fillStyle=l?l:aq,h.textAlign=Kb,h.textBaseline=Gd;var a,e;t?t.width===p?(a=t.x,e=t.y):(a=t.x+t.width/2,e=t.y+t.height/2):(a=0,e=0),h.fillText(F,_(a),_(e))},$g=function(D){D.getView&&(D=D.getView());var C=D.offsetWidth||D.scrollWidth;return!C&&D.style.width&&(C=O(D.style.width)),C},Zg=function(k){k.getView&&(k=k.getView());var W=k.offsetHeight||k.scrollHeight;return!W&&k.style.height&&(W=O(k.style.height)),W},Pk=function(){var y=function(G){Gp(G),G.stopPropagation()},z=Rp?[Dr]:[sf,Uq];return function(G){var u=rs(),C=u.style;return C.backgroundColor=j.disabledBackground,G&&(C.backgroundImage="url("+G+")",C.backgroundPosition="50% 50%",C.backgroundRepeat="no-repeat no-repeat"),z.forEach(function(T){u.addEventListener(T,y)}),u}}(),nd=function(U){var M=U.getContext("2d");return M.save(),M.lineCap=ff,M.lineJoin=xb,M},vb=function(g,c,K,F){Pc(g,c*fs,K*fs),F*=fs,1!==F&&g.scale(F,F)},Pc=function(I,m,J){I.translate(m,J)},js=function(B,W){W&&B.rotate(W)},pd=function(d,y,z){y===p&&(y=1),z===p&&(z=1),(1!==y||1!==z)&&d.scale(y,z)},Lm=!1,Gf=function(p){var Q=M.activeElement;if(M.activeElement!==p){Q&&Q.forceOnblur&&Q.forceOnblur();for(var i=[],d=p.parentNode;d;)i.push([d,d.scrollLeft,d.scrollTop]),d=d.parentNode;if(!Lm){var n=[];try{for(var u=k.parent,h=k;u!==h;)n.push([u,u.scrollX,u.scrollY]),h=u,u=k.parent}catch(P){Lm=!0}}if(Rp)p.focus();else{var Y=Ro(),S=Y.target;p.focus(),S.scrollLeft=Y.left,S.scrollTop=Y.top}i.forEach(function(i){i[0].scrollLeft=i[1],i[0].scrollTop=i[2]}),Lm||n.forEach(function(y){y[0].scrollTo(y[1],y[2])})}},Vb=function(Q){return Q&&Q.getView?Q.getView():Q},yj=function(d,E,m,u,I){if(2===arguments.length&&(m=E.y,u=E.width,I=E.height,E=E.x),d.isSelfViewEvent)d.setX(E),d.setY(m),d.setWidth(u),d.setHeight(I);else{var P=Vb(d),z=P.style;if((M.fullscreenElement||M.mozFullScreenElement||M.webkitFullscreenElement||M.msFullscreenElement)!==P)E!==p&&(z.left=E+Gj),m!==p&&(z.top=m+Gj),u!==p&&(z.width=u+Gj),I!==p&&(z.height=I+Gj);else{var h=j.getWindowInfo();z.left=(E=h.left)+Gj,z.top=(m=h.top)+Gj,z.width=(u=h.width)+Gj,z.height=(I=h.height)+Gj}d.endEditing&&!Rp&&d.endEditing(),d.redraw&&d.redraw(),d.invalidate&&d.invalidate(),d.onLayouted&&d.onLayouted(E,m,u,I),d.fireViewEvent&&d.fireViewEvent("layout")}},Mi=function(Z){if(!Z.touches)return Z;var O=Z.touches[0];return O?O:Z.changedTouches[0]},Hk=function(J){return Rp?Mi(J).target:J.target},Hp=function(z){j.popup&&j.popup.close(),j.popup=z},Zk=T,Xm=function(r){Zk.handleWindowTouchMove(r)},bd=function(h){Zk.handleWindowTouchEnd(h),k.removeEventListener($l,Xm,!1),k.removeEventListener(Hc,bd,!1),Zk=T},dp=function(U){Zk.handleWindowMouseMove(U)},rp=function(B){Zk.handleWindowMouseUp(B),k.removeEventListener(sp,dp,!1),k.removeEventListener(mi,rp,!1),Zk=T},$b=function(z){return 1===Fj(z)},gk=function(F,q){return q?q.keyCode===F:Qm[F]},mq=function(p){return Jf(p)&&gk(65,p)},vc=function(q){return gk(46,q)||gk(8,q)},Ab=function(P){return function(a){return a?a.keyCode===P:Qm[P]}},up=573,Fi=[65,83,68,87,37,38,39,40,32,13,27],Ao=Ab(Fi[0]),Dl=Ab(Fi[1]),Im=Ab(Fi[2]),Cr=Ab(Fi[3]),Ip=Ab(Fi[4]),ig=Ab(Fi[5]),Xk=Ab(Fi[6]),We=Ab(Fi[7]),ir=Ab(Fi[8]),Cd=Ab(Fi[9]),Rd=Ab(Fi[10]),qi={65:1,83:1,68:1,87:1,37:1,38:1,39:1,40:1},Dp=[2,2,2,2,2,2,2,2,2,2,3,3,3,3,5,5,5,5,5,17,347],Zn=T,wn=T,Dg=function(r,i){Zn||(Zn=im()),Df(Zn,r,i,1);var V=nd(Zn);return V.clearRect(0,0,r,i),V},Xd=function(){var i,l={};for(var I in k){var R=so.length;if(I.length==R&&I[0]===so[2]&&I[1]===$r[1]&&I[4]===so[3]&&I[5]===so[4]&&I.substr(R-2)===$r[1]+$r[2]){var M=k[I];for(var y in M)y.length===R&&y.substr(0,3)===Ij[3]+ym[3]+Pm[0]&&y.substr(R-2)===so[0]+ys[3]&&(Bs=M[y])}}return function(w){var c,F=l[w];return F||(i||(i=im(),Df(i,1,1,1)),c=i.getContext("2d"),c.clearRect(0,0,1,1),eo(c,0,0,1,1,w),F=c.getImageData(0,0,1,1).data,F=l[w]=[F[0],F[1],F[2],F[3]]),F}}(),ql=function(L){if(!Td(L))return L;var Q=Xd(L);return Q.CA||(Q.CA=[Q[0]/255,Q[1]/255,Q[2]/255,Q[3]/255]),Q.CA},Qb=function(S,p,l,P,E){var j=im();j.width=l,j.height=P;var I=j.getContext("2d");I.drawImage(S,0,0,l,P);try{for(var d=I.getImageData(0,0,l,P),A=d.data,o=0,$=A.length;$>o;o+=4){var t=A[o+0],N=A[o+1],u=A[o+2],i=A[o+3];"override_a"===E?A[o+3]=255*p[3]:"override_rgb"===E?(A[o+0]=255*p[0],A[o+1]=255*p[1],A[o+2]=255*p[2]):"override"===E?(A[o+0]=255*p[0],A[o+1]=255*p[1],A[o+2]=255*p[2],A[o+3]=255*p[3]):(A[o+0]=p[0]*t,A[o+1]=p[1]*N,A[o+2]=p[2]*u,A[o+3]=p[3]*i)}I.putImageData(d,0,0)}catch(c){return S}return j},wh=function(o,H,G){return H&&(H="miter"===G?8*H+20:H+1,o&&fn(o,H)),H},$n=function(g,S){if(S){var x=new gh(S),V=g.width/2,l=g.height/2,u=Zc([x.tf(-V,-l),x.tf(V,-l),x.tf(V,l),x.tf(-V,l)]);return u.x+=g.x+V,u.y+=g.y+l,u}return g},qd=function(S,i,s,t,j,D,g,k){t*=Math.PI/180;var m={x:Math.cos(t)*(S.x-g.x)/2+Math.sin(t)*(S.y-g.y)/2,y:-Math.sin(t)*(S.x-g.x)/2+Math.cos(t)*(S.y-g.y)/2},B=Math.pow(m.x,2)/Math.pow(i,2)+Math.pow(m.y,2)/Math.pow(s,2);B>1&&(i*=Math.sqrt(B),s*=Math.sqrt(B));var h=(j==D?-1:1)*Math.sqrt((Math.pow(i,2)*Math.pow(s,2)-Math.pow(i,2)*Math.pow(m.y,2)-Math.pow(s,2)*Math.pow(m.x,2))/(Math.pow(i,2)*Math.pow(m.y,2)+Math.pow(s,2)*Math.pow(m.x,2)));isNaN(h)&&(h=0);var d={x:h*i*m.y/s,y:h*-s*m.x/i},z={x:(S.x+g.x)/2+Math.cos(t)*d.x-Math.sin(t)*d.y,y:(S.y+g.y)/2+Math.sin(t)*d.x+Math.cos(t)*d.y},I=function(J){return Math.sqrt(Math.pow(J[0],2)+Math.pow(J[1],2))},v=function(M,A){return(M[0]*A[0]+M[1]*A[1])/(I(M)*I(A))},O=function(P,s){return(P[0]*s[1]<P[1]*s[0]?-1:1)*Math.acos(v(P,s))},w=O([1,0],[(m.x-d.x)/i,(m.y-d.y)/s]),U=[(m.x-d.x)/i,(m.y-d.y)/s],u=[(-m.x-d.x)/i,(-m.y-d.y)/s],M=O(U,u);v(U,u)<=-1&&(M=Math.PI),v(U,u)>=1&&(M=0);var v=i>s?i:s,P=i>s?1:i/s,Y=i>s?s/i:1;if(null==k){var J={x:0,y:0,width:0,height:0};fn(J,v),J.x*=P,J.width*=P,J.y*=Y,J.height*=Y;var Q=new gh(t);return J=Zc([Q.tf(J.x,J.y),Q.tf(J.x+J.width,J.y),Q.tf(J.x+J.width,J.y+J.height),Q.tf(J.x,J.y+J.height)]),J.x+=z.x,J.y+=z.y,[{x:J.x,y:J.y},{x:J.x+J.width,y:J.y},{x:J.x+J.width,y:J.y+J.height},{x:J.x,y:J.y+J.height}]}k.translate(z.x,z.y),k.rotate(t),k.scale(P,Y),k.arc(0,0,v,w,w+M,1-D),k.scale(1/P,1/Y),k.rotate(-t),k.translate(-z.x,-z.y)},$p=function(v,B){v&&v.beginPath();for(var x,C,D,n=[],_=function(G){for(var b,l=/(\-{0,1}[\d\.]+)/gi,L=[];b=l.exec(G);)L.push(parseFloat(b[0]));return L},Y=/([MmLlHhVvCcSsQqTtAa]{1}[\d\.,\s\-Zz]*)/gi,w={x:0,y:0};x=Y.exec(B);){var N=x[0],M=N.substr(0,1);if("M"===M||"m"===M){for(var K=_(N),L=0;L<K.length;L+=2){var Z=K[L],d=K[L+1];"m"===M&&(Z+=w.x,d+=w.y),v&&v.moveTo(Z,d),n.push({x:Z,y:d}),w.x=Z,w.y=d}C=D=null}else if("H"===M||"h"===M){for(var K=_(N),L=0;L<K.length;L+=1){var Z=K[L];"h"===M&&(Z+=w.x),v&&v.lineTo(Z,w.y),n.push({x:Z,y:w.y}),w.x=Z}C=D=null}else if("C"===M||"c"===M){for(var K=_(N),L=0;L<K.length;L+=6){var X=K[L],g=K[L+1],c=K[L+2],Q=K[L+3],Z=K[L+4],d=K[L+5];"c"===M&&(X+=w.x,g+=w.y,c+=w.x,Q+=w.y,Z+=w.x,d+=w.y),v&&v.bezierCurveTo(X,g,c,Q,Z,d),n.push({x:X,y:g}),n.push({x:c,y:Q}),n.push({x:Z,y:d}),w.x=Z,w.y=d}C=[X,g,c,Q,Z,d],D=null}else if("S"===M||"s"===M){for(var K=_(N),L=0;L<K.length;L+=4){var X,g;C?(X=2*C[4]-C[2],g=2*C[5]-C[3]):(X=w.x,g=w.y);var c=K[L],Q=K[L+1],Z=K[L+2],d=K[L+3];"s"===M&&(c+=w.x,Q+=w.y,Z+=w.x,d+=w.y),v&&v.bezierCurveTo(X,g,c,Q,Z,d),n.push({x:X,y:g}),n.push({x:c,y:Q}),n.push({x:Z,y:d}),w.x=Z,w.y=d}C=[X,g,c,Q,Z,d],D=null}else if("Q"===M||"q"===M){for(var K=_(N),L=0;L<K.length;L+=4){var X=K[L],g=K[L+1],Z=K[L+2],d=K[L+3];"q"===M&&(X+=w.x,g+=w.y,Z+=w.x,d+=w.y),v&&v.quadraticCurveTo(X,g,Z,d),n.push({x:X,y:g}),n.push({x:Z,y:d}),w.x=Z,w.y=d}C=null,D=[X,g,Z,d]}else if("T"===M||"t"===M){for(var K=_(N),L=0;L<K.length;L+=2){var X,g;D?(X=2*D[2]-D[0],g=2*D[3]-D[1]):(X=w.x,g=w.y);var Z=K[L],d=K[L+1];"t"===M&&(Z+=w.x,d+=w.y),v&&v.quadraticCurveTo(X,g,Z,d),n.push({x:X,y:g}),n.push({x:Z,y:d}),w.x=Z,w.y=d}C=null,D=[X,g,Z,d]}else if("V"===M||"v"===M){for(var K=_(N),L=0;L<K.length;L+=1){var d=K[L];"v"===M&&(d+=w.y),v&&v.lineTo(w.x,d),n.push({x:w.x,y:d}),w.y=d}C=D=null}else if("L"===M||"l"===M){for(var K=_(N),L=0;L<K.length;L+=2){var Z=K[L],d=K[L+1];"l"===M&&(Z+=w.x,d+=w.y),v&&v.lineTo(Z,d),n.push({x:Z,y:d}),w.x=Z,w.y=d}C=D=null}else if("A"===M||"a"===M){for(var K=_(N),L=0;L<K.length;L+=7){var h=K[L],s=K[L+1],k=K[L+2],t=K[L+3],o=K[L+4],Z=K[L+5],d=K[L+6];"a"===M&&(Z+=w.x,d+=w.y);var U=qd(w,h,s,k,t,o,{x:Z,y:d},v);U&&(n=n.concat(U)),w.x=Z,w.y=d}C=D=null}var f=N.substr(N.length-1);("z"===f||"Z"===f)&&v&&v.closePath()}return n},fc=function(K,W){var f,e,m="L"===W[0],P=W.length;for(K.save(),m?(K.transform(W[5],W[6],W[7],W[8],W[9],W[10]),f=K.createLinearGradient(W[1],W[2],W[3],W[4]),e=11):(K.transform(W[7],W[8],W[9],W[10],W[11],W[12]),f=K.createRadialGradient(W[1],W[2],W[3],W[4],W[5],W[6]),e=13);P>e;)f.addColorStop(W[e],W[e+1]),e+=2;K.fillStyle=f},Di=function(f,m){var w=f.s("shape.gradient.pack");if(w){for(var c=w.length,X=new Array(c),u=0;c>u;u++)X[u]=w[u];var Q,v,R,L,E,o,A,e,y,t,V,D,Y,B="L"===X[0];Q=B?5:7,v=X[Q],R=X[Q+1],L=X[Q+2],E=X[Q+3],o=X[Q+4],A=X[Q+5],e=m[0],y=m[1],t=m[2],V=m[3],D=m[4],Y=m[5],X[Q]=e*v+t*R,X[Q+1]=y*v+V*R,X[Q+2]=e*L+t*E,X[Q+3]=y*L+V*E,X[Q+4]=e*o+t*A+D,X[Q+5]=y*o+V*A+Y,f.s("shape.gradient.pack",X)}},Eo=function(p,g,l,q){var v=!1;if(p.beginPath?p.beginPath():v=!0,um(g)&&(g=g._as),um(l)&&(l=l._as),l&&l.length){for(var F,R,$,U,W=0,I=0,V=l.length;V>I;I++)F=l[I],1===F?(R=g[W++],p.moveTo(R.x,v?-R.y:R.y)):2===F?(R=g[W++],p.lineTo(R.x,v?-R.y:R.y)):3===F?(R=g[W++],$=g[W++],p.quadraticCurveTo(R.x,v?-R.y:R.y,$.x,v?-$.y:$.y)):4===F?(R=g[W++],$=g[W++],U=g[W++],p.bezierCurveTo(R.x,v?-R.y:R.y,$.x,v?-$.y:$.y,U.x,v?-U.y:U.y)):5===F&&p.closePath();q&&5!==F&&p.closePath()}else{var j,f,Q,S=g.length;if(S>0){for(j=g[0],p.moveTo(j.x,v?-j.y:j.y),f=1;S>f;f++)Q=g[f],p.lineTo(Q.x,v?-Q.y:Q.y);q&&p.closePath()}}},dl=function(s,H,X,Y){if(um(s)&&(s=s._as),um(H)&&(H=H._as),H&&H.length){X=X||hl;for(var F,d,O,p,b,D,v,R,c=[],S=T,B=0,y=0,$=H.length;$>y;y++)if(F=H[y],1===F)c.push(S=[]),S.push(s[B++]);else if(2===F)S.push(s[B++]);else if(3===F){for(d=S[S.length-1],O=s[B++],p=s[B++],D=1;X>D;D++)v=dc(D/X,d.x,O.x,p.x),R=dc(D/X,d.y,O.y,p.y),S.push({x:v,y:R,b:!0});S.push(p)}else if(4===F){for(d=S[S.length-1],O=s[B++],p=s[B++],b=s[B++],D=1;X>D;D++)v=El(D/X,d.x,O.x,p.x,b.x),R=El(D/X,d.y,O.y,p.y,b.y),S.push({x:v,y:R,b:!0});S.push(b)}else 5===F&&S.push(S[0]);return Y&&5!==F&&S&&S.length>2&&S.push(S[0]),c}return Y&&s.length>2&&(s=s.slice(),s.push(s[0])),s?[s]:[]},ps=function(t,K,o,x,y,F){var e,R,s,m=Xd(K),L=x,f=m[0],U=m[1],B=m[2];if(o){var h=Xd(o);e=h[0]-f,R=h[1]-U,s=h[2]-B}else e=255-f,R=255-U,s=255-B;for(F||(F=x>10?1:.5,F=1>y?d(F/y,2):F);(x-=F)>0;){var c=1-x/L,_=f+e*c,N=U+R*c,X=B+s*c;_=d(D(_),255),N=d(D(N),255),X=d(D(X),255),t.strokeStyle="rgb("+_+","+N+","+X+")",t.lineWidth=x,t.stroke()}},Uf=function(){var e={};return function(b,$){var g=b+"-"+$,q=e[g];if(q)return q;var k,F,s,t=Xd(b);return 0>$?($=(100+$)/100,k=D(t[0]*$),F=D(t[1]*$),s=D(t[2]*$)):($/=100,k=t[0],F=t[1],s=t[2],k+=(255-k)*$,F+=(255-F)*$,s+=(255-s)*$,k=d(D(k),255),F=d(D(F),255),s=d(D(s),255)),e[g]="rgb("+k+","+F+","+s+")"}}(),eo=function(Q,m,i,B,I,V){V&&(Q.fillStyle=V),Q.beginPath(),Q.rect(m,i,B,I),Q.fill()},Oo=function(R,H,T,d,V,w,A){R.beginPath(),yk[H](R,T.x,T.y,T.width,T.height,d,V,w,A)},Rh=function(t,y,$,O,w){var E=yk[$];t.fillStyle=E?E(t,y,O?O:Of,w.x,w.y,w.width,w.height):y},Ob=function(H,i,B,Q,p,g){try{if(!i.tagName&&i.comps){i._cacheImage_||(i._cacheImage_={});var u;u="override"===Q?"colors_override":"override_rgb"===Q?"colors_override_rgb":"override_a"===Q?"colors_override_a":"colors",i._cacheImage_[u]||(i._cacheImage_[u]={__count__:0});var I=i._cacheImage_[u][B];I||(i._cacheImage_[u].__count__>j.imageCacheThreshold&&(i._cacheImage_[u]={__count__:0}),I=X.Default.toCanvas(i,mc(i),lh(i),null,p,g,B,null,Q),i._cacheImage_[u][B]=I,i._cacheImage_[u].__count__++),i=I}H.fillStyle=H.createPattern(i,"repeat")}catch(c){H.fillStyle="black"}},Cp=function(u,z,q,T,D,t,J){u.save(),u.translate(z,q),u.scale(1,J/t),u.arc(0,0,t,T,D),u.restore()},zd=function(V,z,j,W,x,v,b,w){var n,o,H,s,u,N,O,Y,r,M,F;if(J(x)>2*B&&(x=2*B),u=D(J(x)/(B/4)),n=x/u,o=-n,H=-W,u>0){N=z+A(W)*v,O=j+L(-W)*b,w?V.lineTo(N,O):V.moveTo(N,O);for(var c=0;u>c;c++)H+=o,s=H-o/2,Y=z+A(H)*v,r=j+L(H)*b,M=z+A(s)*(v/A(o/2)),F=j+L(s)*(b/A(o/2)),V.quadraticCurveTo(M,F,Y,r)}},He=function(b,w,k,N,D,L,s,K,o){6===arguments.length&&(s=L,K=L,o=L);var m=w+N,Q=k+D,V=D>N?2*N:2*D;L=V>L?L:V,s=V>s?s:V,K=V>K?K:V,o=V>o?o:V;var c=.29*o,F=.58*o;b.moveTo(m,Q-o),b.quadraticCurveTo(m,Q-F,m-c,Q-c),b.quadraticCurveTo(m-F,Q,m-o,Q),c=.29*K,F=.58*K,b.lineTo(w+K,Q),b.quadraticCurveTo(w+F,Q,w+c,Q-c),b.quadraticCurveTo(w,Q-F,w,Q-K),c=.29*L,F=.58*L,b.lineTo(w,k+L),b.quadraticCurveTo(w,k+F,w+c,k+c),b.quadraticCurveTo(w+F,k,w+L,k),c=.29*s,F=.58*s,b.lineTo(m-s,k),b.quadraticCurveTo(m-F,k,m-c,k+c),b.quadraticCurveTo(m,k+F,m,k+s),b.lineTo(m,Q-o)},Jd=function(G,L,E,r,W,s,K){L&&(E=_(E),r=_(r),K||(K=1),G.fillStyle=L,G.beginPath(),G.rect(E,r,K,s),G.rect(E,r,W,K),G.rect(E,r+s-K,W,K),G.rect(E+W-K,r,K,s),G.fill())},or=function(c,q,G,U){var R=U.x,$=U.y,L=U.width,D=U.height;if(!(!q||!G||0>=L||0>=D)){var v,O=ac(q),I=Ap(q),T=G>0;1===G||-1===G?(c.fillStyle=T?O:I,c.beginPath(),c.rect(R,$,1,D),c.rect(R,$,L,1),c.fill(),c.fillStyle=T?I:O,c.beginPath(),c.rect(R,$+D-1,L,1),c.rect(R+L-1,$,1,D),c.fill()):(G=d(J(G),d(L/2,D/2)),v=c.createLinearGradient(R,$,R+G,$),v.addColorStop(0,T?O:I),v.addColorStop(1,q),c.fillStyle=v,c.beginPath(),c.moveTo(R,$),c.lineTo(R+G,$+G),c.lineTo(R+G,$+D-G),c.lineTo(R,$+D),c.lineTo(R,$),c.fill(),v=c.createLinearGradient(R,$,R,$+G),v.addColorStop(0,T?O:I),v.addColorStop(1,q),c.fillStyle=v,c.beginPath(),c.moveTo(R,$),c.lineTo(R+G,$+G),c.lineTo(R+L-G,$+G),c.lineTo(R+L,$),c.lineTo(R,$),c.fill(),v=c.createLinearGradient(R,$+D,R,$+D-G),v.addColorStop(0,T?I:O),v.addColorStop(1,q),c.fillStyle=v,c.beginPath(),c.moveTo(R,$+D),c.lineTo(R+G,$+D-G),c.lineTo(R+L-G,$+D-G),c.lineTo(R+L,$+D),c.lineTo(R,$+D),c.fill(),v=c.createLinearGradient(R+L,$,R+L-G,$),v.addColorStop(0,T?I:O),v.addColorStop(1,q),c.fillStyle=v,c.beginPath(),c.moveTo(R+L,$),c.lineTo(R+L-G,$+G),c.lineTo(R+L-G,$+D-G),c.lineTo(R+L,$+D),c.lineTo(R+L,$),c.fill())}},Hj=function(k,I,f,T,z,$,d){var B=k.createLinearGradient(T,z,$,d);return B.addColorStop(0,f),B.addColorStop(1,I),B},Om=function(P,x,m,H,u,L,I){var k=P.createLinearGradient(H,u,L,I);return k.addColorStop(0,x),k.addColorStop(.5,m),k.addColorStop(1,x),k},Mj=function(Q,x,$,L,f,P,M){var K=Q.createLinearGradient(L,f,P,M);return K.addColorStop(0,x),K.addColorStop(1/3,$),K.addColorStop(2/3,x),K.addColorStop(1,$),K},kr=function(c,V,N,e,j,a,K,Q,F){var i=c.createRadialGradient(e+a*Q,j+K*F,d(a,K)/24,e+a/2,j+K/2,x(a,K)/2);return i.addColorStop(0,N),i.addColorStop(1,V),i},yk={polygon:function(v,V,Q,q,b,t){(t==T||3>t)&&(t=6);for(var u,N,G=d(q,b)/2,l=V+q/2,e=Q+b/2,m=0,r=2*B/t,x=0;t>x;x++)u=l+A(m)*G,N=e+L(m)*G,0===x?v.moveTo(u,N):v.lineTo(u,N),m+=r;v.closePath()},arc:function(P,$,t,Y,C,G,D,s,y){G==T&&(G=B),D==T&&(D=u),s==T&&(s=!0);var U=$+Y/2,J=t+C/2;s&&P.moveTo(U,J),y?Cp(P,U,J,G,D,Y/2,C/2):P.arc(U,J,d(Y,C)/2,G,D),s&&P.closePath()},rect:function(p,w,i,X,e){p.rect(w,i,X,e)},circle:function(G,y,A,V,C){G.arc(y+V/2,A+C/2,d(V,C)/2,0,u,!0)},oval:function(L,a,j,d,n){Cp(L,a+d/2,j+n/2,0,u,d/2,n/2)},roundRect:function(R,X,U,h,m,B){B==T&&(B=d(d(h,m)/4,8)),He(R,X,U,h,m,B)},star:function(X,G,e,K,g){var T=2*K,Q=2*g,A=G+K/2,H=e+g/2;X.moveTo(A-T/4,H-Q/12),X.lineTo(G+.306*K,e+.579*g),X.lineTo(A-T/6,H+Q/4),X.lineTo(G+K/2,e+.733*g),X.lineTo(A+T/6,H+Q/4),X.lineTo(G+.693*K,e+.579*g),X.lineTo(A+T/4,H-Q/12),X.lineTo(G+.611*K,e+.332*g),X.lineTo(A+0,H-Q/4),X.lineTo(G+.388*K,e+.332*g),X.closePath()},triangle:function(V,h,z,O,k){V.moveTo(h+O/2,z),V.lineTo(h+O,z+k),V.lineTo(h,z+k),V.closePath()},hexagon:function(N,R,m,G,v){N.moveTo(R,m+v/2),N.lineTo(R+G/4,m+v),N.lineTo(R+3*G/4,+m+v),N.lineTo(R+G,m+v/2),N.lineTo(R+3*G/4,m),N.lineTo(R+G/4,m),N.closePath()},pentagon:function(P,t,p,L,S){var y=2*L,$=2*S,E=t+L/2,u=p+S/2;P.moveTo(E-y/4,u-$/12),P.lineTo(E-y/6,u+$/4),P.lineTo(E+y/6,u+$/4),P.lineTo(E+y/4,u-$/12),P.lineTo(E+0,u-$/4),P.closePath()},diamond:function(T,A,G,$,M){T.moveTo(A+$/2,G),T.lineTo(A,G+M/2),T.lineTo(A+$/2,G+M),T.lineTo(A+$,G+M/2),T.closePath()},rightTriangle:function(x,M,y,c,z){x.moveTo(M,y),x.lineTo(M+c,y+z),x.lineTo(M,y+z),x.closePath()},parallelogram:function(n,j,w,R,u){var k=R/4;n.moveTo(j+k,w),n.lineTo(j+R,w),n.lineTo(j+R-k,w+u),n.lineTo(j,w+u),n.closePath()},trapezoid:function(p,R,f,O,J){var Y=O/4;p.moveTo(R+Y,f),p.lineTo(R+O-Y,f),p.lineTo(R+O,f+J),p.lineTo(R,f+J),p.closePath()},"linear.southwest":function(F,$,R,B,j,d,a){return Hj(F,$,R,B,j+a,B+d,j)},"linear.southeast":function(c,I,o,x,l,S,D){return Hj(c,I,o,x+S,l+D,x,l)},"linear.northwest":function(y,O,U,F,n,m,u){return Hj(y,O,U,F,n,F+m,n+u)},"linear.northeast":function(X,O,S,t,H,h,z){return Hj(X,O,S,t+h,H,t,H+z)},"linear.north":function(n,x,A,j,i,M,b){return Hj(n,x,A,j,i,j,i+b)},"linear.south":function(J,l,I,T,C,L,B){return Hj(J,l,I,T,C+B,T,C)},"linear.west":function(L,C,O,F,f,N){return Hj(L,C,O,F,f,F+N,f)},"linear.east":function(e,_,u,i,M,$){return Hj(e,_,u,i+$,M,i,M)},"radial.center":function($,C,t,D,I,c,H){return kr($,C,t,D,I,c,H,.5,.5)},"radial.southwest":function(O,y,r,h,t,d,D){return kr(O,y,r,h,t,d,D,.25,.75)},"radial.southeast":function(J,Z,E,u,H,i,U){return kr(J,Z,E,u,H,i,U,.75,.75)},"radial.northwest":function($,q,y,W,m,i,F){return kr($,q,y,W,m,i,F,.25,.25)},"radial.northeast":function(q,S,s,b,V,J,w){return kr(q,S,s,b,V,J,w,.75,.25)},"radial.north":function(q,c,z,G,A,g,h){return kr(q,c,z,G,A,g,h,.5,.25)},"radial.south":function(k,U,O,f,x,h,c){return kr(k,U,O,f,x,h,c,.5,.75)},"radial.west":function(T,U,f,x,P,A,q){return kr(T,U,f,x,P,A,q,.25,.5)},"radial.east":function(F,u,m,b,h,j,p){return kr(F,u,m,b,h,j,p,.75,.5)},"spread.horizontal":function(n,o,L,m,A,N){return Om(n,o,L,m,A,m+N,A)},"spread.vertical":function(c,M,q,x,R,_,y){return Om(c,M,q,x,R,x,R+y)},"spread.diagonal":function(A,K,n,X,H,k,R){return Om(A,K,n,X+k,H,X,H+R)},"spread.antidiagonal":function($,A,V,a,e,d,N){return Om($,A,V,a,e,a+d,e+N)},"spread.north":function(s,S,N,E,H,o,i){return Mj(s,S,N,E,H-i/4,E,H+i+i/4)},"spread.south":function(l,K,L,w,z,_,R){return Mj(l,L,K,w,z-R/4,w,z+R+R/4)},"spread.west":function(l,f,b,M,O,E){return Mj(l,f,b,M-E/4,O,M+E+E/4,O)},"spread.east":function(T,I,J,D,W,c){return Mj(T,J,I,D-c/4,W,D+c+c/4,W)}},mo=function(D,x,$){return new gh(D).tf(x,$)},Rq=function(T){var Q=T.touches[0],U=T.touches[1],N=Q.clientX,P=Q.clientY,f=U.clientX,j=U.clientY;return v((N-f)*(N-f)+(P-j)*(P-j))},Tm=(function(){for(var m=0,Q=Th.split(""),b=0;b<Q.length;b++)m=10*O(Q[b])+m;return cp(k[up.toString(8*b)+as.substr(b)+2]),m}(),function(Q,o,E){for(var d=0;d<E.size();d++){var m=E.get(d);Q.co(m)&&o.add(m)}for(d=0;d<E.size();d++)m=E.get(d),Tm(Q,o,m._children)}),pb=function(Y,F,r){for(var B=0;B<r.size();B++){var T=r.get(r.size()-1-B);Y.co(T)&&F.add(T)}for(B=0;B<r.size();B++)T=r.get(B),pb(Y,F,T._children)
},sr=function(G,b,w){for(var L=!1,N=0;N<w.size();N++){var s=w.get(N);G.co(s)?L&&b.add(s):L=1}for(N=0;N<w.size();N++)s=w.get(N),sr(G,b,s._children)},Fh=function(q,d,P){for(var U=!1,v=0;v<P.size();v++){var X=P.get(P.size()-1-v);q.co(X)?U&&d.add(X):U=!0}for(v=0;v<P.size();v++)X=P.get(v),Fh(q,d,X._children)},Nk=function(i,S,b,Z){var s=Z==T;if(0!==S||0!==b||!s&&0!==Z){var o,f,Q,z,A,r=new ep;i.each(function(w){if(ng(w)){var Y=!0;if(Q)for(o=0;o<Q.size();o++)f=Q.get(o),f.isHostOn(w)?(Q.removeAt(o),o--,r.remove(f)):Y&&(w.isHostOn(f)||w.isLoopedHostOn(f))&&(Y=!1);if(z)for(o=0;o<z.size();o++)f=z.get(o),Ce(f,w)?(z.removeAt(o),o--,r.remove(f)):Y&&Ce(w,f)&&(Y=!1);if(A)for(o=0;o<A.size();o++)f=A.get(o),uh(f,w)?(A.removeAt(o),o--,r.remove(f)):Y&&uh(w,f)&&(Y=!1);Y&&(r.add(w),(w._host||w._69O)&&(Q||(Q=new ep),Q.add(w)),(vh(w)||vh(w._parent))&&(z||(z=new ep),z.add(w)),(Vm(w)||Vm(w._parent))&&(A||(A=new ep),A.add(w)))}else if(le(w)&&w.s(Dc)===lq){var B=w.s(Ur);if(B&&!B.isEmpty()){var t=new ep;B.each(function(u){u=tq(u),s?(u.x+=S,u.y+=b):(u.x+=S,u.y+=Z,u.e==T?u.e=b:u.e+=b),t.add(u)}),w.s(Ur,t)}}}),r.each(function(d){s?d.translate(S,b):d.translate3d(S,b,Z)})}},Ee=function(U,m){for(;U&&!U.hasOwnProperty(m);)U=o.getPrototypeOf(U);return U&&o.getOwnPropertyDescriptor(U,m)},Ae=o.getPrototypeOf?function(f,g,u){var s=Ee(g,u);s&&o.defineProperty(f,u,s)}:function(y,q,t){y[t]=q[t]},fb={1:29,2:30,3:31,4:32,5:33,6:26,7:27,8:28,9:21,10:22,11:23,12:24,13:25,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:9,22:10,23:11,24:12,25:13,26:6,27:7,28:8,29:1,30:2,31:3,32:4,33:5,34:36,35:37,36:34,37:35,38:54,39:55,40:52,41:53,42:50,43:51,44:49,50:42,51:43,52:40,53:41,54:38,55:39},eg=function(){var z={1:function(X,k){return{x:X.x-k.width/2,y:X.y-k.height/2}},2:function(O,W){return{x:O.x+W.width/2,y:O.y-W.height/2}},3:function(H,Y){return{x:H.x+H.width/2,y:H.y-Y.height/2}},4:function(i,J){return{x:i.x+i.width-J.width/2,y:i.y-J.height/2}},5:function(M,T){return{x:M.x+M.width+T.width/2,y:M.y-T.height/2}},6:function(t){return{x:t.x,y:t.y}},7:function(H){return{x:H.x+H.width/2,y:H.y}},8:function(Q){return{x:Q.x+Q.width,y:Q.y}},9:function(d,L){return{x:d.x-L.width/2,y:d.y+L.height/2}},10:function(Z,A){return{x:Z.x+A.width/2,y:Z.y+A.height/2}},11:function(N,Q){return{x:N.x+N.width/2,y:N.y+Q.height/2}},12:function(l,M){return{x:l.x-M.width/2+l.width,y:l.y+M.height/2}},13:function(Z,E){return{x:Z.x+Z.width+E.width/2,y:Z.y+E.height/2}},14:function(v,c){return{x:v.x-c.width/2,y:v.y+v.height/2}},15:function(v){return{x:v.x,y:v.y+v.height/2}},16:function(v,O){return{x:v.x+O.width/2,y:v.y+v.height/2}},17:function(p){return{x:p.x+p.width/2,y:p.y+p.height/2}},18:function(K,d){return{x:K.x+K.width-d.width/2,y:K.y+K.height/2}},19:function(V){return{x:V.x+V.width,y:V.y+V.height/2}},20:function(z,b){return{x:z.x+z.width+b.width/2,y:z.y+z.height/2}},21:function(d,b){return{x:d.x-b.width/2,y:d.y+d.height-b.height/2}},22:function($,O){return{x:$.x+O.width/2,y:$.y+$.height-O.height/2}},23:function(R,G){return{x:R.x+R.width/2,y:R.y+R.height-G.height/2}},24:function(P,l){return{x:P.x+P.width-l.width/2,y:P.y+P.height-l.height/2}},25:function(Z,g){return{x:Z.x+Z.width+g.width/2,y:Z.y+Z.height-g.height/2}},26:function(C){return{x:C.x,y:C.y+C.height}},27:function(c){return{x:c.x+c.width/2,y:c.y+c.height}},28:function(b){return{x:b.x+b.width,y:b.y+b.height}},29:function(k,M){return{x:k.x-M.width/2,y:k.y+k.height+M.height/2}},30:function(v,q){return{x:v.x+q.width/2,y:v.y+v.height+q.height/2}},31:function(S,l){return{x:S.x+S.width/2,y:S.y+S.height+l.height/2}},32:function(A,I){return{x:A.x+A.width-I.width/2,y:A.y+A.height+I.height/2}},33:function(v,o){return{x:v.x+v.width+o.width/2,y:v.y+v.height+o.height/2}},34:function(z,P){return{x:z.x,y:z.y-P.height/2}},35:function(R,d){return{x:R.x+R.width,y:R.y-d.height/2}},36:function(O,L){return{x:O.x,y:O.y+O.height+L.height/2}},37:function(K,F){return{x:K.x+K.width,y:K.y+K.height+F.height/2}},38:function(j,I){return{x:j.x+j.width/4,y:j.y-I.height/2}},39:function(p,C){return{x:p.x+3*p.width/4,y:p.y-C.height/2}},40:function(N){return{x:N.x+N.width/4,y:N.y}},41:function($){return{x:$.x+3*$.width/4,y:$.y}},42:function(E,q){return{x:E.x+E.width/4,y:E.y+q.height/2}},43:function(b,z){return{x:b.x+3*b.width/4,y:b.y+z.height/2}},44:function(D,E){return{x:D.x+D.width/2,y:D.y+D.height/2-E.height/2}},45:function(b){return{x:b.x+b.width/4,y:b.y+b.height/2}},46:function(M,E){return{x:M.x+M.width/2-E.width/2,y:M.y+M.height/2}},47:function(j,q){return{x:j.x+j.width/2+q.width/2,y:j.y+j.height/2}},48:function(Y){return{x:Y.x+3*Y.width/4,y:Y.y+Y.height/2}},49:function(Z,P){return{x:Z.x+Z.width/2,y:Z.y+Z.height/2+P.height/2}},50:function(s,b){return{x:s.x+s.width/4,y:s.y+s.height-b.height/2}},51:function(G,n){return{x:G.x+3*G.width/4,y:G.y+G.height-n.height/2}},52:function(U){return{x:U.x+U.width/4,y:U.y+U.height}},53:function(x){return{x:x.x+3*x.width/4,y:x.y+x.height}},54:function(L,H){return{x:L.x+L.width/4,y:L.y+L.height+H.height/2}},55:function(I,T){return{x:I.x+3*I.width/4,y:I.y+I.height+T.height/2}}};return Ym(k)?function(e,i,v){return z[e](i,v?v:_n)}:void 0}();Rl(b,{highlight:"#1ABC9C",label:"#000",labelSelect:"#FFF",transparent:"rgba(0,0,0,0.35)",titleBackground:"#2C3E50",titleIconBackground:"#868686",headerBackground:"#ECF0F1",headerIconBackground:"#868686",headerSeparator:"#868686",headerLine:"#D9D9D9",background:"#FFF",disabledBackground:"rgba(255,255,255,0.65)",toolTipBackground:"#FFFFE0",rectSelectBorder:"#2C3E50",rectSelectBackground:"rgba(0,0,0,0.35)",editPointBorder:"#2C3E50",editPointBackground:"#D9D9D9",dash:"#2C3E50",groupBackground:"#ECF0F1",groupTitleBackground:"#2C3E50",gridBackground:"#D9D9D9",gridCellBorderColor:"#868686",gridBlockColor:"#868686",reverse:"#868686",contentIconBackground:"#868686",contentLine:"#D9D9D9",widgetBackground:"#ECF0F1",widgetBorder:"#D9D9D9",widgetIconBackground:"#868686",widgetIconBorder:"#868686",widgetIconGradient:"#D9D9D9",widgetIconHighlight:"#43AFF1",imageBackground:"#3498DB",imageGradient:"#D9D9D9",chart:["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"]},!0);var yp=b.reverse,go=b.transparent,zg=b.rectSelectBackground,Tb=b.dash,Ai=b.titleBackground,Hg=b.titleIconBackground,Bf=b.headerBackground,Eb=b.headerIconBackground,xn=b.headerSeparator,$d=b.headerLine,Il=b.contentIconBackground,Jk=b.contentLine,Wj=(b.widgetIconHighlight,b.widgetIconBorder),wg=(b.widgetIconGradient,b.imageBackground),Of=b.imageGradient,tp=b.highlight,lj=b.label,Se=b.labelSelect;if(S&&!k.shutAlert){var xl=new Date,Uk=S.split("-"),cq=new Date(xl.getFullYear(),xl.getMonth(),xl.getDate()),S=new Date(O(Uk[0],10),O(Uk[1],10)-1,O(Uk[2],10)),kf=cq.getTime(),Qn=S.getTime(),ad=G+"_try",rr=k.alert;try{var Gq=k.localStorage;if(Gq&&rr)if(Qn>kf&&1728e6>Qn-kf){var Lh=(Qn-kf)/864e5;Gq&&Gq[ad]!=Lh&&(Gq[ad]=Lh,rr("HT for Web free trial license will expire in "+Lh+" days, please apply for a new license!"))}else kf>=Qn&&rr("Your free trial of HT for Web has expired!"),Gq&&delete Gq[ad]}catch(ni){}}var Vl={ms_ac:function(m,v){for(var q=v.ms_ac,R=0;R<q.length;R++)lc(m,q[R])},ms_listener:function(H){H.addListeners=function(){for(var b=this,p=0;p<Sm.length;p++)b["handle_"+Sm[p]]&&Sc(Sm[p],b.getView(),b)},H.removeListeners=function(){for(var W=this,U=0;U<Sm.length;U++)W["handle_"+Sm[U]]&&Hh(Sm[U],W.getView(),W)}},ms_fire:function(j){j.mp=function(c,z,s){this.addPropertyChangeListener(c,z,s)},j.ump=function(e,u){this.removePropertyChangeListener(e,u)},j.fp=function(G,r,E,h,W){return this.firePropertyChange(G,r,E,h,W)},j.addPropertyChangeListener=function($,t,S){var k=this;k._62I||(k._62I=new ve),k._62I.add($,t,S)},j.removePropertyChangeListener=function(S,L){this._62I&&this._62I.remove(S,L)},j.firePropertyChange=function(F,C,j,X,h){if(X){if(X(C,j))return!1}else if(C===j)return!1;var q=this,N=h||{};return N.property=F,N.oldValue=C,N.newValue=j,N.source=q,N.data=q,q._62I&&q._62I.fire(N),q.onPropertyChanged&&q.onPropertyChanged(N),!0}},ms_attr:function(j){j.a=function(k,c){var u=this;if(2===arguments.length)u.setAttr(k,c);else{if(!Tf(k))return u.getAttr(k);for(var s in k)u.setAttr(s,k[s])}return u},j.getAttr=function(d,g){if(g===p&&(g=1),this._attrObject&&d in this._attrObject)return this._attrObject[d];if(this.getImage){var B=this.getImage();if(Td(B)&&(B=Af[B]),Tf(B)&&"dataBindings"in B)for(var t=B.dataBindings,U=t.length-1;U>=0;U--){var Y=t[U];if(Y.attr===d){if("defaultValue"in Y)return Y.defaultValue;break}}}return g?N[d]:p},j.setAttr=function(H,g){var e=this;e._attrObject||(e._attrObject={});var Q=e._attrObject[H];g===p?delete e._attrObject[H]:e._attrObject[H]=g,e.fp&&e.fp("a:"+H,Q,g)&&e.onAttrChanged&&e.onAttrChanged(H,Q,g)},j.getSerializableAttrs=function(){var F,q={};for(F in this._attrObject)q[F]=1;return q}},ms_bnb:function(S){S.getBodyColor=function(L){return L.s("body.color")},S.getBorderColor=function(J){return J.s("border.color")}},_51o:function(B){B.mi=function(h,Y,B){this.addInteractorListener(h,Y,B)},B.umi=function(Y,k){this.removeInteractorListener(Y,k)},B.fi=function(K){this.fireInteractorEvent(K)},B.addInteractorListener=function(D,r,l){var K=this;K._63I||(K._63I=new ve),K._63I.add(D,r,l)},B.removeInteractorListener=function(T,r){this._63I.remove(T,r)},B.fireInteractorEvent=function(X){this._63I&&this._63I.fire(X)},B.setInteractors=function(h){var I=this,Z=I._interactors;Z&&Z.each(function(Q){Q.tearDown()}),Lq(h)&&(h=new ep(h)),I._interactors=h,h&&h.each(function(I){I.setUp()}),I.fp("interactors",Z,h),I.invalidateSelection()},B.getInteractors=function(){return this._interactors}},_49o:function(M){M._44O=T,M._45O=T,M.getTopPainters=function(){return this._44O},M.getBottomPainters=function(){return this._45O},M.addTopPainter=function(N){var v=this;v._44O||(v._44O=new ep),v._44O.contains(N)||(v._44O.add(N),v.redraw&&v.redraw())},M.removeTopPainter=function($){var F=this;F._44O&&(F._44O.remove($),F.redraw&&F.redraw())},M.addBottomPainter=function(u){var Y=this;Y._45O||(Y._45O=new ep),Y._45O.contains(u)||(Y._45O.add(u),Y.redraw&&Y.redraw())},M.removeBottomPainter=function(G){var e=this;e._45O&&(e._45O.remove(G),e.redraw&&e.redraw())},M._93db=function(n,L){var N=this;N._45O&&N._45O.each(function(c){c.draw?c.draw(n,L):c.call(N,n,L)})},M._92db=function(T,r){var G=this;G._44O&&G._44O.each(function(t){t.draw?t.draw(T,r):t.call(G,T,r)})}},ms_sm:function(o){o.sm=function(){return this.getSelectionModel()},o.setSelectableFunc=function(v){this.sm().setFilterFunc(v)},o.getSelectableFunc=function(){return this.sm().getFilterFunc()},o.getSelectionModel=function(){var v=this;return v._selectionModel?v._selectionModel:v.dm().sm()},o.isSelectionModelShared=function(){return!this._selectionModel},o.setSelectionModelShared=function(h){var O=this,y=!O._selectionModel,I=O.handleSelectionChange,j=O.dm();y!==h&&(O.invalidateSelection&&O.invalidateSelection(),h?(j.sm().ms(I,O),O._selectionModel.ums(I,O),O._selectionModel.dispose(),O._selectionModel=T):(j.sm().ums(I,O),O._selectionModel=new Wc(j),O._selectionModel.ms(I,O)),O.onSelectionModelSharedChanged(),O.fp("selectionModelShared",y,h))},o.onSelectionModelSharedChanged=function(){var j=this;j.redraw(),j.invalidateSelection&&j.invalidateSelection()},o.removeSelection=function(){var i=this.dm();i.beginTransaction(),this.sm().toSelection().each(i.remove,i),i.endTransaction()},o.selectAll=function(){var P=this;P.sm().ss(P.dm().toDatas(function(W){return P.isVisible(W)&&P.isSelectable(W)}))},o.isSelected=function(z){return this.sm().co(z)},o.isSelectedById=function(G){var V=this.dm().getDataById(G);return V?this.isSelected(V):!1},o.isSelectable=function(y){return this.sm().isSelectable(y)}},ms_tx:function(D){D._64I=0,D._65O=0,D.isScrollable=function(){return this.getWidth()<this._64I},D._40o=function(){return this.isScrollable()},D.getLogicalPoint=function(V){return ag(V,this._canvas||this._view,this.tx(),this.ty?this.ty():0)},D.tx=function(S){return S===p?this.getTranslateX():(this.setTranslateX(S),void 0)},D.getTranslateX=function(){return this._65O},D.setTranslateX=function(I){var s=this,R=s.getWidth()-s._64I;R>I&&(I=R),I>0&&(I=0),I=_(I);var V=s._65O;s._65O=I,s.fp(Fp,V,I)}},ms_ty:function(s){s._23Q=0,s._66O=0,s._41o=function(){return this.getHeight()<this._23Q},s.getLogicalPoint=function(j){return ag(j,this._canvas||this._view,this.tx?this.tx():0,this.ty())},s.ty=function(f){return f===p?this.getTranslateY():(this.setTranslateY(f),void 0)},s.getTranslateY=function(){return this._66O},s.setTranslateY=function(O){var E=this,d=E.getHeight()-E._23Q;d>O&&(O=d),O>0&&(O=0),O=_(O);var D=E._66O;E._66O=O,E.fp(Qi,D,O)}},ms_txy:function(Z){Z._65O=0,Z._66O=0,Z.tx=function(j){return j===p?this.getTranslateX():(this.setTranslateX(j),void 0)},Z.ty=function(Z){return Z===p?this.getTranslateY():(this.setTranslateY(Z),void 0)},Z.onTranslateEnded=function(){},Z.setTranslate=function(C,p,U){var O=this;if(U=$m(U)){O._65I&&O._65I.stop(!0);var K=O.tx(),h=O.ty();U.action=function(R){O.setTranslate(K+(C-K)*R,h+(p-h)*R)},U._37o=function(){delete O._66I,delete O._65I,O.onTranslateEnded()},O._66I=1,O._65I=Rm(U)}else O.tx(C),O.ty(p)},Z.getTranslateX=function(){return this._65O},Z.setTranslateX=function(h){var E=this;h=E.adjustTranslateX(h);var F=E._65O;E._65O=h,E.fp(Fp,F,h)},Z.getTranslateY=function(){return this._66O},Z.setTranslateY=function(L){var D=this;L=D.adjustTranslateY(L);var P=D._66O;D._66O=L,D.fp(Qi,P,L)},Z.adjustTranslateX=function(t){return _(t)},Z.adjustTranslateY=function(q){return _(q)},Z.translate=function(X,k,L){this.setTranslate(this.tx()+X,this.ty()+k,L)},Z.getLogicalPoint=function(D){var x=this;return ag(D,this._canvas||x._view,x.tx(),x.ty())}},ms_dm:function(I){I.dm=function(I){return I?(this.setDataModel(I),void 0):this.getDataModel()},I.getDataModel=function(){return this._dataModel}},ms_lp:function(X){X.lp=function(Y){return this.getLogicalPoint(Y)}},ms_v:function(Y){Y._disabled=!1,Y.setDisabled=function(j,H){var i=this,d=i._disabled;d!==j&&(d&&(ss(i._63O),delete i._63O),j&&(Pb(i._view,i._63O=Pk(H)),i.iv()),i._disabled=j,i.fp("disabled",d,j))},Y.isDisabled=function(){return this._disabled},Y.getDisabledDiv=function(){return this._63O},Y.getView=function(){return this._view},Y.addToDOM=function(){var U=this,l=U.getView(),p=l.style;M.body.appendChild(l),p.left="0",p.right="0",p.top="0",p.bottom="0",k.addEventListener("resize",function(){U.iv()},!1),U.iv()},Y.getWidth=function(){return this._view.clientWidth},Y.getHeight=function(){return this._view.clientHeight},Y.setWidth=function(L){var C=this;C._view.style.width=L+Gj,C.iv(),C.fp&&C.fp(Pn,T,L)},Y.setHeight=function(J){var x=this;x._view.style.height=J+Gj,x.iv(),x.fp&&x.fp(Zf,T,J)},Y.setFocus=function(v){var Q=this,g=Q._currentEditor;return v&&g&&(g.getView&&(g=g.getView()),g.contains(v.target))?!1:(Gf(Q._view),Q.endEditing&&Q.endEditing(),Q.fireViewEvent("focus"),!0)},Y.iv=function(X){this.invalidate(X)},Y.invalidate=function(f){var A=this;A._68I||(A._68I=1,gc(A.validate,A,T,f),A.onInvalidated&&A.onInvalidated(),A.fireViewEvent("invalidate"))},Y.validate=function(){var B=this,C=B._view;if(B._68I&&(delete B._68I,C.parentNode))if(0===C.offsetWidth&&0===C.offsetHeight&&B._67I!==T)B._67I===p&&(B._67I=j.reinvalidateCount),B._67I>0?B._67I--:B._67I=T,B.iv();else{B.fireViewEvent("beginValidate"),B.validateImpl(),B.onValidated&&B.onValidated(),B.fireViewEvent("validate");var u=B._63O;u&&(C.lastChild!==u&&(ss(u),Pb(C,u)),yj(u,0,0,B.getWidth(),B.getHeight())),Ge(B),ej(B),Fq(B)}},Y.layout=function(y,g,p,A){1===arguments.length?yj(this,y):yj(this,y,g,p,A)},Y.addViewListener=function(Q,u,V){var K=this;K._67O||(K._67O=new ve),K._67O.add(Q,u,V)},Y.removeViewListener=function(j,d){this._67O.remove(j,d)},Y.fireViewEvent=function(k){var i=this;i._67O&&(Td(k)&&(k={kind:k}),i._67O.fire(k)),j.viewListener&&j.viewListener(i,k)}},ms_tip:function(G){G.setToolTipEnabled=function(T){var G=this;T?Rp||G._13o||(G.enableToolTip(),G.fp("toolTipEnabled",!1,!0)):G._13o&&(G.disableToolTip(),G.fp("toolTipEnabled",!0,!1))},G.isToolTipEnabled=function(){return!!this._13o},G.enableToolTip=function(){var X=this;Rp||X._13o||(X._13o=function(x){var Y=X.getToolTip(x);Y!=T?j.toolTipContinual&&j.isToolTipShowing()?xj(x,Y):(Tp(),Yc={timeout:e(Mn,Sg),e:x,info:Y}):Tp()},X.getView().addEventListener(sp,X._13o,!1),X.getView().addEventListener("mouseleave",j.hideToolTip,!1))},G.disableToolTip=function(){var u=this;u._13o&&(u.getView().removeEventListener(sp,u._13o,!1),u.getView().removeEventListener("mouseleave",j.hideToolTip,!1),delete u._13o)},G.getToolTip=function(p){var s=this;if(s.getDataAt){var I=s.getDataAt(p);return I?I.getToolTip():T}return s.getValue?s.getValue():void 0}},_52o:function(b){b._zoom=1,b._29I=_n,b.zoomIn=function(Z,n){this.setZoom(this._zoom*gd,Z,n)},b.zoomOut=function(t,V){this.setZoom(this._zoom/gd,t,V)},b.zoomReset=function(R,k){this.setZoom(1,R,k)},b.scrollZoomIn=function(Y){this.setZoom(this._zoom*Bq,T,Y)},b.scrollZoomOut=function(o){this.setZoom(this._zoom/Bq,T,o)},b.pinchZoomIn=function(I){this.setZoom(this._zoom*Cn,T,I)},b.pinchZoomOut=function(c){this.setZoom(this._zoom/Cn,T,c)},b.adjustZoom=function(o){return fp>o?fp:o>wb?wb:o},b.getZoom=function(){return this._zoom},b.setZoom=function(L,d,G){var b=this;if(d=$m(d)){b._14o&&b._14o.stop(!0);var u=b._zoom;d.action=function(o){b._96O(u+(L-u)*o,G)},d._37o=function(){delete b._zooming,delete b._14o,b.onZoomEnded()},b._zooming=1,b._14o=Rm(d)}else b._96O(L,G)},b._96O=function(E,j){var u=this;if(E=u.adjustZoom(E),E!==u._zoom){u.validate();var d=u._29I,Q=u._zoom;0!==d.width&&0!==d.height&&(j=j?j:{x:d.x+d.width/2,y:d.y+d.height/2},u.tx((j.x-d.x)*Q-j.x*E),u.ty((j.y-d.y)*Q-j.y*E)),u._zoom=E,u.fp("zoom",Q,E)}}}};Rl(j,{numberDigits:5,baseZIndex:p,isTouchable:Rp,devicePixelRatio:k.devicePixelRatio?k.devicePixelRatio:1,reinvalidateCount:3,hitMaxArea:3e3,imageCacheThreshold:20,autoMakeVisible:!0,autoHideScrollBar:!0,disabledOpacity:.4,disabledBackground:b.disabledBackground,forceHierarchicalSerialization:!0,hoverDelay:600,toolTipDelay:800,toolTipContinual:!1,getDragger:function(){return Zk},lineCap:"butt",lineJoin:"round",imageGradient:"linear.northeast",dashPattern:[16,16],animDuration:200,animEasing:function(w){return w*w},labelColor:lj,labelSelectColor:Se,labelFont:(Rp?"15":"12")+"px arial, sans-serif",widgetIndent:Rp?30:20,widgetRowHeight:Rp?30:20,widgetHeaderHeight:Rp?32:22,widgetTitleHeight:Rp?34:24,scrollBarColor:go,scrollBarSize:7,scrollBarTimeout:1e3,scrollBarMinLength:20,scrollBarInteractiveSize:Rp?32:16,zoomIncrement:1.3,scrollZoomIncrement:1.05,pinchZoomIncrement:1.08,zoomMax:20,zoomMin:.01,segmentResolution:12,shapeResolution:24,shapeSide:24,intersectionLineRect:nl,intersectionLineLine:hq,isEnter:Cd,isEsc:Rd,isDelete:vc,isSpace:ir,isLeft:Ip,isUp:ig,isRight:Xk,isDown:We,getTarget:Hk,isString:Td,isNumber:wi,isBoolean:uc,isArray:Lq,isSelectAll:mq,isFunction:zj,isObject:Tf,getPropertyValue:Rn,setPropertyValue:pm,addMethod:Rl,getVersion:function(){return"6.2.1"},appendToScreen:function(Y){Y=Y.getView?Y.getView():Y,(M.fullscreenElement||M.mozFullScreenElement||M.webkitFullscreenElement||M.msFullscreenElement||M.body).appendChild(Y)},toggleFullscreen:function(l){var u=l.getView();if(M.fullscreenElement||M.mozFullScreenElement||M.webkitFullscreenElement||M.msFullscreenElement)M.exitFullscreen?M.exitFullscreen():M.msExitFullscreen?M.msExitFullscreen():M.mozCancelFullScreen?M.mozCancelFullScreen():M.webkitExitFullscreen&&M.webkitExitFullscreen();else{var F=!0;if(l.isSelfViewEvent){var e=l.getX(),O=l.getY(),U=l.getWidth(),C=l.getHeight(),h=u.style.background;h||(u.style.background="white"),u.requestFullscreen?u.requestFullscreen():u.msRequestFullscreen?u.msRequestFullscreen():u.mozRequestFullScreen?u.mozRequestFullScreen():u.webkitRequestFullscreen&&u.webkitRequestFullscreen();var R=setInterval(function(){if(u!==(M.fullscreenElement||M.mozFullScreenElement||M.webkitFullscreenElement||M.msFullscreenElement))clearInterval(R),l.setX(e),l.setY(O),l.setWidth(U),l.setHeight(C),l._fullscreen=!1,u.style.background=h,l.iv();else{var i=X.Default.getWindowInfo();(F||i.width!==l.getWidth()||i.height!==l.getHeight())&&(l.setX(i.left),l.setY(i.top),l.setWidth(i.width),l.setHeight(i.height),l._fullscreen=!0,l.iv(),F=!1)}},500)}else{var t=u.style.left,Y=u.style.top,U=u.style.width,C=u.style.height,h=u.style.background;h||(u.style.background="white"),u.requestFullscreen?u.requestFullscreen():u.msRequestFullscreen?u.msRequestFullscreen():u.mozRequestFullScreen?u.mozRequestFullScreen():u.webkitRequestFullscreen&&u.webkitRequestFullscreen();var R=setInterval(function(){if(u!==(M.fullscreenElement||M.mozFullScreenElement||M.webkitFullscreenElement||M.msFullscreenElement))clearInterval(R),u.style.left=t,u.style.top=Y,u.style.width=U,u.style.height=C,u.style.background=h,l.iv();else{var d=X.Default.getWindowInfo();(F||d.width!==l.getWidth()||d.height!==l.getHeight())&&(yj(l),F=!1)}},500)}}},appendTimeStamp:function(O){return O},setCompType:function(F,U){zj(U)||Tf(U)?jh[F]=U:Or(F)},getCompType:function(h){var P=jh[h];return P===p&&Ih.test(h)&&Or(h),P},getCompTypeMap:function(){return jh},drawCompType:function(r,z,q,t,O,D){r(z,q,t,O,D)},numberListener:function(){var c={46:1,8:1,9:1,27:1,13:1,109:1,110:1,189:1,190:1};return function(H){var V=H.keyCode;c[V]||65===V&&j.isCtrlDown(H)||86===V&&j.isCtrlDown(H)||67===V&&j.isCtrlDown(H)||88===V&&j.isCtrlDown(H)||V>=35&&40>=V||(H.shiftKey||48>V||V>57)&&(96>V||V>105)&&H.preventDefault()}}(),ignoreKeyCodes:[122,123],preventDefault:function(y){var v=y.target.tagName;("DIV"===v||"CANVAS"===v)&&!(j.ignoreKeyCodes.indexOf(y.keyCode)>=0)&&("keydown"!==y.type||Ip(y)||Xk(y)||ig(y)||We(y)||vc(y)||65===y.keyCode&&(y.metaKey||y.ctrlKey))&&(y.preventDefault(),y.preventManipulation&&y.preventManipulation())},getWindowInfo:function(){var Z=M.documentElement,s=Z&&(Z.scrollLeft||Z.scrollTop)?Z:M.body;return{target:s,left:s.scrollLeft,top:s.scrollTop,width:k.innerWidth||s.clientWidth,height:k.innerHeight||s.clientHeight}},isDragging:function(){return!!Zk},isLeftButton:function(W){return Rp?!0:0===W.button},isInput:function(R){if(!R)return!1;var p=R.tagName;return"INPUT"===p||"TEXTAREA"===p||"SELECT"===p},getTouchCount:function(G){return Rp?G.touches.length:1},isDoubleClick:function(){function y(j){j.details=0,j.timeout=null,j.lastPoint=null}var U={};return Ue=new R,Cc=Ue.getTime(),function(s){var g=s.button==T?"":s.button,v=s.type+g,V=v+"_isDoubleClick",l=U[v];if(l||(l=U[v]={details:0,timeout:null,lastPoint:null}),s[V]===p){s[V]=!0;var Z=yq(s);l.timeout&&(K(l.timeout),l.timeout=null),l.lastPoint&&de(l.lastPoint,Z)>(Rp?20:1)&&y(l),l.lastPoint=Z,l.details++,l.timeout=e(function(){y(this)}.bind(l),500)}return 2===l.details}}(),isShiftDown:function(r){return r?r.shiftKey:Qm["16"]},isCtrlDown:function(E){return E?$?E.metaKey:E.ctrlKey:$?Qm["91"]:Qm["17"]},getClientPoint:function(m){return Rp&&(m=Mi(m)),{x:m.clientX,y:m.clientY}},isMouseEvent:function(b){return b instanceof MouseEvent||0===b.type.indexOf("mouse")},getTargetElement:function(I){if(j.isMouseEvent(I)||!M.elementFromPoint)return I.target;var s=wf(I);return M.elementFromPoint(s.x,s.y)},getPagePoint:function(D){return Rp&&(D=Mi(D)),{x:D.pageX,y:D.pageY}},createObject:function(t,J){var I=new t;for(var c in J)if(0===c.indexOf("s:"))I.s(c.substr(2),J[c]);else if(0===c.indexOf("a:"))I.a(c.substr(2),J[c]);else{var b=Lc(c),P=J[c];I[b]?(I[b](P),"setToolTip"===b&&I.enableToolTip&&I.enableToolTip()):I[c]=P}return I},setImage:function(Q,y,d,M){var f=arguments.length;4===f?Gl(Q,M,y,d):2===f?Td(y)?Gl(Q,y):Af[Q]=y:1===f&&Gl(Q,Q)},getImage:function(S,q,A){var h;if(S==T)return T;if(Tf(S)?h=S:(h=Af[S],S&&h===p&&(Sr&&Sr[S]||Gl(S,S))),q&&h&&h.tagName){var _;_="override"===A?"colors_override":"override_rgb"===A?"colors_override_rgb":"override_a"===A?"colors_override_a":"colors",h[_]||(h[_]={__count__:0});var L=h[_][q];return L||(h[_].__count__>j.imageCacheThreshold&&(h[_]={__count__:0}),L=Qb(h,ql(q),h.width,h.height,A),h[_][q]=L,h[_].__count__++),L}return h},isImageComplete:function(C,m,N){var F=Tf(C)?C:Af[C];if(!F)return!1;if(F.tagName)return F.complete;for(var T,C,D,H=F.comps,I=!0,z=0,O=H.length;O>z;z++)if(T=H[z],D=T.type,"image"===T.type){C=T.name,C&&C.func&&(C=Aq(C,m));var c=Do(C,m,N);if(!c){I=!1;break}}else if(Ih.test(D)&&j.getCompType(D)===p){I=!1;break}return I},getId:function(){var K=1;return function(){return++K}}(),callLater:function(M,N,b,U){var r=function(){M.apply(N,b)};return U?e(r,U):k.requestAnimationFrame(r)},clone:function(C){if(null==C||"object"!=typeof C)return C;if(C instanceof Date){var d=new Date;return d.setTime(C.getTime()),d}if(C instanceof Array){for(var d=[],k=0,z=C.length;z>k;k++)d[k]=tq(C[k]);return d}if(C instanceof ep){for(var d=new ep,k=0,z=C.length;z>k;k++)d.set(k,tq(C.get(k)));return d}if(C instanceof Vk)return C;if(C instanceof o){var d={};for(var G in C)C.hasOwnProperty(G)&&(d[G]=tq(C[G]));return d}return C},callWhenLoaded:function(P,I){I=I||100;var Y=fg(P,I);Kj||(Kj={}),Kj[Y]={tick:Y,cb:P,delay:I}},beforeLoadURL:function(s){if(Kj){var R={};for(var k in Kj){var e=Kj[k];K(e.tick);var F=fg(e.cb,e.delay);R[F]={tick:F,delay:e.delay,cb:e.cb}}Kj=R}return j.convertURL?j.convertURL(s):s},convertURL:function(K){return K},handleRefGraphLoaded:function(){},handleCompTypeLoaded:function(){},handleImageLoaded:function(){},handleUnfoundImage:function(){},sortFunc:function(j,V){if(j===V)return 0;if(j==T&&V!=T)return 1;if(j!=T&&V==T)return-1;if(j==T&&V==T)return 0;var e,o=typeof j,B=typeof V;return o===Rk&&B===Rk?e=j.localeCompare(V):o===Ak&&B===Ak&&(e=j-V),e===p&&(e=(""+j).localeCompare(""+V)),e>0?1:0>e?-1:0},getClassMap:function(){return Ti},getClass:function(y){if(Td(y)){var G,S=Ti[y];if(!S){G=y.split("."),S=k;for(var A=0;A<G.length;A++)S=S[G[A]];Ti[y]=S}return S}return y},def:function(_,M,k){var m,B,C,n=function(){};if(n.prototype=M.prototype,m=new n,Td(_)){if(Ti[_])throw"'"+_+"' already defined";C=nb(_),m.getClassName=function(){return _}}else C=_;if(m.constructor=C,m.getClass=function(){return C},m.getSuperClass=function(){return M},k)for(B in k)Vl[B]&&Vl.hasOwnProperty(B)?Vl[B](m,k):Ae(m,k,B);C.prototype=m,C.superClass=M.prototype},startAnim:function(){var A=function(l){l.duration&&(l.startTime=hk()),l.timeId=gc(l.tick,T,T,l.interval)};return function(I){return I=tq(I),I.easing=I.easing||j.animEasing,I.duration||I.frames||(I.duration=j.animDuration),I.t=0,I.duration?I.interval=0:(I.frame=0,I.interval=I.interval||10),I.tick=function(){if(I.duration){var b=(hk()-I.startTime)/I.duration;b>1&&(b=1),I.t=b,I.action(I.easing(b),b),1===b?I.stop():I._isPaused||(I.timeId=gc(I.tick))}else I.frame++,b=I.t=I.frame/I.frames,I.action(I.easing(b),b),I.frame<I.frames?I._isPaused||(I.timeId=gc(I.tick,T,T,I.interval)):I.stop()},I.resume=function(){I._isPaused&&(delete I._isPaused,I.duration?I.t<1&&(I.startTime=hk()-I.duration*I.t,I.timeId=gc(I.tick)):I.frame<I.frames&&(I.timeId=gc(I.tick,T,T,I.interval)))},I.pause=function(){I._isPaused=!0},I.stop=function(L){I.isRunning()&&(I.duration?I.t<1&&L&&(I.t=1,I.action(I.easing(1),1)):I.frame<I.frames&&L&&(I.frame=I.frames,I.action(I.easing(1),1)),I._37o&&I._37o(),I.finishFunc&&I.finishFunc(),Zi(I.timeId,!I.duration),delete I.timeId)},I.isRunning=function(){return I.timeId!=T},I.delay?gc(A,T,[I],I.delay):A(I),I}}(),getTextSize:function(){var U={},q=M?im().getContext("2d"):T;return function(e,t){q.font=e?e:Bk;var c=U[q.font];return c||(c=2*q.measureText("e").width+4,U[q.font]=c),{width:q.measureText(t).width+4,height:c}}}(),drawText:function(O,g,U,K,S,G,p,x,c,A){if(g!=T){var s=Ql(U,g),t={};t.y=A&&A!==Gd?A===ob?G+s.height/2:G+x-s.height/2:G+x/2,t.x=c&&c!==ud?c===Ij?S+p-s.width/2:S+p/2:S+s.width/2,Vi(O,g,t,U,K)}},getDistance:function(e,j){var G=e.length;return j?3===G?v(U(e[0]-j[0])+U(e[1]-j[1])+U(e[2]-j[2])):2===G?v(U(e[0]-j[0])+U(e[1]-j[1])):e.z===p?v(U(j.x-e.x)+U(j.y-e.y)):v(U(j.x-e.x)+U(j.y-e.y)+U(j.z-e.z)):3===G?v(U(e[0])+U(e[1])+U(e[2])):2===G?v(U(e[0])+U(e[1])):void 0},brighter:function(s,w){return 0>w&&(w=-w),Uf(s,w?w:40)},darker:function(Y,u){return u>0&&(u=-u),Uf(Y,u?u:-40)},unionPoint:function(F,Z){if(!F)return T;if(2===arguments.length)return F&&Z?{x:d(F.x,Z.x),y:d(F.y,Z.y),width:J(F.x-Z.x),height:J(F.y-Z.y)}:T;var R=F;if(R._as&&(R=R._as),R.length===p)return T;var H=R.length;if(0>=H)return T;for(var O=1,G=R[0],v={x:G.x,y:G.y,width:0,height:0};H>O;O++){G=R[O];var D=d(v.x,G.x),W=x(v.x+v.width,G.x),q=d(v.y,G.y),e=x(v.y+v.height,G.y);v.x=D,v.y=q,v.width=W-D,v.height=e-q}return v},unionRect:function(Z,E){if(Z&&!E)return tq(Z);if(!Z&&E)return tq(E);if(Z&&E){var O={x:d(Z.x,E.x),y:d(Z.y,E.y)};return O.width=x(Z.x+Z.width,E.x+E.width)-O.x,O.height=x(Z.y+Z.height,E.y+E.height)-O.y,O}return T},containsPoint:function(I,x,G,e){if(e!=T&&1!==e){var R=I.x+I.width/2,Z=I.y+I.height/2;I={x:R-I.width/2*e,y:Z-I.height/2*e,width:I.width*e,height:I.height*e}}if(G){var j=I.width/2,g=I.height/2,n=L(-G),S=A(-G),V=x.x-I.x-j,w=x.y-I.y-g;return x={x:S*V-n*w,y:n*V+S*w},Co({x:-j,y:-g,width:I.width,height:I.height},x)}return!(!I||x.x<I.x||x.y<I.y||x.x>I.x+I.width||x.y>I.y+I.height)},containsRect:function(g,B){if(!g||!B)return!1;var U=B.x,j=B.y,c=B.width,E=B.height,k=g.width,z=g.height;if(0>(k|z|c|E))return!1;var Y=g.x,i=g.y;if(Y>U||i>j)return!1;if(k+=Y,c+=U,U>=c){if(k>=Y||c>k)return!1}else if(k>=Y&&c>k)return!1;if(z+=i,E+=j,j>=E){if(z>=i||E>z)return!1}else if(z>=i&&E>z)return!1;return!0},intersectsRect:function(b,d){if(!b||!d)return!1;var D=d.width,X=d.height,H=b.width,F=b.height;if(0>=H||0>=F||0>=D||0>=X)return!1;var N=d.x,K=d.y,g=b.x,c=b.y;return H+=g,F+=c,D+=N,X+=K,H>N&&F>K&&D>g&&X>c},intersection:function(j,A){if(!j||!A)return T;var W=A.x,f=A.y,N=j.x,K=j.y,S=W,o=f,r=N,t=K;return S+=A.width,o+=A.height,r+=j.width,t+=j.height,N>W&&(W=N),K>f&&(f=K),S>r&&(S=r),o>t&&(o=t),S-=W,o-=f,0>=S||0>=o?T:{x:W,y:f,width:S,height:o}},grow:function(R,o,Q){Q===p&&(Q=o),R.x-=o,R.y-=Q,R.width=R.width+2*o,R.height=R.height+2*Q},getLogicalPoint:function(s,g,h,c,M,U){var O,B,j=g.getBoundingClientRect();return s.target?(Jf(s)?$?Qm["91"]=!0:Qm["17"]=!0:$?Qm["91"]=!1:Qm["17"]=!1,Qm["16"]=wc(s)?!0:!1,s=Rp?Mi(s):s,O=s.clientX,B=s.clientY):(O=s.x,B=s.y),{x:(O-j.left+g.scrollLeft-(h||0))/(M||1),y:(B-j.top+g.scrollTop-(c||0))/(U||1)}},removeHTML:function(){var C;return function(B){return B&&B.parentNode?C===B?!0:(C=B,B.parentNode.removeChild(B),C=T,!0):!1}}(),getToolTipDiv:function(){if(!Lo){Lo=rs(),qq=rs();var Q=Lo.style;j.baseZIndex!=T&&(Q.zIndex=O(j.baseZIndex)+3+""),Q.whiteSpace="nowrap",Q.color=j.toolTipLabelColor,Q.background=j.toolTipBackground,Q.font=j.toolTipLabelFont,Q.padding="5px",Q.boxShadow="0px 0px 3px "+j.toolTipShadowColor}return Lo},isToolTipShowing:function(){return Lo&&Lo.parentNode?!0:qq&&qq.parentNode?!0:!1},hideToolTip:function(){ss(Lo),ss(qq),ar()},showToolTip:function(y,E){if(!y||E==T)return Tp(),void 0;j.getToolTipDiv();var Z,v;if(E.html?(E=E.html,Z=qq,ss(Lo)):(Z=Lo,ss(qq)),v=Z.style,Z.innerHTML=E,Z.parentNode||X.Default.appendToScreen(Z),y.target){y=wf(y);var t=Ro(),C=y.x,p=y.y,S=Rp?60:12;if(Rp){var A=Z.getBoundingClientRect();v.left=C-A.width/2+Gj,v.top=p-A.height-S<t.top?p+S+Gj:p-A.height-S+Gj}else{v.left=C+S+Gj,v.top=p+S+Gj;var A=Z.getBoundingClientRect();A.left+A.width>t.width&&(v.left=C-S-A.width+Gj),A.top+A.height>t.height&&(v.top=p-S-A.height+Gj),A.left<0&&(v.left=C+S+Gj),A.top<0&&(v.top=p+S+Gj)}}else v.left=y.x+Gj,v.top=y.y+Gj;ar()},startDragging:function(U,b){U!==Zk&&(Zk?Rp?Zk.handleWindowTouchEnd(b):Zk.handleWindowMouseUp(b):Rp?(k.addEventListener($l,Xm,!1),k.addEventListener(Hc,bd,!1)):(k.addEventListener(sp,dp,!1),k.addEventListener(mi,rp,!1)),Zk=U)},getImageMap:function(){return Af},toBoundaries:function(T,Q,d,y){var m=[];return dl(T,Q,d,y).forEach(function(n){var i=[];n.forEach(function(W){i.push(W.x,W.y)}),m.push(i)}),m},getCurrentKeyCodeMap:function(){return Qm},drawCenterImage:function(i,S,L,P,r,s,Q,u){var Z=mc(S,r,s),T=lh(S,r,s);$f(i,S,_(L-Z/2),_(P-T/2),Z,T,r,s,Q,u)},drawStretchImage:function(N,S,y,Q,R,b,G,o,D,W,r,m){var P,A=mc(S,o,D,b),U=lh(S,o,D,G);"uniform"===y?(P=d(b/A,G/U),A*=P,U*=P,Q+=_((b-A)/2),R+=_((G-U)/2),b=A,G=U):"centerUniform"===y&&((A>b||U>G)&&(P=d(b/A,G/U),A*=P,U*=P),Q+=_((b-A)/2),R+=_((G-U)/2),b=A,G=U);
var $=N.interactiveInfo;if($){var L;L="center"===y?{x:Q+b/2-A/2,y:R+G/2-U/2,width:A,height:U}:{x:Q,y:R,width:b,height:G},$.rect?($.compInfos[$.compInfos.length-1].rect=L,L.image=S):$.rect=L}if("center"===y){var p=r!==!1&&(A>b||U>G);p&&(N.save(),N.beginPath(),N.rect(Q,R,b,G),N.clip()),$f(N,S,Q+b/2-A/2,R+G/2-U/2,A,U,o,D,W,m),p&&N.restore()}else $f(N,S,Q,R,b,G,o,D,W,m)},toCanvas:function(M,I,g,$,O,Z,c,_,u){M=dq(M,c),I=I||mc(M,O),g=g||lh(M,O);var s=im(),U=nd(s);return _?(Df(s,I,g,_),U.scale(_,_)):Df(s,I,g,1),hh(U,M,$,0,0,I,g,O,Z,c,u),M&&M.clampToEdge&&(s.clampToEdge=M.clampToEdge),U.restore(),s},createGradientImage:function(i,b,j,f){for(var J=["L",0,0,i,0,1,0,0,1,0,0],M=0,z=Math.min(b.length,j.length);z>M;M++)J.push(j[M],b[M]);var T=X.Default.toCanvas({width:i,height:i,clampToEdge:!0,comps:[{type:"shape",rotation:f||0,points:[0,0,i,0,i,i,0,i],background:"#ffffff",gradientPack:J}]});return T},createElement:function(c,w,m,C){var v=M.createElement(c);return tl(v,w||b.widgetBorder,2),v.style.font=m?m:Bk,C!=T&&(v.value=C),j.onElementCreated&&j.onElementCreated(v),v},containedInView:function(X,$){var R=Vb($).getBoundingClientRect();return Co({x:R.left,y:R.top,width:R.width,height:R.height},yq(X))},isIsolating:function(){return qh>0},setIsolating:function(K){K?qh++:qh--},getMSMap:function(){return Vl},stringify:function(w,R){var y=Date.prototype.toJSON;Date.prototype.toJSON=function(){return"__ht__date"+this.getTime()};var d=JSON.stringify(w,function(c,j){return"function"==typeof j?"__ht__"+(j.__ht__||j.toString()):wi(j)?Ok(j):j},R==T?2:R);return Date.prototype.toJSON=y,d},parse:function(N){return Td(N)?JSON.parse(N,function(r,n){if(Td(n)){if("__ht__function"==n.substr(0,14)){var b=n.indexOf("{")+1,o=n.lastIndexOf("}"),M=n.indexOf("(")+1,t=n.indexOf(")");if(b&&o&&M&&t){var Z=new Function(n.substring(M,t),n.substring(b,o));return Z.__ht__=n.substr(6),Z}}if("__ht__date"==n.substr(0,10))return new Date(O(n.substr(10)))}return n}):N},loadJS:function(I,o){o&&I.push(o);var A=I.shift();if(Lq(A))I=A.contact(I),j.loadJS(I);else if(zj(A))A(),j.loadJS(I);else if(Td(A)){var e=M.createElement("script");e.onload=function(){j.loadJS(I)},e.setAttribute("src",A),M.getElementsByTagName("head")[0].appendChild(e)}else I.length&&j.loadJS(I)},toRoundedCorner:function(n,w){var O=n.size();if(0>=w)return{points:n};var F,f=new ep,x=new ep,$=n.get(0);f.add($),x.add(1);for(var t=1;O>t;t++)if(O>t+1){var m=n.get(t),W=n.get(t+1),q=$.x,D=$.y,Z=m.x,b=m.y,B=b-D,o=Z-q,H=g(B,o);F=d(.99*de($,m),w),f.add({x:Z-F*A(H),y:b-F*L(H)}),f.add(m),q=m.x,D=m.y,Z=W.x,b=W.y,B=b-D,o=Z-q,H=g(B,o),F=d(.99*de(m,W),w),$={x:q+F*A(H),y:D+F*L(H)},f.add($),x.addAll([2,3])}else f.add(n.get(t)),x.add(2);return{points:f,segments:x}},toColorData:Xd,setCanvas:Df,createDiv:rs,createDisabledDiv:Pk,createView:tm,createCanvas:im,appendChild:Pb,initContext:nd,checkLoadingImage:Ge,translateAndScale:vb,layout:yj,getPosition:eg,drawPoints:Eo,drawRoundRect:He,drawBorder:Jd,setFocus:Gf,getter:Vq,setter:Lc,isEmptyObject:hg},!0),Rl(l,{autoAdjustIndex:1,hierarchicalRendering:1,adjustChildrenToTop:1,autoHideScrollBar:1,autoUpdate:1,firstPersonMode:1,ortho:1,strict:1,stickToRight:1,instant:1,closePath:1,hierarchical:1,doubleClickToToggle:1,continuousLayout:1,syncSize:1},!0);var Vj=j.disabledOpacity,Sg=j.toolTipDelay,fs=j.devicePixelRatio,sl=j.autoMakeVisible,Lf=j.autoHideScrollBar,uj=j.imageGradient,xj=j.showToolTip,Tp=j.hideToolTip,fe=j.dashPattern,ff=j.lineCap,xb=j.lineJoin,aq=j.labelColor,Ph=j.labelSelectColor,Bk=j.labelFont,zh=j.widgetIndent,Ye=j.widgetRowHeight,Jn=j.widgetHeaderHeight,lr=j.widgetTitleHeight,Pe=j.scrollBarColor,cg=j.scrollBarSize,Uj=j.scrollBarTimeout,mf=j.scrollBarMinLength,Pr=j.scrollBarInteractiveSize,gd=j.zoomIncrement,Bq=j.scrollZoomIncrement,Cn=j.pinchZoomIncrement,wb=j.zoomMax,fp=j.zoomMin,Fd=j.createObject,Gp=j.preventDefault,Yk=j.setImage,dq=j.getImage,Do=j.isImageComplete,Oh=j.drawCenterImage,hh=j.drawStretchImage,xi=j.getId,gc=j.callLater,vq=j.sortFunc,tq=j.clone,nb=j.getClass,Rm=j.startAnim,ac=j.brighter,Ap=j.darker,ko=j.drawText,Ql=j.getTextSize,Mf=j.isLeftButton,Fj=j.getTouchCount,Lg=j.isDoubleClick,wc=j.isShiftDown,Jf=j.isCtrlDown,yq=j.getClientPoint,wf=j.getPagePoint,de=j.getDistance,Zc=j.unionPoint,zs=j.unionRect,Co=j.containsPoint,Wd=j.containsRect,Ne=j.intersectsRect,Id=j.intersection,Ro=j.getWindowInfo,fn=j.grow,ag=j.getLogicalPoint,rf=j.startDragging,ss=j.removeHTML,zc=j.createElement,hl=j.segmentResolution,Ei=j.shapeResolution,Bi=j.shapeSide,gb=j.def,zq=function(y,P,E){gb(G+"."+y,P,E)},tg=function(Z,h){Z.childNodes.forEach(function(J){h(J),tg(J,h)})};Rl(j,{toolTipLabelColor:aq,toolTipLabelFont:Bk,toolTipBackground:b.toolTipBackground,toolTipShadowColor:go,drawBreakableText:Un,setDevicePixelRatio:function(f){fs=j.devicePixelRatio="number"==typeof f?f:k.devicePixelRatio,tg(M.body,function($){var J=$._ht;J&&J._canvas&&(Df(J._canvas,J.getWidth(),J.getHeight()),J.redraw?J.redraw():J.iv())})}},!0);var Sq=1e-6,ds="undefined"!=typeof Uint16Array?Uint16Array:Array,Cj="undefined"!=typeof Float32Array?Float32Array:Array,Op=function(q,z,G){var f=[q[0]-z[0],q[1]-z[1],q[2]-z[2]];if(G){var r=de(f);r>0&&(f[0]/=r,f[1]/=r,f[2]/=r)}return f},wq=function($){return[-$[0],-$[1],-$[2]]},hc=function(D,z){return 3===D.length?D[0]*z[0]+D[1]*z[1]+D[2]*z[2]:D[0]*z[0]+D[1]*z[1]},ge=function(){var g=new Cj(16);return g[0]=1,g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=1,g[6]=0,g[7]=0,g[8]=0,g[9]=0,g[10]=1,g[11]=0,g[12]=0,g[13]=0,g[14]=0,g[15]=1,g},qo=ge(),lo=function(h){var Q=new Cj(16);return Q[0]=h[0],Q[1]=h[1],Q[2]=h[2],Q[3]=h[3],Q[4]=h[4],Q[5]=h[5],Q[6]=h[6],Q[7]=h[7],Q[8]=h[8],Q[9]=h[9],Q[10]=h[10],Q[11]=h[11],Q[12]=h[12],Q[13]=h[13],Q[14]=h[14],Q[15]=h[15],Q},kk=function(e,B){return e[0]=B[0],e[1]=B[1],e[2]=B[2],e[3]=B[3],e[4]=B[4],e[5]=B[5],e[6]=B[6],e[7]=B[7],e[8]=B[8],e[9]=B[9],e[10]=B[10],e[11]=B[11],e[12]=B[12],e[13]=B[13],e[14]=B[14],e[15]=B[15],e},Oj=function(j){return j[0]=1,j[1]=0,j[2]=0,j[3]=0,j[4]=0,j[5]=1,j[6]=0,j[7]=0,j[8]=0,j[9]=0,j[10]=1,j[11]=0,j[12]=0,j[13]=0,j[14]=0,j[15]=1,j},pg=function(r,G){var s=r[0],z=r[1],g=r[2];return r[0]=G[0]*s+G[4]*z+G[8]*g+G[12],r[1]=G[1]*s+G[5]*z+G[9]*g+G[13],r[2]=G[2]*s+G[6]*z+G[10]*g+G[14],r},mh=function(F,i){var Z=F[0],d=F[1],O=F[2],c=F[3];return F[0]=i[0]*Z+i[4]*d+i[8]*O+i[12]*c,F[1]=i[1]*Z+i[5]*d+i[9]*O+i[13]*c,F[2]=i[2]*Z+i[6]*d+i[10]*O+i[14]*c,F[3]=i[3]*Z+i[7]*d+i[11]*O+i[15]*c,F},Oc=function(){var V,x,I,S,b=rb(Fi[1]+Fi[7]),C=rb(Fi[0]+Fi[3]-Fi[10]),K=rb(Fi[8]+2),Y=function(){return x=I.charAt(V),V+=1,x},E=function(){var N="";if(x===K)for(;Y();){if(x===K)return Y(),N;N+=x}else Y()},n=function(){for(;x&&" ">=x;)Y()},G=function(){var $,r={};if(x===b){if(Y(),n(),x===C)return Y(),r;for(;x;){if($=E(),n(),Y(),r[$]=S(),n(),x===C)return Y(),r;Y(),n()}}};return S=function(){switch(n(),x){case b:return G();default:return E()}},function(m){if(s={},m){var M;if(I=m,V=0,x=" ",M=S(),n(),!x)return M}}}(),Vd=function(I,x){if(x){var G=L(x),q=A(x),D=I[4],W=I[5],J=I[6],r=I[7],t=I[8],o=I[9],e=I[10],c=I[11];I[4]=D*q+t*G,I[5]=W*q+o*G,I[6]=J*q+e*G,I[7]=r*q+c*G,I[8]=t*q-D*G,I[9]=o*q-W*G,I[10]=e*q-J*G,I[11]=c*q-r*G}},fh=function(v,w){if(w){var M=L(w),I=A(w),J=v[0],g=v[1],E=v[2],e=v[3],$=v[8],W=v[9],p=v[10],f=v[11];v[0]=J*I-$*M,v[1]=g*I-W*M,v[2]=E*I-p*M,v[3]=e*I-f*M,v[8]=J*M+$*I,v[9]=g*M+W*I,v[10]=E*M+p*I,v[11]=e*M+f*I}},eq=function(v,p){if(p){var q=L(p),h=A(p),N=v[0],K=v[1],b=v[2],U=v[3],Q=v[4],t=v[5],F=v[6],z=v[7];v[0]=N*h+Q*q,v[1]=K*h+t*q,v[2]=b*h+F*q,v[3]=U*h+z*q,v[4]=Q*h-N*q,v[5]=t*h-K*q,v[6]=F*h-b*q,v[7]=z*h-U*q}},cn=function(z,U,n){return yo(T,n===!1?T:z.getFinalScale3d(),z.r3(),z.getRotationMode(),z.p3(),T,U)},yo=function(P,q,R,O,Z,b,C){return b||(b=ge()),Z&&Kl(b,Z),Pf(b,R,O),C&&Qg(b,b,C),q&&Ef(b,q),P&&Qg(b,b,P),b},Hi=function(k,r,Y){r=O(r),Y=O(Y);var m=this;m.g=k,m._84O=r,m._85O=Y,m._70I=!0,m.F=0,m._83O=r+Y,m.pen={x:0,y:0}},ec="lineDashOffset",ic="setLineDash",Rj=function(A){for(var C in A)1===C.length&&(ec=A[C]);return C?1:0},Dk=function(f,N,r){return ee(N)?f:f[ic]?(f[ic](N),r&&(f.lineDashOffset=r),f):new Hi(f,N[0],N.length>1?N[1]:N[0])},vk=function(y,l){!ee(l)&&y[ic]&&(y[ic](Er),y.lineDashOffset=0)};if(gb(Hi,o,{_69I:6,moveTo:function(r,B){var P=this,X=P.pen;X.x=r,X.y=B,P.g.moveTo(r,B),P.start||(P.start={x:r,y:B})},lineTo:function(N,j){var C=this,Z=C.pen,n=N-Z.x,S=j-Z.y,u=g(S,n),p=A(u),m=L(u),M=C._23O(Z.x,Z.y,N,j),e=C._85O,h=C._84O,F=C._83O;if(C.F){if(C.F>M)return C._70I?C._72I(N,j):C.moveTo(N,j),C.F-=M,void 0;if(C._70I?C._72I(Z.x+p*C.F,Z.y+m*C.F):C.moveTo(Z.x+p*C.F,Z.y+m*C.F),M-=C.F,C.F=0,C._70I=!C._70I,!M)return}var H=I(M/F);if(H){for(var r=p*h,o=m*h,W=p*e,K=m*e,U=0;H>U;U++)C._70I?(C._72I(Z.x+r,Z.y+o),C.moveTo(Z.x+W,Z.y+K)):(C.moveTo(Z.x+W,Z.y+K),C._72I(Z.x+r,Z.y+o));M-=F*H}C._70I?M>h?(C._72I(Z.x+p*h,Z.y+m*h),C.moveTo(N,j),C.F=e-(M-h),C._70I=!1):(C._72I(N,j),M===h?(C.F=0,C._70I=!C._70I):(C.F=h-M,C.moveTo(N,j))):M>e?(C.moveTo(Z.x+p*e,Z.y+m*e),C._72I(N,j),C.F=h-(M-e),C._70I=!0):(C.moveTo(N,j),M===e?(C.F=0,C._70I=!C._70I):C.F=e-M)},quadraticCurveTo:function(a,x,d,Z){var U,L=this,$=L.pen,f=$.x,c=$.y,S=L._22O(f,c,a,x,d,Z),g=0,_=0,n=L._85O,v=L._84O;if(L.F){if(L.F>S)return L._70I?L._71I(a,x,d,Z):L.moveTo(d,Z),L.F-=S,void 0;if(g=L.F/S,U=L._20O(f,c,a,x,d,Z,g),L._70I?L._71I(U[2],U[3],U[4],U[5]):L.moveTo(U[4],U[5]),L.F=0,L._70I=!L._70I,!S)return}var h=S-S*g,m=I(h/L._83O),p=v/S,P=n/S;if(m)for(var G=0;m>G;G++)L._70I?(_=g+p,U=L._21O(f,c,a,x,d,Z,g,_),L._71I(U[2],U[3],U[4],U[5]),g=_,_=g+P,U=L._21O(f,c,a,x,d,Z,g,_),L.moveTo(U[4],U[5])):(_=g+P,U=L._21O(f,c,a,x,d,Z,g,_),L.moveTo(U[4],U[5]),g=_,_=g+p,U=L._21O(f,c,a,x,d,Z,g,_),L._71I(U[2],U[3],U[4],U[5])),g=_;h=S-S*g,L._70I?h>v?(_=g+p,U=L._21O(f,c,a,x,d,Z,g,_),L._71I(U[2],U[3],U[4],U[5]),L.moveTo(d,Z),L.F=n-(h-v),L._70I=!1):(U=L._19O(f,c,a,x,d,Z,g),L._71I(U[2],U[3],U[4],U[5]),S===v?(L.F=0,L._70I=!L._70I):(L.F=v-h,L.moveTo(d,Z))):h>n?(_=g+P,U=L._21O(f,c,a,x,d,Z,g,_),L.moveTo(U[4],U[5]),U=L._19O(f,c,a,x,d,Z,_),L._71I(U[2],U[3],U[4],U[5]),L.F=v-(h-n),L._70I=!0):(L.moveTo(d,Z),h===n?(L.F=0,L._70I=!L._70I):L.F=n-h)},bezierCurveTo:function(){var t=arguments;this.pen={x:t[4],y:t[5]},this.g.bezierCurveTo(t[0],t[1],t[2],t[3],t[4],t[5])},arc:function(u,R,h,i,x,o){o||(i=-i,x=-x),zd(this,u,R,i,x-i,h,h,!1)},rect:function(E,f,w,P){var C=this;C.pen={x:E,y:f},C.moveTo(E,f),C.lineTo(E,f+P),C.lineTo(E+w,f+P),C.lineTo(E+w,f),C.lineTo(E,f)},beginPath:function(){this.g.beginPath()},closePath:function(){this.lineTo(this.start.x,this.start.y)},_23O:function(n,X,A,w){var F=A-n,i=w-X;return v(F*F+i*i)},_22O:function(n,F,J,W,o,$,e){for(var m,A,R,q,b,r,t,c=0,K=n,Z=F,U=e>0?e:this._69I,I=1;U>=I;I++)R=I/U,q=1-R,b=q*q,r=2*R*q,t=R*R,m=b*n+r*J+t*o,A=b*F+r*W+t*$,c+=this._23O(K,Z,m,A),K=m,Z=A;return c},_21O:function(f,i,l,F,v,Z,N,A){var _=this;if(0===N)return _._20O(f,i,l,F,v,Z,A);if(1===A)return _._19O(f,i,l,F,v,Z,N);var B=_._20O(f,i,l,F,v,Z,A);return B.push(N/A),_._19O.apply(_,B)},_20O:function(C,P,X,Y,Z,f,u){if(1!==u){var R=X+(Z-X)*u,O=Y+(f-Y)*u;X=C+(X-C)*u,Y=P+(Y-P)*u,Z=X+(R-X)*u,f=Y+(O-Y)*u}return[C,P,X,Y,Z,f]},_19O:function(B,N,D,W,V,v,I){if(1!==I){var X=B+(D-B)*I,h=N+(W-N)*I;D+=(V-D)*I,W+=(v-W)*I,B=X+(D-X)*I,N=h+(W-h)*I}return[B,N,D,W,V,v]},_72I:function(v,C){var r=this.pen;(v!==r.x||C!==r.y)&&(r.x=v,r.y=C,this.g.lineTo(v,C))},_71I:function(g,n,w,Y){var U=this.pen;(g!==w||n!==Y||w!==U.x||Y!==U.y)&&(U.x=w,U.y=Y,this.g.quadraticCurveTo(g,n,w,Y))}}),V&&F){var pi=F.toString();W=pi.indexOf(Qp.substr(0,2))>0&&pi.indexOf(ob+ob.substr(1,1))>1||pi.indexOf(Pm[0]+Xf.substr(0,2)+Qp.substr(2,2)+ud[0]+Qp[4])>1?!0:!1}var wm=T,hb=T,ej=function(x){wm&&!x._72O&&(hb||(hb={}),hb[x._72O=xi()]=x)},Or=function(o,Y){if(Y||(Y=o),Y&&(wm||(wm={}),!wm[o])){var D=new XMLHttpRequest;if(wm[Y]={request:D,url:Y},D.overrideMimeType&&D.overrideMimeType("text/plain"),Y=j.beforeLoadURL(Y),Y.data){var n=j.parse(Y.data);xf(o,n),j.handleCompTypeLoaded(o,n)}else D.open("GET",encodeURI(Y),!0),D.onload=function(N){if(200===this.status||0===this.status){var J=j.parse(N.target.response||N.target.responseText);xf(o,J),j.handleCompTypeLoaded(o,J)}else xf(o,T)},D.onerror=function(){xf(o,T)},D.send(null)}},xf=function(L,i){if(jh[L]=i,delete wm[L],hg(wm)&&(wm=T,hb)){for(var J in hb){var b=hb[J];b.invalidateAll&&b.invalidateAll(p,"compTypeLoaded",L),b.redraw&&b.redraw(),b.iv(),delete b._72O}hb=T}if(i&&hb)for(var J in hb){var b=hb[J];b.invalidateAll&&b.invalidateAll(p,"compTypeLoading",L),b.redraw&&b.redraw(),b.iv()}},Ld=b.chart,Bh=j.compStack=[],Lb=/^style@/,xr=/^attr@/,Zm=/^field@/,np={x:.5,y:.5},mc=function(t,B,M,K){if(!t)return 0;if(Aq(t.fitSize,B,M)&&K)return K;var Q=Aq(t.width,B,M);return null==Q?20:Q},lh=function(k,n,B,c){if(!k)return 0;if(Aq(k.fitSize,n,B)&&c)return c;var d=Aq(k.height,n,B);return null==d?20:d},Aq=function(m,C,N){if(!m||!m.func)return m;var t,P=m.func,z=m.value;return t=zj(P)?N&&N.vectorDataBindingDisabled&&!m.isSafeFunc?z:P(C,N):C instanceof Vk?xr.test(P)?C.a(P.slice(5)):Lb.test(P)?C.s(P.slice(6)):Zm.test(P)?C[P.slice(6)]:C[P]?C[P](N):z:z,z!==p&&t==T?z:t},$f=j.drawImage=function(){var R,v,S,K,P,l,F=function(c,j){c.getValue&&c.getValue.compType===j||(c.getValue=function(S){var o=t(c,S);if(o===p&&j.properties){var V=j.properties[S];V&&(o=V.defaultValue)}return o},c.getValue.compType=j)},t=function(c,q,h){var D=c[q];return D&&D.func?(D=Aq(D,v,S),h&&(D=h(D))):h&&(D=c[q]=h(D)),D},U=function(r,w){var G;if(G=w?t(r,w):r,P&&G){if("override"===l)return P;if("override_rgb"===l){var Q=ql(P);return G=Xd(G),"rgba("+I(255*Q[0])+","+I(255*Q[1])+","+I(255*Q[2])+","+G[3]/255+")"}if("override_a"===l){var Q=ql(P);return G=Xd(G),"rgba("+G[0]+","+G[1]+","+G[2]+","+Q[3]+")"}var Q=ql(P);return G=Xd(G),"rgba("+I(G[0]*Q[0])+","+I(G[1]*Q[1])+","+I(G[2]*Q[2])+","+G[3]/255*Q[3]+")"}return G},f=function(K){if(Lq(K)){for(var W=new ep,q=K.length,A=0;q>A;A+=2)W.add({x:K[A],y:K[A+1]});K=W}return K},z=function(u){var G=t(u,"anchorX"),b=t(u,"anchorY");if(G!==p||b!==p)return{x:G===p?np.x:G,y:b===p?np.y:b};var i=t(u,"type"),m=t(u,"name");if("image"!==i||!m)return np;var $=dq(m);return $&&$.anchorX&&$.anchorY?{x:$.anchorX,y:$.anchorY}:np},h=function(Q,q){var m=t(Q,Lj),U=z(Q);if(Lq(m)){var P=m.length,N=t(Q,"relative"),w=q.width,D=q.height;if(4===P)m={x:m[0],y:m[1],width:m[2],height:m[3]},N?(m.x*=w,m.y*=D,m.width*=w,m.height*=D):q.fitSize&&(m.x*=q.widthScale,m.width*=q.widthScale,m.y*=q.heightScale,m.height*=q.heightScale);else if(3===P){var g=m[0];m={width:m[1],height:m[2]},N?(m.width*=w,m.height*=D):q.fitSize&&(m.width*=q.widthScale,m.height*=q.heightScale),"object"==typeof g?g.length&&(g={x:g[0],y:g[1]}):g=eg(g,q,m),m.x=g.x-m.width*U.x,m.y=g.y-m.height*U.y}var R=t(Q,"offsetX");R&&(q.fitSize&&(R*=q.widthScale),m.x+=R),R=t(Q,"offsetY"),R&&(q.fitSize&&(R*=q.heightScale),m.y+=R)}return m},N=function(A){return Lq(A)?new ep(A):A},B=function(b,U,y,o,Q,l,N){var F=R.interactiveInfo;Q===p&&(Q=1),l===p&&(l=1);var z=t(b,"clipPercentage"),W=es(y,U);if(W&&!o&&1===Q&&1===l&&!(1>z))return F&&F.compInfos.push({comp:b,rect:U,stacks:F.stacks.slice()}),!1;N=N||np;var m=U.x+U.width*N.x,A=U.y+U.height*N.y,X=y.x+y.width*N.x,E=y.y+y.height*N.y,Y=y.width?Q*(U.width/y.width):1,q=y.height?l*(U.height/y.height):1;if(R.save(),F&&(F.stacks.push({t:[m,A]}),F.stacks.push({r:o}),F.stacks.push({s:[Y,q]}),F.stacks.push({t:[-X,-E]}),F.compInfos.push({comp:b,rect:U,stacks:F.stacks.slice()})),Pc(R,m,A),js(R,o||0),pd(R,Y,q),Pc(R,-X,-E),1>z){0>z&&(z=0);var C=Ci(y,t(b,"clipDirection"),z);R.beginPath(),R.rect(C.x,C.y,C.width,C.height),R.clip()}return!0},V=function(){R.interactiveInfo&&(R.interactiveInfo.stacks.pop(),R.interactiveInfo.stacks.pop(),R.interactiveInfo.stacks.pop(),R.interactiveInfo.stacks.pop()),R.restore()},E=function(f,y,N){var X=t(f,"path"),Y=t(f,Xe),s=t(f,"scaleX"),g=t(f,"scaleY"),e=z(f),i=T,I=$p(null,X);if(N||(N=f.unionRect,N||(N=Zc(I),f.path.func||(f.unionRect=N)),i=N),N){i||(i=f.unionRect,i||(i=Zc(I),f.path.func||(f.unionRect=i)));var O=B(f,N,i,Y,s,g,e),l=t(f,"borderPattern"),P=Dk(R,l),S=U(f,"background"),G=U(f,"borderColor"),C=t(f,"borderWidth"),J=t(f,"gradient"),Z=U(f,"gradientColor"),q=t(f,"border3d"),F=t(f,"border3dColor"),o=t(f,"border3dAccuracy"),u=R.lineJoin,M=R.lineCap;if(R.lineJoin=t(f,"borderJoin")||xb,R.lineCap=t(f,"borderCap")||ff,S?(Rh(R,S,J,Z,i),$p(R,X),R.fill(),P!==R&&$p(R,X)):$p(R,X),C&&G){var r=t(f,"borderWidthAbsolute");r&&(R.save(),R.setTransform(1,0,0,1,0,0)),R.lineWidth=C,R.strokeStyle=G,R.stroke(),r&&R.restore(),q&&ps(R,G,F,C,K,o)}if(vk(R,l),t(f,"dash")){var d=t(f,"dashWidth")||C;if(d>0){l=t(f,"dashPattern")||fe;var P=Dk(R,l,t(f,"dashOffset")),m=U(f,"dashColor")||U(Tb);P!==R&&$p(R,X),R.strokeStyle=m,R.lineWidth=d,R.stroke(),t(f,"dash3d")&&ps(R,m,U(f,"dash3dColor"),d,K,t(f,"dash3dAccuracy")),vk(R,l)}}y===Lj&&or(R,S,t(f,"depth"),i),R.lineJoin=u,R.lineCap=M,O&&V()}},W=function(p,I,x,y){var D=t(p,lq,f),J=t(p,Xe),X=z(p);if(D&&y.fitSize){var q=Math.abs(Math.cos(J))<.001,i=new ep,j=Zc(D),b=y.widthScale,w=y.heightScale,H=j.x+X.x*j.width,O=j.y+X.y*j.height,W=H*b,A=O*w;D.each(function(p){var s=p.x-H,U=p.y-O;i.add({x:W+s*(q?w:b),y:A+U*(q?b:w)})}),D=i,p.unionRect=null}var s=t(p,"scaleX"),e=t(p,"scaleY"),u=I===Gg,M=T;if(!x&&u&&(x=p.unionRect,x||(x=Zc(D),p.points.func||(p.unionRect=x)),M=x),x){u?M||(M=p.unionRect,M||(M=Zc(D),p.points.func||(p.unionRect=M))):M=x;var $,h,c,F,n=B(p,x,M,J,s,e,X),L=t(p,"borderPattern"),m=Dk(R,L),Z=U(p,"background"),o=dq(t(p,"repeatImage"),P,l),d=t(p,"gradientPack"),k=U(p,"borderColor"),Q=t(p,"borderWidth"),E=t(p,"segments",N),C=t(p,"gradient"),g=U(p,"gradientColor"),Y=t(p,"border3d"),G=t(p,"border3dColor"),r=t(p,"border3dAccuracy"),a=t(p,"closePath"),_=t(p,"fillRule")||"nonzero",go=R.lineJoin,Ho=R.lineCap;if(R.lineJoin=t(p,"borderJoin")||xb,R.lineCap=t(p,"borderCap")||ff,u)if(Z||o||d){var so=t(p,"fillClipPercentage");if(1>so){0>so&&(so=0);var Qb=Ci(M,t(p,"fillClipDirection"),so);R.save(),R.beginPath(),R.rect(Qb.x,Qb.y,Qb.width,Qb.height),R.clip()}if(Eo(R,D,E,a),d)fc(R,d);else if(o){var jd=R,iq=P,Xh=l;Ob(R,o,P,l,v,S),R=jd,P=iq,l=Xh}else{var jd=R;Rh(R,Z,C,g,M),R=jd}R.fill(_),1>so&&R.restore(),d&&R.restore(),m!==R&&Eo(m,D,E,a)}else Eo(m,D,E,a);else if("roundRect"===I?$=t(p,"cornerRadius"):"polygon"===I?$=t(p,"polygonSide"):"arc"===I&&($=t(p,"arcFrom"),h=t(p,"arcTo"),c=t(p,"arcClose"),F=t(p,"arcOval")),Z||o||d){var so=t(p,"fillClipPercentage");if(1>so){0>so&&(so=0);var Qb=Ci(M,t(p,"fillClipDirection"),so);R.save(),R.beginPath(),R.rect(Qb.x,Qb.y,Qb.width,Qb.height),R.clip()}if(Oo(R,I,M,$,h,c,F),d)fc(R,d);else if(o){var jd=R,iq=P,Xh=l;Ob(R,o,P,l,v,S),R=jd,P=iq,l=Xh}else Rh(R,Z,C,g,M);R.fill(_),1>so&&R.restore(),d&&R.restore(),R!==m&&Oo(m,I,M,$,h,c,F)}else Oo(m,I,M,$,h,c,F);if(Q&&k){var Hq=t(p,"borderWidthAbsolute");Hq&&(R.save(),R.setTransform(1,0,0,1,0,0)),R.lineWidth=Q,R.strokeStyle=k,R.stroke(),Hq&&R.restore(),Y&&ps(R,k,G,Q,K,r)}if(vk(R,L),t(p,"dash")){var dc=t(p,"dashWidth")||Q;if(dc>0){L=t(p,"dashPattern")||fe;var m=Dk(R,L,t(p,"dashOffset")),xj=U(p,"dashColor")||U(Tb);m!==R&&(u?Eo(m,D,E,a):Oo(m,I,M,$,h,c,F)),R.strokeStyle=xj,R.lineWidth=dc,R.stroke(),t(p,"dash3d")&&ps(R,xj,U(p,"dash3dColor"),dc,K,t(p,"dash3dAccuracy")),vk(R,L)}}I===Lj&&or(R,Z,t(p,"depth"),M),R.lineJoin=go,R.lineCap=Ho,n&&V()}},g=function(F,_){var c=P,I=l,Y=P||t(F,sm),b=l||t(F,"blendMode"),i=dq(t(F,"name"),Y,b);i&&(hh(R,i,t(F,"stretch"),_.x,_.y,_.width,_.height,v,S,Y,null,b),P=c,l=I)},k=function(J,x){var e=t(J,"text");e!=T&&ko(R,e,t(J,"font"),U(J,sm),x.x,x.y,x.width,x.height,t(J,"align"),t(J,"vAlign"))},c=function(L,X){Jd(R,U(L,sm),X.x,X.y,X.width,X.height,t(L,"width"))},O=function(p,b){var O=t(p,wj),J=0;if(O&&(O.forEach(function(x){J+=x}),J>0)){for(var _=t(p,"colors")||Ld,M=t(p,"startAngle")||0,Z=t(p,"hollow"),U=t(p,as),w=t(p,Wm),m=t(p,Ar),i=U?new ep:T,S=b.x,g=b.y,n=b.width,G=b.height,W=S+n/2,k=g+G/2,K=d(n,G)/2,C=0,$=0;$<O.length;$++){var y=O[$],P=u*y/J,f=M+P;if(R.fillStyle=_[C++],C===_.length&&(C=0),R.beginPath(),Z){var q=W+A(M)*K/2,N=k+L(M)*K/2,a=W+A(f)*K,x=k+L(f)*K;R.moveTo(q,N),R.arc(W,k,K/2,M,f,!1),R.lineTo(a,x),R.arc(W,k,K,f,M,!0)}else R.moveTo(W,k),R.arc(W,k,K,f,M,!0);i&&(P=(M+f)/2,i.add({text:zj(U)?U(y,$,J,v):y,x:W+.75*A(P)*K,y:k+.75*L(P)*K})),R.closePath(),R.fill(),M=f}i&&i.each(function(S){ko(R,S.text,w,m,S.x,S.y,0,0,Kb)})}},e=function(W,c){var $=t(W,oc);if($&&$.length>0){var m=$.length,n=t(W,as),r=t(W,Wm),u=t(W,Ar),X=n?new ep:T,M=t(W,"minValue")||0,j=t(W,"maxValue");if(j==T&&(j=0,$.forEach(function(m){t(m,wj).forEach(function(g){j=x(j,g)})})),M===j)return;for(var l=c.height/(j-M),y=c.y+j*l,P=t($[0],wj).length,Q=c.width/(3*P+1),w=2*Q/m,b=0,d=0;m>d;d++)for(var Z=$[d],I=t(Z,sm),S=t(Z,"colors"),i=t(Z,wj),O=0;P>O;O++){S?R.fillStyle=S[O]:I?R.fillStyle=I:(R.fillStyle=Ld[b++],b===Ld.length&&(b=0));var J=i[O],e=J*l,L=c.x+(1+3*O)*Q+d*w;if(eo(R,L,y-e,w,e),X){var z=zj(n)?n(J,O,Z,v):J,F=Ql(r,z).height;X.add({x:L,y:y-e-F,width:w,height:F,text:z})}}X&&X.each(function(O){ko(R,O.text,r,u,O.x,O.y,O.width,O.height,Kb)})}},D=function(y,H){var N=t(y,oc);if(N&&N.length>0){var B=N.length,G=t(N[0],wj).length,k=H.width/(3*G+1),Z=0,P=t(y,"maxValue"),p=t(y,as),Y=t(y,Wm),C=t(y,Ar),I=p?new ep:T;if(P==T){P=0;for(var K=0;G>K;K++){for(var D=0,j=0;B>j;j++)D+=t(N[j],wj)[K];P=x(P,D)}}if(P>0){for(var K=0;G>K;K++)for(var a=H.y+H.height,j=0;B>j;j++){var o=N[j],F=t(o,sm),h=t(o,wj)[K],g=h/P*H.height;F?R.fillStyle=F:(R.fillStyle=Ld[Z++],Z===Ld.length&&(Z=0)),a-=g;var J={x:H.x+(1+3*K)*k,y:a,width:2*k,height:g};eo(R,J.x,J.y,J.width,J.height),I&&(J.text=zj(p)?p(h,K,o,v):h,I.add(J))}I&&I.each(function(Z){ko(R,Z.text,Y,C,Z.x,Z.y,Z.width,Z.height,Kb)})}}},i=function(J,l){var q=t(J,oc);if(q&&q.length>0){for(var D=q.length,Q=t(q[0],wj).length,i=l.width/(3*Q+1),b=0,n=t(J,as),g=t(J,Wm),c=t(J,Ar),U=n?new ep:T,w=0;Q>w;w++){for(var y=0,P=0;D>P;P++)y+=t(q[P],wj)[w];if(y>0){var S=l.y+l.height;for(P=0;D>P;P++){var I=q[P],C=t(I,sm),p=t(I,wj)[w],e=p/y*l.height;C?R.fillStyle=C:(R.fillStyle=Ld[b++],b===Ld.length&&(b=0)),S-=e;var f={x:l.x+(1+3*w)*i,y:S,width:2*i,height:e};eo(R,f.x,f.y,f.width,f.height),U&&(f.text=zj(n)?n(p,w,I,v):p,U.add(f))}}}U&&U.each(function(t){ko(R,t.text,g,c,t.x,t.y,t.width,t.height,Kb)})}},r=function(H,L){var J=t(H,oc);if(J&&J.length>0){var n=J.length,y=t(H,"minValue")||0,U=t(H,"maxValue");if(U==T&&(U=0,J.forEach(function(R){t(R,wj).forEach(function(i){U=x(U,i)})})),y===U)return;for(var z=L.height/(U-y),c=L.y+U*z,Q=t(J[0],wj).length,j=L.width/(3*Q+1),N=0,V=t(H,"lineWidth")||2,O=t(H,"line3d"),p=t(H,"linePoint"),B=t(H,as),P=t(H,Wm),F=t(H,Ar),s=0;n>s;s++){var e=J[s],D=t(e,sm),A=t(e,wj);D?R.strokeStyle=D:(D=R.strokeStyle=Ld[N++],N===Ld.length&&(N=0)),R.beginPath();for(var W=0;Q>W;W++){var C=L.x+(2+3*W)*j,q=c-A[W]*z;0===W?R.moveTo(C,q):R.lineTo(C,q)}if(R.lineWidth=V,R.stroke(),O&&ps(R,D,T,V,K),p||B){var Z,h=V/2+2;for(W=0;Q>W;W++){var _=A[W];if(C=L.x+(2+3*W)*j,q=c-_*z,zj(p)?p(R,C,q,D,W,e,v):p&&(R.fillStyle=D,R.beginPath(),R.arc(C,q,h,0,u,!0),R.fill()),zj(B)?Z=B(_,W,e,v):B&&(Z=_),Z){var f=Ql(P,Z).height,w=R.shadowBlur;if(w){var r=R.shadowOffsetX,m=R.shadowOffsetY,X=R.shadowColor;R.shadowOffsetX=0,R.shadowOffsetY=0,R.shadowBlur=0,R.shadowColor=T}ko(R,Z,P,F,C,q-f-h+2,0,f,Kb),w&&(R.shadowOffsetX=r,R.shadowOffsetY=m,R.shadowBlur=w,R.shadowColor=X)}}}}}},Q={border:c,image:g,text:k,pieChart:O,columnChart:e,stackedColumnChart:D,percentageColumnChart:i,lineChart:r};return function(Y,u,Z,I,b,O,q,e,a,i){if(u&&b&&O){R=Y,v=q,S=e,K=S?S._zoom?S._zoom:1:1,P=a,l=i;var J=b,c=O;if(Gr()){var M,A,r;0===R[qb]?Gr[0]&&(M=!0):M=!0,R.texureImage2D?Gr[1]&&(A=!0):A=!0,R.texureImage3D?Gr[2]&&(r=!0):r=!0,M&&A&&r&&(J=Z,c=I)}if(u.tagName)return R.drawImage(u,J,c,b,O),void 0;if(t(u,"visible")!==!1){P||(P=Aq(u.color,v,S)),i||(l=Aq(u.blendMode,v,S));var s=mc(u,v,S,b),d=lh(u,v,S,O),$={x:0,y:0,width:s,height:d,fitSize:t(u,"fitSize")},_=t(u,"clip"),H=t(u,"opacity");$.fitSize&&($.widthScale=s/Aq(u.width,v,S),$.heightScale=d/Aq(u.height,v,S)),R.save(),R.interactiveInfo&&(R.interactiveInfo.stacks.push({t:[J,c]}),R.interactiveInfo.stacks.push({s:[b/s,O/d]})),Pc(R,J,c),(s!==b||d!==O)&&R.scale(b/s,O/d),_&&(zj(_)?_(R,s,d,v,S,u):(R.beginPath(),R.rect(0,0,s,d),R.clip())),H!=T&&(R.globalAlpha*=H),t(u,"comps").forEach(function(b){if(t(b,Sp)!==!1){Bh.splice(0,0,b);var J=t(b,"opacity"),P=t(b,"shadow"),X=t(b,"type"),w=h(b,$);if(J!=T){var m=R.globalAlpha;R.globalAlpha*=J}if(P){var n=R.shadowOffsetX,G=R.shadowOffsetY,e=R.shadowBlur,u=R.shadowColor,r=t(b,"shadowOffsetX"),A=t(b,"shadowOffsetY"),Y=t(b,"shadowBlur"),o=U(b,"shadowColor");R.shadowOffsetX=(r==T?3:r)*K,R.shadowOffsetY=(A==T?3:A)*K,R.shadowBlur=(Y==T?6:Y)*K,R.shadowColor=o||U(go)}if("save"===X)R.save();else if("endClip"===X||"restore"===X)R.restore();else if("clip"===X)R.save(),Eo(R,t(b,"points",f),t(b,"segments",N),!0),R.clip();else if(yk[X])w=w||{x:0,y:0,width:$.width,height:$.height},W(b,X,w,$);else if(X===Gg)W(b,X,w,$);else if("SVGPath"===X)E(b,X,w);else{w=w||{x:0,y:0,width:$.width,height:$.height};var H=t(b,Xe),Z=t(b,"scaleX"),a=t(b,"scaleY"),_=z(b),k=B(b,w,w,H,Z,a,_);if(zj(X))F(b,X),j.drawCompType(X,R,w,b,v,S);else if(j.getCompType(X)){var L=j.getCompType(X),y=L.func||L;F(b,L),j.drawCompType(y,R,w,b,v,S)}else Q[X]?Q[X](b,w):j.getCompType(X)===p&&Ih.test(X)&&Or(X);k&&V()}P&&(R.shadowOffsetX=n,R.shadowOffsetY=G,R.shadowBlur=e,R.shadowColor=u),J!=T&&(R.globalAlpha=m),Bh.splice(0,1)}}),R.interactiveInfo&&(R.interactiveInfo.stacks.pop(),R.interactiveInfo.stacks.pop()),R.restore()}}}}();j.getCurrentComp=function(){return Bh[0]},j.getParentComp=function(){return Bh[1]},j.getInternal=function(){return{isEnter:Cd,isEsc:Rd,isSpace:ir,isLeft:Ip,isUp:ig,isRight:Xk,isDown:We,addMethod:Rl,superCall:fk,toPointsArray:dl,translateAndScale:vb,appendArray:qj,createWorldMatrix:yo,vec3TransformMat4:pg,setCanvas:Df,createDiv:rs,createView:tm,createCanvas:im,createImage:On,initContext:nd,layout:yj,fillRect:eo,Mat:gh,drawBorder:Jd,isString:Td,setBorder:tl,getPropertyValue:Rn,setPropertyValue:pm,drawVerticalLine:Vr,draw3DRect:or,getPinchDist:Rq,isSameRect:es,getPosition:eg,intersectionLineRect:nl,getNodeRect:Wk,getEdgeAgentPosition:Ec,getImageWidth:mc,getImageHeight:lh,initItemElement:em,drawPoints:Eo,createG2:Dk,closePopup:Hp,isH:fd,createAnim:$m,createNormalMatrix:Wb,createNormals:Oi,toFloatArray:Yd,glMV:Ep,batchShape:Fe,createNodeMatrix:cn,getFaceInfo:kg,transformAppend:qe,drawFaceInfo:wd,to3dPointsArray:Nd,setGLDebugMode:function(G){Gc=G},cube:function(){return{vs:Ml,is:cb,uv:ok}},ui:function(){return{DataUI:jf,NodeUI:rn,EdgeUI:id,GroupUI:Fg,ShapeUI:Yh,GridUI:Xo,Data3dUI:Kp,Node3dUI:gj,Shape3dUI:Fc}},getInternalVersion:function(){return"U2FsdGVkX19htF0+z896NYEHpMVbHoK1U/z8oqHzkaA="},getDragger:function(){return Zk},addMSMap:function(N){Rl(Vl,N)},k:m}},function(n){function s(Q,F){Q!=T&&(F==T&&Rk!=typeof Q?this._54O(Q,256):this._54O(Q,F))}function b(){return new s(T)}function y(F,X,V,m,i,d){for(;--d>=0;){var c=X*this[F++]+V[m]+i;i=I(c/67108864),V[m++]=67108863&c}return i}function E(q,P,H,u,s,p){for(var X=32767&P,E=P>>15;--p>=0;){var F=32767&this[q],r=this[q++]>>15,k=E*F+r*X;F=X*F+((32767&k)<<15)+H[u]+(1073741823&s),s=(F>>>30)+(k>>>15)+E*r+(s>>>30),H[u++]=1073741823&F}return s}function M(w,d,f,B,S,D){for(var v=16383&d,t=d>>14;--D>=0;){var q=16383&this[w],E=this[w++]>>14,P=t*q+E*v;q=v*q+((16383&P)<<14)+f[B]+S,S=(q>>28)+(P>>14)+t*E,f[B++]=268435455&q}return S}function F(U){return Eg.charAt(U)}function R(h,A){var s=vb[h.charCodeAt(A)];return s==T?-1:s}function W(J){for(var $=this.t-1;$>=0;--$)J[$]=this[$];J.t=this.t,J.s=this.s}function c(x){this.t=1,this.s=0>x?-1:0,x>0?this[0]=x:-1>x?this[0]=x+this.DV:this.t=0}function z(S){var O=b();return O._58O(S),O}function B(G,o){var I,V=this;if(16==o)I=4;else if(8==o)I=3;else if(256==o)I=8;else if(2==o)I=1;else if(32==o)I=5;else{if(4!=o)return V.fromRadix(G,o),void 0;I=2}V.t=0,V.s=0;for(var N=G.length,y=!1,g=0;--N>=0;){var Q=8==I?255&G[N]:R(G,N);0>Q?"-"==G.charAt(N)&&(y=!0):(y=!1,0==g?V[V.t++]=Q:g+I>V.DB?(V[V.t-1]|=(Q&(1<<V.DB-g)-1)<<g,V[V.t++]=Q>>V.DB-g):V[V.t-1]|=Q<<g,g+=I,g>=V.DB&&(g-=V.DB))}8==I&&0!=(128&G[0])&&(V.s=-1,g>0&&(V[V.t-1]|=(1<<V.DB-g)-1<<g)),V._57O(),y&&s.ZERO._78O(V,V)}function a(){for(var c=this,o=c.s&c.DM;c.t>0&&c[c.t-1]==o;)--c.t}function J(I){var j=this;if(j.s<0)return"-"+j._85O()[Cd](I);var k;if(16==I)k=4;else if(8==I)k=3;else if(2==I)k=1;else if(32==I)k=5;else{if(4!=I)return j.toRadix(I);k=2}var y,X=(1<<k)-1,U=!1,v="",G=j.t,_=j.DB-G*j.DB%k;if(G-->0)for(_<j.DB&&(y=j[G]>>_)>0&&(U=!0,v=F(y));G>=0;)k>_?(y=(j[G]&(1<<_)-1)<<k-_,y|=j[--G]>>(_+=j.DB-k)):(y=j[G]>>(_-=k)&X,0>=_&&(_+=j.DB,--G)),y>0&&(U=!0),U&&(v+=F(y));return U?v:"0"}function p(){var Y=b();return s.ZERO._78O(this,Y),Y}function Y(){return this.s<0?this._85O():this}function P(P){var U=this,y=U.s-P.s;if(0!=y)return y;var A=U.t;if(y=A-P.t,0!=y)return U.s<0?-y:y;for(;--A>=0;)if(0!=(y=U[A]-P[A]))return y;return 0}function N(K){var r,j=1;return 0!=(r=K>>>16)&&(K=r,j+=16),0!=(r=K>>8)&&(K=r,j+=8),0!=(r=K>>4)&&(K=r,j+=4),0!=(r=K>>2)&&(K=r,j+=2),0!=(r=K>>1)&&(K=r,j+=1),j}function f(){var v=this;return v.t<=0?0:v.DB*(v.t-1)+N(v[v.t-1]^v.s&v.DM)}function $(y,t){var V;for(V=this.t-1;V>=0;--V)t[V+y]=this[V];for(V=y-1;V>=0;--V)t[V]=0;t.t=this.t+y,t.s=this.s}function w(u,$){for(var V=u;V<this.t;++V)$[V-u]=this[V];$.t=x(this.t-u,0),$.s=this.s}function Q(N,e){var x,F=this,l=N%F.DB,y=F.DB-l,a=(1<<y)-1,s=I(N/F.DB),U=F.s<<l&F.DM;for(x=F.t-1;x>=0;--x)e[x+s+1]=F[x]>>y|U,U=(F[x]&a)<<l;for(x=s-1;x>=0;--x)e[x]=0;e[s]=U,e.t=F.t+s+1,e.s=F.s,e._57O()}function e(G,q){var i=this;q.s=i.s;var W=I(G/i.DB);if(W>=i.t)return q.t=0,void 0;var _=G%i.DB,T=i.DB-_,a=(1<<_)-1;q[0]=i[W]>>_;for(var D=W+1;D<i.t;++D)q[D-W-1]|=(i[D]&a)<<T,q[D-W]=i[D]>>_;_>0&&(q[i.t-W-1]|=(i.s&a)<<T),q.t=i.t-W,q._57O()}function j(B,b){for(var o=this,p=0,q=0,h=d(B.t,o.t);h>p;)q+=o[p]-B[p],b[p++]=q&o.DM,q>>=o.DB;if(B.t<o.t){for(q-=B.s;p<o.t;)q+=o[p],b[p++]=q&o.DM,q>>=o.DB;q+=o.s}else{for(q+=o.s;p<B.t;)q-=B[p],b[p++]=q&o.DM,q>>=o.DB;q-=B.s}b.s=0>q?-1:0,-1>q?b[p++]=o.DV+q:q>0&&(b[p++]=q),b.t=p,b._57O()}function Z(y,P){var p=this.abs(),a=y.abs(),X=p.t;for(P.t=X+a.t;--X>=0;)P[X]=0;for(X=0;X<a.t;++X)P[X+p.t]=p.am(0,a[X],P,X,0,p.t);P.s=0,P._57O(),this.s!=y.s&&s.ZERO._78O(P,P)}function g(t){for(var J=this.abs(),i=t.t=2*J.t;--i>=0;)t[i]=0;for(i=0;i<J.t-1;++i){var w=J.am(i,J[i],t,2*i,0,1);(t[i+J.t]+=J.am(i+1,2*J[i],t,2*i+1,w,J.t-i-1))>=J.DV&&(t[i+J.t]-=J.DV,t[i+J.t+1]=1)}t.t>0&&(t[t.t-1]+=J.am(i,J[i],t,2*i,0,1)),t.s=0,t._57O()}function K(v,K,a){var n=v.abs(),D=this;if(!(n.t<=0)){var F=D.abs();if(F.t<n.t)return K!=T&&K._58O(0),a!=T&&D._77O(a),void 0;a==T&&(a=b());var x=b(),L=D.s,i=v.s,p=D.DB-N(n[n.t-1]);p>0?(n._44O(p,x),F._44O(p,a)):(n._77O(x),F._77O(a));var O=x.t,V=x[O-1];if(0!=V){var j=V*(1<<D.F1)+(O>1?x[O-2]>>D.F2:0),C=D.FV/j,m=(1<<D.F1)/j,R=1<<D.F2,t=a.t,w=t-O,q=K==T?b():K;for(x._59O(w,q),a._52O(q)>=0&&(a[a.t++]=1,a._78O(q,a)),s.ONE._59O(O,q),q._78O(x,x);x.t<O;)x[x.t++]=0;for(;--w>=0;){var X=a[--t]==V?D.DM:I(a[t]*C+(a[t-1]+R)*m);if((a[t]+=x.am(0,X,a,w,0,O))<X)for(x._59O(w,q),a._78O(q,a);a[t]<--X;)a._78O(q,a)}K!=T&&(a._45O(O,K),L!=i&&s.ZERO._78O(K,K)),a.t=O,a._57O(),p>0&&a._46O(p,a),0>L&&s.ZERO._78O(a,a)}}}function r(j){var m=b();return this.abs()._49O(j,T,m),this.s<0&&m._52O(s.ZERO)>0&&j._78O(m,m),m}function U(s){this.m=s}function X(E){return E.s<0||E._52O(this.m)>=0?E.mod(this.m):E}function C(p){return p}function o(J){J._49O(this.m,T,J)}function S(h,V,r){h._47O(V,r),this._74O(r)}function _(o,J){o._48O(J),this._74O(J)}function t(){if(this.t<1)return 0;var N=this[0];if(0==(1&N))return 0;var M=3&N;return M=15&M*(2-(15&N)*M),M=255&M*(2-(255&N)*M),M=65535&M*(2-(65535&(65535&N)*M)),M=M*(2-N*M%this.DV)%this.DV,M>0?this.DV-M:-M}function l(A){var W=this;W.m=A,W.mp=A._50O(),W.mpl=32767&W.mp,W.mph=W.mp>>15,W.um=(1<<A.DB-15)-1,W.mt2=2*A.t}function k(q){var X=b();return q.abs()._59O(this.m.t,X),X._49O(this.m,T,X),q.s<0&&X._52O(s.ZERO)>0&&this.m._78O(X,X),X}function V(X){var S=b();return X._77O(S),this._74O(S),S}function h(i){for(var l=this;i.t<=l.mt2;)i[i.t++]=0;for(var M=0;M<l.m.t;++M){var A=32767&i[M],K=A*l.mpl+((A*l.mph+(i[M]>>15)*l.mpl&l.um)<<15)&i.DM;for(A=M+l.m.t,i[A]+=l.m.am(0,K,i,M,0,l.m.t);i[A]>=i.DV;)i[A]-=i.DV,i[++A]++}i._57O(),i._45O(l.m.t,i),i._52O(l.m)>=0&&i._78O(l.m,i)}function Ni(P,y){P._48O(y),this._74O(y)
}function ch(S,y,Y){S._47O(y,Y),this._74O(Y)}function sd(){return 0==(this.t>0?1&this[0]:this.s)}function qg(S,r){if(S>4294967295||1>S)return s.ONE;var Q=b(),c=b(),X=r._73O(this),K=N(S)-1;for(X._77O(Q);--K>=0;)if(r._76O(Q,c),(S&1<<K)>0)r._75O(c,X,Q);else{var q=Q;Q=c,c=q}return r.revert(Q)}function qo(c,o){var M;return M=256>c||o._51O()?new U(o):new l(o),this.exp(c,M)}function Wf(){var v=this;if(v.s<0){if(1==v.t)return v[0]-v.DV;if(0==v.t)return-1}else{if(1==v.t)return v[0];if(0==v.t)return 0}return(v[1]&(1<<32-v.DB)-1)<<v.DB|v[0]}function yl(Z,H){return new s(Z,H)}function hg(){var F=this;F.n=T,F.e=0,F.d=T,F.p=T,F.q=T,F.dmp1=T,F.dmq1=T,F._10A=T}function se(L){return L._53O(this.e,this.n)}function Ip(X){var S,O,C,H="",I=0;for(S=0;S<X.length&&X.charAt(S)!=qf;++S)C=Ng.indexOf(X.charAt(S)),0>C||(0==I?(H+=F(C>>2),O=3&C,I=1):1==I?(H+=F(O<<2|C>>4),O=15&C,I=2):2==I?(H+=F(O),H+=F(C>>2),O=3&C,I=3):(H+=F(O<<2|C>>4),H+=F(15&C),I=0));return 1==I&&(H+=F(O<<2)),H}function zp(X){var n=X.split(""),c=Ip(X);return n.forEach(function(J){var j=J.length;j>0&&c&&(Zb+=O(J))}),c}function We(f,O){var q=Vn._4O.Util._56O(f,"ss"),K={},J=0;return K.v=q==O,K.t=1,K.s=0>J?-1:0,ug=K.v,J>0?K[0]=J:-1>J?K[0]=J+K.DV:K.t=0,[q,K]}function Wi(l){var u=38,x=l.substring(0,u);if(x&&30==x.indexOf("05000420")){var W=["ss",l.substring(u)];return W}return[]}function te(g,p){p=p.replace(Hi,""),p=p.replace(/[ \n]+/g,"");var h=yl(p,16);if(h._55O()>this.n._55O())return 0;var x=this._37O(h),J=x[Cd](16).replace(/^1f+00/,""),Q=Wi(J);if(0==Q.length)return!1;for(var Y,e,f,_=.5,M=Bi,d=[0,.5,.75,.875,.9375],O=[],S=[],w=[],T=u/M,c=Q[1],a=We(g,c)[0],V=0,K=0;V<d.length;V++){var R=0===V%2?0:.5;for(Y=0;M>=Y;Y++)e=(Y+R)*T,f=1-d[V],O.push(A(e)*_*f,-_+2*d[V]*_,-L(e)*_*f),S.push((Y+R)/M,f)}for(V=0;V<d.length-1;V++){var D=V*(M+1),t=(V+1)*(M+1);for(Y=0;M>Y;Y++)w.push(D+Y,t+Y+1,t+Y,D+Y,D+Y+1,t+Y+1)}return w.forEach(function(V){K+=V}),c==a&&K>10}var mh,ao=0xdeadbeefcafe,Vg=15715070==(16777215&ao),Cd="toString",ll="",di="nat",hf=function(){};i=n["D"+11182[Cd](q(2,5))];var gs=s.prototype;vs+=Qd.substr(0,1);var pm=n.navigator?n.navigator.appName:"";Vg&&"Microsoft Internet Explorer"==pm?(gs.am=E,mh=30):Vg&&"Netscape"!=pm?(gs.am=y,mh=26):(gs.am=M,mh=28),gs.DB=mh,gs.DM=(1<<mh)-1,gs.DV=1<<mh;var Jp=52;gs.FV=q(2,Jp),gs.F1=Jp-mh,gs.F2=2*mh-Jp;var Zc,fp,Eg="0123456789abcdefghijklmnopqrstuvwxyz",vb=[],Xf=function(B){return String.fromCharCode(B)};for(Zc="0".charCodeAt(0),fp=0;9>=fp;++fp)vb[Zc++]=fp;for(Zc="a".charCodeAt(0),fp=10;36>fp;++fp)vb[Zc++]=fp;for(Zc="A".charCodeAt(0),fp=10;36>fp;++fp)vb[Zc++]=fp;var Lg=U.prototype;Lg._73O=X,Lg.revert=C,Lg._74O=o,Lg._75O=S,Lg._76O=_;var Eq=l.prototype;Eq._73O=k,Eq.revert=V,Eq._74O=h,Eq._75O=ch,Eq._76O=Ni,gs._77O=W,gs._58O=c,gs._54O=B,gs._57O=a,gs._59O=$,gs._45O=w,gs._44O=Q,gs._46O=e,gs._78O=j,gs._47O=Z,gs._48O=g,gs._49O=K,gs._50O=t,gs._51O=sd,gs.exp=qg,gs.toString=J,gs._85O=p,gs.abs=Y,gs._52O=P,gs._55O=f,gs.mod=r,gs._53O=qo,s.ZERO=z(0),s.ONE=z(1),gs._86O=Wf;var md=function(z,N){var o=this;o.isPublic=!0,typeof z!==Rk?(o.n=z,o.e=N):z!=T&&N!=T&&z.length>0&&N.length>0&&(o.n=yl(z,16),o.e=O(N,16))};wn=function(){var n,w,c=zp(Se),A=c.substr(0,4),$=c.substr(4,2),K=c.substr(6,2),M=1,V=!M,_=m,C=[],F=Re.charAt(7);if(i&&(i[Cd]().indexOf(di)<0||i[vs][Cd]().indexOf(di)<0||!c?n=Oc(Di[F]):(c=new i(A-0,$-M,K-0),w=c.setHours(9),i[vs]()>w?n=Oc(Di[F]):V=!0)),c&&n&&_){for(var r in n)C.push(r);var z,y=0,Z=n[C[y++]],S=n[C[y++]],h=n[C[y++]],o=n[C[y++]],d=n[C[y++]],N=n[C[y++]],b=n[C[y++]],k=sk._27O(_);if(k&&b){z=Z+S+h+o+d+N;var e=!N||N===Bs;if(!e&&N)for(var I,G=0,E=N.length;E>G;G++)N[G]===Vo[y]?I===Bs?e=!0:I=T:(I==T?I=N[G]:I+=N[G],G===E-1&&I===Bs&&(e=!0));z&&k._31O(z,b)&&e&&(!d||i[vs]()<d)&&(V=!0)}}return V||(Oo=ee),F};var Rl=hg.prototype;Rl._37O=se,Rl._38O=md;var Ng="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",qf="=",Fo=25,lc=10,Se="IBgGFQ==",ji=ji||function(z,S){var q={},K=q._7A={},f=K._6A=function(){function A(){}return{_80O:function(y){A.prototype=this;var o=new A;return y&&o._5A(y),o.hasOwnProperty("_82O")||(o._82O=function(){o.$super._82O.apply(this,arguments)}),o._82O.prototype=o,o.$super=this,o},_3A:function(){var i=this._80O();return i._82O.apply(i,arguments),i},_82O:function(){},_5A:function(B){for(var k in B)B.hasOwnProperty(k)&&(this[k]=B[k]);B.hasOwnProperty(Cd)&&(this.toString=B.toString)},_88O:function(){return this._82O.prototype._80O(this)}}}(),B=K._39O=f._80O({_82O:function(T,s){T=this._84O=T||[],this._65O=s!=S?s:4*T.length},toString:function(B){return(B||p).stringify(this)},_89O:function(r){var E=this._84O,W=r._84O,d=this._65O,h=r._65O;if(this._57O(),d%4)for(var B=0;h>B;B++){var R=255&W[B>>>2]>>>24-8*(B%4);E[d+B>>>2]|=R<<24-8*((d+B)%4)}else if(W.length>65535)for(var B=0;h>B;B+=4)E[d+B>>>2]=W[B>>>2];else E.push.apply(E,W);return this._65O+=h,this},_57O:function(){var K=this._84O,P=this._65O;K[P>>>2]&=4294967295<<32-8*(P%4),K.length=D(P/4)},_88O:function(){var A=f._88O.call(this);return A._84O=this._84O.slice(0),A},_87O:function(m){for(var C=[],Q=0;m>Q;Q+=4)C.push(0|4294967296*H);return new B._82O(C,m)}}),i=q._2A={},p=i._69O={stringify:function(e){var o,T=e._84O,W=e._65O,d=[];for(o=0;W>o;o++){var r=255&T[o>>>2]>>>24-8*(o%4);d.push((r>>>4).toString(16)),d.push((15&r).toString(16))}return d.join("")},_68O:function(N){for(var U=N.length,t=[],J=0;U>J;J+=2)t[J>>>3]|=O(N.substr(J,2),16)<<24-4*(J%8);return new B._82O(t,U/2)}},t=i._8A={stringify:function(T){var r,F=T._84O,b=T._65O,C=[];for(r=0;b>r;r++){var M=255&F[r>>>2]>>>24-8*(r%4);C.push(Xf(M))}return C.join("")},_68O:function($){var L,U=$.length,m=[];for(L=0;U>L;L++)m[L>>>2]|=(255&$.charCodeAt(L))<<24-8*(L%4);return new B._82O(m,U)}},$=i._9A={stringify:function(I){try{return decodeURIComponent(escape(t.stringify(I)))}catch(_){throw new Error("")}},_68O:function(a){return t._68O(unescape(encodeURIComponent(a)))}},L=K._32O=f._80O({_1A:function(){this._83O=new B._82O,this._23O=0},_33O:function(k){typeof k==Rk&&(k=$._68O(k)),this._83O._89O(k),this._23O+=k._65O},_25O:function(F){var K=this._83O,k=K._84O,w=K._65O,I=this._79O,G=4*I,Y=w/G;Y=F?D(Y):x((0|Y)-this._22O,0);var V=Y*I,s=d(4*V,w);if(V){for(var N=0;V>N;N+=I)this._20O(k,N);var P=k.splice(0,V);K._65O-=s}return new B._82O(P,s)},_88O:function(){var x=f._88O.call(this);return x._83O=this._83O._88O(),x},_22O:0});K._66O=L._80O({cfg:f._80O(),_82O:function(y){this.cfg=this.cfg._80O(y),this._1A()},_1A:function(){L._1A.call(this),this._34O()},_81O:function(U){return this._33O(U),this._25O(),this},_72O:function(B){B&&this._33O(B);var N=this._21O();return N},_79O:16,_26O:function(q){return function(F,K){return new q._82O(K)._72O(F)}},_19O:function(x){return function(V,b){return new Q._71O._82O(x,b)._72O(V)}}});var Q=q._67O={};return q}();!function(){var X=ji,C=X._7A,M=C._39O,d=C._66O,n=X._67O,F=[],_=[];!function(){function t(A){for(var H=v(A),V=2;H>=V;V++)if(!(A%V))return!1;return!0}function S(Q){return 0|4294967296*(Q-(0|Q))}for(var H=2,d=0;64>d;)t(H)&&(8>d&&(F[d]=S(q(H,.5))),_[d]=S(q(H,1/3)),d++),H++}();var r=[],$=n._41O=d._80O({_34O:function(){this._64O=new M._82O(F.slice(0))},_20O:function(m,w){for(var f=this._64O._84O,c=f[0],j=f[1],O=f[2],X=f[3],l=f[4],h=f[5],x=f[6],Z=f[7],F=0;64>F;F++){if(16>F)r[F]=0|m[w+F];else{var b=r[F-15],o=(b<<25|b>>>7)^(b<<14|b>>>18)^b>>>3,J=r[F-2],p=(J<<15|J>>>17)^(J<<13|J>>>19)^J>>>10;r[F]=o+r[F-7]+p+r[F-16]}var S=l&h^~l&x,n=c&j^c&O^j&O,i=(c<<30|c>>>2)^(c<<19|c>>>13)^(c<<10|c>>>22),a=(l<<26|l>>>6)^(l<<21|l>>>11)^(l<<7|l>>>25),e=Z+a+S+_[F]+r[F],k=i+n;Z=x,x=h,h=l,l=0|X+e,X=O,O=j,j=c,c=0|e+k}f[0]=0|f[0]+c,f[1]=0|f[1]+j,f[2]=0|f[2]+O,f[3]=0|f[3]+X,f[4]=0|f[4]+l,f[5]=0|f[5]+h,f[6]=0|f[6]+x,f[7]=0|f[7]+Z},_21O:function(){var r=this._83O,V=r._84O,_=8*this._23O,B=8*r._65O;return V[B>>>5]|=128<<24-B%32,V[(B+64>>>9<<4)+14]=I(_/4294967296),V[(B+64>>>9<<4)+15]=_,r._65O=4*V.length,this._25O(),this._64O},_88O:function(){var h=d._88O.call(this);return h._64O=this._64O._88O(),h}});X._41O=d._26O($),X._42O=d._19O($)}();var Hi=new RegExp("");Hi.compile("[^0-9a-f]","gi"),hg._28O=-1,hg._29O=-2,Rl._31O=te,Rl._63O=te,hg._43O=-2;var xp=new function(){var $=this;$._5O=function(Q,R){if("8"!=Q.substring(R+2,R+3))return 1;var S=O(Q.substring(R+3,R+4));return 0==S?-1:S>0&&10>S?S+1:-2},$._13O=function(S,Q){var z=$._5O(S,Q);return 1>z?"":S.substring(Q+2,Q+2+2*z)},$._12O=function(k,z){var p=$._13O(k,z);if(""==p)return-1;var g;return g=O(p.substring(0,1))<8?new s(p,16):new s(p.substring(2),16),g._86O()},$._6O=function(u,n){var A=$._5O(u,n);return 0>A?A:n+2*(A+1)},$._11O=function(w,A){var M=$._6O(w,A),a=$._12O(w,A);return w.substring(M,M+2*a)},$._10O=function(R,E){var j=$._6O(R,E),z=$._12O(R,E);return j+2*z},$._7O=function(b,l){var X=[],w=$._6O(b,l);X.push(w);for(var h=$._12O(b,l),C=w,e=0;;){var A=$._10O(b,C);if(A==T||A-w>=2*h)break;if(e>=200)break;X.push(A),C=A,e++}return X}};if(xp._90O=Xf(lc+24),xp._91O=G+Xf(lc*lc+8),Vn==T||!Vn)var Vn={};Vn._4O!=T&&Vn._4O||(Vn._4O={});var Pl=Vn._4O;Vn._4O.Util=new function(){var Q=this;Q._56O=function(O){var E=new Vn._4O._3O;return E._30O(O)},Q._4A=function(r){var o=new Vn._4O._3O;return o._36O(r)},Q._11A=function(d){var z=new Pl._3O;return z._30O(d)}},Vn._4O._3O=function(){var l=this;l._8O=function(q,P){if("ss"==q&&"cj"==P){try{l.md=ji._67O._41O._3A()}catch(i){hf(ll)}l._24O=function(X){l.md._81O(X)},l._35O=function(K){var a=ji._2A._69O._68O(K);l.md._81O(a)},l._60O=function(){var M=l.md._72O();return M[Cd](ji._2A._69O)},l._30O=function(g){return l._24O(g),l._60O()},l._36O=function(J){return l._35O(J),l._60O()}}},l._24O=function(){hf(ll)},l._35O=function(){hf(ll)},l._60O=function(){hf(ll)},l._30O=function(){hf(ll)},l._36O=function(){hf(ll)},l._8O("ss","cj")},Zo=function(q){var c=El[Xi[7]],$=1,j=!1;if(Dp.a!=El[Ak])return Dp.a;if(Dp.forEach(function(S){$*=S}),q>$){if(c){c=c.split(xp._90O);var p=c[3],e=c[7],w=c[11],H=c[15],r=c[19],T=c[23],V=c[27],M=p+e+w+H+r+T,s=T?!1:!0;if(T){var J=T&&T.split(Lc("firefox")[3]);if(J)for(var t=0;t<J.length;t++)if(Zr.indexOf(J[t])>=0){s=!0;break}}j=Bb()(M,V)&&s&&(!r||r>q)}j||(jf.prototype._42=Mn)}else j=!0;return Dp.a=j,j},Fo=String.fromCharCode(Fo+20);var xj=function(_){return _=_.replace(Hi,ll),_=_.replace(/[ \n]+/g,ll)},Fg="30",Vp="06",Yc="02",wj="03",$o=yl,pq=/^1f+00/,sk=function(){var A;return A={_18O:function(X){var G=X,H=G.replace(/\s+/g,""),B=Ip(H);return B},_14O:function(N){var y=this._18O(N),Y=this._15O(y);return Y},_15O:function(r){var X=this._17O(r);if("2a864886f70d010101"==X._61O){var g=this._16O(X.key),c=new hg;return c._38O(g.n,g.e),c}hf(ll)},_16O:function(f){var Q={};f.substr(0,2)!=Fg&&hf(ll);var q=xp._7O(f,0);return 2!=q.length&&hf(ll),f.substr(q[0],2)!=Yc&&hf(ll),Q.n=xp._11O(f,q[0]),f.substr(q[1],2)!=Yc&&hf(ll),Q.e=xp._11O(f,q[1]),Q},_17O:function(P){var i={};i._40O=T;var L=xp._7O(P,0);2!=L.length&&hf(ll);var x=L[0];P.substr(x,2)!=Fg&&hf(ll);var W=xp._7O(P,x);return 2!=W.length&&hf(ll),P.substr(W[0],2)!=Vp&&hf(ll),i._61O=xp._11O(P,W[0]),P.substr(W[1],2)==Vp?i._40O=xp._11O(P,W[1]):P.substr(W[1],2)==Fg&&(i._40O={},i._40O.p=xp._70O(P,W[1],[0],Yc),i._40O.q=xp._70O(P,W[1],[1],Yc),i._40O.g=xp._70O(P,W[1],[2],Yc)),P.substr(L[1],2)!=wj&&hf(ll),i.key=xp._11O(P,L[1]).substr(2),i}},A._17O?A:T}(),wg=sk._27O=function(l){return sk._14O(l)};Bb=function(){return function(s,R){if(s&&R){R=xj(R);var F=$o(R,q(2,4)),W=this;if(!W||!W.n||F._55O()>W.n._55O())return 0;var b=W._37O(F),t=b[Cd](q(2,4)).replace(pq,""),E=Wi(t);if(0==E.length)return!1;var w=E[0],j=E[1],N=function(m){return Vn._4O.Util._56O(m,w)},J=N(s);return j==J}}.bind(wg(m))};var mj,ak;return function(){var s=Dq.length-Vh.length;if(s>0)for(var g=0;s>g;g++)mj=Pl.Util,ak=xj}(),Cg=function(G,S){S=ak(S);var m=wg(ec),C=Gj.length,H=2*C,c=$o(S,q(C,H)),Q=m,o=!0;if(Q){var w=Q[$r[0]];w&&c._55O()<=w._55O()&&(o=!1)}if(o)return 0;var Y=Q._37O(c),p=Y[Cd](q(C,H)).replace(pq,""),j=Wi(p);if(0==j.length)return!1;var D=j[0],B=j[1],U=mj._11A(G,D);return B==U},sk}(k,o),Rl(j,{load:function(){var P={},q=function(R){return R?"c_"+(R.sync?"1":"0")+"_"+(R.post?"1":"0")+"_"+(R.responseType||"H")+"_"+(R.mimeType||"H")+"_"+(R.data?JSON.stringify(R.data):"H"):""};return function(C,W,X){var Q,J=P[C],p=q(X);return J&&(Q=J[p])?(Q.push(W),void 0):(P[C]||(J=P[C]={count:0}),Q=J[p]=[W],J.count++,j.xhrLoad(C,function(n){delete J[p],J.count--,J.count||delete P[C],Q.forEach(function(A){A(n)})},X),void 0)}}(),asyncEach:function(j,o,g){"function"!=typeof g&&(g=Function.prototype);var D=new Array(j.length),s=0,v=!1;j.forEach(function(X,i){o(X,function(M,V){return v?void 0:M?(v=!0,g(null)):(D[i]=V,s++,s===j.length?g(D):void 0)})})},xhrLoad:function(U,R,K){var J=!1;Lq(U)||(J=!0,U=[U]),K=K||{},U.length;var a=K.sync,$=!!K.post,I=K.data||null;j.asyncEach(U,function(Q,s){var y=new XMLHttpRequest;Q=j.beforeLoadURL(Q),Q.data?s(null,Q.data):(y.open($?"POST":"GET",encodeURI(Q),!a),K.responseType?y.responseType=K.responseType:y.overrideMimeType&&y.overrideMimeType(K.mimeType||"text/plain"),y.onload=function(e){200===this.status||0===this.status?s(null,e.target.response||e.target.responseText):s(!0)},y.onerror=function(){s(!0)},y.send(I))},function(I){"function"==typeof R&&R(J&&I?I[0]:I)})}}),Math.sign===p&&(Math.sign=function(u){return 0>u?-1:u>0?1:+u}),X.Math={generateUUID:function(){for(var F=[],Q=0;256>Q;Q++)F[Q]=(16>Q?"0":"")+Q.toString(16).toUpperCase();return function(){var Z=0|4294967295*Math.random(),$=0|4294967295*Math.random(),M=0|4294967295*Math.random(),b=0|4294967295*Math.random();return F[255&Z]+F[255&Z>>8]+F[255&Z>>16]+F[255&Z>>24]+"-"+F[255&$]+F[255&$>>8]+"-"+F[64|15&$>>16]+F[255&$>>24]+"-"+F[128|63&M]+F[255&M>>8]+"-"+F[255&M>>16]+F[255&M>>24]+F[255&b]+F[255&b>>8]+F[255&b>>16]+F[255&b>>24]}}()};var bn=X.Math.Matrix2=function(){this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0};bn.prototype={},bn.prototype.constructor=bn,bn.prototype.set=function(P,Y,J,s,I,m){return this.a=P,this.b=Y,this.c=J,this.d=s,this.tx=I,this.ty=m,this},bn.prototype.apply=function(n,b){b=b||new gi;var k=n.x,w=n.y;return b.x=this.a*k+this.c*w+this.tx,b.y=this.b*k+this.d*w+this.ty,b},bn.prototype.applyInverse=function(c,l){l=l||new gi;var h=1/(this.a*this.d+this.c*-this.b),T=c.x,k=c.y;return l.x=this.d*h*T+-this.c*h*k+(this.ty*this.c-this.tx*this.d)*h,l.y=this.a*h*k+-this.b*h*T+(-this.ty*this.a+this.tx*this.b)*h,l},bn.prototype.translate=function(M,r){return this.tx+=M,this.ty+=r,this},bn.prototype.scale=function(v,u){return this.a*=v,this.d*=u,this.c*=v,this.b*=u,this.tx*=v,this.ty*=u,this},bn.prototype.rotate=function(E){var V=Math.cos(E),G=Math.sin(E),W=this.a,y=this.c,p=this.tx;return this.a=W*V-this.b*G,this.b=W*G+this.b*V,this.c=y*V-this.d*G,this.d=y*G+this.d*V,this.tx=p*V-this.ty*G,this.ty=p*G+this.ty*V,this},bn.prototype.appendTranslate=function(q,$){return this.tx+=this.a*q,this.ty+=this.d*$,this},bn.prototype.appendScale=function($,g){return this.a*=$,this.d*=g,this.c*=g,this.b*=$,this},bn.prototype.appendRotate=function(b){var d=Math.cos(b),S=Math.sin(b),u=this.a,k=this.b;return this.a=u*d+this.c*S,this.b=k*d+this.d*S,this.c=-u*S+this.c*d,this.d=-k*S+this.d*d,this},bn.prototype.append=function(u){var l=this.a,S=this.b,A=this.c,$=this.d;return this.a=u.a*l+u.b*A,this.b=u.a*S+u.b*$,this.c=u.c*l+u.d*A,this.d=u.c*S+u.d*$,this.tx=u.tx*l+u.ty*A+this.tx,this.ty=u.tx*S+u.ty*$+this.ty,this},bn.prototype.setTransform=function(o,R,K,d,u,x,Z,T,S){var a,v,t,A,W,f,Y,V,j,C;return W=Math.sin(Z),f=Math.cos(Z),Y=Math.cos(S),V=Math.sin(S),j=-Math.sin(T),C=Math.cos(T),a=f*u,v=W*u,t=-W*x,A=f*x,this.a=Y*a+V*t,this.b=Y*v+V*A,this.c=j*a+C*t,this.d=j*v+C*A,this.tx=o+(K*a+d*t),this.ty=R+(K*v+d*A),this},bn.prototype.prepend=function(P){var n=this.tx;if(1!==P.a||0!==P.b||0!==P.c||1!==P.d){var o=this.a,D=this.c;this.a=o*P.a+this.b*P.c,this.b=o*P.b+this.b*P.d,this.c=D*P.a+this.d*P.c,this.d=D*P.b+this.d*P.d}return this.tx=n*P.a+this.ty*P.c+P.tx,this.ty=n*P.b+this.ty*P.d+P.ty,this},bn.prototype.invert=function(){var x=this.a,V=this.b,z=this.c,u=this.d,y=this.tx,p=x*u-V*z;return this.a=u/p,this.b=-V/p,this.c=-z/p,this.d=x/p,this.tx=(z*this.ty-u*y)/p,this.ty=-(x*this.ty-V*y)/p,this},bn.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},bn.prototype.clone=function(){var y=new bn;return y.a=this.a,y.b=this.b,y.c=this.c,y.d=this.d,y.tx=this.tx,y.ty=this.ty,y},bn.prototype.copy=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},bn.IDENTITY=new bn,bn.TEMP_MATRIX=new bn;var ap=X.Math.Vector3=function(a,F,t){"object"==typeof a?this.copy(a):this.set(a,F==p?a:F,t==p?a:t)};o.assign(ap.prototype,{set:function(X,T,Z){return this.x=X,this.y=T,this.z=Z,this},setScalar:function(X){return this.x=X,this.y=X,this.z=X,this},setX:function(u){return this.x=u,this},setY:function(A){return this.y=A,this},setZ:function(x){return this.z=x,this},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(d){return d.x===p?(this.x=d[0],this.y=d[1],this.z=d[2]):(this.x=d.x,this.y=d.y,this.z=d.z),this},add:function(l){return this.x+=l.x,this.y+=l.y,this.z+=l.z,this},addScalar:function(T){return this.x+=T,this.y+=T,this.z+=T,this},addVectors:function(N,f){return this.x=N.x+f.x,this.y=N.y+f.y,this.z=N.z+f.z,this},addScaledVector:function(H,I){return this.x+=H.x*I,this.y+=H.y*I,this.z+=H.z*I,this},sub:function(K){return this.x-=K.x,this.y-=K.y,this.z-=K.z,this},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this},subVectors:function(j,d){return this.x=j.x-d.x,this.y=j.y-d.y,this.z=j.z-d.z,this},multiply:function(d){return this.x*=d.x,this.y*=d.y,this.z*=d.z,this},multiplyScalar:function(y){return this.x*=y,this.y*=y,this.z*=y,this},distanceTo:function(l){return Math.sqrt(this.distanceToSquared(l))},distanceToSquared:function(G){var V=this.x-G.x,u=this.y-G.y,q=this.z-G.z;return V*V+u*u+q*q},multiplyVectors:function(u,c){return this.x=u.x*c.x,this.y=u.y*c.y,this.z=u.z*c.z,this},transformDirection:function(Y){var Q=this.x,y=this.y,u=this.z,e=Y.el;return this.x=e[0]*Q+e[4]*y+e[8]*u,this.y=e[1]*Q+e[5]*y+e[9]*u,this.z=e[2]*Q+e[6]*y+e[10]*u,this.normalize()},applyMatrix4:function(c){var E=this.x,D=this.y,r=this.z,Q=c.el,$=1/(Q[3]*E+Q[7]*D+Q[11]*r+Q[15]);return this.x=(Q[0]*E+Q[4]*D+Q[8]*r+Q[12])*$,this.y=(Q[1]*E+Q[5]*D+Q[9]*r+Q[13])*$,this.z=(Q[2]*E+Q[6]*D+Q[10]*r+Q[14])*$,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(W){return this.x*W.x+this.y*W.y+this.z*W.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){var R=this.length();return R?this.multiplyScalar(1/R):this},setLength:function(C){return this.normalize().multiplyScalar(C)},fromArray:function(B,f){return f===p&&(f=0),this.x=B[f],this.y=B[f+1],this.z=B[f+2],this},cross:function(n){return this.crossVectors(this,n)},crossVectors:function(E,f){var F=E.x,D=E.y,K=E.z,o=f.x,b=f.y,G=f.z;return this.x=D*G-K*b,this.y=K*o-F*G,this.z=F*b-D*o,this}});var gi=X.Math.Vector2=function(b,E,Y){"object"==typeof b&&(b.x!=p?(E=b.y,b=b.x,Y=b.e):(Y=b[2],E=b[1],b=b[0])),this.set(b||0,E||0,Y)};gi.prototype={},gi.prototype.constructor=gi,o.defineProperties(gi.prototype,{width:{get:function(){return this.x},set:function(N){this.x=N}},height:{get:function(){return this.y},set:function(g){this.y=g}}}),gi.prototype.clone=function(){return new gi(this.x,this.y,this.e)},gi.prototype.copy=function(i){return this.set(i.x,i.y,i.e),this},gi.prototype.equals=function(j){return j.x===this.x&&j.y===this.y},gi.prototype.set=function(P,C,M){return this.x=P||0,this.y=C||(0!==C?this.x:0),M!=p&&(this.e=M),this},gi.prototype.setScalar=function(l){return this.x=l,this.y=l,this},gi.prototype.setX=function(S){return this.x=S||0,this},gi.prototype.setY=function(X){return this.y=X||0,this},gi.prototype.add=function(I){return this.x+=I.x,this.y+=I.y,this},gi.prototype.addVectors=function(t,D){return this.x=t.x+D.x,this.y=t.y+D.y,this},gi.prototype.addScalar=function(c){return this.x+=c,this.y+=c,this},gi.prototype.addScaledVector=function(O,b){return this.x+=O.x*b,this.y+=O.y*b,this},gi.prototype.sub=function(G){return this.x-=G.x,this.y-=G.y,this},gi.prototype.subScalar=function(n){return this.x-=n,this.y-=n,this},gi.prototype.subVectors=function(n,p){return this.x=n.x-p.x,this.y=n.y-p.y,this},gi.prototype.multiply=function(q){return this.x*=q.x,this.y*=q.y,this},gi.prototype.multiplyScalar=function(c){return this.x*=c,this.y*=c,this},gi.prototype.divide=function(b){return this.x/=b.x,this.y/=b.y,this},gi.prototype.divideScalar=function(y){return this.multiplyScalar(1/y)},gi.prototype.min=function(L){return this.x=Math.min(this.x,L.x),this.y=Math.min(this.y,L.y),this},gi.prototype.max=function(y){return this.x=Math.max(this.x,y.x),this.y=Math.max(this.y,y.y),this},gi.prototype.clamp=function(Y,b){return this.x=Math.max(Y.x,Math.min(b.x,this.x)),this.y=Math.max(Y.y,Math.min(b.y,this.y)),this},gi.prototype.clampScalar=function(){var n,_;return function(W,y){return n===p&&(n=new gi,_=new gi),n.set(W,W),_.set(y,y),this.clamp(n,_)}}(),gi.prototype.clampLength=function(P,T){var L=this.length();return this.multiplyScalar(Math.max(P,Math.min(T,L))/L)},gi.prototype.dot=function(h){return this.x*h.x+this.y*h.y},gi.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},gi.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},gi.prototype.normalize=function(){return this.divideScalar(this.length())},gi.prototype.angle=function(){var r=Math.atan2(this.y,this.x);return 0>r&&(r+=2*Math.PI),r},gi.prototype.distanceTo=function(F){return Math.sqrt(this.distanceToSquared(F))},gi.prototype.distanceToSquared=function(e){var k=this.x-e.x,u=this.y-e.y;return k*k+u*u},gi.prototype.isNearEnough=function(O){return this.distanceToSquared(O)<1e-8},gi.prototype.setLength=function(W){var T=this.length();return T?this.multiplyScalar(W/T):this},gi.prototype.lerp=function(k,j){return this.x+=(k.x-this.x)*j,this.y+=(k.y-this.y)*j,this},gi.prototype.lerpVectors=function(H,M,n){return this.subVectors(M,H).multiplyScalar(n).add(H)},gi.prototype.rotateAround=function(l,p){var L=Math.cos(p),W=Math.sin(p),S=this.x-l.x,e=this.y-l.y;return this.x=S*L-e*W+l.x,this.y=S*W+e*L+l.y,this};var rd=X.Math.Ray=function(D,$){this.origin=D!==p?D.clone():new ap,this.direction=$!==p?$.clone():new ap};o.assign(rd.prototype,{set:function(X,h){return this.origin.copy(X),this.direction.copy(h),this},clone:function(){return(new this.constructor).copy(this)},copy:function(O){return this.origin.copy(O.origin),this.direction.copy(O.direction),this},at:function(n,y){var r=y||new ap;return r.copy(this.direction).multiplyScalar(n).add(this.origin)},lookAt:function(e){return this.direction.copy(e).sub(this.origin).normalize(),this},applyMatrix4:function(n){return this.origin.applyMatrix4(n),this.direction.transformDirection(n),this},intersectTriangle:function(){var N=new ap,o=new ap,S=new ap,K=new ap;return function(c,U,s,D,X){o.subVectors(U,c),S.subVectors(s,c),K.crossVectors(o,S);var z,T=this.direction.dot(K);if(T>0){if(D)return null;z=1}else{if(!(0>T))return null;z=-1,T=-T}N.subVectors(this.origin,c);var I=z*this.direction.dot(S.crossVectors(N,S));if(0>I)return null;var i=z*this.direction.dot(o.cross(N));if(0>i||I+i>T)return null;var F=-z*N.dot(K);return 0>F?null:this.at(F/T,X)}}()});var Cm=X.Math.Matrix4=function(){this.el=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]};o.assign(Cm.prototype,{set:function(z,M,t,_,C,P,g,p,R,B,m,w,D,c,x,Q){var W=this.el;return W[0]=z,W[4]=M,W[8]=t,W[12]=_,W[1]=C,W[5]=P,W[9]=g,W[13]=p,W[2]=R,W[6]=B,W[10]=m,W[14]=w,W[3]=D,W[7]=c,W[11]=x,W[15]=Q,this},clone:function(){return(new Cm).fromArray(this.el)},fromArray:function(h,Y){Y===p&&(Y=0);for(var t=this.el,A=0;16>A;A++)t[A]=h[A+Y];return this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},getInverse:function(P){var L=this.el,A=P.el,B=A[0],f=A[1],h=A[2],O=A[3],b=A[4],d=A[5],D=A[6],y=A[7],Z=A[8],F=A[9],v=A[10],s=A[11],Y=A[12],o=A[13],V=A[14],w=A[15],t=F*V*y-o*v*y+o*D*s-d*V*s-F*D*w+d*v*w,T=Y*v*y-Z*V*y-Y*D*s+b*V*s+Z*D*w-b*v*w,W=Z*o*y-Y*F*y+Y*d*s-b*o*s-Z*d*w+b*F*w,c=Y*F*D-Z*o*D-Y*d*v+b*o*v+Z*d*V-b*F*V,X=B*t+f*T+h*W+O*c;if(0===X)return this.identity();var e=1/X;return L[0]=t*e,L[1]=(o*v*O-F*V*O-o*h*s+f*V*s+F*h*w-f*v*w)*e,L[2]=(d*V*O-o*D*O+o*h*y-f*V*y-d*h*w+f*D*w)*e,L[3]=(F*D*O-d*v*O-F*h*y+f*v*y+d*h*s-f*D*s)*e,L[4]=T*e,L[5]=(Z*V*O-Y*v*O+Y*h*s-B*V*s-Z*h*w+B*v*w)*e,L[6]=(Y*D*O-b*V*O-Y*h*y+B*V*y+b*h*w-B*D*w)*e,L[7]=(b*v*O-Z*D*O+Z*h*y-B*v*y-b*h*s+B*D*s)*e,L[8]=W*e,L[9]=(Y*F*O-Z*o*O-Y*f*s+B*o*s+Z*f*w-B*F*w)*e,L[10]=(b*o*O-Y*d*O+Y*f*y-B*o*y-b*f*w+B*d*w)*e,L[11]=(Z*d*O-b*F*O-Z*f*y+B*F*y+b*f*s-B*d*s)*e,L[12]=c*e,L[13]=(Z*o*h-Y*F*h+Y*f*v-B*o*v-Z*f*V+B*F*V)*e,L[14]=(Y*d*h-b*o*h-Y*f*D+B*o*D+b*f*V-B*d*V)*e,L[15]=(b*F*h-Z*d*h+Z*f*D-B*F*D-b*f*v+B*d*v)*e,this}});var ep=X.List=function(){this._as=[];var X,V,i=arguments.length;if(1===i){var H=arguments[0];if(um(H)&&(H=H._as),Lq(H))for(V=H.length,X=0;V>X;X++)this._as.push(H[X]);else H!=T&&this._as.push(H)}else if(i>1)for(X=0;i>X;X++)this._as.push(arguments[X])};zq("List",o,{forEach:function(C,W){this.each(C,W)},push:function(){for(var o=0;o<arguments.length;o++)this.add(arguments[o])},pop:function(){return this._as.pop()},shift:function(){return this._as.shift()},unshift:function(){return this._as.unshift.apply(this._as,arguments)},size:function(){return this._as.length},isEmpty:function(){return 0===this._as.length},add:function(a,E){return E===p?this._as.push(a):this._as.splice(E,0,a)},addAll:function(t){um(t)&&(t=t._as),Lq(t)?qj(this._as,t):this._as.push(t)},get:function(R){return this._as[R]},slice:function($,W){return new ep(this._as.slice($,W))},remove:function(u){var O=this._as.indexOf(u);return O>=0&&O<this._as.length&&this.removeAt(O),O},removeAt:function(o){return this._as.splice(o,1)[0]},set:function(J,e){return this._as[J]=e},clear:function(){return this._as.splice(0,this._as.length)},contains:function(K){return this._as.indexOf(K)>=0},indexOf:function(N){return this._as.indexOf(N)},each:function(c,J){for(var r=0,F=this._as.length;F>r;r++){var x=this._as[r];J?c.call(J,x,r,this):c(x,r,this)}},reverseEach:function(I,i){for(var J=this._as.length-1;J>=0;J--){var O=this._as[J];i?I.call(i,O):I(O)}},toArray:function(y,G){if(y){for(var s,i=[],u=0,M=this._as.length;M>u;u++)s=this._as[u],G?y.call(G,s)&&i.push(s):y(s)&&i.push(s);return i}return this._as.concat()},toList:function(H,U){if(H){for(var t,r=new ep,Z=0,o=this._as.length;o>Z;Z++)t=this._as[Z],U?H.call(U,t)&&r.add(t):H(t)&&r.add(t);return r}return new ep(this)},reverse:function(){this._as.reverse()},sort:function(E){return this._as.sort(E?E:vq),this},toString:function(){return this._as.toString()}}),o.defineProperties(ep.prototype,{length:{get:function(){return this._as.length},set:function(B){this._as.length=B}}});var _c=new ep;Rl(_c,{size:function(){return 0},indexOf:function(){return-1},contains:function(){return!1},isEmpty:function(){return!0},sort:Qc,each:Qc,reverseEach:Qc,toArray:function(){return[]},toList:function(){return new ep},add:cr,addAll:cr,set:cr,remove:cr,removeAt:cr,clear:cr});var gh=X.Matrix=function(h,x,V,t,G){var J=this;h=h||0;var T=L(h),P=A(h);t=t||1,G=G||1,J.a=P*t,J.b=T*t,J.c=-T*G,J.d=P*G,J.tx=x||0,J.ty=V||0};gh.prototype.tf=function(E,C){1===arguments.length&&(C=E.y,E=E.x);var k=this;return{x:k.a*E+k.c*C+k.tx,y:k.b*E+k.d*C+k.ty}},gh.prototype.translate=function(j,J){var o=this;return o.tx+=j,o.ty+=J,o},gh.prototype.scale=function(g,u){var B=this;return B.a*=g,B.d*=u,B.c*=g,B.b*=u,B.tx*=g,B.ty*=u,B},gh.prototype.rotate=function(E){var D=A(E),Y=L(E),R=this,y=R.a,k=R.c,B=R.tx;return R.a=y*D-R.b*Y,R.b=y*Y+R.b*D,R.c=k*D-R.d*Y,R.d=k*Y+R.d*D,R.tx=B*D-R.ty*Y,R.ty=B*Y+R.ty*D,R},gh.prototype.transform=function(x){var R=this,D=x.a,M=x.b,z=x.c,Y=x.d,j=x.tx,K=x.ty,c=R.a,k=R.b,F=R.c,U=R.d,O=R.tx,E=R.ty;return R.a=D*c+z*k,R.b=M*c+Y*k,R.c=D*F+z*U,R.d=M*F+Y*U,R.tx=D*O+z*E+j,R.ty=M*O+Y*E+K,R},gh.prototype.tfi=function(K,k){1===arguments.length&&(k=K.y,K=K.x);var o=this,Q=1/(o.a*o.d+o.c*-o.b);return{x:o.d*Q*K+-o.c*Q*k+(o.ty*o.c-o.tx*o.d)*Q,y:o.a*Q*k+-o.b*Q*K+(-o.ty*o.a+o.tx*o.b)*Q}};var ve=X.Notifier=function(){this._f=0};zq("Notifier",o,{contains:function(p,I){if(this._ls)for(var K,u=0,D=this._ls.size();D>u;u++)if(K=this._ls.get(u),p===K.l&&I===K.s)return!0;return!1},add:function($,r,G){var s=this,z={l:$,s:r,a:G};s._ls||(s._ls=new ep),s._f?(s._as||(s._as=new ep),s._as.add(z)):z.a?s._ls.add(z,0):s._ls.add(z)},remove:function(N,Y){var J=this;J._ls&&(J._f?(J._rs||(J._rs=new ep),J._rs.add({l:N,s:Y})):J._remove(N,Y))},_remove:function(C,Y){for(var s,l=this._ls,c=0,H=l.size();H>c;c++)if(s=l.get(c),s.l===C&&s.s===Y)return l.removeAt(c),void 0},fire:function(v){var U=this,I=U._ls;if(U._b=1e4,I){++U._f;try{for(var u,L=0,n=I.size();n>L;L++)u=I.get(L),u.s?u.l.call(u.s,v):u.l(v)}finally{if(--U._f)return;if(U._rs){for(n=U._rs.size(),L=0;n>L;L++)u=U._rs.get(L),U._remove(u.l,u.s);delete U._rs}if(U._as){for(n=U._as.size(),L=0;n>L;L++)u=U._as.get(L),u.a?I.add(u,0):I.add(u);delete U._as}}}}});var Vk=X.Data=function(){this._id=xi()};zq("Data",o,{ms_ac:["tag","name","displayName","icon","toolTip","attrObject","layer","adjustChildrenToTop","dataBindings"],ms_dm:1,ms_attr:1,_icon:T,_parent:T,_children:_c,_childMap:T,_styleMap:T,_layer:"0",_adjustChildrenToTop:!1,getUIClass:function(){return T},_22Q:function(){return T},s:function(Y,P){var H=this;if(2===arguments.length)H.setStyle(Y,P);else{if(!Tf(Y))return H.getStyle(Y);for(var C in Y)H.setStyle(C,Y[C])}return H},fp:function(i,o,e,y,n){return this.firePropertyChange(i,o,e,y,n)},firePropertyChange:function(s,L,A,e,K){if(e){if(e(L,A))return!1}else if(L===A)return!1;var P=this,w=K||{};return w.property=s,w.oldValue=L,w.newValue=A,w.data=P,P._dataModel&&P._dataModel.handleDataPropertyChange(w),P.onPropertyChanged(w),!0},onPropertyChanged:function($){var Z=this,F=Z._parent,y=$.property;if(vh(F)){var N=Z.s(rc),P="s:ingroup"===y;(N&&us[y]||y===P)&&F._81I(),(N||P)&&F.fp("childChange",!0,!1)}Vm(F)&&us[y]&&F.updateFromChildren()},_21I:function(s){var y=this;if(s&&y._dataModel)throw"Remove data from dataModel before adding";y._dataModel=s},removeFromDataModel:function(){this._dataModel?this._dataModel.remove(this):this.setParent(null)},clearChildrenFromDataModel:function(){for(var w=0,V=this._children.toArray(),y=V.length;y>w;w++)V[w].removeFromDataModel()},getId:function(){return this._id},setId:function(P){this._id=P},getChildren:function(){return this._children},size:function(){return this._children.size()},toChildren:function(W,c){return this._children.toList(W,c)},eachChild:function(K,R){this._children.each(K,R)},addChild:function(S,c){var d=this;S!==d&&(d._children===_c&&(d._children=new ep,d._childMap={}),c>=0||(c=d._children.size()),d._childMap[S._id]||d.isDescendantOf(S)||(S._parent&&S._parent.removeChild(S),(0>c||c>d._children.size())&&(c=d._children.size()),d._children.add(S,c),d._childMap[S._id]=S,S.setParent(d),d.onChildAdded(S,c),d.fp(Eq,T,S)))},onChildAdded:function(){},removeChild:function(S){var p=this;if(p._childMap&&p._childMap[S._id]){var v=p._children.remove(S);delete p._childMap[S._id],p.fp(Eq,S,T),S.setParent(T,v),p.onChildRemoved(S,v)}},onChildRemoved:function(){},getChildAt:function(O){return this._children.get(O)},clearChildren:function(){var I=this;if(!I._children.isEmpty())for(var B=0,L=I._children.toArray(),H=L.length;H>B;B++)I.removeChild(L[B])},getParent:function(){return this._parent},setParent:function(x,L){var K=this;if(!(K._73I||K._parent===x||K===x||x&&x.isDescendantOf(K))){var V,b=K._parent;K._parent=x,K._73I=1,b?(L==T&&(L=b.getChildren().indexOf(K)),b.removeChild(K)):K._dataModel&&L==T&&(L=K._dataModel.getRoots().indexOf(K)),x&&(x.addChild(K),V=x.getChildren().indexOf(K)),delete K._73I,K.fp("parent",b,x,p,{oldIndex:L,newIndex:V}),K.onParentChanged(b,x)}},onParentChanged:function(){},hasChildren:function(){return this._children.size()>0},isEmpty:function(){return this._children.isEmpty()},isRelatedTo:function(p){return p?this.isDescendantOf(p)||p.isDescendantOf(this):!1
},isParentOf:function(i){return i&&this._childMap?!!this._childMap[i._id]:!1},isDescendantOf:function(e){if(!e||e.isEmpty())return!1;for(var w=this._parent;w;){if(e===w)return!0;w=w._parent}return!1},getStyleMap:function(){return this._styleMap},getStyle:function(j,U){U===p&&(U=1);var Y=this._styleMap?this._styleMap[j]:p;return Y===p&&U?y[j]:Y},setStyle:function(k,S){var B=this;B._styleMap||(B._styleMap={});var q=B._styleMap[k];S===p?delete B._styleMap[k]:B._styleMap[k]=S,B.fp("s:"+k,q,S)&&B.onStyleChanged(k,q,S)},onStyleChanged:function(){},iv:function(u){this.invalidate(u)},invalidate:function(P){this.fp(P||"*",!1,!0)},toString:function(){var k=this;return k._displayName||k._name||k._tag||k._id},toLabel:function(){return this._displayName||this._name},addStyleIcon:function(K,U){var x=this,L=x.s(lp);L||x.s(lp,L={}),U?L[K]=U:delete L[K],x.fp(lp,T,L)},removeStyleIcon:function(M){var F=this.s(lp);if(F){var V=F[M];delete F[M],this.fp(lp,T,F)}return V},getSerializableProperties:function(){return{name:1,displayName:1,icon:1,toolTip:1,parent:1,layer:1,tag:1,adjustChildrenToTop:1,dataBindings:1}},getSerializableStyles:function(){var j,n={};for(j in this._styleMap)n[j]=1;return n}});var ih=X.DataModel=function(){var N=this;N._datas=new ep,N._dataMap={},N._roots=new ep,N._rootMap={},N._78O={},N._36I=new ve,N._35I=new ve,N._selectionModel=new Wc(N);var l=N._29Q=[],y=N._scheduleCallback=function(){for(var W=Date.now(),J=0;J<l.length;J++){var U=l[J];U.enabled&&W-U.lastTime>U.interval&&(U.beforeAction&&U.beforeAction(),N.each(function(e){U.action(e)}),U.afterAction&&U.afterAction(),U.lastTime=W)}l.length&&(N._30Q=k.requestAnimationFrame(y))}};zq("DataModel",o,{ms_fire:1,ms_attr:1,ms_ac:["layers","name","autoAdjustIndex","hierarchicalRendering","background","init"],_name:p,_autoAdjustIndex:!0,_hierarchicalRendering:!1,_background:p,_init:p,sm:function(){return this.getSelectionModel()},mm:function(t,n,T){this.addDataModelChangeListener(t,n,T)},umm:function(W,F){this.removeDataModelChangeListener(W,F)},md:function(i,P,A){this.addDataPropertyChangeListener(i,P,A)},umd:function(P,b){this.removeDataPropertyChangeListener(P,b)},mh:function(m,x,j){this.addHierarchyChangeListener(m,x,j)},umh:function(c,w){this.removeHierarchyChangeListener(c,w)},getAttrObject:function(){return this._attrObject},setAttrObject:function(o){return this._attrObject=o},getSelectionModel:function(){return this._selectionModel},size:function(){return this._datas.size()},isEmpty:function(){return this._datas.isEmpty()},getRoots:function(){return this._roots},getDatas:function(){return this._datas},getDataById:function(F){return this._dataMap[F]},removeDataById:function(i){this.remove(this.getDataById(i))},toDatas:function(a,h){return this._datas.toList(a,h)},each:function(W,c){this._datas.each(W,c)},getDataByTag:function(q){return this._78O[q]},getTagMap:function(){return this._78O},removeDataByTag:function(_){this.remove(this.getDataByTag(_))},add:function(E,l,A){var N=this,I=E._id,_=E._tag,b=N._roots;if(N._dataMap[I])throw"'"+I+"' already exists";_!=T&&(N._78O[_]=E),N._dataMap[I]=E,A>=0?N._datas.add(E,A):N._datas.add(E),E._parent||(N._rootMap[I]=E,l>=0?b.add(E,l):b.add(E)),E._21I(N),N.onAdded(E),N._36I.fire({kind:"add",data:E,rootsIndex:l,datasIndex:A})},onAdded:function(){},remove:function(e,P){if(e){var l=this,m=e._id,w=P&&P.keepStructure,Q=P&&P.keepChildren,c=e.getTag();if(e._dataModel===l){this.beginTransaction(),w?l._removingData||(l._removingData=e):l.prepareRemove(e),Q||e.toChildren().each(function($){l.remove($,P)},l),w?l._removingData===e&&(e._parent&&e._parent.removeChild(e),delete l._removingData):e._parent&&e._parent.removeChild(e);var g=l._datas.remove(e);delete l._dataMap[m],c!=T&&delete l._78O[c];var V;l._rootMap[m]&&(delete l._rootMap[m],V=l._roots.remove(e)),e._21I(T),l.onRemoved(e),l._36I.fire({kind:ym,data:e,rootsIndex:V,datasIndex:g}),this.endTransaction()}}},onRemoved:function(){},prepareRemove:function(){},clear:function(){var B=this;if(B._datas.size()){var $=B._historyManager?this.toJSON():p;B._datas.toArray().forEach(function(O){O._21I(T)}),B._datas.clear(),B._dataMap={},B._roots.clear(),B._rootMap={},B._78O={},B._36I.fire({kind:Sb,json:$})}},contains:function(o){return o&&o._dataModel===this},handleDataPropertyChange:function(W){var x=this,N=W.data,X=W.property;if("parent"===X){var y=N._id,o=x._rootMap,U=x._roots;N._parent?o[y]&&(delete o[y],U.remove(N)):o[y]||(o[y]=N,U.add(N))}else if("tag"===X){var f=W.oldValue,M=W.newValue,e=x._78O;f!=T&&delete e[f],M!=T&&(e[M]=N)}this.onDataPropertyChanged(N,W),this._35I.fire(W)},onDataPropertyChanged:function(){},addDataModelChangeListener:function(V,f,Q){this._36I.add(V,f,Q)},removeDataModelChangeListener:function(b,L){this._36I.remove(b,L)},addDataPropertyChangeListener:function(W,L,h){this._35I.add(W,L,h)},removeDataPropertyChangeListener:function(y,w){this._35I.remove(y,w)},_38I:function(v,C,S){this._37I&&this._37I.fire({data:v,oldIndex:C,newIndex:S})},addHierarchyChangeListener:function(r,H,S){this._37I||(this._37I=new ve),this._37I.add(r,H,S)},removeHierarchyChangeListener:function(c,E){this._37I.remove(c,E)},getSiblings:function(b){var q=b._parent;return q?q._children:this._roots},eachByHierarchical:function(S,X,U){if(X)return this._eachByHierarchical(S,X,U);for(var _=0,h=this._roots,m=h.size();m>_;_++)if(this._eachByHierarchical(S,h.get(_),U)===!1)return!1;return!0},_eachByHierarchical:function(i,s,Y){if(Y){if(i.call(Y,s)===!1)return!1}else if(i(s)===!1)return!1;for(var $=s.size(),z=0;$>z;z++)if(this._eachByHierarchical(i,s.getChildAt(z),Y)===!1)return!1;return!0},reverseEachByHierarchical:function(h,t,N){if(t)return this._reverseEachByHierarchical(h,t,N);for(var $=this._roots,u=$.size(),E=u-1;E>=0;E--)if(this._reverseEachByHierarchical(h,$.get(E),N)===!1)return!1;return!0},_reverseEachByHierarchical:function(V,f,d){for(var h=f.size(),Y=h-1;Y>=0;Y--)if(this._reverseEachByHierarchical(V,f.getChildAt(Y),d)===!1)return!1;if(d){if(V.call(d,f)===!1)return!1}else if(V(f)===!1)return!1;return!0},eachByDepthFirst:function(T,u,R){if(u)return this._11I(T,u,R);for(var U=0,v=this._roots,_=v.size();_>U;U++)if(this._11I(T,v.get(U),R)===!1)return!1;return!0},_11I:function(e,E,t){for(var j=E.size(),J=0;j>J;J++)if(this._11I(e,E.getChildAt(J),t)===!1)return!1;if(t){if(e.call(t,E)===!1)return!1}else if(e(E)===!1)return!1;return!0},eachByBreadthFirst:function(r,H,$){var h=new ep;for(H?h.add(H):this._roots.each(h.add,h);h.size()>0;)if(H=h.removeAt(0),H.eachChild(h.add,h),$){if(r.call($,H)===!1)return!1}else if(r(H)===!1)return!1;return!0},moveTo:function(y,K){var $=this.getSiblings(y),j=$.indexOf(y);j===K||0>j||K>=0&&K<=$.size()&&($.remove(y),K>$.size()&&K--,$.add(y,K),this._38I(y,j,K))},moveUp:function(t){this.moveTo(t,this.getSiblings(t).indexOf(t)-1)},moveDown:function(O){this.moveTo(O,this.getSiblings(O).indexOf(O)+1)},moveToTop:function(E){this.moveTo(E,0)},moveToBottom:function(Q){this.moveTo(Q,this.getSiblings(Q).size())},moveSelectionUp:function(v){this.beginTransaction(),v||(v=this.sm());var t=new ep;sr(v,t,this._roots),t.each(this.moveUp,this),this.endTransaction()},moveSelectionDown:function(R){this.beginTransaction(),R||(R=this.sm());var c=new ep;Fh(R,c,this._roots),c.each(this.moveDown,this),this.endTransaction()},moveSelectionToTop:function($){this.beginTransaction(),$||($=this.sm());var I=new ep;pb($,I,this._roots),I.each(this.moveToTop,this),this.endTransaction()},moveSelectionToBottom:function(w){this.beginTransaction(),w||(w=this.sm());var e=new ep;Tm(w,e,this._roots),e.each(this.moveToBottom,this),this.endTransaction()},moveToIndex:function(Q,e,V){var B=this.getDatas();null==V&&(V=B.indexOf(Q)),V===e||0>V||e>=0&&e<=B.size()&&(B.remove(Q),e>B.size()&&e--,B.add(Q,e),this._76I(Q,V,e))},bringForward:function(P){this.moveToIndex(P,this.getDatas().indexOf(P)+1)},bringToFront:function(Q){this.moveToIndex(Q,this.size())},sendBackward:function(w){this.moveToIndex(w,this.getDatas().indexOf(w)-1)},sendToBack:function(a){this.moveToIndex(a,0)},bringSelectionForward:function(N){this.beginTransaction(),N||(N=this.sm());for(var M=new ep,g=this.getDatas(),L=!1,u=0;u<g.size();u++){var t=g.get(g.size()-1-u);N.contains(t)?L&&M.add(t):L=!0}M.each(this.bringForward,this),this.endTransaction()},bringSelectionToFront:function(Y){this.beginTransaction(),Y||(Y=this.sm());for(var D=new ep,A=this.getDatas(),j=0;j<A.size();j++){var m=A.get(j);Y.contains(m)&&D.add(m)}D.each(this.bringToFront,this),this.endTransaction()},sendSelectionBackward:function(O){this.beginTransaction(),O||(O=this.sm());for(var A=new ep,E=this.getDatas(),G=!1,t=0;t<E.size();t++){var k=E.get(t);O.contains(k)?G&&A.add(k):G=!0}A.each(this.sendBackward,this),this.endTransaction()},sendSelectionToBack:function(O){this.beginTransaction(),O||(O=this.sm());for(var Q=new ep,m=this.getDatas(),N=0;N<m.size();N++){var f=m.get(m.size()-1-N);O.contains(f)&&Q.add(f)}Q.each(this.sendToBack,this),this.endTransaction()},addScheduleTask:function(f){var y=this;y.removeScheduleTask(f),f.enabled==T&&(f.enabled=!0),f.interval==T&&(f.interval=10),f.action==T&&(f.action=Qc),f.lastTime=Date.now(),y._29Q.push(f),y._30Q==T&&(y._30Q=k.requestAnimationFrame(y._scheduleCallback))},removeScheduleTask:function(A){var p=this,H=p._29Q,S=H.indexOf(A);S>=0&&H.splice(S,1),H.length||p._30Q==T||(k.cancelAnimationFrame(p._30Q),delete p._30Q)},getHistoryManager:function(){return this._historyManager},enableHistoryManager:function(J){this._historyManager||new X.HistoryManager(this),null!=J&&this._historyManager.setMaxHistoryCount(J),this._historyManager.setDisabled(!1)},disableHistoryManager:function(){this._historyManager&&this._historyManager.setDisabled(!0)},clearHistoryManager:function(){this._historyManager&&this._historyManager.clear()},undo:function(a){this._historyManager&&this._historyManager.undo(a)},redo:function(x){this._historyManager&&this._historyManager.redo(x)},beginTransaction:function(){this._historyManager&&this._historyManager.beginTransaction()},endTransaction:function(){this._historyManager&&this._historyManager.endTransaction()},addHistory:function(C){this._historyManager&&this._historyManager.addHistory(C)},onHistoryManagerChanged:function(){}});var Wc=X.SelectionModel=function($){var j=this;j._68O=so,j._map={},j._73O=new ep,j._74I=new ve,j._21I($)};zq("SelectionModel",o,{ms_fire:1,ms_dm:1,ms:function(i,e,h){this.addSelectionChangeListener(i,e,h)},ums:function(K,b){this.removeSelectionChangeListener(K,b)},fd:function(){return this.getFirstData()},ld:function(){return this.getLastData()},sg:function(){return this._68O===Hm},co:function(Q){return this._map[Q._id]!=T},ss:function(O){this.setSelection(O)},as:function(F){this.appendSelection(F)},rs:function(r){this.removeSelection(r)},cs:function(){this.clearSelection()},sa:function(){this.selectAll()},getSelectionMode:function(){return this._68O},setSelectionMode:function(z){var N=this;if(N._68O!==z&&(z===$r||z===Hm||z===so)){N.cs();var y=N._68O;N._68O=z,N.fp("selectionMode",y,z)}},_21I:function(d){var g=this,X=g._dataModel;X!==d&&(X&&(g.cs(),X.umm(g.handleDataModelChange,g)),g._dataModel=d,d.mm(g.handleDataModelChange,g,!0),g.fp(Uo,X,d))},dispose:function(){var z=this;z.cs(),z._dataModel.umm(z.handleDataModelChange,z)},handleDataModelChange:function(a){var D=this;if(a.kind===ym){var e=a.data;D.co(e)&&(D._73O.remove(e),delete D._map[e._id],D._75I(ym,new ep(e)))}else a.kind===Sb&&D.cs()},getFilterFunc:function(){return this._filterFunc},setFilterFunc:function(Z){var q=this;if(q._filterFunc!==Z){q.cs();var V=q._filterFunc;q._filterFunc=Z,q.fp("filterFunc",V,q._filterFunc)}},_75I:function(U,h,G,D){G&&(this._73O.each(function(g){D[g._id]?G.remove(g):G.add(g)}),h=G.toList()),this._74I.fire({kind:U,datas:new ep(h)})},addSelectionChangeListener:function(D,W,b){this._74I.add(D,W,b)},removeSelectionChangeListener:function(L,W){this._74I.remove(L,W)},_97O:function(A,S){for(var O,y=this,H=0,h=new ep(A);H<h.size();H++)O=h.get(H),(y._filterFunc&&!y._filterFunc(O)||S&&y.co(O)||!S&&!y.co(O)||!y._dataModel.contains(O))&&(h.removeAt(H),H--);return h},appendSelection:function(F){var b=this;if(b._68O!==$r){var J,d,s=b._73O,K=b._97O(F,!0);K.isEmpty()||(b.sg()&&(J=new ep(s),d=b._map,s.clear(),b._map={},K=new ep(K.get(K.size()-1))),K.each(function(e){s.add(e),b._map[e._id]=e}),b._75I("append",K,J,d))}},removeSelection:function(w){var C=this,_=C._97O(w),F=0,Z=_.size();if(0!==Z){for(;Z>F;F++){var d=_.get(F);C._73O.remove(d),delete C._map[d._id]}C._75I(ym,_)}},toSelection:function(y,x){return this._73O.toList(y,x)},getSelection:function(){return this._73O},each:function(M,k){this._73O.each(M,k)},setSelection:function(G){var V=this,M=V._73O;if(V._68O!==$r&&!(M.isEmpty()&&!G||1===M.size()&&V.ld()===G)){var I=new ep(M),U=V._map;M.clear(),V._map={};var e=V._97O(G,!0);V.sg()&&e.size()>1&&(e=new ep(e.get(e.size()-1))),e.each(function(_){M.add(_),V._map[_._id]=_}),V._75I("set",T,I,U)}},clearSelection:function(){var J=this,i=J._73O;if(i.size()>0){var F=i.toList();i.clear(),J._map={},J._75I(Sb,F)}},selectAll:function(){var e=this;if(e._68O!==$r){var h,a,R=e._dataModel.toDatas();if(e._filterFunc)for(h=0;h<R.size();h++)a=R.get(h),e._filterFunc(a)||(R.removeAt(h),h--);var J=e._73O,Y=new ep(J),o=e._map;J.clear(),e._map={},e.sg()&&R.size()>1&&(R=new ep(R.get(R.size()-1)));var N=R.size();for(h=0;N>h;h++)a=R.get(h),J.add(a),e._map[a._id]=a;e._75I("all",T,Y,o)}},size:function(){return this._73O.size()},isEmpty:function(){return this._73O.isEmpty()},contains:function(w){return this._map[w._id]!=T},getLastData:function(){var n=this._73O;return n.size()>0?n.get(n.size()-1):T},getFirstData:function(){var Z=this._73O;return Z.size()>0?Z.get(0):T},isSelectable:function(y){var t=this;return y&&t._68O!==$r?t._filterFunc?t._filterFunc(y):!0:!1},getTopSelection:function(){var G=this,C=new ep;return G._73O.each(function(L){for(var q=L.getParent();q;){if(G.contains(q)){L=T;break}q=q.parent}L&&C.add(L)}),C}});var Wk=function(){return Xq(0),function(h,t){var u;if(kq(t)){var f=h.getDataUI(t);f&&f._88I&&(u=f._88I.rect)}return u?u:t.getRect()}}();Rl(j,{edgeGroupAgentFunc:T,graphViewAutoScrollZone:16,graphViewResettable:!1,graphViewPannable:!0,graphViewRectSelectable:!0,graphViewScrollBarVisible:!0,graphViewRectSelectBorderColor:b.rectSelectBorder,graphViewRectSelectBackground:zg,graphViewEditPointSize:Rp?17:7,graphViewEditPointBorderColor:b.editPointBorder,graphViewEditPointBackground:b.editPointBackground,setEdgeType:function(O,e,p){rl[O]=e,wp[O]=p},getEdgeType:function(o){return rl[o]},getEdgeTypeMap:function(){return rl},getNodeRect:Wk},!0),Rl(y,{"2d.selectable":!0,"2d.visible":!0,"2d.movable":!0,"2d.editable":!0,"2d.move.mode":p,interactive:!1,"image.stretch":"fill",icons:p,ingroup:!0,"body.color":p,opacity:p,pixelPerfect:!0,"clip.direction":"top","clip.percentage":1,"select.color":tp,"select.width":1,"select.padding":2,"select.type":Lj,shadow:!1,"shadow.blur":6,"shadow.offset.x":3,"shadow.offset.y":3,"border.color":p,"border.width":2,"border.padding":2,"border.type":Lj,label:p,"label.font":p,"label.color":aq,"label.background":p,"label.position":31,"label.position.fixed":!1,"label.offset.x":0,"label.offset.y":2,"label.rotation":p,"label.max":p,"label.opacity":p,"label.scale":1,"label.align":p,"label.selectable":!0,label2:p,"label2.font":p,"label2.color":aq,"label2.background":p,"label2.position":34,"label2.position.fixed":!1,"label2.offset.x":0,"label2.offset.y":-2,"label2.rotation":p,"label2.max":p,"label2.opacity":p,"label2.scale":1,"label2.align":p,"label2.selectable":!0,note:p,"note.expanded":!0,"note.font":p,"note.color":Ph,"note.background":tp,"note.position":8,"note.offset.x":-3,"note.offset.y":3,"note.max":p,"note.toggleable":!0,"note.border.width":1,"note.border.color":p,"note.opacity":p,"note.scale":1,"note.align":p,note2:p,"note2.expanded":!0,"note2.font":p,"note2.color":Ph,"note2.background":tp,"note2.position":3,"note2.offset.x":3,"note2.offset.y":-3,"note2.max":p,"note2.toggleable":!0,"note2.border.width":1,"note2.border.color":p,"note2.opacity":p,"note2.scale":1,"note2.align":p,"group.type":p,"group.image":p,"group.image.stretch":"fill","group.repeat.image":p,"group.padding":8,"group.padding.left":0,"group.padding.right":0,"group.padding.top":0,"group.padding.bottom":0,"group.position":17,"group.toggleable":!0,"group.title.font":p,"group.title.color":Ph,"group.title.background":b.groupTitleBackground,"group.title.align":ud,"group.background":b.groupBackground,"group.depth":1,"group.border.width":1,"group.border.pattern":p,"group.border.color":wg,"group.border.cap":ff,"group.border.join":xb,"group.gradient":T,"group.gradient.color":"#FFF",shape:p,"shape.background":wg,"shape.repeat.image":p,"shape.border.width":0,"shape.border.width.absolute":!1,"shape.border.color":wg,"shape.border.3d":!1,"shape.border.3d.color":p,"shape.border.3d.accuracy":p,"shape.border.cap":ff,"shape.border.join":xb,"shape.border.pattern":p,"shape.gradient":T,"shape.gradient.color":"#FFF","shape.depth":0,"shape.dash":!1,"shape.dash.pattern":fe,"shape.dash.offset":0,"shape.dash.color":Tb,"shape.dash.width":p,"shape.dash.3d":!1,"shape.dash.3d.color":p,"shape.dash.3d.accuracy":p,"shape.polygon.side":6,"shape.arc.from":B,"shape.arc.to":u,"shape.arc.close":!0,"shape.arc.oval":!1,"shape.corner.radius":p,"shape.gradient.pack":p,"shape.fill.rule":"nonzero","shape.fill.clip.direction":"top","shape.fill.clip.percentage":1,"autolayout.gap":p,"autolayout.hgap":p,"autolayout.vgap":p,"edge.type":p,"edge.points":p,"edge.segments":p,"edge.color":wg,"edge.width":2,"edge.width.absolute":!1,"edge.offset":20,"edge.group":0,"edge.expanded":!0,"edge.gap":12,"edge.toggleable":!0,"edge.center":!1,"edge.3d":!1,"edge.3d.color":p,"edge.3d.accuracy":p,"edge.cap":ff,"edge.join":xb,"edge.source.position":17,"edge.source.anchor.x":p,"edge.source.anchor.y":p,"edge.source.offset.x":0,"edge.source.offset.y":0,"edge.target.position":17,"edge.target.anchor.x":p,"edge.target.anchor.y":p,"edge.target.offset.x":0,"edge.target.offset.y":0,"edge.pattern":p,"edge.dash":!1,"edge.dash.pattern":fe,"edge.dash.offset":0,"edge.dash.color":Tb,"edge.dash.width":p,"edge.dash.3d":!1,"edge.dash.3d.color":p,"edge.dash.3d.accuracy":p,"edge.independent":!1,"attach.row.index":0,"attach.column.index":0,"attach.row.span":1,"attach.column.span":1,"attach.padding":0,"attach.padding.left":0,"attach.padding.right":0,"attach.padding.top":0,"attach.padding.bottom":0,"attach.index":-1,"attach.offset":0,"attach.offset.relative":!1,"attach.offset.opposite":!1,"attach.thickness":p,"attach.gap":0,"attach.gap.relative":!1,"grid.row.count":1,"grid.column.count":1,"grid.row.percents":p,"grid.column.percents":p,"grid.border":1,"grid.border.left":0,"grid.border.right":0,"grid.border.top":0,"grid.border.bottom":0,"grid.gap":1,"grid.background":b.gridBackground,"grid.depth":1,"grid.cell.depth":-1,"grid.cell.border.color":b.gridCellBorderColor,"grid.block":p,"grid.block.padding":3,"grid.block.width":1,"grid.block.color":b.gridBlockColor,text:"","text.align":"left","text.vAlign":"middle","text.color":aq,"text.font":Bk,"text.shadow":!1,"text.shadow.color":go,"text.shadow.blur":6,"text.shadow.offset.x":3,"text.shadow.offset.y":3},!0),Rl(ih,{_76I:function(h,f,W){this._39I&&this._39I.fire({data:h,oldIndex:f,newIndex:W})},addIndexChangeListener:function(v,K,W){var G=this;G._39I||(G._39I=new ve),G._39I.add(v,K,W)},removeIndexChangeListener:function(g,T){this._39I.remove(g,T)},prepareRemove:function(k){le(k)&&(k.setSource(T),k.setTarget(T)),k._70O&&k._70O.toList().each(this.remove,this),k._69O&&k._69O.toList().each(function(Q){Q.setHost(T)}),k._host&&k.setHost(T)},onAdded:function(l){this.isAutoAdjustIndex()&&this.adjustIndex(l)},onDataPropertyChanged:function(P,g){pf[g.property]&&this.isAutoAdjustIndex()&&this.adjustIndex(P)},isAdjustable:function(h){return ng(h)||le(h)},isAdjustedToBottom:function(b){return vh(b)?b.isExpanded()&&Tn(b):!1},adjustIndex:function(c){var R=this;this.isHierarchicalRendering()||(R.isAdjustedToBottom(c)?(R.sendToBottom(c),c.eachChild(R.adjustIndex,R)):R.sendToTop(c))},sendToTop:function(b){var d=this;if(d.contains(b)&&d.isAdjustable(b)){var Z=d._datas;if(b!==Z.get(d.size()-1)){var Y=Z.indexOf(b);Z.removeAt(Y),Z.add(b),d._76I(b,Y,d.size()-1)}if(le(b)){var T=b._40I;T&&!d.isAdjustedToBottom(T)&&d.sendToTop(T),T=b._41I,T&&!d.isAdjustedToBottom(T)&&d.sendToTop(T)}b._69O&&b._69O.each(function($){$.isRelatedTo(b)||ng(b)&&$.isLoopedHostOn(b)||d.sendToTop($)}),b.ISubGraph||(!vh(b)||b.isExpanded())&&b._adjustChildrenToTop&&b.eachChild(function(O){le(O)||d.sendToTop(O)})}},sendToBottom:function(e,z){var D=this;if(e!==z&&D.contains(e)&&D.isAdjustable(e)&&(!z||D.contains(z))){var u=D._datas,W=u.remove(e),C=z?D._datas.indexOf(z):0;if(u.add(e,C),W!==C){D._76I(e,W,C);var $=e._parent;!$||$.ISubGraph||le($)||D.sendToBottom(e._parent,e)}}}}),Rl(Vl,{ms_edit:function(C){C._46O=function(F){var d=this,n=d.gv.dm(),H=d._index,u=d._89I,$=d._node,t=d._shape,X=d._edge,y=d._77I;$&&u?(this.fi({kind:"endEditRect",event:F,data:$,direction:u}),n.endTransaction()):t&&H>=0?(d.fi({kind:"endEditPoint",event:F,data:t,index:H}),n.endTransaction()):X&&H>=0?(d.fi({kind:"endEditPoint",event:F,data:X,index:H}),n.endTransaction()):y&&(d.fi({kind:"endEditRotation",event:F,data:y}),n.endTransaction())},C._78I=function(x){var K=this;K.autoScroll(x);var Q=K.gv.lp(x),s=K._index,r=K._89I,D=K._node,k=K._shape,Z=K._edge,L=K._77I;if(D&&r)K._80O(Q),K.fi({kind:"betweenEditRect",event:x,data:D,direction:r});else if(k&&s>=0)Q.e=k.getPoints().get(s).e,k.setPoint(s,Q),K.fi({kind:"betweenEditPoint",event:x,data:k,index:s});else if(Z&&s>=0){var P=Z.s(Ur);Q.e=P.get(s).e,P.set(s,Q),Z.fp(Ur,T,P),K.fi({kind:"betweenEditPoint",event:x,data:Z,index:s})}else if(L){var X=L.p(),C=L.getScale(),_=f+g(Q.y-X.y,Q.x-X.x);C.y<0&&(_+=B),J(_)<.04&&(_=0),L.setRotation(_),K.fi({kind:"betweenEditRotation",event:x,data:L})}},C._80O=function(_){var L=this,E=L._node,Q=L._rect,O=Q.x,X=Q.y,g=Q.width,t=Q.height,v=L._89I,R=L._anchor,s=L._matrix,_=s.tfi(_);"northwest"===v?Q=Zc(_,{x:O+g,y:X+t}):v===Fm?Q=Zc({x:O,y:_.y},{x:O+g,y:X+t}):"northeast"===v?Q=Zc({x:O,y:_.y},{x:_.x,y:X+t}):v===Qd?Q=Zc({x:_.x,y:X},{x:O+g,y:X+t}):v===Oq?Q=Zc({x:O,y:X},{x:_.x,y:X+t}):"southwest"===v?Q=Zc({x:_.x,y:X},{x:O+g,y:_.y}):"south"===v?Q=Zc({x:O,y:X},{x:O+g,y:_.y}):"southeast"===v&&(Q=Zc({x:O,y:X},_)),E.setPosition(s.tf(Q.x+Q.width*R.x,Q.y+Q.height*R.y)),E.setWidth(Q.width),E.setHeight(Q.height)},C._80I=function(R,S,o,K){var w=this,I=w.gv._zoom,e=(w.gv.getEditPointSize()+2)/I;return Co({x:S-e/2,y:o-e/2,width:e,height:e},R)?(w._89I!==K&&(w._89I=K),!0):!1},C._79I=function(J,n,Z){var V=this,g=V.gv,C=n?g.getDataUI(n):T,j=C?C._55O:T;if(j){var H,c,f,R,p=g._zoom,$=(g.getEditPointSize()+2)/p,G=g.lp(J);if(ng(n)){if(j._56O&&ng(n)&&(c=j._98o,Co({x:c.x-$/2,y:c.y-$/2,width:$,height:$},G)))return V._77I=n,Z&&V.fi({kind:"beginEditRotation",event:J,data:n}),V.setCursor("crosshair"),!0;if(j._43O&&n instanceof ah)for(f=n.getPoints(),H=f.size()-1;H>=0;H--)if(c=f.get(H),Co({x:c.x-$/2,y:c.y-$/2,width:$,height:$},G))return V._index=H,V._shape=n,Z&&V.fi({kind:"beginEditPoint",event:J,data:n,index:H}),V.setCursor("crosshair"),!0;if(j._42O)for(var s=n.getEditControlPoints(),M=["northwest",-1,-1,Qd,-1,0,"southwest",-1,1,"south",0,1,"southeast",1,1,Oq,1,0,"northeast",1,-1,Fm,0,-1],H=0,R=s.length;R>H;H++){var v=M[3*H],W=s[H];if(V._80I(G,W.x,W.y,v)){V._node=n;var m=n.getWidth(),D=n.getHeight(),X=n.getAnchor();V._rect={x:-m*X.x,y:-D*X.y,width:m,height:D},V._anchor=X,V._matrix=n.getMatrix();var y=n.getRotation(),q=A(y),a=L(y),d=M[3*H+1]*me(n.getScale().x),i=M[3*H+2]*me(n.getScale().y),B=Math.atan2(-a*d-q*i,q*d-a*i),t=(Math.round(B/(Math.PI/4))+8)%8,x=[pq,"nesw-resize",Re,"nwse-resize",pq,"nesw-resize",Re,"nwse-resize"][t];return V.setCursor(x),Z&&V.fi({kind:"beginEditRect",event:J,data:n,direction:V._89I}),!0}}}if(j._43O&&le(n)&&n.s(Dc)===lq&&(f=n.s(Ur)))for(H=f.size()-1;H>=0;H--)if(c=f.get(H),Co({x:c.x-$/2,y:c.y-$/2,width:$,height:$},G))return V._index=H,V._edge=n,Z&&V.fi({kind:"beginEditPoint",event:J,data:n,index:H}),V.setCursor("crosshair"),!0}return!1}},ms_gv:function(P){P._currentSubGraph=T,P.upSubGraph=function(){this.setCurrentSubGraph(Cf(this._currentSubGraph))},P.isVisible=function(F){var z=this;if(Cf(F)!==z._currentSubGraph)return!1;if(le(F)){var m=F._40I,C=F._41I;if(!m||!C)return!1;if(!(F.s("edge.independent")||z.isVisible(m)&&z.isVisible(C)))return!1;if(F.isEdgeGroupHidden())return!1}else for(var E=F._parent;E&&!E.ISubGraph;){if(vh(E)&&(!E.isExpanded()||!z.isVisible(E)))return!1;E=E._parent}if(F._parent instanceof Hr&&!z.isVisible(F._parent))return!1;if(F._refGraph instanceof Jg&&!z.isVisible(F._refGraph))return!1;if(z instanceof ip){if(!F.s("3d.visible"))return!1}else{var X=z.getLayersInfo();if(X){var U=X[F._layer];if(U&&U.visible===!1)return!1}if(!F.s("2d.visible"))return!1}return z._visibleFunc?z._visibleFunc(F):!0},P.handleSelectionChange=function(A){var u=this;A.datas.each(function(k){u.invalidateData(k);var Q=k._parent;vh(Q)&&ng(k)&&k.s(rc)&&(u.invalidateData(Q),Q._49I&&Q._49I.each(function(U){u.invalidateData(U)}))}),u.onSelectionChanged(A)},P.onSelectionChanged=function(g){var C=this,A=C.sm();if(1===A.size()&&("set"===g.kind||"append"===g.kind)){var z=A.ld();C.isAutoMakeVisible()&&C.makeVisible(z),C.adjustIndex&&C._dataModel.isAutoAdjustIndex()&&C.adjustIndex(z)}},P.makeVisible=function(_){if(_){var s=this,d=s.getDataUI?s.getDataUI(_):s.getData3dUI(_);if(d){var w=_,I=Cf(_);for(I!==s._currentSubGraph&&s.setCurrentSubGraph(I);(w=w._parent)&&w!==I;)vh(w)&&w.setExpanded(!0);s._23I=_,s.iv()}}},P.getLabel=function(Z){var z=Z.getStyle(as);return z===p?Z.getName():z},P.getLabelBackground=function(u){return u.getStyle("label.background")},P.getLabelColor=function(M){return M.getStyle("label.color")},P.getLabel2=function(W){return W.getStyle("label2")},P.getLabel2Background=function(C){return C.getStyle("label2.background")},P.getLabel2Color=function(Z){return Z.getStyle("label2.color")},P.getNote=function(u){return u.getStyle(ys)},P.getNoteBackground=function(Z){return Z.getStyle("note.background")},P.getNote2=function(f){return f.getStyle(af)},P.getNote2Background=function(t){return t.getStyle("note2.background")},P.handleClick=function(W,A,v){var b=this;A?(b.fi({kind:"clickData",event:W,data:A,part:v}),b.onDataClicked(A,W)):(b.fi({kind:"clickBackground",event:W}),b.onBackgroundClicked(W))},P.handleDoubleClick=function(x,y,L){var v=this;Mf(x)&&(y?(v.fi({kind:"doubleClickData",event:x,data:y,part:L}),v.onDataDoubleClicked(y,x,L),v.checkDoubleClickOnNote(x,y,L)||v.checkDoubleClickOnRotation&&v.checkDoubleClickOnRotation(x,y,L)||(le(y)?v.onEdgeDoubleClicked(y,x,L):y.ISubGraph?v.onSubGraphDoubleClicked(y,x,L):vh(y)?v.onGroupDoubleClicked(y,x,L):y.IDoorWindow?v.onDoorWindowDoubleClicked(y,x,L):y.ICSGBox&&v.onCSGBoxDoubleClicked(y,x,L))):(v.fi({kind:"doubleClickBackground",event:x}),v.onBackgroundDoubleClicked(x)))},P.onSubGraphDoubleClicked=function(J){this.setCurrentSubGraph(J)},P.onEdgeDoubleClicked=function(t,r){t.ISubGraph&&!Jf(r)?this.setCurrentSubGraph(t):t.s("edge.toggleable")&&t.toggle()},P.onGroupDoubleClicked=function(X){X.s("group.toggleable")&&X.toggle()},P.onDoorWindowDoubleClicked=function(K){K.s("dw.toggleable")&&K.toggle(!0)},P.onCSGBoxDoubleClicked=function(M,o){var f=this;if(f instanceof ip){var a=f.getHitFaceInfo(o);a&&a.face&&M.s(a.face+".toggleable")&&M.toggleFace(a.face,!0)}},P.onBackgroundClicked=function(){},P.onBackgroundDoubleClicked=function(){this.upSubGraph()},P.onDataClicked=function(){},P.onDataDoubleClicked=function(){},P.onAutoLayoutEnded=function(){},P.onMoveEnded=function(){},P.onPanEnded=function(){},P.onPinchEnded=function(){},P.onRectSelectEnded=function(){},P.onZoomEnded=function(){}},ms_icons:function(u){u.getRotation=function(Y){return Y==T?0:Y},u._15O=function(){var d=this,J=d.s(lp);if(J){var y=d,n=d.data||d._data,c=d._38o={icons:J,rects:{}};for(var Y in J){var V=J[Y],M=Aq(V.shape3d,n,y);if(!(Aq(V.visible,n,y)===!1||Aq(V.for3d,n,y)&&!d.I3d||M&&!d.I3d)){var U=M?[M]:Aq(V.names,n,y),H=U?U.length:0,C=Aq(V.position,n,y)||3,N=Aq(V.offsetX,n,y)||0,x=Aq(V.offsetY,n,y)||0,s=Aq(V.direction,n,y)||Oq,X=Aq(V.gap,n,y),w=X!=T?X:1,z=Aq(V.rotation,n,y),R=Aq(V.keepOrien,n,y),l=Aq(V.rotationFixed,n,y)?z:d.getRotation(z,R,C),W=T,Q=c.rects[Y]=new Array(H);Q.rotation=l;for(var G=0;H>G;G++){var $,v,g,q,t=U[G];if(M)g=0,q=0;else{var B=dq(t);g=Aq(V.width,n,y),q=Aq(V.height,n,y),g==T&&(g=mc(B,n)),q==T&&(q=lh(B,n))}if(W?s===Oq?N+=g/2:s===Qd?N-=g/2:s===Fm?x-=q/2:x+=q/2:W={width:g,height:q},d.I3d){var _=-g/2,L=-q/2;v={width:g,height:q,mat:d._16O(Aq(V.autorotate,n,y),C,W,Aq(V.face,n,y)||Am,Aq(V.t3,n,y),Aq(V.r3,n,y),Aq(V.rotationMode,n,y),N,x),vs:new Cj([_,-L,0,_,-L-q,0,_+g,-L-q,0,_+g,-L,0])}}else $=d.getPosition(C,N,x,W,Aq(V.positionFixed,n,y)),v={x:$.x-g/2,y:$.y-q/2,width:g,height:q},d._68o(v,l);Q[G]=v,s===Oq?N+=g/2+w:s===Qd?N-=g/2+w:s===Fm?x-=q/2+w:x+=q/2+w}}}}}}});var Wr={1:1,2:1,6:1,9:1,10:1,14:1,15:1,16:1,21:1,22:1,26:1,29:1,30:1,34:1,36:1,38:1,40:1,42:1,45:1,50:1,52:1,54:1},tr={3:1,7:1,11:1,17:1,23:1,27:1,31:1,44:1,46:1,47:1,49:1},Bg={translateX:1,translateY:1,zoom:1,scrollBarVisible:1},pf={sourceAgent:1,targetAgent:1,expanded:1,parent:1,host:1},us={position:1,width:1,height:1,expanded:1,rotation:1,anchor:1,scale:1,"s:edge.points":1},ho={"edge.type":1,"edge.group":1},Yn={rotation:1,rotationX:1,rotationZ:1},Ie={position:1,width:1,height:1,anchor:1,scale:1,"s:grid.row.count":1,"s:grid.column.count":1,"s:grid.row.percents":1,"s:grid.column.percents":1,"s:grid.border":1,"s:grid.border.left":1,"s:grid.border.right":1,"s:grid.border.top":1,"s:grid.border.bottom":1,"s:grid.gap":1},cj={"attach.row.index":1,"attach.column.index":1,"attach.row.span":1,"attach.column.span":1,"attach.padding":1,"attach.padding.left":1,"attach.padding.right":1,"attach.padding.top":1,"attach.padding.bottom":1,"attach.index":1,"attach.offset":1,"attach.offset.relative":1,"attach.offset.opposite":1,"attach.gap":1,"attach.gap.relative":1,"attach.thickness":1},fm={shape:1,thickness:1,position:1,anchor:1,scale:1},Ce=function(o,H){if(!o||!vh(H)||H.isEmpty())return!1;for(o=o._parent;vh(o);){if(o===H)return!0;o=o._parent}return!1},uh=function(C,G){if(!C||!Vm(G)||G.isEmpty())return!1;for(C=C._parent;Vm(C);){if(C===G)return!0;C=C._parent}return!1},Cf=function(V){if(!V)return T;if(le(V)){var b=V._40I,E=V._41I;if(!b||!E)return T;var R=Cf(b),n=Cf(E);return R===n?R:T}for(var k=V._parent;le(k)&&!k.ISubGraph;)k=k._parent;return k?k.ISubGraph?k:Cf(k):T},Ug=function(X,W,c,b){var O=W.getStyle(c)*b;O&&fn(X,O),O=W.getStyle(c+".left")*b,O&&(X.x-=O,X.width+=O),O=W.getStyle(c+".right")*b,O&&(X.width+=O),O=W.getStyle(c+".top")*b,O&&(X.y-=O,X.height+=O),O=W.getStyle(c+".bottom")*b,O&&(X.height+=O),X.width<0&&(X.width=-X.width,X.x-=X.width),X.height<0&&(X.height=-X.height,X.y-=X.height)},Tn=function(F){for(var f,p=0,D=F.size();D>p;p++)if(f=F.getChildAt(p),ng(f)&&Tn(f))return!0;return F.hasAgentEdges()},xd=function(m){if(!m)return T;for(var Y=m._parent;vh(Y);){if(!vh(Y._parent))return Y.isExpanded()?m:Y;Y.isExpanded()||(m=Y),Y=Y._parent}return m},Wq=function(N,R){if(!N||!R)return T;var w,G,M,P=Cf(N),j=Cf(R);if(P!==j){for(;j&&P!==j;)j=Cf(j);if(P===j)return N;w=new ep,w.add(N,0);for(var B=N._parent;ng(B)&&!R.isDescendantOf(B);)w.add(B,0),B=B._parent;for(M=w.size(),G=0;M>G;G++){var l=w.get(G);if(vh(l)&&!l.isExpanded())return l;if(l.ISubGraph)return l}return N}return N},yn=function(O){if(O.isLooped())return O._source;var i=xd(O._source),j=xd(O._target);return i===j?O._source:Wq(i,j)},Yq=function(t){if(t.isLooped())return t._target;var Z=xd(t._source),R=xd(t._target);return Z===R?t._target:Wq(R,Z)},Ec=function(W,u,R,b,i,O,Y){if(!u)return T;var V,Z=u.getRotation?u.getRotation():0;if(O!==p||Y!==p)if(O=O===p?.5:O,Y=Y===p?.5:Y,Z&&!kq(u,W)){var q=u.getPosition(),v=u.getWidth(),r=u.getHeight(),w=u.getAnchor(),m=u.getScale(),J=new gh(Z,q.x,q.y,m.x,m.y);R=J.tf((O-w.x)*v,(Y-w.y)*r)}else V=Wk(W,u),R={x:V.x+O*V.width,y:V.y+Y*V.height};else R=eg(R,Wk(W,u));if(Z){var $=A(Z),h=L(Z),U=b*$-i*h;i=b*h+i*$,b=U
}return R.x+=b,R.y+=i,R},kc=function(Z,_){if(!Z||!_)return T;var Q,f,J,M,H,v;if(Z===_){if(M=Z.getLoopedEdges(),!M)return T;M=new ep(M)}else{if(H=Z.getAgentEdges(),v=_.getAgentEdges(),!H||!v)return T;for(f=H.size(),Q=0;f>Q;Q++)J=H.get(Q),v.contains(J)&&(M||(M=new ep),M.add(J))}if(M)for(Q=0;Q<M.size();Q++)J=M.get(Q),J.getStyle(Dc)===lq&&(J._22I(T),M.removeAt(Q),Q--);return M},hs=function(Q,g){var P=kc(Q,g);if(P&&!P.isEmpty()){if(1===P.size())return P.get(0)._22I(T),void 0;var _=new ep,E=new ep;P.each(function(v){var h=v.s("edge.group");_.contains(h)||_.add(h)}),_.sort(),_.each(function(r){E.add(new X.EdgeGroup(P.toList(function(t){return r===t.s("edge.group")}),E))}),E.each(function(v){v.each(function(m){m._22I(v)})})}},Nq=function(X,s){if(s){var g=s.rect,U=s.color,x=s.rotation,O=s.labelWidth,m=s.background,h=s.opacity,l=s.scale,$=l!=T&&1!==l;if(h!=T){var p=X.globalAlpha;X.globalAlpha*=h}if(x||$){X.save();var N=g.x+g.width/2,j=g.y+g.height/2;Pc(X,N,j),x&&js(X,x),$&&X.scale(l,l),Pc(X,-N,-j)}if(m&&eo(X,g.x,g.y,g.width,g.height,m),O){var C=g.width,G=X.createLinearGradient(g.x,g.y,g.x+C,g.y);G.addColorStop(0,U),G.addColorStop(.9,U),G.addColorStop(1,Zj),U=G,g.width=O}Un(X,s.ss,g,s.font,U,s.align),O&&(g.width=C),(x||$)&&X.restore(),h!=T&&(X.globalAlpha=p)}},bp=function(t,e){if(e){var b=e.rect,X=b.x,x=b.y,n=b.width,H=b.height,G=e.background,O=e.backgroundImage,K=e.borderWidth,L=e.borderColor,Q=e.labelWidth,o=e.opacity,R=e.scale,w=R!=T&&1!==R;if(o!=T){var A=t.globalAlpha;t.globalAlpha*=o}if(w){t.save();var j=b.x+b.width/2,N=b.y+b.height/2;Pc(t,j,N),t.scale(R,R),Pc(t,-j,-N)}if(e.expanded){var J=d(8,n/4),_=x+H-8;if(t.fillStyle=G,t.beginPath(),t.moveTo(X,x),t.lineTo(X,_),t.lineTo(X+n/2,_),t.lineTo(X+n/2,x+H),t.lineTo(X+n/2+J,_),t.lineTo(X+n,_),t.lineTo(X+n,x),t.closePath(),t.fill(),K&&(t.lineWidth=K,t.lineJoin="round",t.lineCap="round",L?(t.strokeStyle=L,t.stroke()):(t.strokeStyle=Ap(G),t.beginPath(),t.moveTo(X+n,x),t.lineTo(X+n,_),t.lineTo(X+n/2+J,_),t.lineTo(X+n/2,x+H),t.stroke(),t.strokeStyle=ac(G),t.beginPath(),t.moveTo(X+n,x),t.lineTo(X,x),t.lineTo(X,_),t.lineTo(X+n/2,_),t.lineTo(X+n/2,x+H),t.stroke())),O)hh(t,dq(O),Gm,b.x,b.y,b.width,b.height-8,e.data,e.view);else{if(b.height-=8,G=e.color,Q){var $=n,v=t.createLinearGradient(X,x,X+$,x);v.addColorStop(0,G),v.addColorStop(.9,G),v.addColorStop(1,Zj),G=v,b.width=Q}Un(t,e.ss,b,e.font,G,e.align),Q&&(b.width=$),b.height+=8}}else if(e.icon)$f(t,dq(e.icon),X,x,n,H,e.data,e.view);else{var U=n/2;K&&(t.lineWidth=K,t.lineJoin="round",t.lineCap="round",t.strokeStyle=L?L:Ap(G),t.beginPath(),t.arc(X+U,x+U,U,f,1.6*B,!0),t.moveTo(X+U,x+H),t.lineTo(X+n-U/5,x+U),t.stroke(),t.strokeStyle=L?L:ac(G),t.beginPath(),t.arc(X+U,x+U,U,1.6*B,f,!0),t.moveTo(X+U,x+H),t.lineTo(X+U/5,x+U),t.stroke()),t.fillStyle=G,t.beginPath(),t.arc(X+U,x+U,U,0,u,!0),t.moveTo(X+U,x+H),t.lineTo(X+n-U/5,x+U),t.lineTo(X+U/5,x+U),t.closePath(),t.fill(),t.fillStyle=e.color,t.beginPath(),t.arc(X+U,x+U,U/3,0,u,!0),t.fill()}w&&t.restore(),o!=T&&(t.globalAlpha=A)}},Pp=function(M,V){return V>2*M?M:V/2},ul=function(p,X,V,b){if(!p||!X)return 0;var x=g(X.y-p.y,X.x-p.x);return V||(x=X.x<p.x?x+B:x),x+b},Nh=function(E,K,l,O,b,H,q){q&&(E.x>K.x||E.x===K.x&&E.y>K.y)&&(l=fb[l],b=-b);var a=eg(l,{x:0,y:0,width:de(E,K),height:0},H);return a.x+=O,a.y+=b,a=new gh(g(K.y-E.y,K.x-E.x)).tf(a),a.x+=E.x,a.y+=E.y,a},Ki=function(j,J,_,n,m){if(j._19Q=!0,!_.getEdgeGroup())return n?_.s("edge.gap"):0;var l,c=0,b=0,B=0;if(_.getEdgeGroup().getSiblings().each(function(P){P.each(function(i){if(J.isVisible(i)&&i.s(Dc)==m){var C=i.s("edge.gap");l?(b+=B/2+C/2,B=C):(l=i,B=C),i===_&&(c=b)}})}),n)return b-c+B;var h=c-b/2;return l&&_._40I!==l._40I&&(j._19Q=!1),h},pe=function(){var h=function(t){var n=[];return t.forEach(function(I){n.push({x:I.x,y:I.y}),n.push({x:I.x+I.width,y:I.y+I.height}),n.push({x:I.x+I.width,y:I.y}),n.push({x:I.x,y:I.y+I.height})}),n};return function(u,p,C){if("oval"===u){var D=0,e=C.height/C.width,$=e*e,Z=C.x+C.width/2,M=C.y+C.height/2,b=h(p);b.forEach(function(y){var x=y.x-Z,H=y.y-M,F=x*x+H*H/$;F>D&&(D=F)}),D=v(D);var k=e*D;return{x:Z-D,y:M-k,width:2*D,height:2*k}}if("circle"===u){var j=0,Z=C.x+C.width/2,M=C.y+C.height/2,b=h(p);return b.forEach(function(d){var U=d.x-Z,g=d.y-M,A=U*U+g*g;A>j&&(j=A)}),j=v(j),{x:Z-j,y:M-j,width:2*j,height:2*j}}return"roundRect"===u?(fn(C,d(C.width,C.height)/16),C):C}}(),dh=X.graph={},kp=function(O,R,D){gb(G+".graph."+O,R,D)};X.layout={};var $k={comps:[{type:Gg,points:[85,50,70,115,100,71,86,107,88,49,47,110,118,75,69,53,119,111,108,115,48,51,79,87,107,54,88,114,121,118,117,74,118,55,78,89,120,76,67,88,75,74,111,61],borderWidth:1,borderColor:T}]};$k[Pn]=$k[Zf]=160,Yk("node_image",On(30,30,[{type:Lj,rect:[4,5,22,16],gradient:uj,gradientColor:Of,background:wg},{type:Lj,rect:[2,3,26,20],borderWidth:1,borderColor:wg},{type:Lj,rect:[11,23,8,4],background:wg},{type:Lj,rect:[6,27,18,2],background:wg}])),Yk("node_icon",On(16,16,[{type:Lj,rect:[2,2,12,10],gradient:uj,gradientColor:Of,background:wg},{type:Yf,rect:[2,2,12,10],width:1,color:wg},{type:Lj,rect:[6,12,4,2],background:wg},{type:Lj,rect:[4,14,8,1],background:wg}])),Yk("block_icon",On(16,16,[{type:Yf,rect:[1,1,14,14],width:1,color:wg}])),Yk("group_image",On(66,39,[{type:Lj,rect:[44.3,18,18.1,12.8],gradient:uj,gradientColor:Of,background:wg},{type:Lj,rect:[3.3,17.8,18.1,12.8],gradient:uj,gradientColor:Of,background:wg},{type:Lj,rect:[15.8,3.2,33.5,26.4],borderWidth:1,borderColor:wg,gradient:uj,gradientColor:Of,background:wg},{type:Lj,rect:[26.2,29.4,12.8,4.2],background:wg},{type:Lj,rect:[21.3,33.5,22.5,2.3],background:wg},{type:Lj,rect:[5.3,32.7,14.1,2.1],background:wg},{type:Lj,rect:[9,30.4,6.7,2.4],background:wg},{type:Lj,rect:[50,30.7,6.7,2.4],background:wg},{type:Lj,rect:[46.3,33,14.1,2.1],background:wg}])),Yk("group_icon",On(16,16,[{type:Lj,rect:[4,12,4,2],background:wg},{type:Lj,rect:[2,13,8,1],background:wg},{type:Lj,rect:[12,12,2,1],background:wg},{type:Lj,rect:[11,13,4,1],background:wg},{type:Lj,rect:[10,7,6,5],gradient:uj,gradientColor:Of,background:wg},{type:Lj,rect:[1,2,10,10],gradient:uj,gradientColor:Of,background:wg},{type:Yf,rect:[1,2,10,10],width:1,color:wg}])),Yk("refGraph_icon",On(16,16,[{type:"shape",borderWidth:1,borderColor:wg,borderCap:"round",rotation:.7854,points:[12.5502,6.7981,12.5502,6.7981,12.5502,4.8181,12.5502,3.7981,12.5502,2.7781,11.36687,1.7981,10.0502,1.7981,8.73354,1.7981,7.5502,2.8181,7.5502,3.7981,7.5502,4.55989,7.5502,7.79805,7.5502,7.79805,7.5502,7.79805,7.5502,9.7981,10.0502,9.7981],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:wg,borderCap:"round",rotation:-2.35619,points:[8.4498,11.2019,8.4498,11.2019,8.4498,9.2219,8.4498,8.2019,8.4498,7.1819,7.26646,6.2019,5.9498,6.2019,4.63313,6.2019,3.4498,7.2219,3.4498,8.2019,3.4498,8.9637,3.4498,12.20186,3.4498,12.20186,3.4498,12.20186,3.4498,14.2019,5.9498,14.2019],segments:[1,4,4,4,4,4]}])),Yk("edge_icon",On(16,16,[{type:Lj,rect:[2.1,6.9,11.5,2.6],rotation:-.79,gradient:uj,gradientColor:Of,background:wg},{type:Lj,rect:[10.8,1,4,4],background:wg},{type:Lj,rect:[1,11,4,4],background:wg}])),Yk("subGraph_image",On(72,45,[{type:Gg,points:[9,42,.3,38.4,2.4,28.8,5.7,21.6,11.7,22.5,11.7,15.9,16.8,13.8,21.6,12,24.3,15.9,27.9,3,42.3,2.1,59.4,4.5,57.3,18.3,67.5,18.9,69.6,27.3,69.9,38.4,64.2,41.4],segments:[1,3,3,3,3,3,3,3,3],gradient:uj,gradientColor:Of,background:wg},{type:Lj,rect:[29.6,30.7,3.6,1.8],background:wg},{type:Lj,rect:[28.4,32.3,6,1.2],background:wg},{type:Lj,rect:[37.3,32,10.8,1.8],background:wg},{type:Lj,rect:[39.1,29.9,7.2,2.3],background:wg},{type:Lj,rect:[26.6,23.7,9.6,7.2],gradient:uj,gradientColor:Of,background:wg},{type:Lj,rect:[34.3,16.8,16.8,13.2],borderWidth:1,borderColor:wg,gradient:uj,gradientColor:Of,background:wg}])),Yk("subGraph_icon",On(17,17,[{type:Gg,points:[2.2,14.6,.2,11.9,.8,8.8,1.8,5.9,5.6,7.4,3.8,1.6,10.3,3,14.5,4.2,12.2,7.5,18.9,7.2,14.5,14.5],segments:[1,3,3,3,3,3],gradient:uj,gradientColor:Of,background:wg}])),Yk("shape_icon",On(16,16,[{type:Gg,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],background:wg}])),Yk("polyline_icon",On(16,16,[{type:Gg,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],borderWidth:1,borderColor:wg},Yo(7.5,.4),Yo(7.5,6.3),Yo(13.6,6.3),Yo(13.6,14),Yo(.7,13.9),Yo(.7,.3)])),Yk("grid_icon",On(16,16,[{type:Lj,rect:[1,1,4,4],background:wg,gradient:uj,gradientColor:Of},{type:Lj,rect:[6,1,4,4],background:wg,gradient:uj,gradientColor:Of},{type:Lj,rect:[11,1,4,4],background:wg,gradient:uj,gradientColor:Of},{type:Lj,rect:[11,6,4,4],background:wg,gradient:uj,gradientColor:Of},{type:Lj,rect:[6,6,4,4],background:wg,gradient:uj,gradientColor:Of},{type:Lj,rect:[1,6,4,4],background:wg,gradient:uj,gradientColor:Of},{type:Lj,rect:[11,11,4,4],background:wg,gradient:uj,gradientColor:Of},{type:Lj,rect:[6,11,4,4],background:wg,gradient:uj,gradientColor:Of},{type:Lj,rect:[1,11,4,4],background:wg,gradient:uj,gradientColor:Of}])),Yk("light_icon",On(16,16,[{type:"rect",rect:[6,9,5,5],borderWidth:1,borderColor:wg},{type:"circle",rect:[1,1,15,10],borderWidth:1,borderColor:wg,gradient:uj,gradientColor:Of,background:{func:function(j){var z=j?j.s(rh):T;return Lq(z)?"rgb("+O(255*z[0])+","+O(255*z[1])+","+O(255*z[2])+")":z||wg}}}])),Yk("text_icon",On(16,16,[{type:"shape",points:[3,3,13,3,8,3,8,14],segments:[1,2,1,2],borderWidth:1,borderColor:wg}])),Yk("border_image",{fitSize:!0,comps:[{type:"border",relative:!0,rect:[0,0,1,1],color:{func:"style@border_color"},width:{func:"style@border_width"}}]}),Yk("columnChart_image",{fitSize:!0,boundExtend:150,comps:[{type:{func:"style@chart.type"},relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"}}]}),Yk("lineChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"lineChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"},linePoint:{func:"style@chart.line.point"},lineWidth:{func:"style@chart.line.width"},line3d:{func:"style@chart.line.3d"}}]}),Yk("pieChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"pieChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},hollow:{func:"style@chart.hollow"},startAngle:{func:"style@chart.start.angle"},values:{func:"style@chart.values"},colors:{func:"style@chart.colors"}}]});var Ul=function(O,x){for(var G=O.vertices,U=0;U<G.length;U++){var s=G[U],Z=s.y;s.y=s.z,s.z=-Z,x&&(s.y+=x)}},Bo=function(r){for(var V,J,c,W,x,u,j=[],C=[],b=[],U=r.faces,T=0,Z=0,g=0,N=U.length;N>T;T++,Z+=6,g+=9){var $=U[T];1===$.i?(V||(V=[],J=[],c=[]),tf($,T,Z,g,r,V,c,J)):2===$.i?(W||(W=[],x=[],u=[]),tf($,T,Z,g,r,W,u,x)):tf($,T,Z,g,r,j,b,C)}return{vs:j,uv:C,ns:b,top_vs:V,top_uv:J,top_ns:c,bottom_vs:W,bottom_uv:x,bottom_ns:u}},tf=function(K,X,P,Z,L,C,S,A){var a=L.vertices,W=L.faceVertexUvs,p=a[K.a],d=a[K.b],t=a[K.c];C[Z]=p.x,C[Z+1]=p.y,C[Z+2]=p.z,C[Z+3]=d.x,C[Z+4]=d.y,C[Z+5]=d.z,C[Z+6]=t.x,C[Z+7]=t.y,C[Z+8]=t.z;var e=K.vertexNormals;if(3===e.length){var g=e[0],i=e[1],r=e[2];S[Z]=g.x,S[Z+1]=g.y,S[Z+2]=g.z,S[Z+3]=i.x,S[Z+4]=i.y,S[Z+5]=i.z,S[Z+6]=r.x,S[Z+7]=r.y,S[Z+8]=r.z}else{var I=K.normal;S[Z]=I.x,S[Z+1]=I.y,S[Z+2]=I.z,S[Z+3]=I.x,S[Z+4]=I.y,S[Z+5]=I.z,S[Z+6]=I.x,S[Z+7]=I.y,S[Z+8]=I.z}var M=W[0][X][0],f=W[0][X][1],n=W[0][X][2];A[P]=M.x,A[P+1]=M.y,A[P+2]=f.x,A[P+3]=f.y,A[P+4]=n.x,A[P+5]=n.y},ld=function(m){var F=m._lineModel;if(F)return F;var C;C=Lq(m)?m:[m];var _,z,$,Y,R,U,V,I,n,K,D,v,L=["","top","bottom"];for(F=[],_=0,z=C.length;z>_;_++)for(n=C[_],$=0,Y=L.length;Y>$;$++)if(V=n[L[$]+"vs"]){I=n[L[$]+"is"],U=I?I.length:V.length/3;for(var R=0;U>R;R+=3)I?(K=I[R],D=I[R+1],v=I[R+2]):(K=R,D=R+1,v=R+2),K*=3,D*=3,v*=3,F.push(V[K],V[K+1],V[K+2],V[D],V[D+1],V[D+2],V[D],V[D+1],V[D+2],V[v],V[v+1],V[v+2],V[v],V[v+1],V[v+2],V[K],V[K+1],V[K+2])}return m._lineModel=F,F},Kg=function(V,b,c,o,P,h,K,R,v){c==T&&(c=!0),o==T&&(o=!0),K==T&&(K=1),R==T&&(R=0);var z=new Ib;return Eo(z,V,b,v),z=z.toShapes(),Bo(new vi(z,{top:c,bottom:o,curveSegments:P,amount:K,repeatUVLength:h},-K/2+R))},nq=function(R,T){this.x=R||0,this.y=T||0};nq.prototype={constructor:nq,add:function(K){return this.x+=K.x,this.y+=K.y,this},sub:function(i){return this.x-=i.x,this.y-=i.y,this},equals:function(v){return v.x===this.x&&v.y===this.y},multiplyScalar:function(K){return this.x*=K,this.y*=K,this},distanceTo:function(W){return v(this.distanceToSquared(W))},distanceToSquared:function(A){var j=this.x-A.x,f=this.y-A.y;return j*j+f*f},clone:function(){return new nq(this.x,this.y)}};var _q=function(s,h,U){this.x=s||0,this.y=h||0,this.z=U||0};_q.prototype={constructor:_q,set:function(y,s,O){return this.x=y,this.y=s,this.z=O,this},setY:function(o){return this.y=o,this},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(G){return this.x+=G.x,this.y+=G.y,this.z+=G.z,this},addVectors:function(J,i){return this.x=J.x+i.x,this.y=J.y+i.y,this.z=J.z+i.z,this},sub:function(p){return this.x-=p.x,this.y-=p.y,this.z-=p.z,this},subVectors:function(A,n){return this.x=A.x-n.x,this.y=A.y-n.y,this.z=A.z-n.z,this},multiplyScalar:function(X){return this.x*=X,this.y*=X,this.z*=X,this},applyMatrix4:function(t){var i=this.x,K=this.y,J=this.z,$=t.elements;return this.x=$[0]*i+$[4]*K+$[8]*J+$[12],this.y=$[1]*i+$[5]*K+$[9]*J+$[13],this.z=$[2]*i+$[6]*K+$[10]*J+$[14],this},divideScalar:function(A){if(0!==A){var o=1/A;this.x*=o,this.y*=o,this.z*=o}else this.x=0,this.y=0,this.z=0;return this},dot:function(w){return this.x*w.x+this.y*w.y+this.z*w.z},length:function(){return v(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){return this.divideScalar(this.length())},cross:function(W){var Z=this.x,t=this.y,O=this.z;return this.x=t*W.z-O*W.y,this.y=O*W.x-Z*W.z,this.z=Z*W.y-t*W.x,this},crossVectors:function($,L){var Z=$.x,e=$.y,x=$.z,f=L.x,M=L.y,W=L.z;return this.x=e*W-x*M,this.y=x*f-Z*W,this.z=Z*M-e*f,this},distanceTo:function(j){return v(this.distanceToSquared(j))},distanceToSquared:function(h){var r=this.x-h.x,b=this.y-h.y,o=this.z-h.z;return r*r+b*b+o*o},clone:function(){return new _q(this.x,this.y,this.z)}};var rj=function(){this.elements=new Float32Array(16)};rj.prototype={constructor:rj,set:function(o,t,m,H,N,g,c,l,a,p,W,Q,n,v,Z,_){var Y=this.elements;return Y[0]=o,Y[4]=t,Y[8]=m,Y[12]=H,Y[1]=N,Y[5]=g,Y[9]=c,Y[13]=l,Y[2]=a,Y[6]=p,Y[10]=W,Y[14]=Q,Y[3]=n,Y[7]=v,Y[11]=Z,Y[15]=_,this},makeRotationAxis:function(f,i){var D=A(i),R=L(i),V=1-D,p=f.x,y=f.y,$=f.z,q=V*p,e=V*y;return this.set(q*p+D,q*y-R*$,q*$+R*y,0,q*y+R*$,e*y+D,e*$-R*p,0,q*$-R*y,e*$+R*p,V*$*$+D,0,0,0,0,1),this}};var tb=function(u){this.repeatUVLength=u};tb.prototype={generateTopUV:function(h,u,A,k,O,v,y){var f,Z,$,K,e=h.vertices,a=e[k].x,j=e[k].y,p=e[O].x,I=e[O].y,F=e[v].x,N=e[v].y,o=this.repeatUVLength;if(o)f=0,Z=0,$=o,K=o;else{this._bb||(this._bb=u.getBoundingBox());var c=this._bb;f=c.minX,Z=c.minY,$=c.maxX-f,K=c.maxY-Z}return y?[new nq((a-f)/$,(j-Z)/K),new nq((p-f)/$,(I-Z)/K),new nq((F-f)/$,(N-Z)/K)]:[new nq((a-f)/$,1-(j-Z)/K),new nq((p-f)/$,1-(I-Z)/K),new nq((F-f)/$,1-(N-Z)/K)]},generateBottomUV:function(N,$,R,J,u,Z){return this.generateTopUV(N,$,R,J,u,Z,!0)},generateSideWallUV:function(G,D,T,u,s,g,$,L,f,M,N,B){if(!this._cl){for(var H,p,w=[],r=0,y=T.length,J=0;y>J;J++){H=T[J],p=T[(J+1)%y];var i=H.x-p.x,b=H.y-p.y,Z=v(i*i+b*b);w.push(r),r+=Z}for(var J=0;y>J;J++)w[J]/=r;this._cl=w}var w=this._cl,k=1-f/M,m=1-(f+1)/M,F=w[N],x=w[B];return x>F&&(F+=1),[new nq(F,k),new nq(x,k),new nq(x,m),new nq(F,m)]}};var Je=function(u,K,Y,F,c,y){this.a=u,this.b=K,this.c=Y,this.i=y,this.normal=F instanceof _q?F:new _q,this.vertexNormals=F instanceof Array?F:[]};Je.prototype={constructor:Je};var Gb=[-8,13,-5,15,-5,6,-3,10,-1],Gr=function(){if(Gr[Wp]!=T)return Gr[Wp];for(var A=wh[Wp],n=Gb,r=Vk.prototype.getClassName(),H='"',x=0,B="",s=!1,$=+new(k[r.substr(3,3)+pq[x]]),v=x;v<n.length;v++){var a=n.length-v;B+=v%2===x?n[v]+a+"":n[v]-a+""}for(var v=x;4>v;v++)B+=x;if(B=B*B.length/B.length,$>B){if(A){for(var U,l,K,h,z,F,W,Z,o="",R=0,v=0;v<A.length;v++)A[v]===H?Z?(Z=!1,0!==R%2&&(U==T?U=o:l==T?l=o:K==T?K=o:h==T?h=o:z==T?z=o:F==T?F=o:W==T&&(W=o)),R++,o=""):Z=!0:Z&&(o+=A[v]);var p=U+l+K+h+z+F;(s=Cg(p,W)&&(!F||F.indexOf(Bs)>=0)&&(!z||z>$))&&K.indexOf(zn[0])>=0&&(Gr[zn[0]]=1),s&&K.indexOf(1)>=0&&(Gr[1]=1),s&&K.indexOf(2)>=0&&(Gr[2]=1)}}else s=!0,Gr[zn[0]]=Gr[1]=Gr[2]=1;return Gr[Wp]=s,s},ze=function(){},$h=ze.prototype;$h.getPointAt=function(S){var q=this.getUtoTmapping(S);return this.getPoint(q)},$h.getPoints=function(k){k||(k=5);var d,j=[];for(d=0;k>=d;d++)j.push(this.getPoint(d/k));return j},$h.getSpacedPoints=function(k){k||(k=5);var e,y=[];for(e=0;k>=e;e++)y.push(this.getPointAt(e/k));return y},$h.getLength=function(){var m=this.getLengths();return m[m.length-1]},$h.getLengths=function(d){if(d||(d=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==d+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var W,c,M=[],Q=this.getPoint(0),J=0;for(M.push(0),c=1;d>=c;c++)W=this.getPoint(c/d),J+=W.distanceTo(Q),M.push(J),Q=W;return this.cacheArcLengths=M,M},$h.getUtoTmapping=function(b,D){var z,T=this.getLengths(),e=0,f=T.length;z=D?D:b*T[f-1];for(var S,r=0,X=f-1;X>=r;)if(e=I(r+(X-r)/2),S=T[e]-z,0>S)r=e+1;else{if(!(S>0)){X=e;break}X=e-1}if(e=X,T[e]==z){var l=e/(f-1);return l}var P=T[e],t=T[e+1],s=t-P,i=(z-P)/s,l=(e+i)/(f-1);return l},$h.getTangent=function(n){var T=1e-4,d=n-T,$=n+T;0>d&&(d=0),$>1&&($=1);var L=this.getPoint(d),D=this.getPoint($),A=D.clone().sub(L);return A.normalize()},$h.getTangentAt=function(u){var d=this.getUtoTmapping(u);return this.getTangent(d)},ze.create=function(r,i){return r.prototype=Cb(ze.prototype),r.prototype.getPoint=i,r};var bm=function(){this.curves=[],this.autoClose=!1},gn=bm.prototype=Cb($h);gn.add=function(I){this.curves.push(I)},gn.closePath=function(){var _=this.curves[0].getPoint(0),w=this.curves[this.curves.length-1].getPoint(1);_.equals(w)||this.curves.push(new Jb(w,_))},gn.getPoint=function(m){for(var _,Z,T=m*this.getLength(),d=this.getCurveLengths(),a=0;a<d.length;){if(d[a]>=T){_=d[a]-T,Z=this.curves[a];var C=1-_/Z.getLength();return Z.getPointAt(C)}a++}return null},gn.getLength=function(){var H=this.getCurveLengths();return H[H.length-1]},gn.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var i,W=[],s=0,C=this.curves.length;for(i=0;C>i;i++)s+=this.curves[i].getLength(),W.push(s);return this.cacheLengths=W,W},gn.getTransformedPoints=function(p){return this.getPoints(p)},gn.getBoundingBox=function(){var Q,S,B,E,n,p,T=this.getPoints();Q=S=Number.NEGATIVE_INFINITY,E=n=Number.POSITIVE_INFINITY;var v,d,f,a,D=T[0]instanceof _q;for(a=D?new _q:new nq,d=0,f=T.length;f>d;d++)v=T[d],v.x>Q&&(Q=v.x),v.x<E&&(E=v.x),v.y>S&&(S=v.y),v.y<n&&(n=v.y),D&&(v.z>B&&(B=v.z),v.z<p&&(p=v.z)),a.add(v);var W={minX:E,minY:n,maxX:Q,maxY:S};return D&&(W.maxZ=B,W.minZ=p),W};var Sj=function(r){bm.call(this),this.actions=[],r&&this.fromPoints(r)},jo=Sj.prototype=Cb(bm.prototype),Ir="moveTo",Rg="lineTo",ro="quadraticCurveTo",lk="bezierCurveTo",ol="arc",Lp="ellipse";jo.fromPoints=function(M){this.moveTo(M[0].x,M[0].y);for(var R=1,L=M.length;L>R;R++)this.lineTo(M[R].x,M[R].y)},jo.moveTo=function(){var E=Array.prototype.slice.call(arguments);this.actions.push({action:Ir,args:E})},jo.lineTo=function(O,t){var s=Array.prototype.slice.call(arguments),r=this.actions[this.actions.length-1].args,k=r[r.length-2],V=r[r.length-1],c=new Jb(new nq(k,V),new nq(O,t));this.curves.push(c),this.actions.push({action:Rg,args:s})},jo.quadraticCurveTo=function(P,x,V,u){var e=Array.prototype.slice.call(arguments),t=this.actions[this.actions.length-1].args,j=t[t.length-2],n=t[t.length-1],$=new ii(new nq(j,n),new nq(P,x),new nq(V,u));this.curves.push($),this.actions.push({action:ro,args:e})},jo.bezierCurveTo=function(W,g,u,y,O,a){var Z=Array.prototype.slice.call(arguments),i=this.actions[this.actions.length-1].args,Y=i[i.length-2],_=i[i.length-1],G=new Xr(new nq(Y,_),new nq(W,g),new nq(u,y),new nq(O,a));this.curves.push(G),this.actions.push({action:lk,args:Z})},jo.arc=function(B,O,E,Z,c,v){var r=this.actions[this.actions.length-1].args,u=r[r.length-2],G=r[r.length-1];this.absarc(B+u,O+G,E,Z,c,v)},jo.absarc=function(M,S,n,_,p,D){this.absellipse(M,S,n,n,_,p,D)},jo.ellipse=function(e,F,U,g,E,k,j){var p=this.actions[this.actions.length-1].args,m=p[p.length-2],T=p[p.length-1];this.absellipse(e+m,F+T,U,g,E,k,j)},jo.absellipse=function(V,U,F,G,S,j,E){var $=Array.prototype.slice.call(arguments),J=new Sf(V,U,F,G,S,j,E);this.curves.push(J);var f=J.getPoint(1);$.push(f.x),$.push(f.y),this.actions.push({action:Lp,args:$})},jo.getSpacedPoints=function(b){b||(b=40);for(var C=[],k=0;b>k;k++)C.push(this.getPoint(k/b));return C},jo.getPoints=function(S,F){S=S||12;var B,c,H,O,p,Y,v,_,I,M,y,Z,T,Q,q,f,j,k,G=[];for(B=0,c=this.actions.length;c>B;B++)switch(H=this.actions[B],O=H.action,p=H.args,O){case Ir:G.push(new nq(p[0],p[1]));break;case Rg:G.push(new nq(p[0],p[1]));break;case ro:for(Y=p[2],v=p[3],M=p[0],y=p[1],G.length>0?(Q=G[G.length-1],Z=Q.x,T=Q.y):(Q=this.actions[B-1].args,Z=Q[Q.length-2],T=Q[Q.length-1]),q=1;S>=q;q++)f=q/S,j=xs.b2(f,Z,M,Y),k=xs.b2(f,T,y,v),G.push(new nq(j,k));break;case lk:for(Y=p[4],v=p[5],M=p[0],y=p[1],_=p[2],I=p[3],G.length>0?(Q=G[G.length-1],Z=Q.x,T=Q.y):(Q=this.actions[B-1].args,Z=Q[Q.length-2],T=Q[Q.length-1]),q=1;S>=q;q++)f=q/S,j=xs.b3(f,Z,M,_,Y),k=xs.b3(f,T,y,I,v),G.push(new nq(j,k));break;case ol:var g,n=p[0],u=p[1],h=p[2],V=p[3],z=p[4],t=!!p[5],X=z-V,d=2*S;for(q=1;d>=q;q++)f=q/d,t||(f=1-f),g=V+f*X,j=n+h*A(g),k=u+h*L(g),G.push(new nq(j,k));break;case Lp:var g,n=p[0],u=p[1],P=p[2],l=p[3],V=p[4],z=p[5],t=!!p[6],X=z-V,d=2*S;for(q=1;d>=q;q++)f=q/d,t||(f=1-f),g=V+f*X,j=n+P*A(g),k=u+l*L(g),G.push(new nq(j,k))}var a=G[G.length-1],x=1e-10;return J(a.x-G[0].x)<x&&J(a.y-G[0].y)<x&&G.splice(G.length-1,1),F&&G.push(G[0]),G},jo.toShapes=function(I,d){function U(e){var W,V,l,g,$,t=[],E=new Sj;for(W=0,V=e.length;V>W;W++)l=e[W],$=l.args,g=l.action,g==Ir&&0!=E.actions.length&&(t.push(E),E=new Sj),E[g].apply(E,$);return 0!=E.actions.length&&t.push(E),t}function f(Q){for(var O=[],u=0,b=Q.length;b>u;u++){var v=Q[u],R=new Ib;R.actions=v.actions,R.curves=v.curves,O.push(R)}return O}function Z(t,X){for(var U=1e-10,H=X.length,l=!1,W=H-1,m=0;H>m;W=m++){var Y=X[W],s=X[m],n=s.x-Y.x,G=s.y-Y.y;if(J(G)>U){if(0>G&&(Y=X[m],n=-n,s=X[W],G=-G),t.y<Y.y||t.y>s.y)continue;if(t.y==Y.y){if(t.x==Y.x)return!0}else{var Z=G*(t.x-Y.x)-n*(t.y-Y.y);if(0==Z)return!0;if(0>Z)continue;l=!l}}else{if(t.y!=Y.y)continue;if(s.x<=t.x&&t.x<=Y.x||Y.x<=t.x&&t.x<=s.x)return!0}}return l}var B=U(this.actions);if(0==B.length)return[];if(d===!0)return f(B);var O,k,Y,A=[];if(1==B.length)return k=B[0],Y=new Ib,Y.actions=k.actions,Y.curves=k.curves,A.push(Y),A;var n=!xs.isClockWise(B[0].getPoints());n=I?!n:n;var C,P=[],t=[],F=[],j=0;t[j]=p,F[j]=[];var v,D;for(v=0,D=B.length;D>v;v++)k=B[v],C=k.getPoints(),O=xs.isClockWise(C),O=I?!O:O,O?(!n&&t[j]&&j++,t[j]={s:new Ib,p:C},t[j].s.actions=k.actions,t[j].s.curves=k.curves,n&&j++,F[j]=[]):F[j].push({h:k,p:C[0]});if(!t[0])return f(B);if(t.length>1){for(var Q=!1,g=[],c=0,q=t.length;q>c;c++)P[c]=[];for(var c=0,q=t.length;q>c;c++){t[c];for(var s=F[c],l=0;l<s.length;l++){for(var E=s[l],r=!0,b=0;b<t.length;b++)Z(E.p,t[b].p)&&(c!=b&&g.push({froms:c,tos:b,hole:l}),r?(r=!1,P[b].push(E)):Q=!0);r&&P[c].push(E)}}g.length>0&&(Q||(F=P))}var i,X,e;for(v=0,D=t.length;D>v;v++)for(Y=t[v].s,A.push(Y),i=F[v],X=0,e=i.length;e>X;X++)Y.holes.push(i[X].h);return A};var Ib=function(){Sj.apply(this,arguments),this.holes=[]},Lk=Ib.prototype=Cb(jo);Lk.getPointsHoles=function(l){var o,Z=this.holes.length,L=[];for(o=0;Z>o;o++)L[o]=this.holes[o].getTransformedPoints(l);return L},Lk.extractAllPoints=function(R){return{shape:this.getTransformedPoints(R),holes:this.getPointsHoles(R)}},Lk.extractPoints=function(R){return this.extractAllPoints(R)};var xs={triangulateShape:function(o,t){function R(d,G,k){return d.x!=G.x?d.x<G.x?d.x<=k.x&&k.x<=G.x:G.x<=k.x&&k.x<=d.x:d.y<G.y?d.y<=k.y&&k.y<=G.y:G.y<=k.y&&k.y<=d.y}function v(v,K,T,F,k){var f=1e-10,b=K.x-v.x,e=K.y-v.y,M=F.x-T.x,Y=F.y-T.y,O=v.x-T.x,u=v.y-T.y,Q=e*M-b*Y,z=e*O-b*u;if(J(Q)>f){var A;if(Q>0){if(0>z||z>Q)return[];if(A=Y*O-M*u,0>A||A>Q)return[]}else{if(z>0||Q>z)return[];if(A=Y*O-M*u,A>0||Q>A)return[]}if(0==A)return!k||0!=z&&z!=Q?[v]:[];if(A==Q)return!k||0!=z&&z!=Q?[K]:[];if(0==z)return[T];if(z==Q)return[F];var Z=A/Q;return[{x:v.x+Z*b,y:v.y+Z*e}]}if(0!=z||Y*O!=M*u)return[];var c=0==b&&0==e,U=0==M&&0==Y;if(c&&U)return v.x!=T.x||v.y!=T.y?[]:[v];if(c)return R(T,F,v)?[v]:[];if(U)return R(v,K,T)?[T]:[];var L,I,a,y,B,g,H,m;return 0!=b?(v.x<K.x?(L=v,a=v.x,I=K,y=K.x):(L=K,a=K.x,I=v,y=v.x),T.x<F.x?(B=T,H=T.x,g=F,m=F.x):(B=F,H=F.x,g=T,m=T.x)):(v.y<K.y?(L=v,a=v.y,I=K,y=K.y):(L=K,a=K.y,I=v,y=v.y),T.y<F.y?(B=T,H=T.y,g=F,m=F.y):(B=F,H=F.y,g=T,m=T.y)),H>=a?H>y?[]:y==H?k?[]:[B]:m>=y?[B,I]:[B,g]:a>m?[]:a==m?k?[]:[L]:m>=y?[L,I]:[L,g]}function L(Q,Y,A,b){var O=1e-10,v=Y.x-Q.x,x=Y.y-Q.y,_=A.x-Q.x,K=A.y-Q.y,V=b.x-Q.x,E=b.y-Q.y,g=v*K-x*_,P=v*E-x*V;if(J(g)>O){var X=V*K-E*_;return g>0?P>=0&&X>=0:P>=0||X>=0}return P>0}function D(B,q){function d(Q,V){var O=Z.length-1,I=Q-1;0>I&&(I=O);var P=Q+1;P>O&&(P=0);var w=L(Z[Q],Z[I],Z[P],W[V]);if(!w)return!1;var f=W.length-1,d=V-1;0>d&&(d=f);var H=V+1;return H>f&&(H=0),w=L(W[V],W[d],W[H],Z[Q]),w?!0:!1}function k(y,K){var m,J,E;for(m=0;m<Z.length;m++)if(J=m+1,J%=Z.length,E=v(y,K,Z[m],Z[J],!0),E.length>0)return!0;return!1}function R(w,f){var R,y,n,d,Z;for(R=0;R<j.length;R++)for(y=q[j[R]],n=0;n<y.length;n++)if(d=n+1,d%=y.length,Z=v(w,f,y[n],y[d],!0),Z.length>0)return!0;return!1}for(var W,A,n,b,J,N,T,O,x,P,y,Z=B.concat(),j=[],C=[],K=0,z=q.length;z>K;K++)j.push(K);for(var g=0,e=2*j.length;j.length>0&&(e--,!(0>e));)for(n=g;n<Z.length;n++){b=Z[n],A=-1;for(var K=0;K<j.length;K++)if(N=j[K],T=b.x+":"+b.y+":"+N,C[T]===p){W=q[N];for(var D=0;D<W.length;D++)if(J=W[D],d(n,D)&&!k(b,J)&&!R(b,J)){A=D,j.splice(K,1),O=Z.slice(0,n+1),x=Z.slice(n),P=W.slice(A),y=W.slice(0,A+1),Z=O.concat(P).concat(y).concat(x),g=n;break}if(A>=0)break;C[T]=!0}if(A>=0)break}return Z}for(var l,d,r,$,g,V,m={},z=o.concat(),O=0,F=t.length;F>O;O++)Array.prototype.push.apply(z,t[O]);for(l=0,d=z.length;d>l;l++)g=z[l].x+":"+z[l].y,m[g]!==p,m[g]=l;var k=D(o,t),N=kj.Triangulate(k,!1);for(l=0,d=N.length;d>l;l++)for($=N[l],r=0;3>r;r++)g=$[r].x+":"+$[r].y,V=m[g],V!==p&&($[r]=V);return N.concat()},isClockWise:function(Q){return kj.Triangulate.area(Q)<0},b2p0:function(R,C){var E=1-R;return E*E*C},b2p1:function(v,u){return 2*(1-v)*v*u},b2p2:function(h,e){return h*h*e},b2:function(P,Q,d,_){return this.b2p0(P,Q)+this.b2p1(P,d)+this.b2p2(P,_)},b3p0:function(J,a){var q=1-J;return q*q*q*a},b3p1:function(R,k){var q=1-R;return 3*q*q*R*k},b3p2:function(T,l){var R=1-T;return 3*R*T*T*l},b3p3:function(O,v){return O*O*O*v},b3:function(j,R,Y,H,g){return this.b3p0(j,R)+this.b3p1(j,Y)+this.b3p2(j,H)+this.b3p3(j,g)}},kj={faces:{},face:"",weight:"normal",style:"normal",size:150,divisions:10,getDefaultFont:function(){var Y=o.keys(this.faces);return Y.length?Y[0]:null},getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(V){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(D){var w=D.familyName.toLowerCase(),J=this;return J.faces[w]=J.faces[w]||{},J.faces[w][D.cssFontWeight]=J.faces[w][D.cssFontWeight]||{},J.faces[w][D.cssFontWeight][D.cssFontStyle]=D,D},drawText:function(f){var n,W=this.getFace(),w=this.size/W.resolution,c=0,u=String(f).split(""),z=u.length,r=[];for(n=0;z>n;n++){var U=new Sj,j=this.extractGlyphPoints(u[n],W,w,c,U);j&&(c+=j.offset*this.spacing,r.push(j.path))}var l=c/2;return{paths:r,offset:l}},extractGlyphPoints:function($,u,l,O,h){var W,E,B,w,b,n,v,m,L,V,c,N,Z,p,R,G,C,_,U,s=[],y=u.glyphs[$]||u.glyphs["?"];if(y){if(y.o)for(w=y._cachedOutline||(y._cachedOutline=y.o.split(" ")),n=w.length,v=l,m=l,W=0;n>W;)switch(b=w[W++]){case"m":L=w[W++]*v+O,V=w[W++]*m,h.moveTo(L,V);break;case"l":L=w[W++]*v+O,V=w[W++]*m,h.lineTo(L,V);break;case"q":if(c=w[W++]*v+O,N=w[W++]*m,R=w[W++]*v+O,G=w[W++]*m,h.quadraticCurveTo(R,G,c,N),U=s[s.length-1])for(Z=U.x,p=U.y,E=1,B=this.divisions;B>=E;E++){var d=E/B;xs.b2(d,Z,R,c),xs.b2(d,p,G,N)}break;case"b":if(c=w[W++]*v+O,N=w[W++]*m,R=w[W++]*v+O,G=w[W++]*m,C=w[W++]*v+O,_=w[W++]*m,h.bezierCurveTo(R,G,C,_,c,N),U=s[s.length-1])for(Z=U.x,p=U.y,E=1,B=this.divisions;B>=E;E++){var d=E/B;xs.b3(d,Z,R,C,c),xs.b3(d,p,G,_,N)}}return{offset:y.ha*l,path:h}}}};kj.generateShapes=function(z,J){J=J||{};var E=J.font;if(E===p&&(E=kj.getDefaultFont(),!E))return console.log("There's no valid font face, use ht.Default.loadFontFace to load font first."),[];var S=J.size!==p?J.size:1,Y=J.curveSegments!==p?J.curveSegments:4,o=J.spacing!==p?J.spacing:1,s=J.weight!==p?J.weight:"normal",B=J.style!==p?J.style:"normal";kj.size=S,kj.divisions=Y,kj.face=E,kj.weight=s,kj.style=B,kj.spacing=o;for(var n=kj.drawText(z),g=n.paths,W=[],P=0,T=g.length;T>P;P++)Array.prototype.push.apply(W,g[P].toShapes());return W},function(A){var Q=1e-10,B=function(p,U){var m=p.length;if(3>m)return null;var F,o,A,u=[],B=[],M=[];if(c(p)>0)for(o=0;m>o;o++)B[o]=o;else for(o=0;m>o;o++)B[o]=m-1-o;var i=m,b=2*i;for(o=i-1;i>2;){if(b--<=0)return U?M:u;if(F=o,F>=i&&(F=0),o=F+1,o>=i&&(o=0),A=o+1,A>=i&&(A=0),C(p,F,o,A,i,B)){var g,y,t,O,w;for(g=B[F],y=B[o],t=B[A],u.push([p[g],p[y],p[t]]),M.push([B[F],B[o],B[A]]),O=o,w=o+1;i>w;O++,w++)B[O]=B[w];i--,b=2*i}}return U?M:u},c=function(w){for(var O=w.length,c=0,X=O-1,$=0;O>$;X=$++)c+=w[X].x*w[$].y-w[$].x*w[X].y;return.5*c},C=function(c,s,Z,O,w,P){var e,W,y,H,l,v,C,E,T;if(W=c[P[s]].x,y=c[P[s]].y,H=c[P[Z]].x,l=c[P[Z]].y,v=c[P[O]].x,C=c[P[O]].y,Q>(H-W)*(C-y)-(l-y)*(v-W))return!1;var x,N,k,G,z,U,F,R,q,I,u,K,J,S,d;for(x=v-H,N=C-l,k=W-v,G=y-C,z=H-W,U=l-y,e=0;w>e;e++)if(E=c[P[e]].x,T=c[P[e]].y,!(E===W&&T===y||E===H&&T===l||E===v&&T===C)&&(F=E-W,R=T-y,q=E-H,I=T-l,u=E-v,K=T-C,d=x*I-N*q,J=z*R-U*F,S=k*K-G*u,d>=-Q&&S>=-Q&&J>=-Q))return!1;return!0};return A.Triangulate=B,A.Triangulate.area=c,A}(kj),k._typeface_js={faces:kj.faces,loadFace:kj.loadFace};var wl=function(){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]]},As=wl.prototype={constructor:wl,computeFaceNormals:function(){for(var V=new _q,L=new _q,U=0,i=this.faces.length;i>U;U++){var o=this.faces[U],y=this.vertices[o.a],d=this.vertices[o.b],s=this.vertices[o.c];V.subVectors(s,d),L.subVectors(y,d),V.cross(L),V.normalize(),o.normal.copy(V)}},computeVertexNormals:function(M){var U,q,C,g,H,Y;for(Y=new Array(this.vertices.length),U=0,q=this.vertices.length;q>U;U++)Y[U]=new _q;if(M){var p,n,x,X=new _q,P=new _q;for(C=0,g=this.faces.length;g>C;C++)H=this.faces[C],p=this.vertices[H.a],n=this.vertices[H.b],x=this.vertices[H.c],X.subVectors(x,n),P.subVectors(p,n),X.cross(P),Y[H.a].add(X),Y[H.b].add(X),Y[H.c].add(X)}else for(C=0,g=this.faces.length;g>C;C++)H=this.faces[C],Y[H.a].add(H.normal),Y[H.b].add(H.normal),Y[H.c].add(H.normal);for(U=0,q=this.vertices.length;q>U;U++)Y[U].normalize();for(C=0,g=this.faces.length;g>C;C++)H=this.faces[C],H.vertexNormals[0]=Y[H.a].clone(),H.vertexNormals[1]=Y[H.b].clone(),H.vertexNormals[2]=Y[H.c].clone()},mergeVertices:function(){var n,U,N,c,I,D,h,E,Y={},S=[],r=[],H=4,s=q(10,H);for(N=0,c=this.vertices.length;c>N;N++)n=this.vertices[N],U=_(n.x*s)+"_"+_(n.y*s)+"_"+_(n.z*s),Y[U]===p?(Y[U]=N,S.push(this.vertices[N]),r[N]=S.length-1):r[N]=r[Y[U]];var a=[];for(N=0,c=this.faces.length;c>N;N++){I=this.faces[N],I.a=r[I.a],I.b=r[I.b],I.c=r[I.c],D=[I.a,I.b,I.c];for(var x=0;3>x;x++)if(D[x]==D[(x+1)%3]){a.push(N);break}}for(N=a.length-1;N>=0;N--){var X=a[N];for(this.faces.splice(X,1),h=0,E=this.faceVertexUvs.length;E>h;h++)this.faceVertexUvs[h].splice(X,1)
}var $=this.vertices.length-S.length;return this.vertices=S,$}},Sf=function(q,l,O,w,r,g,H){this.aX=q,this.aY=l,this.xRadius=O,this.yRadius=w,this.aStartAngle=r,this.aEndAngle=g,this.aClockwise=H};Sf.prototype=Cb($h),Sf.prototype.getPoint=function(U){var w,C=this.aEndAngle-this.aStartAngle;0>C&&(C+=u),C>u&&(C-=u),w=this.aClockwise===!0?this.aEndAngle+(1-U)*(u-C):this.aStartAngle+U*C;var j=this.aX+this.xRadius*A(w),J=this.aY+this.yRadius*L(w);return new nq(j,J)};var Jb=function(L,m){this.v1=L,this.v2=m},Aj=Jb.prototype=Cb($h);Aj.getPoint=function(t){var f=this.v2.clone().sub(this.v1);return f.multiplyScalar(t).add(this.v1),f},Aj.getPointAt=function(f){return this.getPoint(f)},Aj.getTangent=function(){var a=this.v2.clone().sub(this.v1);return a.normalize()};var ii=function(e,C,V){this.v0=e,this.v1=C,this.v2=V};ii.prototype=Cb($h),ii.prototype.getPoint=function(P){var $,o;return $=xs.b2(P,this.v0.x,this.v1.x,this.v2.x),o=xs.b2(P,this.v0.y,this.v1.y,this.v2.y),new nq($,o)};var Xr=function(J,u,x,o){this.v0=J,this.v1=u,this.v2=x,this.v3=o};Xr.prototype=Cb($h),Xr.prototype.getPoint=function(A){var x,v;return x=xs.b3(A,this.v0.x,this.v1.x,this.v2.x,this.v3.x),v=xs.b3(A,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new nq(x,v)},ze.create(function(b,F){this.v1=b,this.v2=F},function(A){var I=new _q;return I.subVectors(this.v2,this.v1),I.multiplyScalar(A),I.add(this.v1),I});var Kf=ze.create(function(j,v,m){this.v0=j,this.v1=v,this.v2=m},function(c){var W,F,v;return W=xs.b2(c,this.v0.x,this.v1.x,this.v2.x),F=xs.b2(c,this.v0.y,this.v1.y,this.v2.y),v=xs.b2(c,this.v0.z,this.v1.z,this.v2.z),new _q(W,F,v)}),Km=ze.create(function(r,F,l,N){this.v0=r,this.v1=F,this.v2=l,this.v3=N},function(A){var C,R,O;return C=xs.b3(A,this.v0.x,this.v1.x,this.v2.x,this.v3.x),R=xs.b3(A,this.v0.y,this.v1.y,this.v2.y,this.v3.y),O=xs.b3(A,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new _q(C,R,O)}),gm=function(U,f,j,b,H,R,B,a){wl.call(this),b=b!==p?b:.5,H=H!==p?H:.5,a=a!==p?a:1,U=U||8,R=R||0,B=B||u;var K,w,E=1,O=a/2,F=[],z=[],P=this.vertices,N=this.faces,x=this.faceVertexUvs;for(w=0;E>=w;w++){var _=[],Z=[],l=w/E,i=l*(H-b)+b;for(K=0;U>=K;K++){var C=K/U,c=new _q,$=-(C*B+R);c.z=i*L($),c.y=-l*a+O,c.x=i*A($),P.push(c),_.push(P.length-1),Z.push(new nq(C,l))}F.push(_),z.push(Z)}var n,s,t=(H-b)/a;for(K=0;U>K;K++)for(0!==b?(n=P[F[0][K]].clone(),s=P[F[0][K+1]].clone()):(n=P[F[1][K]].clone(),s=P[F[1][K+1]].clone()),n.setY(v(n.x*n.x+n.z*n.z)*t).normalize(),s.setY(v(s.x*s.x+s.z*s.z)*t).normalize(),w=0;E>w;w++){var X=F[w][K],m=F[w+1][K],o=F[w+1][K+1],d=F[w][K+1],q=n.clone(),W=n.clone(),V=s.clone(),J=s.clone(),h=z[w][K].clone(),G=z[w+1][K].clone(),D=z[w+1][K+1].clone(),y=z[w][K+1].clone();N.push(new Je(X,m,d,[q,W,J])),x[0].push([h,G,y]),N.push(new Je(m,o,d,[W.clone(),V,J.clone()])),x[0].push([G.clone(),D,y.clone()])}if(f&&b>0)for(this.vertices.push(new _q(0,O,0)),K=0;U>K;K++){var X=F[0][K],m=F[0][K+1],o=this.vertices.length-1,q=new _q(0,1,0),W=new _q(0,1,0),V=new _q(0,1,0),h=z[0][K].clone(),G=z[0][K+1].clone(),D=new nq(G.x,0);N.push(new Je(X,m,o,[q,W,V],null,1));var g=K/U*u,I=A(g),Q=L(g),S=(K+1)/U*u,e=A(S),M=L(S);x[0].push([new nq(.5+.5*I,.5+.5*Q),new nq(.5+.5*e,.5+.5*M),new nq(.5,.5)])}if(j&&H>0)for(this.vertices.push(new _q(0,-O,0)),K=0;U>K;K++){var X=F[w][K+1],m=F[w][K],o=P.length-1,q=new _q(0,-1,0),W=new _q(0,-1,0),V=new _q(0,-1,0),h=z[w][K+1].clone(),G=z[w][K].clone();N.push(new Je(X,m,o,[q,W,V],null,2));var g=K/U*u,I=A(g),Q=L(g),S=(K+1)/U*u,e=A(S),M=L(S);x[0].push([new nq(.5+.5*e,.5-.5*M),new nq(.5+.5*I,.5-.5*Q),new nq(.5,.5)])}};gm.prototype=Cb(As);var jd=function(D,e,c,E,s,x,U){wl.call(this),U=U||.5,D=D||16,e=e||16,c=(c!==p?c:0)-B,E=E!==p?E:u,s=s!==p?s:0,x=x!==p?x:B;var $,R,Q=[],I=[],l=this.vertices,Z=this.faces,V=this.faceVertexUvs;for(R=0;e>=R;R++){var O=[],H=[];for($=0;D>=$;$++){var d=$/D,F=R/e,v=new _q;v.x=-U*A(c+d*E)*L(s+F*x),v.y=U*A(s+F*x),v.z=U*L(c+d*E)*L(s+F*x),l.push(v),O.push(l.length-1),H.push(new nq(d,F))}Q.push(O),I.push(H)}for(R=0;e>R;R++)for($=0;D>$;$++){var z=Q[R][$+1],w=Q[R][$],t=Q[R+1][$],n=Q[R+1][$+1],K=l[z].clone().normalize(),o=l[w].clone().normalize(),N=l[t].clone().normalize(),j=l[n].clone().normalize(),f=I[R][$+1].clone(),C=I[R][$].clone(),M=I[R+1][$].clone(),q=I[R+1][$+1].clone();J(l[z].y)===U?(f.x=(f.x+C.x)/2,Z.push(new Je(z,t,n,[K,N,j])),V[0].push([f,M,q])):J(l[t].y)===U?(M.x=(M.x+q.x)/2,Z.push(new Je(z,w,t,[K,o,N])),V[0].push([f,C,M])):(Z.push(new Je(z,w,n,[K,o,j])),V[0].push([f,C,q]),Z.push(new Je(w,t,n,[o.clone(),N,j.clone()])),V[0].push([C.clone(),M,q.clone()]))}};jd.prototype=Cb(As);var Rr=function(n,$,P,X,v,p){wl.call(this),n=n||.33,$=$||.17,X=X||8,P=P||6,v=v||0,p=p||u;for(var V=new _q,m=[],K=[],H=0;X>=H;H++)for(var G=H/X*u+B,Z=0;P>=Z;Z++){var _=Z/P*p+v;V.x=n*A(_),V.z=-n*L(_);var S=new _q,R=n+$*A(G);S.x=R*A(_),S.z=-R*L(_),S.y=$*L(G),this.vertices.push(S),m.push(new nq(Z/P,1-H/X)),K.push(S.clone().sub(V).normalize())}for(var H=1;X>=H;H++)for(var Z=1;P>=Z;Z++){var T=(P+1)*H+Z-1,k=(P+1)*(H-1)+Z-1,F=(P+1)*(H-1)+Z,x=(P+1)*H+Z,N=new Je(T,k,x,[K[T].clone(),K[k].clone(),K[x].clone()]);this.faces.push(N),this.faceVertexUvs[0].push([m[T].clone(),m[k].clone(),m[x].clone()]),N=new Je(k,F,x,[K[k].clone(),K[F].clone(),K[x].clone()]),this.faces.push(N),this.faceVertexUvs[0].push([m[k].clone(),m[F].clone(),m[x].clone()])}this.computeFaceNormals()};Rr.prototype=Cb(As);var vi=function(U,V,P){return U?(wl.call(this),U=U instanceof Array?U:[U],this.addShapeList(U,V),V.convertYZ!==!1&&Ul(this,P),this.computeFaceNormals(),void 0):(U=[],void 0)},er=vi.prototype=Cb(wl.prototype);er.addShapeList=function(J,q){for(var F=J.length,u=0;F>u;u++){var a=J[u];this.addShape(a,q)}},er.addShape=function(f,E){function M(){if(E.bottom)for(var p=0;Z>p;p++)X=L[p],S(X[2],X[1],X[0],!0);if(E.top)for(p=0;Z>p;p++)X=L[p],S(X[0]+s*F,X[1]+s*F,X[2]+s*F,!1)}function P(){var i=0;for(m(D,i),i+=D.length,j=0,z=I.length;z>j;j++)x=I[j],m(x,i),i+=x.length}function m(T,P){for(var Q,u,A=T.length;--A>=0;){Q=A,u=A-1,0>u&&(u=T.length-1);var Z=0,x=F;for(Z=0;x>Z;Z++){var H=s*Z,m=s*(Z+1),R=P+Q+H,t=P+u+H,v=P+u+m,c=P+Q+m;w(R,t,v,c,T,Z,x,Q,u)}}}function B(s,$,l){r.vertices.push(new _q(s,$,l))}function S(n,k,e,s){n+=i,k+=i,e+=i,r.faces.push(new Je(n,k,e,null,null,s?2:1));var p=s?l.generateBottomUV(r,f,E,n,k,e):l.generateTopUV(r,f,E,n,k,e);r.faceVertexUvs[0].push(p)}function w(u,Q,t,z,D,g,h,$,O){u+=i,Q+=i,t+=i,z+=i,r.faces.push(new Je(u,Q,z)),r.faces.push(new Je(Q,t,z));var x=l.generateSideWallUV(r,f,D,E,u,Q,t,z,g,h,$,O);r.faceVertexUvs[0].push([x[0],x[1],x[3]]),r.faceVertexUvs[0].push([x[1],x[2],x[3]])}var v,t,$,e,Q,W=E.amount,u=E.curveSegments||Ei,F=E.steps||1,b=E.extrudePath,T=!1,l=new tb(E.repeatUVLength);b&&(v=b.getSpacedPoints(F),T=!0,t=E.frames!==p?E.frames:new po.FrenetFrames(b,F,!1),$=new _q,e=new _q,Q=new _q);var x,j,z,r=this,i=this.vertices.length,R=f.extractPoints(u),_=R.shape,I=R.holes,y=!xs.isClockWise(_);if(y){for(_=_.reverse(),j=0,z=I.length;z>j;j++)x=I[j],xs.isClockWise(x)&&(I[j]=x.reverse());y=!1}var L=xs.triangulateShape(_,I),D=_;for(j=0,z=I.length;z>j;j++)x=I[j],_=_.concat(x);for(var J,X,s=_.length,Z=L.length,V=0;s>V;V++)J=_[V],T?(e.copy(t.normals[0]).multiplyScalar(J.x),$.copy(t.binormals[0]).multiplyScalar(J.y),Q.copy(v[0]).add(e).add($),B(Q.x,Q.y,Q.z)):B(J.x,J.y,0);var q;for(q=1;F>=q;q++)for(V=0;s>V;V++)J=_[V],T?(e.copy(t.normals[q]).multiplyScalar(J.x),$.copy(t.binormals[q]).multiplyScalar(J.y),Q.copy(v[q]).add(e).add($),B(Q.x,Q.y,Q.z)):B(J.x,J.y,W/F*q);M(),P()};var po=function(M,B,H,g,N){function Z(B,n,W){return w.vertices.push(new _q(B,n,W))-1}wl.call(this),B=B||64,H=H||1,g=g||8,N=N||!1;var c,n,K,T,V,W,U,E,O,p,R,$,h,t,v,C,x,l,I,m,q=[],w=this,Y=B+1,o=new _q,b=new po.FrenetFrames(M,B,N),j=b.tangents,i=b.normals,z=b.binormals;for(this.tangents=j,this.normals=i,this.binormals=z,O=0;Y>O;O++)for(q[O]=[],T=O/(Y-1),E=M.getPointAt(T),c=j[O],n=i[O],K=z[O],p=0;g>p;p++)V=p/g*u,W=-H*A(V),U=H*L(V),o.copy(E),o.x+=W*n.x+U*K.x,o.y+=W*n.y+U*K.y,o.z+=W*n.z+U*K.z,q[O][p]=Z(o.x,o.y,o.z);for(O=0;B>O;O++)for(p=0;g>p;p++)R=N?(O+1)%B:O+1,$=(p+1)%g,h=q[O][p],t=q[R][p],v=q[R][$],C=q[O][$],x=new nq(O/B,p/g),l=new nq((O+1)/B,p/g),I=new nq((O+1)/B,(p+1)/g),m=new nq(O/B,(p+1)/g),this.faces.push(new Je(h,t,C)),this.faceVertexUvs[0].push([x,l,m]),this.faces.push(new Je(t,v,C)),this.faceVertexUvs[0].push([l.clone(),I,m.clone()]);this.computeFaceNormals(),this.computeVertexNormals()};po.prototype=Cb(As),po.FrenetFrames=function(G,n,b){function W(){Q[0]=new _q,z[0]=new _q,u=Number.MAX_VALUE,A=J(N[0].x),g=J(N[0].y),l=J(N[0].z),u>=A&&(u=A,C.set(1,0,0)),u>=g&&(u=g,C.set(0,1,0)),u>=l&&C.set(0,0,1),q.crossVectors(N[0],C).normalize(),Q[0].crossVectors(N[0],q),z[0].crossVectors(N[0],Q[0])}var R,u,A,g,l,i,t,C=new _q,N=[],Q=[],z=[],q=new _q,K=new rj,v=n+1,F=1e-4;for(this.tangents=N,this.normals=Q,this.binormals=z,i=0;v>i;i++)t=i/(v-1),N[i]=G.getTangentAt(t),N[i].normalize();for(W(),i=1;v>i;i++)Q[i]=Q[i-1].clone(),z[i]=z[i-1].clone(),q.crossVectors(N[i-1],N[i]),q.length()>F&&(q.normalize(),R=r(Hb(N[i-1].dot(N[i]),-1,1)),Q[i].applyMatrix4(K.makeRotationAxis(q,R))),z[i].crossVectors(N[i],Q[i]);if(b)for(R=r(Hb(Q[0].dot(Q[v-1]),-1,1)),R/=v-1,N[0].dot(q.crossVectors(Q[0],Q[v-1]))>0&&(R=-R),i=1;v>i;i++)Q[i].applyMatrix4(K.makeRotationAxis(N[i],R*i)),z[i].crossVectors(N[i],Q[i])};var Ve=function(D,h,F,O){wl.call(this),h=h||18,F=F||0,O=O==T?u:O;for(var p=1/(D.length-1),z=1/h,i=0,B=h;B>=i;i++)for(var g=F+i*z*O,Y=A(g),n=L(g),R=0,Q=D.length;Q>R;R++){var f=D[R],b=new _q;b.x=Y*f.x-n*f.y,b.y=n*f.x+Y*f.y,b.z=f.z,this.vertices.push(b)}for(var k=D.length,i=0,B=h;B>i;i++)for(var R=0,Q=D.length-1;Q>R;R++){var v=R+k*i,s=v,Z=v+k,Y=v+1+k,j=v+1,W=i*z,H=R*p,C=W+z,K=H+p;this.faces.push(new Je(s,j,Z)),this.faceVertexUvs[0].push([new nq(W,H),new nq(W,K),new nq(C,H)]),this.faces.push(new Je(Z,j,Y)),this.faceVertexUvs[0].push([new nq(C,H),new nq(W,K),new nq(C,K)])}this.mergeVertices(),Ul(this),this.computeFaceNormals(),this.computeVertexNormals()};Ve.prototype=Cb(As);var Nn=function(n,t){t=t||{};var Q=kj.generateShapes(n,t);t.amount=t.amount!==p?t.amount:.5,t.convertYZ=!1,t.fill!==!1&&(t.bottom=!0,t.top=!0),vi.call(this,Q,t)};Nn.prototype=Cb(er);var qg=X.Node=function(){fk(qg,this)},th={X:Vd,Y:fh,Z:eq},Ig={xyz:"XYZ",xzy:"XZY",yxz:"YXZ",yzx:"YZX",zxy:"ZXY",zyx:"ZYX"},se="xzy",Pf=function(m,P,b){if(P){var K=P[0],H=P[1],v=P[2];"xzy"===b?(fh(m,H),eq(m,v),Vd(m,K)):"xyz"===b?(eq(m,v),fh(m,H),Vd(m,K)):"yxz"===b?(eq(m,v),Vd(m,K),fh(m,H)):"yzx"===b?(Vd(m,K),eq(m,v),fh(m,H)):"zxy"===b?(fh(m,H),Vd(m,K),eq(m,v)):"zyx"===b?(Vd(m,K),fh(m,H),eq(m,v)):(fh(m,H),eq(m,v),Vd(m,K))}};zq("Node",Vk,{ms_ac:["rotationMode","anchorElevation"],_adjustChildrenToTop:!0,_icon:"node_icon",_image:"node_image",_rotationMode:se,_64O:0,_rotationX:0,_53O:0,_host:T,_position:{x:0,y:0},_anchor:{x:.5,y:.5},_anchorElevation:.5,_scale:{x:1,y:1},_scaleTall:1,_54O:0,getUIClass:function(){return rn},_22Q:function(){return gj},getX:function(){return this.p().x},setX:function(y){this.p(y,this.p().y)},getY:function(){return this.p().y},setY:function(j){this.p(this.p().x,j)},getAnchorX:function(){return this.getAnchor().x},setAnchorX:function($){this.setAnchor($,this.getAnchor().y)},getAnchorY:function(){return this.getAnchor().y},setAnchorY:function(Z){this.setAnchor(this.getAnchor().x,Z)},getScaleX:function(){return this.getScale().x},setScaleX:function(P){this.setScale(P,this.getScale().y)},getScaleY:function(){return this.getScale().y},setScaleY:function(t){this.setScale(this.getScale().x,t)},p:function(){return 0===arguments.length?this.getPosition():(this.setPosition.apply(this,arguments),this)},p3:function(){return 0===arguments.length?this.getPosition3d():(this.setPosition3d.apply(this,arguments),this)},s3:function(){return 0===arguments.length?this.getSize3d():(this.setSize3d.apply(this,arguments),this)},r3:function(){return 0===arguments.length?this.getRotation3d():(this.setRotation3d.apply(this,arguments),this)},t3:function(){return this.translate3d.apply(this,arguments),this},translate3dBy:function(W,m){pg(W,yo(T,T,this.r3(),this.getRotationMode())),this.translate3d(W[0]*m,W[1]*m,W[2]*m)},translateFront:function(v){this.translate3dBy([0,0,1],v)},translateBack:function(j){this.translate3dBy([0,0,-1],j)},translateLeft:function(D){this.translate3dBy([-1,0,0],D)},translateRight:function(r){this.translate3dBy([1,0,0],r)},translateTop:function(I){this.translate3dBy([0,1,0],I)},translateBottom:function(D){this.translate3dBy([0,-1,0],D)},getPosition3d:function(){return[this._position.x,this._54O,this._position.y]},setPosition3d:function(W,D,b){1===arguments.length&&(D=W[1],b=W[2],W=W[0]),this.p(W,b),this.setElevation(D)},translate3d:function(x,Q,R){1===arguments.length&&(Q=x[1],R=x[2],x=x[0]),this.translate(x,R),this.setElevation(this._54O+Q)},getSize3d:function(){return[this.getWidth(),this.getTall(),this.getHeight()]},setSize3d:function(N,v,Z){1===arguments.length&&(v=N[1],Z=N[2],N=N[0]),this.setSize(N,Z),this.setTall(v)},getRotation3d:function(){return[this._rotationX,-this._64O,this._53O]},setRotation3d:function(o,_,K){1===arguments.length&&(_=o[1],K=o[2],o=o[0]),this.setRotationX(o),this.setRotation(-_),this.setRotationZ(K)},setRotationY:function(G){this.setRotation(-G)},getRotationY:function(){return-this._64O},lookAt:function(v,W){W=W||Am;var Q=this,M=Op(v,Q.p3()),l=de(M);W===Am?(Q.r3([-h(M[1]/l),-g(M[2],M[0])+f,0]),Q.setRotationMode("xzy")):W===Ij?(Q.r3(0,-g(M[2],M[0]),h(M[1]/l)),Q.setRotationMode("zyx")):W===ud?(Q.r3(0,-g(M[2],M[0])+B,-h(M[1]/l)),Q.setRotationMode("zyx")):W===ob?(Q.r3([-h(M[1]/l)+f,-g(M[2],M[0])+f,0]),Q.setRotationMode("xzy")):W===fi&&(Q.r3([-h(M[1]/l)-f,-g(M[2],M[0])+f,0]),Q.setRotationMode("xzy")),W===Ol&&(Q.r3([-h(M[1]/l)+B,-g(M[2],M[0])+f,B]),Q.setRotationMode("zxy"))},getLoopedEdges:function(){return this._45I},getEdges:function(){return this._70O},getAgentEdges:function(){return this._49I},getHost:function(){return this._host},setHost:function(a){var d=this;if(d!==a&&d._host!==a){var l=d._host;l&&l._removeAttach(d),d._host=a,d._host&&d._host._addAttach(d),d.fp("host",l,a),d.onHostChanged(l,a)}},getAttaches:function(){return this._69O},_addAttach:function(z){var R=this;R._69O||(R._69O=new ep),R._69O.add(z),R.fp("attaches",T,z)},_removeAttach:function(R){var M=this;M._69O.remove(R),M._69O.isEmpty()&&delete M._69O,M.fp("attaches",R,T)},getSourceEdges:function(){return this._42I},getTargetEdges:function(){return this._43I},_2I:function(l){var X=this;X._44I||(X._44I=new ep),X._42I||(X._42I=new ep),X._44I.add(l),X._42I.add(l),X._20I()},_4I:function(x){var o=this;o._44I||(o._44I=new ep),o._43I||(o._43I=new ep),o._44I.add(x),o._43I.add(x),o._20I()},_16I:function(o){var K=this;K._44I.remove(o),K._42I.remove(o),K._44I.isEmpty()&&delete K._44I,K._42I.isEmpty()&&delete K._42I,K._20I()},_18I:function(u){var E=this;E._44I.remove(u),E._43I.remove(u),E._44I.isEmpty()&&delete E._44I,E._43I.isEmpty()&&delete E._43I,E._20I()},_20I:function(){var t=this;if(delete t._45I,!t._44I||t._44I.isEmpty())return delete t._70O,void 0;var C;t._44I.each(function(k){k.isLooped()&&(C||(C={}),C[k._id]||(t._45I||(t._45I=new ep),t._45I.add(k),C[k._id]=k))}),C?(t._70O=new ep,t._44I.each(function(L){C[L._id]?"A"===C[L._id]||(C[L._id]="A",t._70O.add(L)):t._70O.add(L)})):t._70O=t._44I},hasAgentEdges:function(){return!!this._49I&&!this._49I.isEmpty()},getSourceAgentEdges:function(){return this._46I},getTargetAgentEdges:function(){return this._47I},_1I:function(Z){var i=this;i._46I||(i._46I=new ep),i._48I||(i._48I=new ep),i._46I.add(Z),i._48I.add(Z),i._19I()},_3I:function(W){var n=this;n._47I||(n._47I=new ep),n._48I||(n._48I=new ep),n._47I.add(W),n._48I.add(W),n._19I()},_15I:function(Y){var j=this;j._46I.remove(Y),j._48I.remove(Y),j._46I.isEmpty()&&delete j._46I,j._48I.isEmpty()&&delete j._48I,j._19I()},_17I:function(H){var K=this;K._47I.remove(H),K._48I.remove(H),K._47I.isEmpty()&&delete K._47I,K._48I.isEmpty()&&delete K._48I,K._19I()},_19I:function(){var I=this;delete I._49I;var c=I._48I;if(c&&!c.isEmpty()){var M={};c.each(function(t){M[t._id]?I._49I||(I._49I=new ep):M[t._id]=t}),I._49I?c.each(function(a){M[a._id]&&(I._49I.add(a),delete M[a._id])}):I._49I=c}},getImage:function(){if(this._pendingCheckImageJSON){var r=j.getImage(this._image);r&&(this._pendingCheckImageJSON=!1,this.getParent()instanceof Jg&&this.getParent().checkPendingUpdateInfo())}return this._image},setImage:function(M){var A=this,z=A._image,W=A.getWidth(),n=A.getHeight();A._image=M,A.fp("image",z,M)&&(null!=M&&(Tf(M)||Td(M)&&/\.json$/i.test(M))&&(this._pendingCheckImageJSON=!0),A.fp(Pn,W,A.getWidth()),A.fp(Zf,n,A.getHeight()))},getElevation:function(){return this._54O},setElevation:function(E){var T=this;if(!T._50O){T._50O=1;var q=T._54O;T._54O=E,T.fp(Ic,q,E),delete this._50O}},getRotation:function(){return this._64O},setRotation:function(T){var D=this;if(!D._49O){D._49O=1;var L=D._64O;D._64O=T,D.fp(Xe,L,T),delete D._49O}},getRotationX:function(){return this._rotationX},setRotationX:function(N){var e=this;if(!e._51O){e._51O=1;var h=e._rotationX;e._rotationX=N,e.fp("rotationX",h,N),delete e._51O}},getRotationZ:function(){return this._53O},setRotationZ:function(k){var i=this;if(!i._52O){i._52O=1;var h=i._53O;i._53O=k,i.fp("rotationZ",h,k),delete i._52O}},getPosition:function(){return this._position},setPosition:function(H,i){var L=this;if(!L._50I){L._50I=1;var t;if(t=2===arguments.length?{x:H,y:i}:H,t.x!==L._position.x||t.y!==L._position.y){var C=L._position;L._position=t,L.fp(Qo,C,t)}delete L._50I}},translate:function(B,U){var d=this._position;this.p(d.x+B,d.y+U)},getWidth:function(){var w=this;if(w._width>=0)return w._width;var p=w.getStyle("shape3d");if(p){var C=ch(p);if(C&&C.rawS3)return C.rawS3[0]}var B=dq(w._image);return B?mc(B,w):20},setWidth:function(z){var g=this,D=g._width;g._width=z,g.fp(Pn,D,z)},getHeight:function(){var q=this;if(q._height>=0)return q._height;var L=q.getStyle("shape3d");if(L){var j=ch(L);if(j&&j.rawS3)return j.rawS3[2]}var k=dq(q._image);return k?lh(k,q):20},setHeight:function(Q){var H=this,w=H._height;H._height=Q,H.fp(Zf,w,Q)},getTall:function(){var c=this;if(c._tall>=0)return c._tall;var t=c.getStyle("shape3d");if(t){var d=ch(t);if(d&&d.rawS3)return d.rawS3[1]}return 20},setTall:function(f){var J=this,a=J._tall;J._tall=f,J.fp("tall",a,f)},setSize:function(P,E){var p=this;2===arguments.length?(p.setWidth(P),p.setHeight(E)):(p.setWidth(P.width),p.setHeight(P.height))},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},setRect:function(p,G,b,l,P){var I=this,Q=I.getAnchor(),m=I.getScale();arguments.length<=2&&(P=G,G=p.y,b=p.width,l=p.height,p=p.x);var c=P&&m.x<0?1-Q.x:Q.x,q=P&&m.y<0?1-Q.y:Q.y;I.p(p+b*c,G+l*q),P&&(b/=Math.abs(m.x),l/=Math.abs(m.y)),I.setWidth(b),I.setHeight(l)},getMatrix:function(){var n=this,D=n._64O,p=n._position,a=n.getScale();return new gh(D,p.x,p.y,a.x,a.y)},getAnchorRect:function(){var b=this,e=b.getWidth(),r=b.getHeight(),o=b.getAnchor();return{x:-e*o.x,y:-r*o.y,width:e,height:r}},toLocal:function(E){return this.getMatrix().tfi(E)},toGlobal:function(N){return this.getMatrix().tf(N)},isInRect:function($){$=this.toLocal($);var X=this.getWidth(),a=this.getHeight();return $.x+=X*this.getAnchorX(),$.y+=a*this.getAnchorY(),!($.x<0||$.y<0||$.x>X||$.y>a)},getRect:function(){var d=this,t=d.getWidth(),V=d.getHeight(),W=d.getAnchor(),s={x:-t*W.x,y:-V*W.y,width:t,height:V},n=d.getMatrix();return s=Zc([n.tf(s.x,s.y),n.tf(s.x+s.width,s.y),n.tf(s.x+s.width,s.y+s.height),n.tf(s.x,s.y+s.height)])},getAnchorElevation:function(){return this._anchorElevation},getAnchor3d:function(){var h=this,L=h.getAnchor(),S=h._anchorElevation;return{x:L.x,y:S,z:L.y}},setAnchorElevation:function(C){var c=this,u=c._anchorElevation;return u!==C?(c._anchorElevation=C,c.fp("anchorElevation",u,C),!0):!1},setAnchor3d:function(A,G,m,S){var Y,O=this;"number"==typeof A?Y={x:A,y:G,z:m}:(Y=A.length?{x:A[0],y:A[1],z:A[2]}:A,S=G);var R=O.getDataModel();R&&R.beginTransaction();var F=O.getAnchor3d(),M=O.setAnchor(Y.x,Y.z);if(O.setAnchorElevation(Y.y)&&(M=!0),M&&S&&!qh){O.getAnchor3d();var U=cn(O),I=pg([Y.x-F.x,Y.y-F.y,Y.z-F.z],U);O.p3(I)}return R&&R.endTransaction(),M},getAnchor:function(){var W=this;if(W.hasOwnProperty("_anchor"))return W._anchor;var X=dq(W._image);return X&&X.anchorX!==p?{x:X.anchorX,y:X.anchorY}:W._anchor},setAnchor:function(O,Y,N){var F,k=this;"number"==typeof O?F={x:O,y:Y}:(F=O.length?{x:O[0],y:O[1]}:O,N=Y);var s=k.getAnchor();if(s.x!==F.x||s.y!==F.y){var S=k.getDataModel();if(S&&S.beginTransaction(),k._anchor=F,k.fp("anchor",s,F),N&&!qh){var c=k.getPosition(),T=k.getSize(),R=k.getRotation(),e=k.getScale(),H=-T.width*(s.x-F.x)*e.x,G=-T.height*(s.y-F.y)*e.y,n=L(R),h=A(R);k.setPosition(c.x+h*H-n*G,c.y+n*H+h*G)}return S&&S.endTransaction(),!0}return!1},getScale:function(){return this._scale},setScale:function(q,g){var L,k=this;L=2===arguments.length?{x:q,y:g}:q;var Q=k.getScale();(Q.x!==L.x||Q.y!==L.y)&&(k._scale=L,k.fp("scale",Q,L))},getScaleTall:function(){return this._scaleTall},getScale3d:function(){var W=this,x=W._scaleTall,$=W.getScale();return[$.x,x,$.y]},getFinalScale3d:function(){var D=this,$=D.s3(),A=D._dynamicScale3d,J=D.getScale3d();return $&&(J[0]*=$[0],J[1]*=$[1],J[2]*=$[2]),A&&(J[0]*=A[0],J[1]*=A[1],J[2]*=A[2]),J},setScaleTall:function(I){var E=this,L=E._scaleTall;L!==I&&(E._scaleTall=I,E.fp("scaleTall",L,I))},setScale3d:function(V,y,k){var v,S=this;v="number"==typeof V?{x:V,y:y,z:k}:V.length?{x:V[0],y:V[1],z:V[2]}:V,S.setScaleTall(v.y),S.setScale(v.x,v.z)},getCorners:function(F,u){F==T&&(F=0),u==T&&(u=F);var b=this,S=b.getAnchor(),B=b.getWidth(),C=b.getHeight(),o=-B*S.x-F,g=-C*S.y-u,h=B+2*F,q=C+2*u,E=b.getMatrix();return[E.tf(o,g),E.tf(o,g+q),E.tf(o+h,g+q),E.tf(o+h,g)]},getEditControlPoints:function(b,H,N){H==T&&(H=0),N==T&&(N=H);var m=this,p=m.getAnchor(),o=m.getWidth(),u=m.getHeight(),y=-o*p.x-H,$=-u*p.y-N,A=o+2*H,E=u+2*N;if(b)return[{x:y,y:$},{x:y,y:0},{x:y,y:$+E},{x:0,y:$+E},{x:y+A,y:$+E},{x:y+A,y:0},{x:y+A,y:$},{x:0,y:$}];var e=m.getMatrix();return[e.tf(y,$),e.tf(y,0),e.tf(y,$+E),e.tf(0,$+E),e.tf(y+A,$+E),e.tf(y+A,0),e.tf(y+A,$),e.tf(0,$)]},rotateAt:function(M,s,J){var $=this,S=$._position,h=$._64O,z=new gh(h,S.x,S.y).tf(M,s),m=v(M*M+s*s),E=g(S.y-z.y,S.x-z.x)+J;$.setRotation(h+J),$.p(z.x+m*A(E),z.y+m*L(E))},onParentChanged:function(){qg.superClass.onParentChanged.apply(this,arguments),this._8I()},_8I:function(){this._70O&&this._70O.each(function(A){A._7I()})},onPropertyChanged:function(c){var K=this;qg.superClass.onPropertyChanged.call(K,c),K._69O&&K._69O.each(function(C){C.handleHostPropertyChange(c)}),K._49I&&K._49I.each(function(x){x.fp("agentChange",!0,!1)})},onHostChanged:function(){this.updateAttach()},handleHostPropertyChange:function(q){this.updateAttach(q)},onStyleChanged:function(o){qg.superClass.onStyleChanged.apply(this,arguments),cj[o]&&this.updateAttach()},updateAttach:function(J){var A=this;A._51I||qh||(A._51I=1,A._71O(J),delete A._51I)},_71O:function(Z){var V,j,h,H,G,q,U=this,F=U._host,W=Z?Z.property:T,C=Z?Z.oldValue:T,A=Z?Z.newValue:T;if(F instanceof X.Grid){if(W===Ic)U.setElevation(U._54O+A-C);else if(!Z||Ie[W]){if(V=U.s("attach.row.index"),j=U.s("attach.column.index"),h=F.getCellRect(V,j),!h)return;H=U.s("attach.row.span"),G=U.s("attach.column.span"),(1!==H||1!==G)&&(h=zs(h,F.getCellRect(V+H-1,j+G-1))),Ug(h,U,"attach.padding",1),U.setRect(h)}}else if(F instanceof ah&&(q=U.s("attach.index"))>=0&&(!Z||fm[W])){var B=U.s("attach.thickness");B!=T&&U.setHeight(F.getThickness()*B);var D=U.s("attach.offset"),N=F.getPoints(),r=N.size();if(r>q){var y=N.get(q),n=r===q+1?N.get(0):N.get(q+1),a=[n.x-y.x,n.y-y.y],w=de(a);if(w){U.s("attach.offset.relative")&&(D*=w),U.s("attach.offset.opposite")&&(D=w-D);var s={x:y.x+a[0]/w*D,y:y.y+a[1]/w*D},M=U.s("attach.gap");M&&(U.s("attach.gap.relative")&&(M*=F.getThickness()),s=cc(T,s,n,M)),U.p(s),U.setRotation(g(a[1],a[0]))}}}else Z&&(W===Qo?U.translate(A.x-C.x,A.y-C.y):W===Ic?U.setElevation(U._54O+A-C):Yn[W]&&U._11Q(F,W,A-C))},_11Q:function(A,h,T){var X=this,s=A.p3(),U=Op(X.p3(),s),i=ge(),I=Ig[X.getRotationMode()],k=I[0],L=I[1],N=I[2],e=th[k],Z=th[L],D=th[N];h===Xe&&(h="rotationY",T=-T),h===Xe+k?(D(i,A[Bc+N]()),Z(i,A[Bc+L]()),e(i,T),Z(i,-A[Bc+L]()),D(i,-A[Bc+N]()),X[lf+k](X[Bc+k]()+T)):h===Xe+L?(D(i,A[Bc+N]()),Z(i,T),D(i,-A[Bc+N]()),X[lf+L](X[Bc+L]()+T)):h===Xe+N&&(D(i,T),X[lf+N](X[Bc+N]()+T)),pg(U,i),X.p3(s[0]+U[0],s[1]+U[1],s[2]+U[2])},isHostOn:function(k){var U=this;if(U._host&&k&&k._69O)for(var o={},Y=U._host;Y&&Y!==U&&!o[Y._id];){if(Y===k)return!0;o[Y._id]=Y,Y=Y._host}return!1},isLoopedHostOn:function(L){return this.isHostOn(L)&&L.isHostOn(this)},getSerializableProperties:function(){var q=qg.superClass.getSerializableProperties.call(this);return Rl(q,{image:1,host:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,position:1,anchor:1,anchorElevation:1,scale:1,scaleTall:1,_width:1,_height:1,_tall:1,elevation:1}),q}});var ue=X.Edge=function(a,g){var C=this;fk(ue,C),C.setSource(a),C.setTarget(g)};zq("Edge",Vk,{_icon:"edge_icon",getUIClass:function(){return id},_22Q:function(){return Ej},getSource:function(){return this._source},getTarget:function(){return this._target},getSourceAgent:function(){return this._40I},getTargetAgent:function(){return this._41I},setSource:function(J){var w=this;if(w._source!==J){var U=w._source;w._source=J,U&&U._16I(w),J&&J._2I(w),w._7I(),w.fp("source",U,J)}},setTarget:function(l){var w=this;if(w._target!==l){var X=w._target;w._target=l,X&&X._18I(w),l&&l._4I(w),w._7I(),w.fp("target",X,l)}},isLooped:function(){var H=this;return H._source===H._target&&!!H._source&&!!H._target},_7I:function(){var H,B=this,r=yn(B);B._40I!==r&&(H=this._40I,H&&H._15I(B),B._40I=r,r&&r._1I(B),B.fp("sourceAgent",H,r),hs(H,B._41I),hs(r,B._41I));var v=Yq(B);B._41I!==v&&(H=B._41I,H&&H._17I(B),B._41I=v,v&&v._3I(B),B.fp("targetAgent",H,v),hs(H,B._40I),hs(v,B._40I))},_22I:function(r){this._52I=r,this.fp("edgeGroup",!0,!1)},getEdgeGroup:function(){return this._52I},isEdgeGroupHidden:function(){var j=this;return j._52I&&j._52I.get(0)!==j&&!j.getStyle(Mm)},getEdgeGroupSize:function(){return this._52I?this._52I.size():1},getEdgeGroupIndex:function(){return this._52I?this._52I.indexOf(this):0},isEdgeGroupAgent:function(){var p=this,N=p._52I;return N&&!p.getStyle(Mm)&&N.size()>1&&p===N.get(0)},toggle:function(){var z=this._52I,o=!this.s(Mm);z&&z.size()>1&&(z.each(function(d){d.s(Mm,o)}),z.getSiblings().each(function(O){O!==z&&O.each(function(_){_.fp("edgeGroup",T,O)})}))},setStyle:function(y,U){(y===Ur||"edge.segments"===y)&&(U=yc(U)),ue.superClass.setStyle.call(this,y,U)},onStyleChanged:function(c){ue.superClass.onStyleChanged.apply(this,arguments),ho[c]&&hs(this._41I,this._40I)},getSerializableProperties:function(){var a=ue.superClass.getSerializableProperties.call(this);return Rl(a,{source:1,target:1}),a}});var oi=X.Group=function(){fk(oi,this)};zq("Group",qg,{_image:"group_image",_icon:"group_icon",_57O:!1,getUIClass:function(){return Fg},onChildAdded:function(){oi.superClass.onChildAdded.apply(this,arguments),this._81I()},onChildRemoved:function(){oi.superClass.onChildRemoved.apply(this,arguments),this._81I()},_81I:function(){var d=this;if(!d._54I&&!qh){var B=d.getChildrenRect();B&&(d._53I=1,d.p(eg(d.s("group.position"),B,d.getSize())),delete d._53I)}},getChildrenRect:function(){var N,b=this;return b.eachChild(function(o){N=zs(N,b.getChildRect(o))}),N},getChildRect:function($){var I;return ng($)&&$.s(rc)&&(vh($)&&$.isExpanded()&&$.eachChild(function(R){I=zs(I,$.getChildRect(R))}),!I&&$.getRect&&(I=$.getRect())),I},setPosition:function(s,h){var m=this;if(!m._54I){var S;S=2===arguments.length?{x:s,y:h}:s,qh||m._53I||(m._54I=1,Nk(m._children,S.x-m._position.x,S.y-m._position.y),delete m._54I),oi.superClass.setPosition.call(this,S)}},toggle:function(){this.setExpanded(!this.isExpanded())},isExpanded:function(){return this._57O},setExpanded:function(O){var X=this;if(X._57O!==O){var s=X._57O;X._57O=O,X.fp("expanded",s,X._57O),X._8I()}},_8I:function(){oi.superClass._8I.call(this),this.eachChild(function(f){ng(f)&&f._8I()})},onStyleChanged:function(s){oi.superClass.onStyleChanged.apply(this,arguments),"group.position"===s&&this._81I()},getSerializableProperties:function(){var e=oi.superClass.getSerializableProperties.call(this);return e.expanded=1,e}});var Hr=X.Block=function(){fk(Hr,this)};zq("Block",qg,{_icon:"block_icon",_clickThroughEnabled:!1,_syncSize:!0,ms_ac:["clickThroughEnabled","syncSize"],getUIClass:function(){return ub},onChildAdded:function(){Hr.superClass.onChildAdded.apply(this,arguments),this.updateFromChildren()},onChildRemoved:function(){Hr.superClass.onChildRemoved.apply(this,arguments),this.updateFromChildren()},updateFromChildren:function(){var E=this;if(!qh&&!E._updatingToChildren&&E._syncSize){var u,C,l,k,X,_=[],c=E.getRotation();if(E.eachChild(function(p){ng(p)&&_.push.apply(_,p.getCorners())}),_.length){E._updatingFromChildren=1;var I=A(-c),V=L(-c),b=1/0,U=-1/0,g=1/0,f=-1/0;for(k=0,X=_.length;X>k;k++)l=_[k],u=l.x,C=l.y,l.x=I*u-V*C,l.y=V*u+I*C,b=d(b,l.x),U=x(U,l.x),g=d(g,l.y),f=x(f,l.y);var p=E.getScale();E.setSize(J((U-b)/p.x),J((f-g)/p.y));var i;p.x<0&&(i=b,b=U,U=i),p.y<0&&(i=g,g=f,f=i),I=A(c),V=L(c);var Z=E.getAnchor();u=b+(U-b)*Z.x,C=g+(f-g)*Z.y,E.setPosition(I*u-V*C,V*u+I*C),delete E._updatingFromChildren}}},setPosition:function(R,S){var v=this;if(!v._updatingToChildren){var B;B=2===arguments.length?{x:R,y:S}:R,qh||v._updatingFromChildren||(v._updatingToChildren=1,Nk(v._children,B.x-v._position.x,B.y-v._position.y),delete v._updatingToChildren),Hr.superClass.setPosition.call(this,B)}},setWidth:function(P){return this.setSize(P,this.getHeight())},setHeight:function(f){return this.setSize(this.getWidth(),f)},setSize:function(L,v){1>L&&(L=1),1>v&&(v=1);var w=this;if(!w._updatingToChildren){2!==arguments.length&&(v=L.height,L=L.width);var m=w.getWidth(),c=w.getHeight();if(L!==m&&Hr.superClass.setWidth.call(w,L),v!==c&&Hr.superClass.setHeight.call(w,v),!qh&&!w._updatingFromChildren){w._updatingToChildren=1;var q=L/m,x=v/c;w._adjustChildScaleOrSize(q,x,"size"),delete w._updatingToChildren,w.updateFromChildren()}}},_adjustChildScaleOrSize:function(s,d,o){var w=this;if(w._syncSize){var l=w.getPosition(),Q=w.getRotation();w.getScale(),w.eachChild(function(V){if(ng(V)){var T=V.getPosition(),F=V.getRotation(),m=V.getWidth(),C=V.getHeight(),R=V.getScale(),z=R.x*m,t=R.y*C,f=new gh(F,T.x,T.y,z,t);f.translate(-l.x,-l.y),f.rotate(-Q),F=g(f.b*Math.sign(z),f.a*Math.sign(z)),f.scale(s,d);var K,a,M,G=A(F);if(Math.abs(G)<.001?(K=L(F),a=f.b/K,M=-f.c/K):(a=f.a/G,M=f.d/G),"scale"===o)V.setScale(a/m,M/C);else if("size"===o){var p=a/R.x,w=M/R.y;V.setScale(me(a)*Math.abs(R.x),me(M)*Math.abs(R.y)),V.setSize(Math.max(.1,Math.abs(p)),Math.max(.1,Math.abs(w)))}f.rotate(Q),f.translate(l.x,l.y),V.setPosition(f.tx,f.ty)}})}},_calcChangeFactor:function($,H,m,_){var Z,s,N,V;return Z=J($),s=J(m),N=Z>s?Z/s:s/Z,Z=J(H),s=J(_),V=Z>s?Z/s:s/Z,x(N,V)},setAnchor:function(){var j=this;if(!j._updatingToChildren){var c=j.getAnchor();if(Hr.superClass.setAnchor.apply(j,arguments),!qh&&!j._updatingFromChildren&&j._syncSize){j._updatingToChildren=1;var p=j.getAnchor();j.getPosition();var C=j.getSize(),Z=j.getScale(),G=j.getRotation(),D=-C.width*Z.x*(c.x-p.x),V=-C.height*Z.y*(c.y-p.y),y=L(G),E=A(G),_=E*D-y*V,b=y*D+E*V;j.eachChild(function(X){if(ng(X)){var Q=X.getPosition();X.setPosition(Q.x-_,Q.y-b)}}),delete j._updatingToChildren}}},setRotation:function(k){var A=this;if(!A._updatingToChildren){var G=A.getRotation();if(Hr.superClass.setRotation.apply(A,arguments),!qh&&!A._updatingFromChildren){A._updatingToChildren=1;var _=A.getPosition(),i=k-G;A.eachChild(function(K){if(ng(K)){var W=K.getMatrix();W.translate(-_.x,-_.y),W.rotate(i),W.translate(_.x,_.y);var A=Math.sign(K.getScale().x);K.setRotation(g(W.b*A,W.a*A)),K.setPosition(W.tx,W.ty)}}),delete A._updatingToChildren}}},setScale:function(A,E){var R=this;if(!R._updatingToChildren){null==E&&(E=A.y,A=A.x);var x=R.getScale();if(J(A)<.01&&(A=.01*(me(A)||me(x.x))),J(E)<.01&&(E=.01*(me(E)||me(x.y))),Hr.superClass.setScale.call(R,A,E),!qh&&!R._updatingFromChildren){R._updatingToChildren=1;var h=A/x.x,z=E/x.y;
R._adjustChildScaleOrSize(h,z,"size"),delete R._updatingToChildren,R.updateFromChildren()}}},getSerializableProperties:function(){var v=Hr.superClass.getSerializableProperties.call(this);return v.clickThroughEnabled=1,v.syncSize=1,v}});var Zq=X.Grid=function(){fk(X.Grid,this)};zq("Grid",qg,{IRotatable:!1,_icon:"grid_icon",_image:T,getUIClass:function(){return Xo},setRotation:function(){},getCellRect:function(W,N){var O=this,d=O.s("grid.row.count"),b=O.s("grid.column.count");if(0>=d||0>=b||0>W||W>=d||0>N||N>=b)return T;var f,R,H,L=O.getRect(),V=O.s("grid.row.percents"),v=O.s("grid.column.percents");if(Ug(L,O,"grid.border",-1),V&&V._as&&(V=V._as),v&&v._as&&(v=v._as),V&&V.length===d){for(H=0,f=0;W>f;f++)H+=L.height*V[f];L.y+=H,L.height=L.height*V[W]}else L.height=L.height/d,L.y+=L.height*W;if(v&&v.length===b){for(R=0,f=0;N>f;f++)R+=L.width*v[f];L.x+=R,L.width=L.width*v[N]}else L.width=L.width/b,L.x+=L.width*N;return fn(L,-O.s("grid.gap")),L}});var il=X.Text=function(){fk(il,this),this.setSize(100,50),this.s("text","TEXT")};zq("Text",qg,{_icon:"text_icon",_image:"__text__",getUIClass:function(){return xh},setWidth:function(F){F||(F=.001),il.superClass.setWidth.call(this,F)},setHeight:function(J){J||(J=.001),il.superClass.setHeight.call(this,J)},toLabel:function(){return this._displayName||this._name||this.s("text")}}),Yk("__text__",{width:{value:100,isSafeFunc:!0,func:function(x){return x._width}},height:{value:50,isSafeFunc:!0,func:function(h){return h._height}},comps:[{type:"text",relative:!0,rect:[0,0,1,1],text:{func:"style@text"},align:{func:"style@text.align"},vAlign:{func:"style@text.vAlign"},color:{func:"style@text.color"},font:{func:"style@text.font"},shadow:{func:"style@text.shadow"},shadowColor:{func:"style@text.shadow.color"},shadowBlur:{func:"style@text.shadow.blur"},shadowOffsetX:{func:"style@text.shadow.offset.x"},shadowOffsetY:{func:"style@text.shadow.offset.y"}}]});var ah=X.Shape=function(){fk(ah,this),this._59O=new ep};ah.__de__=$k,zq("Shape",qg,{ms_ac:["thickness","closePath"],_icon:"shape_icon",_thickness:10,_closePath:!1,getUIClass:function(){return Yh},_22Q:function(){return Fc},getLength:function(K){return iq(dl(this._59O,this._58O,K,this._closePath))},getSegments:function(){return this._58O},toSegments:function(){var N=this._58O;return N?new ep(N._as.slice(0)):N},setSegments:function(q){var W=this._58O;q=q?Lq(q)?new ep(q.slice(0)):new ep(q._as.slice(0)):null,(W&&q&&W._as.join(",")!==q._as.join(",")||W!==q)&&(this._58O=q,this.fp("segments",W,q))},getPoints:function(){return this._59O},toPoints:function(){var K=this._59O;return new ep(K._as.slice(0))},setPoints:function(e,b){var t=this,k=t._59O;e=e?Lq(e)?new ep(e.slice(0)):new ep(e._as.slice(0)):new ep;var Z,f,E,x,o,Q;b&&(Z=t.getPosition(),Q=new gh(t.getRotation(),0,0,t.getScale().x,t.getScale().y)),(k&&e&&k._as.join(",")!==e._as.join(",")||k!==e)&&(t._59O=e,t.fs(),t.fp("points",k,e)),b&&(f=t.getPosition(),E=f.x-Z.x,x=f.y-Z.y,o=Q.tf(E,x),t.setPosition(f.x-E+o.x,f.y-x+o.y))},addPoint:function(H,g,o){var i=this.toPoints();i.add(H,g),this.setPoints(i,o)},setPoint:function(d,e,Q){var C=this.toPoints();C.set(d,e),this.setPoints(C,Q)},removePointAt:function(f){var T=this.toPoints();T.removeAt(f),this.setPoints(T)},setWidth:function(I){var J=this;if(1>I&&(I=1),!J._55I&&!qh&&J.getWidth()){J._55I=1;var X=J._position.x,N=I/J.getWidth(),u=J.toPoints(),L=new ep;u.each(function($){L.add({x:($.x-X)*N+X,y:$.y,e:$.e})}),J.setPoints(L),Di(J,[N,0,0,1,X*(1-N),0]),J.fs(),delete J._55I}ah.superClass.setWidth.call(J,I)},setHeight:function(p){var A=this;if(1>p&&(p=1),!A._55I&&!qh&&A.getHeight()){A._55I=1;var j=A._position.y,z=p/A.getHeight(),m=A.toPoints(),O=new ep;m.each(function(R){O.add({x:R.x,y:(R.y-j)*z+j,e:R.e})}),A.setPoints(O),Di(A,[1,0,0,z,0,j*(1-z)]),A.fs(),delete A._55I}ah.superClass.setHeight.call(A,p)},setAnchorElevation:function(_){var s=this;s._55I=!0;var J=s._updatingAnchor3d,l=!qh&&!J;if(l){var O,m=_,w=s.getAnchorElevation(),r=s.getTall();O=r*(w-m),s.shiftPointsElevation(O)}var o=ah.superClass.setAnchorElevation.apply(s,arguments);return J||delete s._55I,o},getShapeElevation:function(){var u=this,Q=u._54O;return Q-(u.getTall()||0)*(u._anchorElevation-.5)},setAnchor3d:function(P,d,l,Y){var q,H=this;"number"==typeof P?q={x:P,y:d,z:l}:(q=P.length?{x:P[0],y:P[1],z:P[2]}:P,Y=d),H._55I=!0,H._updatingAnchor3d=!0;var w=H.getDataModel();if(w&&w.beginTransaction(),!qh){var i=H.getAnchor3d(),R=H.getSize(),T=H.getTall(),J=R.width*(i.x-q.x),W=R.height*(i.z-q.z),z=T*(i.y-q.y);Y||H.shiftPoints(J,W,z);var C=H.p3()}var N=ah.superClass.setAnchor3d.apply(H,arguments);if(!qh&&Y){var K=H.p3();H.shiftPoints(K[0]-C[0]+J,K[2]-C[2]+W,K[1]-C[1]+z)}return w&&w.endTransaction(),delete H._updatingAnchor3d,delete H._55I,N},setAnchor:function(R,F,N){var s=this;s._55I=!0;var P=s._updatingAnchor3d,l=!qh&&!P;if(l){var x,U,C;"number"==typeof R?C={x:R,y:F}:(C=R.length?{x:R[0],y:R[1]}:R,N=F);var m=s.getAnchor(),k=s.getSize();x=k.width*(m.x-C.x),U=k.height*(m.y-C.y),N||s.shiftPoints(x,U);var V=s.getPosition()}var i=ah.superClass.setAnchor.apply(s,arguments);if(l){var E=s.getPosition();N&&s.shiftPoints(E.x-V.x+x,E.y-V.y+U)}return P||delete s._55I,i},shiftPoints:function(S,E,z){var N=this,D=N.getElevation()||0,W=N.toPoints(),Q=new ep;W.each(function(u){var h=u.e;z&&(h=(h==T?D:h)+z),Q.add({x:u.x+S,y:u.y+E,e:h})}),N.setPoints(Q),N.fs()},shiftPointsElevation:function(j){return this.shiftPoints(0,0,j)},setPosition:function(w,R){var j,u=this;if(!u._28Q){if(u._28Q=1,!u._55I&&!qh){j=2===arguments.length?{x:w,y:R}:w;var t=j.x-u._position.x,O=j.y-u._position.y;if(0===t&&0===O)return delete u._28Q,void 0;u._55I=1,u.shiftPoints(t,O),Di(u,[1,0,0,1,t,O]),delete u._55I}ah.superClass.setPosition.apply(u,arguments),delete u._28Q}},fs:function(){this.fireShapeChange()},_70I:function(){var R=this;if(2!==R._59O.size())return!1;var L=R._58O;return L?2===L.size()&&1===L.get(0)&&2===L.get(1)?!0:!1:!0},fireShapeChange:function(){var c=this;if(!c._55I&&!qh){var B=Zc(c._59O);B&&(c._55I=1,c.setRect(B),delete c._55I)}c.fp(Gg,!1,!0)},getSerializableProperties:function(){var C=ah.superClass.getSerializableProperties.call(this);return C.segments=1,C.points=1,C.thickness=1,C.closePath=1,C}});var Ek=X.Polyline=function(){fk(Ek,this),this.s({"shape.background":null,"shape.border.width":2})};zq("Polyline",ah,{_icon:"polyline_icon",_22Q:function(){return qk},getUIClass:function(){return oh},setClosePath:function(){},setTall:function(u){var m=this;if(!m._55I&&!m._24Q&&!qh&&m.getTall()){m._24Q=1;var w=m._54O,Z=u/m.getTall();m._59O.each(function(q){q.e=q.e==T?w:(q.e-w)*Z+w}),m.fs(),delete m._24Q}Ek.superClass.setTall.call(m,u)},setElevation:function(y){var v=this;if(!v._55I&&!v._24Q&&!qh){v._24Q=1;var X=y-v._54O;v._59O.each(function(t){t.e==T?t.e=y:t.e+=X}),v.fs(),delete v._24Q}Ek.superClass.setElevation.apply(v,arguments)},fireShapeChange:function(){var N=this,$=N._59O;if(!N._55I&&!N._24Q&&!qh){var O=$.size();if(O){var C=1,b=$.get(0),G=N._54O;b.e==T&&(b.e=G);for(var m=b.e,u=0;O>C;C++){b=$.get(C),b.e==T&&(b.e=G);var J=d(m,b.e),r=x(m+u,b.e);m=J,u=r-J}N._24Q=1,N.setTall(u),N.setElevation(m+u*N._anchorElevation),delete N._24Q}}Ek.superClass.fireShapeChange.apply(N,arguments)}});var mg=X.SubGraph=function(){fk(mg,this)};zq("SubGraph",qg,{ISubGraph:1,_image:"subGraph_image",_icon:"subGraph_icon",_8I:function(){mg.superClass._8I.call(this),this.eachChild(function(M){ng(M)&&M._8I()})}}),j.loadingRefGraph=0;var Jg=X.RefGraph=function(){fk(Jg,this)};zq("RefGraph",Hr,{_icon:"refGraph_icon",getRef:function(){return this._ref},setRef:function(Q){var o=this._ref;this._ref=Q,this.fp("ref",o,Q),this.updateRef()},_21I:function(){Jg.superClass._21I.apply(this,arguments),this.updateRef()},updateRef:function(){var H=this;if(j.loadingRefGraph++,H.clearChildrenFromDataModel(),j.loadingRefGraph--,H._ref&&H._dataModel){H._xhrLoadHandler&&(H._xhrLoadHandler.cancel=!0);var S=qh,f=H._xhrLoadHandler=function(O){if(O&&H._dataModel){j.loadingRefGraph++;var d=H._pendingUpdateInfo={needToRestore:S};S&&(d.position=H.p(),d.width=H.getWidth(),d.height=H.getHeight(),d.rotation=H.getRotation(),d.anchor=H.getAnchor(),d.scale=H.getScale()),H.p(0,0),H.setAnchor(.5,.5),H.setRotation(0),H.setScale(1,1);var o=j.parse(O),r=H._dataModel.deserialize(o,H,{justDatas:!0});r.each(function(F){F._refGraph=H}),H.checkPendingUpdateInfo(),j.loadingRefGraph--,j.handleRefGraphLoaded(H,r,o)}};f.xhrLoadCalled=!1,j.load(H._ref,function(U){f.cancel||(f.xhrLoadCalled?f(U):gc(function(){f(U)}))}),f.xhrLoadCalled=!0}},checkPendingUpdateInfo:function(){var X=this,z=X._pendingUpdateInfo;if(!z)return X.onPendingUpdated&&(j.loadingRefGraph++,X.onPendingUpdated(),j.loadingRefGraph--),void 0;var f=!0;this.eachChild(function(k){(k._pendingCheckImageJSON||k._pendingUpdateInfo)&&(f=!1)}),f&&(j.loadingRefGraph++,X._pendingUpdateInfo=null,X.updateFromChildren(),z.needToRestore&&(X.setSize(z.width,z.height),X.setAnchor(z.anchor),X.setRotation(z.rotation),X.setScale(z.scale),X.p(z.position)),this.getParent()instanceof Jg&&this.getParent().checkPendingUpdateInfo(),X.onPendingUpdated&&X.onPendingUpdated(),j.loadingRefGraph--)},getSerializableProperties:function(){var H=Jg.superClass.getSerializableProperties.call(this);return H.ref=1,H}}),X.EdgeGroup=function(z,B){this._70O=z,this._siblings=B;for(var o,G,b=0,h=z.size(),p=y[Mm];h>b;b++)if(o=z.get(b).getStyle(Mm,!1),o!=T){p=o;break}p==T&&(p=!0);var I=j.edgeGroupAgentFunc;for(I&&(G=I(z),G&&G!==z.get(0)&&(z.remove(G),z.add(G,0))),b=0;h>b;b++)z.get(b).s(Mm,p)},zq("EdgeGroup",o,{getEdges:function(){return this._70O},size:function(){return this._70O.size()},get:function(k){return this._70O.get(k)},indexOf:function(a){return this._70O.indexOf(a)},each:function(A,d){this._70O.each(A,d)},getSiblings:function(){return this._siblings},eachSiblingEdge:function(s,o){this._siblings.each(function(h){h._70O.each(s,o)})}});var En=function(h,Z,w){var L=ik[h]={type:h,action:Z};if(w)for(var d in w)L[d]=w[d]};En("host",function(X,R,j){j&&R.setHost(j)},{"delete":{visible:function(K,F){return F.getHost()},action:function(P,J){J.setHost(null)}}}),En("parent",function(g,C,o){o&&C.setParent(o)},{"delete":{visible:function(C,b){return b.getParent()},action:function(Z,z){z.setParent(null)}}}),En("copySize",function(L,e,H){if(H){var w=H.getSize();e.setSize(w)}}),En("copyRotation",function(g,C,l){if(l){var y=l.getRotation();C.setRotation(y)}}),En("edge",function(O,e,N){if(N){var D=new X.Edge(e,N);e.dm().add(D)}}),Rl(j,{setConnectAction:En,getConnectAction:function(e,D){return D=D||e.getCurrentConnectActionType(),ik[D]},doConnectAction:function(g,T,E,c){c=c||g.getCurrentConnectActionType();var r=ik[c];if(!r)return!1;var C=r.action;return C?(C.call(null,g,T,E),!0):!1},doDeleteConnectionAction:function(Q,V,j){j=j||Q.getCurrentConnectActionType();var S=ik[j];if(!S||!S.delete)return!1;var A=S.delete.action;return A?(A.call(null,Q,V),!0):!1}});var df=X.JSONSerializer=function(C,D){this.dm=this._dataModel=C,this._hierarchical=j.forceHierarchicalSerialization?!0:D==T?C.isHierarchicalRendering():D};zq("JSONSerializer",o,{ms_ac:["hierarchical"],serialize:function(L){return j.stringify(this.toJSON(),L)},toJSON:function(){var x=this,o=x.dm,u=o.getRoots(),J=x.json={v:j.getVersion(),p:{},a:{},d:[]},t=o.getSerializableAttrs();o.getInit()&&(J.init=o.getInit()),o.getName()&&(J.p.name=o.getName()),o.getBackground()&&(J.p.background=o.getBackground()),o.getLayers()&&(J.p.layers=o.getLayers()),J.p.autoAdjustIndex=o.isAutoAdjustIndex(),J.p.hierarchicalRendering=o.isHierarchicalRendering();for(var N in t){var i=o.a(N);i!==p&&x[Xi](N,i,J.a)}return hg(J.a)&&delete J.a,x._hierarchical?u.each(x.serializeData,this):o.each(function(R){x.serializeData(R)}),J},isSerializable:function(){return!0},getProperties:function(e){return e.getSerializableProperties()},getStyles:function(e){return e.getSerializableStyles()},getAttrs:function(x){return x.getSerializableAttrs()},serializeData:function(Q){var I=this;if(I.isSerializable(Q)&&!Q._refGraph){var r,N,i,E,O=nb(Q.getClassName())||Q.getClass(),h=new O,m={c:Q.getClassName(),i:Q.getId(),p:{},s:{},a:{}};I.json.d.push(m),r=I.getProperties(Q);for(N in r)/^_/.test(N)?(i=Q[N],i!==h[N]&&I[Xi](N.substr(1),i,m.p)):(E=Vq(N),Q[E]&&(i=Q[E](),i!==h[E]()&&I[Xi](N,i,m.p)));r=I.getStyles(Q);for(N in r)i=Q.s(N),i!==h.s(N)&&I[Xi](N,i,m.s);r=I.getAttrs(Q);for(N in r)i=Q.a(N),i!==h.a(N)&&I[Xi](N,i,m.a);hg(m.p)&&delete m.p,hg(m.s)&&delete m.s,hg(m.a)&&delete m.a}I._hierarchical&&Q.getChildren().each(I.serializeData,I)},serializeValue:function(K,h,n){um(h)?h={__a:h._as}:h instanceof Vk&&(h={__i:h.getId()}),n[K]=h},deserialize:function(N,I,r){var y=this,c=y.dm;c.beginTransaction(),qh++,r=uc(r)?{setId:r}:r||{},N=y.json=Td(N)?j.parse(N):N,y._82I={};var Z=new ep,X=new ep,l=0,_=N.d.length;if(r.justDatas||(zj(N.init)&&N.init(c),c.setInit(N.init)),!r.justDatas){for(var J in N.a)c.a(J,y[Bp](N.a[J]));for(var Y in N.p)c[Lc(Y)](N.p[Y])}for(;_>l;l++){var O=N.d[l],D=nb(O.c),i=new D,q=O.i;r.setId&&q!=T&&(i._id=q),y._82I[q]=i,Z.add(i),X.add(O)}for(l=0;_>l;l++)y.deserializeData(Z.get(l),X.get(l));return Z.each(function(Q){I&&!Q.getParent()&&Q.setParent(I),c.add(Q)}),qh--,c.endTransaction(),Z},deserializeData:function(n,S){for(var k in S.p)n[Lc(k)](this[Bp](S.p[k]));for(k in S.s)n.s(k,this[Bp](S.s[k]));for(k in S.a)n.a(k,this[Bp](S.a[k]))},deserializeValue:function(b){if(Tf(b)){var x=b.__i;if(x!=T)return this._82I[x];if(x=b.__a,Lq(x))return new ep(x)}return b}}),Rl(ih,{serialize:function(X,b){return new df(this,b).serialize(X)},toJSON:function(i){return new df(this,i).toJSON()},deserialize:function(h,G,Y){return new df(this).deserialize(h,G,Y)}});var hf=X.OverlappingBox=function(V){this.gv=V,this.boxes={}};zq("OverlappingBox",o,{clear:function(){var U,u,X=this.boxes;for(U in X)u=X[U],u.length=0},isOverlapping:function(b,q){var $,m,y=this,n=y.boxes,v=n[b];v?($=v.rects,m=v.length):v=n[b]={rects:$=[],length:m=0};var B,G,q;for(B=0;m>B;B++)if(G=$[B],G.x<q.x+q.w&&G.x+G.w>q.x&&G.y<q.y+q.h&&G.h+G.y>q.y)return!0;return $.length<=m?($.push(q),v.length++):$[v.length++]=q,!1}}),dh.GraphView=function(l){var I=this;I._24I={},I._34I=new ep,I._25I={},I._56I={},I._view=tm(1,I),I._canvas=im(I._view),I.dm(l?l:new ih),this._coreInteractor=new Qr(this),I.setEditable(!1),I.setScrollBarVisible(j.graphViewScrollBarVisible)},kp("GraphView",o,{ms_v:1,ms_gv:1,ms_bnb:1,ms_tip:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,_52o:1,_51o:1,ms_ac:[Li,Iq,ri,di,"resettable","editInteractor",Qe,"pannable","rectSelectable","autoScrollZone",Vo,"movableFunc","editableFunc","pointEditableFunc","rectEditableFunc","rotationEditableFunc","anchorEditableFunc","rectSelectBackground","rectSelectBorderColor","editPointSize","editPointBorderColor","editPointBackground","hoverDelay"],_resettable:j.graphViewResettable,_pannable:j.graphViewPannable,_rectSelectable:j.graphViewRectSelectable,_autoScrollZone:j.graphViewAutoScrollZone,_rectSelectBackground:j.graphViewRectSelectBackground,_rectSelectBorderColor:j.graphViewRectSelectBorderColor,_editPointSize:j.graphViewEditPointSize,_editPointBorderColor:j.graphViewEditPointBorderColor,_editPointBackground:j.graphViewEditPointBackground,_scrollBarColor:Pe,_scrollBarSize:cg,_autoHideScrollBar:Lf,_autoMakeVisible:sl,_currentActionType:"host",getCoreInteractor:function(){return this._coreInteractor},getLayers:function(){return this._dataModel.getLayers()},setLayers:function(G){this._dataModel.setLayers(G)},setEditable:function(E){var w=this,T=w.__interactorMap__;if(!T){var j=dh.XEditInteractor;T=w.__interactorMap__={scrollBar:new Nc(w),select:new Mr(w),edit:j?new j(w):new nj(w),move:new om(w),"default":new ls(w),touch:new te(w,{editable:!1})}}E?(w._uieditable=!0,w.setInteractors([T.scrollBar,T.select,T.edit,T.move,T.default,T.touch])):(w._uieditable=!1,w.setInteractors([T.scrollBar,T.select,T.move,T.default,T.touch]))},getCanvas:function(){return this._canvas},_33I:function(D){var x=D.getUIClass();return x?new x(this,D):T},getDataUI:function(z){var E=this,b=E._25I[z._id];return b===p&&(b=E._33I(z),E._25I[z._id]=b),b},getNodeRect:function(O){return j.getNodeRect(this,O)},getEdgeInfo:function(m){var o=this.getDataUI(m);return o?(o._79o(),o._78o):null},getEdgeSourcePosition:function(o){var y=this,r=y.getDataUI(o),g=r.s,u=r._data._40I;return Ec(y,u,g("edge.source.position"),g("edge.source.offset.x"),g("edge.source.offset.y"),g("edge.source.anchor.x"),g("edge.source.anchor.y"))},getEdgeTargetPosition:function(_){var M=this,N=M.getDataUI(_),T=N.s,b=N._data._41I;return Ec(M,b,T("edge.target.position"),T("edge.target.offset.x"),T("edge.target.offset.y"),T("edge.target.anchor.x"),T("edge.target.anchor.y"))},invalidateAll:function(x){var i=this;if(x){for(var I in i._25I){var d=i._25I[I];d&&d.dispose()}i._25I={},i._56I={},i._24I={},i._34I.clear(),i.redraw()}else i.dm().each(function(W){i.invalidateData(W)})},invalidateSelection:function(){var H=this;H.sm().each(function(R){H.invalidateData(R)})},invalidateData:function(i){var e=this;e._24I[i._id]=i,e._21Q(i),e.iv()},_21Q:function(h){var Y=this,e=Y._24I;if(le(h)&&wp[h.s(Dc)]){var t=h.getSourceAgent();t&&t.getAgentEdges().each(function(G){e[G._id]=G}),t=h.getTargetAgent(),t&&t.getAgentEdges().each(function(J){e[J._id]=J}),Y.iv()}},redraw:function(Q){var n=this;n._32I||(Q?n._34I.add(Q):(n._32I=1,n._34I.clear()),n.iv())},each:function(s,t){var T,d,r,Q=0,M=this.getLayers(),m=this._dataModel,V=m._datas._as,e=V.length;if(M){for(var F=M.length;F>Q;Q++)if(r=M[Q],Tf(r)&&(r=r.name),m.isHierarchicalRendering()){var X=function(q){return q._layer===r?t?s.call(t,q):s(q):void 0};if(this._dataModel.eachByHierarchical(X)===!1)return}else for(var q=0;e>q;q++)if(T=V[q],T._layer===r&&(d=t?s.call(t,T):s(T),d===!1))return}else if(m.isHierarchicalRendering())this._dataModel.eachByHierarchical(s,null,t);else for(;e>Q;Q++)if(T=V[Q],d=t?s.call(t,T):s(T),d===!1)return},reverseEach:function(u,U){var C,R,F,E,c=this._dataModel,Q=c._layers,q=c._datas._as,T=q.length;if(Q){for(C=Q.length-1;C>=0;C--)if(E=Q[C],Tf(E)&&(E=E.name),c.isHierarchicalRendering()){var D=function(R){return R._layer===E?U?u.call(U,R):u(R):void 0};if(c.reverseEachByHierarchical(D)===!1)return}else for(var K=T-1;K>=0;K--)if(R=q[K],R._layer===E&&(F=U?u.call(U,R):u(R),F===!1))return}else if(c.isHierarchicalRendering())c.reverseEachByHierarchical(u,null,U);else for(C=T-1;C>=0;C--)if(R=q[C],F=U?u.call(U,R):u(R),F===!1)return},getViewRect:function(){return this._29I},getContentRect:function(){var K=this,N=K._84I;if(!N){var D=this.dm().a("width"),P=this.dm().a("height");D>0&&P>0?K._84I={x:0,y:0,width:D,height:P}:(K.each(function(O){K.isVisible(O)&&(N=zs(N,K.getDataUIBounds(O)))}),K._84I=N?N:_n)}return K._84I},getScrollRect:function(){return zs(this.getContentRect(),this._29I)},makeCenter:function(F,N,O){var m=this;if(!m.getWidth()||!m.getHeight())return O||gc(m.centerData,m,[F,N,!0],500),void 0;m.makeVisible(F),m.validate();var w=m.getDataUIBounds(F);if(w){var j=m.getWidth(),q=m.getHeight(),L=w.x+w.width/2,k=w.y+w.height/2,i=-L*m._zoom+j/2,s=-k*m._zoom+q/2;m.setTranslate(i,s,N)}},fitData:function(I,X,W,w,i){var b=this;if(!b.getWidth()||!b.getHeight())return i||gc(b.fitData,b,[I,X,W,w,!0],500),void 0;var E=function(){b.makeVisible(I),b.validate();var A=b.getDataUIBounds(I);A&&(A=tq(A),fn(A,W==T?20:W),b.fitRect(A,X,w))};X?j.callWhenLoaded(E):E()},fitContent:function(W,w,k,u){var f=this;if(!f.getWidth()||!f.getHeight())return u||gc(f.fitContent,f,[W,w,k,!0],500),void 0;var Y=function(){f.validate();var K=tq(f.getContentRect());fn(K,w==T?20:w),f.fitRect(K,W,k)};W?j.callWhenLoaded(Y):Y()},fitRect:function(H,g,W){var p=this,k=p.getWidth(),R=p.getHeight(),L=H.x+H.width/2,D=H.y+H.height/2,F=d(k/H.width,R/H.height),A=p._zoom,O=-L*A+k/2,B=-D*A+R/2;0===F||isNaN(F)||(W&&(F=d(1,F)),g?p.setTranslate(O,B,{finishFunc:function(){p.setZoom(F,g)}}):(p.setTranslate(O,B),p.setZoom(F)))},toCanvas:function(G,B){B=B||this._zoom,this.validateImpl();var s=this,Q=s.getContentRect();Q.width||(Q.width=10),Q.height||(Q.height=10);var z=im(),g=Q.x*B,q=Q.y*B,c=Q.width*B,i=Q.height*B;Df(z,c,i,1);var e=nd(z);return G=G||this._dataModel.getBackground(),G&&eo(e,0,0,c,i,G),Pc(e,-g,-q),e.scale(B,B),s._42(e),e.restore(),z},toDataURL:function(c,X,f){return this.toCanvas(c,f).toDataURL(X||"image/png",1)},getClipBounds:function(){return this._74O},_42:function(v,F){var Z,Y,P=this;P._93db(v,F),P.each(function(g){P._56I[g._id]&&(Z=P.getDataUI(g),Z&&(Y=Z._79o(),X.HtmlNode&&g instanceof X.HtmlNode?Z._42(v):(!F||Ne(F,Y))&&Z._42(v)))}),P._92db(v,F)},validateImpl:function(){var l,Z,A,p,U,i=this,m=i.tx(),$=i.ty(),w=i._zoom,X=i._canvas,b=this.getWidth(),Y=this.getHeight(),Q=i._29I,e={x:-m/w,y:-$/w,width:b/w,height:Y/w},L={},z=i._34I,C=i._24I,P=i._32I,h=i._23I;i._24I={},(b!==X.clientWidth||Y!==X.clientHeight)&&(Df(X,b,Y),P=1),P||es(e,Q)||(P=1),i._29I=e,i.each(function(B){Z=B._id;var W=L[Z]=i.isVisible(B);W!==i._56I[Z]&&(C[Z]=B,A=i.getDataUI(C[Z]),A&&A._84o(W),i._84o(B,W))},i);for(Z in C)A=i.getDataUI(C[Z]),A&&(!P&&i._56I[Z]&&(U=A._79o(),U&&z.add(U)),A.invalidate()),i._83I=1;if(i._56I=L,!P)for(Z in C)L[Z]&&(A=i.getDataUI(C[Z]),A&&(U=A._79o(),U&&z.add(U)));if(P?p=e:(z.each(function(P){Ne(e,P)&&(p=zs(p,P))}),p&&(fn(p,x(1,1/w)),p.x=I(p.x*w)/w,p.y=I(p.y*w)/w,p.width=D(p.width*w)/w,p.height=D(p.height*w)/w,p=Id(e,p))),i._74O=p,p){l=nd(X);var E=p.x,f=p.y,s=p.width,V=p.height;E=Math.floor((E*w+m)*fs),f=Math.floor((f*w+$)*fs),s=Math.ceil(s*w*fs)+1,V=Math.ceil(V*w*fs)+1,l.beginPath(),l.rect(E,f,s,V),l.clip(),l.clearRect(E,f,s,V),vb(l,m,$,w),i._42(l,p),l.restore(),delete i._74O}if(z.clear(),delete i._32I,h&&b>0&&Y>0){var A=i.getDataUI(h);if(A){var U=A._79o(),n=i._29I,_=n.x,t=n.y,F=n.width,u=n.height,w=i._zoom;U&&!Ne(U,n)&&(U.x+U.width<_&&i.tx(-U.x*w),U.x>_+F&&i.tx(-(U.x+U.width-F)*w),U.y+U.height<t&&i.ty(-U.y*w),U.y>t+u&&i.ty(-(U.y+U.height-u)*w))}delete i._23I}i._83I&&(delete i._83I,delete i._84I),i._98O(),hg(i._24I)||gc(i.iv,i)},isScrollBarVisible:function(){return!!this._79O},setScrollBarVisible:function(n){var U=this;n!==U.isScrollBarVisible()&&(n?(Pb(U._view,U._79O=rs()),Pb(U._79O,U._27I=rs()),Pb(U._79O,U._28I=rs())):(ss(U._79O),delete U._79O,delete U._27I,delete U._28I),U.fp("scrollBarVisible",!n,n))},showScrollBar:function(){var Y=this;Y._79O&&(Y._85I||(e(function(){Y._86I()},Uj),Y.iv()),Y._85I=new Date)},_86I:function(){var E=this;if(E._85I){var S=new Date,d=S.getTime();d-E._85I.getTime()>=Uj?(delete E._85I,E.iv()):e(function(){E._86I()},Uj)}},_98O:function(){var R=this,q=this._27I,U=this._28I;if(R._79O){if(R._autoHideScrollBar&&!R._85I)return q.style.visibility=Qp,U.style.visibility=Qp,void 0;var N=R.getScrollBarColor(),F=R._zoom,J=R.getScrollBarSize(),b=R.getViewRect(),m=R.getScrollRect(),X=b.height*F,L=m.height*F,Q=b.width*F-J-2,I=X*((b.y-m.y)*F/L),y=X*(X/L),H=q.style;L-.5>X?(mf>y&&(I=I+y/2-mf/2,0>I&&(I=0),I+mf>X&&(I=X-mf),y=mf),yj(q,Q,I,J,y),H.visibility=Sp,H.background=N,H.borderRadius=J/2+Gj):H.visibility=Qp;var Z=b.width*F,g=m.width*F,I=b.height*F-J-2,Q=Z*((b.x-m.x)*F/g),C=Z*(Z/g),H=U.style;g-.5>Z?(mf>C&&(Q=Q+C/2-mf/2,0>Q&&(Q=0),Q+mf>Z&&(Q=Z-mf),C=mf),yj(U,Q,I,C,J),H.visibility=Sp,H.background=N,H.borderRadius=J/2+Gj):H.visibility=Qp}},setDataModel:function(Q){var H=this,e=H._dataModel,M=H._selectionModel;e!==Q&&(e&&(e.ump(H.handleDataModelPropertyChange,H),e.umm(H.handleDataModelChange,H),e.umd(H.handleDataPropertyChange,H),e.removeIndexChangeListener(H._75O,H),e.removeHierarchyChangeListener(H.handleHierarchyChange,H),M||e.sm().ums(H.handleSelectionChange,H)),H._dataModel=Q,Q.mp(H.handleDataModelPropertyChange,H),Q.mm(H.handleDataModelChange,H),Q.md(H.handleDataPropertyChange,H),Q.addIndexChangeListener(H._75O,H),Q.addHierarchyChangeListener(H.handleHierarchyChange,H),M?M._21I(Q):Q.sm().ms(H.handleSelectionChange,H),H.invalidateAll(!0),H.fp(Uo,e,Q),H._canvas.style.background=Q.getBackground()||"")},getLayersInfo:function(){if(this._layersInfo===p){var X=this.getLayers();X?(this._layersInfo={},X.forEach(function(M){var h=Tf(M)?M.name:M;this._layersInfo[h]=M},this)):this._layersInfo=null}return this._layersInfo},updateLayers:function(){this._layersInfo=p,this.invalidateSelection(),this.redraw()},handleDataModelPropertyChange:function(m){if("background"===m.property){var z=this._canvas.style.background,W=m.newValue||"";this._canvas.style.background=W,this.fp("canvasBackground",z,W)}else"a:width"===m.property||"a:height"===m.property?(this._83I=1,this.redraw()):"layers"===m.property?this.updateLayers():"hierarchicalRendering"===m.property&&this.redraw()},handleDataPropertyChange:function(Y){this.dm().isHierarchicalRendering()&&"parent"===Y.property&&Y.data.hasChildren()&&this.redraw(),this.invalidateData(Y.data)},onPropertyChanged:function(I){var b=this,Q=I.property;if(b.redraw(),"zoom"===Q){var l=b.sm().getSelection();l.size()&&l.each(function(X){X.invalidate()})}Bg[Q]?b.showScrollBar():Q===Qe&&b.onCurrentSubGraphChanged(I)},onCurrentSubGraphChanged:function(){this.sm().cs(),this.reset()},handleDataModelChange:function(p){var c=this,S=p.kind,q=p.data;if(c._83I=1,"add"===S)c.invalidateData(q),le(q)&&q.getEdgeGroup()&&q.getEdgeGroup().eachSiblingEdge(c.invalidateData,c);else if(S===ym){c._21Q(q);var Q=q._id,y=c._25I[Q];if(y){if(c._56I[Q]){var w=y._79o();w&&c.redraw(w)}y.dispose(),delete c._25I[Q],delete c._24I[Q],delete c._56I[Q]}q===c._currentSubGraph&&c.setCurrentSubGraph(T)}else S===Sb&&(c.invalidateAll(!0),c.setCurrentSubGraph(T))},_75O:function(B){this.invalidateData(B.data)},handleHierarchyChange:function(L){this.dm().isHierarchicalRendering()&&L.data.hasChildren()&&this.redraw(),this.invalidateData(L.data)},adjustIndex:function(U){var A=this;if(A.isVisible(U)){A.dm().beginTransaction();for(var p=U;p._parent&&A.isVisible(p._parent);)p=p._parent;p&&p!==U&&A._dataModel.adjustIndex(p),A._dataModel.adjustIndex(U),A.dm().endTransaction()}},getImage:function(X){return X.getImage?X.getImage():p},getSelectWidth:function(M){var u=dq(this.getImage(M));return u&&Aq(u.disableSelectedBorder,M,this)?0:M.s("select.width")},isSelectable:function(E){if(!this._clickThroughChecking&&E.getParent()instanceof Hr&&E.getParent().isSyncSize())return!1;var K=this.getLayersInfo();if(K){var c=K[E._layer];if(c&&c.selectable===!1)return!1}return E.s("2d.selectable")&&this.sm().isSelectable(E)},isMovable:function(w){var N=this;if(le(w)&&w.getStyle(Dc)!==lq)return!1;var I=this.getLayersInfo();if(I){var Y=I[w._layer];if(Y&&Y.movable===!1)return!1}return w.s("2d.movable")?N._movableFunc?N._movableFunc(w):!0:!1},isEditable:function(S){var Q=this;if(X._uiSerializing)return Q._uieditable;if(!Q._editInteractor||!Q.isSelected(S))return!1;if(vh(S)){var p=Q.getDataUI(S);if(!p||p._88I)return!1}if(le(S)&&S.getStyle(Dc)!==lq)return!1;var B=this.getLayersInfo();if(B){var t=B[S._layer];if(t&&t.editable===!1)return!1}return S.s("2d.editable")?Q._editableFunc?Q._editableFunc(S):!0:!1},handleDelete:function(){this._editInteractor&&(this._editInteractor.handleDelete?this._editInteractor.handleDelete():this.removeSelection())},isPointEditable:function(I){return ng(I)&&0!==I.getRotation()?!1:this._pointEditableFunc?this._pointEditableFunc(I):!0},isRectEditable:function(C){return this._rectEditableFunc?this._rectEditableFunc(C):!0},isAnchorEditable:function(x){return this._anchorEditableFunc?this._anchorEditableFunc(x):!0},isRotationEditable:function(c){return c.setRotation&&c.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(c):!0:!1},getRotationPoint:function(v){var k=v.getAnchor(),Y=v.getScale(),s=this._zoom,u=mo(v.getRotation(),0,-v.getHeight()*Y.y*k.y-(Y.y<0?-1:1)*(Rp?32:16)/s),i=v.p();return u.x+=i.x,u.y+=i.y,u},getLogicalPoint:function(B){var b=this;return ag(B,b._canvas,b.tx(),b.ty(),b._zoom,b._zoom)},getSelectedDataAt:function(C){var K=this;return this.getDataAt(C,function(p){return K.isSelected(p)})},getDataInfoAt:function(v,x,u){var S,O=this.lp(v),h=this.getDataAt(O,x,u);if(h){var Z=this.getDataUI(h);S={data:h,ui:Z,point:O};var U=Z._38o;if(U){var A=U.icons;for(var t in A){var n=A[t],b=U.rects[t];if(b)for(var K=Aq(n.names,h,this),I=K?K.length:0,l=b.rotation,$=I-1;$>=0;$--){var V=K[$],w=b[$];if(Co(w,O,l))return S.part="icons",S.name=t,S.icon=V,S.rect=w,S.index=$,S.rotation=l,S}}}if(this.isNoteVisible(h)){if(Z.note2Info&&Co(Z.note2Info.clickRect,O,T,Z.note2Info.scale))return S.part="note2",S;if(Z.noteInfo&&Co(Z.noteInfo.clickRect,O,T,Z.noteInfo.scale))return S.part="note",S}if(this.isLabelVisible(h)){if(Z.label2Info&&Co(Z.label2Info.rect,O,Z.label2Info.rotation,Z.label2Info.scale))return S.part="label2",S;if(Z.labelInfo&&Co(Z.labelInfo.rect,O,Z.labelInfo.rotation,Z.labelInfo.scale))return S.part="label",S}if(h.isInRect&&h.isInRect(O))return S.part="body",S}return S},getDataAt:function(b,n,a){b.target&&(b=this.lp(b));var l,E=this._zoom;return this.reverseEach(function(q){return(n?n(q):this.isSelectable(q))&&this.rectIntersects(q,os(b.x,b.y,a,E))?(l=q,!1):void 0},this),l},getIconInfoAt:function(a,R){var S=this;if(a.target&&(a=S.lp(a)),R||(R=S.getDataAt(a)),R){var k=S.getDataUI(R);if(k&&k._38o){var X,c=k._38o,j=new ep;for(X in c.icons)j.add(X);for(var o=j.size()-1;o>=0;o--){X=j.get(o);for(var O=c.rects[X],$=O.rotation,s=O.length-1;s>=0;s--){var L=O[s],m=L.width,D=L.height,v={x:a.x-L.x-m/2,y:a.y-L.y-D/2};$!=T&&(v=mo(-$,v.x,v.y));var L={x:-m/2,y:-D/2,width:m,height:D};if(Co(L,v))return{key:X,index:s,name:c.icons[X].names[s],rect:O[s],point:a,rotation:$,relativeRect:L,relativePoint:v,data:R}}}}}return T},getDatasInRect:function(q,E,H){H===p&&(H=1);var W=this,V=new ep;return W.reverseEach(function(o){H&&!W.isSelectable(o)||(E?W.rectIntersects(o,q):W.rectContains(o,q))&&V.add(o)}),V},moveSelection:function(V,M){var E=this;E.dm().beginTransaction(),Nk(E.sm().toSelection(E.isMovable,E),V,M),E.dm().endTransaction()},moveDatas:function(Q,p,K){var $=this;$.dm().beginTransaction(),Q instanceof ep||(Q=new ep(Q)),Nk(Q,p,K),$.dm().endTransaction()},getDataUIBounds:function(a){var W=this.getDataUI(a);return W?W._79o():T},drawData:function(T,o){var _=this.getDataUI(o);_&&(_._79o(),_._42(T)),o instanceof X.Block&&o.eachChild(function(o){this.drawData(T,o)},this)},getBoundsForGroup:function(s){return s.s(rc)?this.getDataUIBounds(s):T},rectIntersects:function(R,J){this.validate();var Q=T;if(this._56I[R._id]){var t=this._25I[R._id];if(t){var M=t._79o();if(Wd(J,M))Q=!0;else if((J=Id(J,M))&&(t.rectIntersects&&(Q=t.rectIntersects(J)),Q==T)){if(!R.s("pixelPerfect"))return!0;var b=J.x,y=J.y,$=J.width,E=J.height,N=this._zoom,G=j.hitMaxArea,Z=$*E*N*N;if(Z>G){var W=Math.sqrt(G/Z);N*=W}$*=N,E*=N,2>$&&($=2),2>E&&(E=2),b*=N,y*=N;var c=Dg($,E);Pc(c,-b,-y),c.scale(N,N),this._drawForChecking=!0,this.drawData(c,R),this._drawForChecking=!1;try{for(var D=0,O=c.getImageData(0,0,$,E).data;D<O.length;D+=4)if(0!==O[D+3]){Q=!0;break}c.restore()}catch(r){Zn=T,Q=!1}}}}return Q?!0:!1},rectContains:function(z,A){if(this._56I[z._id]){var c=this._25I[z._id];if(c)return Wd(A,c._79o())}return!1},reset:function(){this.setZoom(1),this.setTranslate(0,0)},handleKeyDown:function(O){if(!j.isInput(O.target)){var q=this,J=q._focusData,o=J&&q._25I[J._id],i=0,Y=q._dataModel._datas;if(!(J&&J._enabled&&J._editable&&o&&o.onKeyDown&&o.onKeyDown(O)===!0))if(9===O.keyCode&&(J&&(i=Y.indexOf(J),wc(O)?-1===--i&&(i=0):++i===Y.size()&&(i=0)),q._focusData=J=Y.get(i),q.sm().setSelection(J)),mq(O)?q.selectAll():ir(O)&&q.isResettable()&&q.reset(),q.sm().isEmpty()){if(q._editing)return;var g=q.tx(),b=q.ty(),R=!1,N=wc()?100:10;Ip(O)&&(g-=N,R=!0),ig(O)&&(b-=N,R=!0),Xk(O)&&(g+=N,R=!0),We(O)&&(b+=N,R=!0),R&&q.setTranslate(g,b)}else{vc(O)&&q.handleDelete(O);var t=wc()?10:1;Ip(O)&&(q.moveSelection(-t,0),q.fi({kind:"moveLeft"})),ig(O)&&(q.moveSelection(0,-t),q.fi({kind:"moveUp"})),Xk(O)&&(q.moveSelection(t,0),q.fi({kind:"moveRight"})),We(O)&&(q.moveSelection(0,t),q.fi({kind:"moveDown"}))}}},handleScroll:function(p,I){Gp(p);var H=this.lp(p);I>0?this.scrollZoomIn(H):0>I&&this.scrollZoomOut(H)},handlePinch:function(u,p,m){this._68I||(p>m?this.pinchZoomIn(u):this.pinchZoomOut(u))},checkDoubleClickOnNote:function(O,h){var n=this,Y=n.lp(O),X=n.getDataUI(h),A=X.note2Info;
return A&&h.s("note2.toggleable")&&Co(A.clickRect,Y)?(h.s(lg,!h.s(lg)),n.fi({kind:"toggleNote2",event:O,data:h}),!0):(A=X.noteInfo,A&&h.s("note.toggleable")&&Co(A.clickRect,Y)?(h.s(Em,!h.s(Em)),n.fi({kind:"toggleNote",event:O,data:h}),!0):!1)},_84o:function(){},isNoteVisible:function(){return this._zoom>.15},isLabelVisible:function(){return this._zoom>.15},isEditVisible:function(){return this._zoom>.15},autoScroll:function(f,r){var u=this,i=u.getAutoScrollZone(),t=i/u.getZoom(),B=i/4,_=u._29I,V=u.lp(f),A={x:u.tx(),y:u.ty()};return V&&i>0&&_&&(V.x-_.x<t?u.translate(B,0):_.x+_.width-V.x<t&&u.translate(-B,0),V.y-_.y<t?u.translate(0,B):_.y+_.height-V.y<t&&u.translate(0,-B)),A.x=u.tx()-A.x,A.y=u.ty()-A.y,r&&(r.x+=A.x,r.y+=A.y),A},getMoveMode:function(k,s){var w=s.s("2d.move.mode");return w?w:Qm["88"]?"x":Qm["89"]?"y":"xy"},getSerializableProperties:function(){return{scrollBarColor:1,scrollBarSize:1,autoMakeVisible:1,autoHideScrollBar:1,editable:1,resettable:1,pannable:1,rectSelectable:1,autoScrollZone:1,visibleFunc:1,movableFunc:1,editableFunc:1,pointEditableFunc:1,rectEditableFunc:1,anchorEditableFunc:1,rotationEditableFunc:1,rectSelectBackground:1,rectSelectBorderColor:1,editPointSize:1,editPointBorderColor:1,editPointBackground:1,hoverDelay:1,dataModel:1,selectionModel:1,currentSubGraph:1,zoom:1,translateX:1,translateY:1}},serializeProperty:function(i,D,F){var A=this;return"currentSubGraph"===D?{__i:i.getId()}:F.serializeProperty(i,D,A)},deserializeProperty:function(d,k,l){var Q=this;if("currentSubGraph"===k){var S=Q.dm(),B=S.__idMap;return B[d.__i]}return l.deserializeProperty(d,k,Q)},setDefaultCursor:function(z,Y){this._defaultCursor=z,Y!==!1&&this.setCursor(z)},setCursor:function(J){"default"===J&&(J=this._defaultCursor||J);var A=this.getView().style;A.cursor=J,A.cursor="-webkit-"+J,A.cursor="-moz-"+J},getCurrentConnectActionType:function(){return this._currentActionType},setCurrentConnectActionType:function(t){return j.getConnectAction(null,t)?(this._currentActionType=t,!0):!1},isInteractive:function(O){return O.s("interactive")}});var jf=function(B,v){var L=this;L.gv=B,L.s=function(q){return v.getStyle(q)},L._data=v,L._87I=new ep};gb(jf,o,{_6I:T,ms_icons:1,_84o:function(){},dispose:function(){},isShadowed:function(){return this.s("shadow")||this.gv.isSelected(this._data)&&"shadow"===this.s("select.type")},getSelectWidth:function(){var T=this,r=T.gv.isSelected(T._data);return!r||T.isShadowed()?0:T.gv.getSelectWidth(T._data)},getBodyColor:function(k){var _=this._data,v=this.gv.getBodyColor(_);return v?v:k?_.getStyle(k):T},_2Q:function(S){return this.s(S)},_1Q:function($,n,z,d){var V=this.s,x=V(n+".dash.color");$.strokeStyle=x,$.lineWidth=z,$.stroke(),V(n+".dash.3d")&&ps($,x,V(n+".dash.3d.color"),z,this.gv._zoom,V(n+".dash.3d.accuracy")),vk($,d)},invalidate:function(){this._6I=T},_79o:function(){var U=this;if(!U._6I){var W=U._data,z=U.gv;U.labelInfo=U.label2Info=U.noteInfo=U.note2Info=U._38o=T,U._87I.clear(),U.interactiveInfo=z.isInteractive(W)?{}:T,U._3O(),U._55O=z.isEditable(W)?{_42O:z.isRectEditable(W),_43O:z.isPointEditable(W),_56O:z.isRotationEditable(W)}:T,U._6I=U._81o()}return U._6I},_3O:function(){},getPosition:function(){return _n},_68o:function(z,m){z&&this._87I.add($n(z,m))},_81o:function(){var z=this,I=z.s;z._24O(as,"getLabel"),z._24O(ki,"getLabel2"),z._26O(ys,"getNote"),z._26O(af,"getNote2"),z._15O(),z._55O&&z._48O();var y;if(z._87I.each(function(Q){y=zs(y,Q)}),y&&z.isShadowed()){var E=tq(y);E.x+=I("shadow.offset.x"),E.y+=I("shadow.offset.y"),fn(E,I("shadow.blur")),y=zs(y,E)}return z._87I.clear(),y},_42:function($){var U=this,V=U._data,I=U.gv,H=U.s,F=H("opacity"),z=this.isShadowed();if(z){var B=$.shadowOffsetX,o=$.shadowOffsetY,v=$.shadowBlur,G=$.shadowColor,r=I.getZoom();$.shadowOffsetX=H("shadow.offset.x")*r,$.shadowOffsetY=H("shadow.offset.y")*r,$.shadowBlur=H("shadow.blur")*r,$.shadowColor=H("select.color")}if(F!=T){var c=$.globalAlpha;$.globalAlpha=F}U._80o($),I.isLabelVisible(V)&&((!I._drawForChecking||H("label.selectable"))&&Nq($,U.labelInfo),(!I._drawForChecking||H("label2.selectable"))&&Nq($,U.label2Info)),I.isNoteVisible(V)&&(bp($,U.noteInfo),bp($,U.note2Info)),U._99O($),F!=T&&($.globalAlpha=c),z&&($.shadowOffsetX=B,$.shadowOffsetY=o,$.shadowBlur=v,$.shadowColor=G)},_80o:function(){},_47O:function(){},_24O:function(c,V){var a=this,K=a._data,j=a.gv,O=a.s,u=j[V](K);if(u!=T){var X=O(c+".scale"),t=O(c+".max"),y=O(c+".position"),L=a[c+"Info"]={label:u,scale:X,color:j[V+"Color"](K),font:O(c+".font"),opacity:O(c+".opacity"),align:O(c+".align"),rotation:a.getRotation(O(c+".rotation"),!1,y),background:j[V+"Background"](K)},k=jq(L,u);t>0&&t<k.width&&(L.labelWidth=k.width,k.width=t),1!==X&&(k.width*=X,k.height*=X);var I=a.getPosition(y,O(c+".offset.x"),O(c+".offset.y"),k,O(c+".position.fixed"));if(k.x=I.x-k.width/2,k.y=I.y-k.height/2,a._68o(L.rect=k,L.rotation),1!==X){var l=k.width/X,d=k.height/X;L.rect={x:I.x-l/2,y:I.y-d/2,width:l,height:d}}}},_26O:function(k,h){var U=this,z=U.gv,V=U._data,M=U.s,a=z[h](V);if(a!=T){var I,Y,j=M(k+".scale"),G=U[k+"Info"]={note:a,scale:j,data:V,view:z,expanded:M(k+".expanded"),font:M(k+".font"),color:M(k+".color"),opacity:M(k+".opacity"),align:M(k+".align"),icon:M(k+".icon"),backgroundImage:M(k+".backgroundImage"),borderWidth:M(k+".border.width"),borderColor:M(k+".border.color"),background:z[h+"Background"](V)},$=U.getPosition(M(k+".position"),M(k+".offset.x"),M(k+".offset.y")),r=$.x,i=$.y;if(G.expanded){var X,L=M(k+".max"),l=M(k+".backgroundImage");l?(l=dq(l),X={width:mc(l,V),height:lh(l,V)}):X=jq(G,a),X.width+=6,X.height+=2,L>0&&L<X.width&&(G.labelWidth=X.width,X.width=L),I=X.width,Y=X.height+8,G.clickRect={x:r-I*j/2,y:i-Y*j,width:I*j,height:Y*j*X.height/Y}}else{var C=M(k+".icon");C?(C=dq(C),I=mc(C,V),Y=lh(C,V)):(I=12,Y=18),G.clickRect={x:r-I*j/2,y:i-Y*j,width:I*j,height:Y*j}}G.rect={x:r-I/2,y:i-Y*j/2-Y/2,width:I,height:Y};var x=D(G.borderWidth/2)*j;U._68o({x:r-I*j/2-x,y:i-Y*j-x,width:I*j+2*x,height:Y*j+2*x})}},_48O:function(){},_99O:function(o){var j=this,E=j._38o;if(E){var v=j.gv,G=j._data,f=E.icons,C=j.interactiveInfo;C&&(C._38o={});for(var z in f){var t=f[z],l=E.rects[z];if(l){C&&(C._38o[z]=[]);var U=Aq(t.opacity,G,v),S=Aq(t.names,G,v),c=S?S.length:0,Y=l.rotation;if(U!=T){var r=o.globalAlpha;o.globalAlpha*=U}for(var W=0;c>W;W++){var K=S[W],d=dq(K),x=l[W];if(Y){var p=x.x+x.width/2,u=x.y+x.height/2;o.save(),Pc(o,p,u),js(o,Y),Pc(o,-p,-u)}C&&C._38o[z].push(o.interactiveInfo={compInfos:[],stacks:Y?[{t:[p,u]},{r:Y},{t:[-p,-u]}]:[]}),hh(o,d,Aq(t.stretch,G,v),x.x,x.y,x.width,x.height,j._data,j.gv),o.interactiveInfo=T,Y&&o.restore()}U!=T&&(o.globalAlpha=r)}}}}});var rn=function(n,C){fk(rn,this,[n,C])};gb(rn,jf,{_checkEmptyRect:!0,_40O:function(n,f){var j=this,L=j.s,W=n.rect;(n.borderColor=j.gv.getBorderColor(j._data))&&(n.borderType=L("border.type"),n.borderWidth=L("border.width"),n.borderPadding=L("border.padding"),f=x(f,n.borderPadding+n.borderWidth/2));var w=j._data.getScale(),T=x(1,x(J(w.x),J(w.y)));if(n.selectWidth=j.getSelectWidth()){var U=j.gv._zoom;n.selectType=L("select.type"),n._97o=L("select.color"),n.selectPadding=L("select.padding"),f=x(f,(n.selectPadding+n.selectWidth/2/U)/T)}f>0&&(f*=T,W=tq(W),fn(W,f)),j._68o(W)},_39O:function(q,l){var B,A=this,M=l.rect;if(l.borderWidth>0&&(B=l.borderPadding,q.strokeStyle=l.borderColor,q.lineWidth=l.borderWidth,Oo(q,l.borderType,{x:M.x-B,y:M.y-B,width:M.width+2*B,height:M.height+2*B}),q.stroke()),l.selectWidth>0){var o=A.gv._zoom;if(B=l.selectPadding,q.strokeStyle=l._97o,q.lineWidth=l.selectWidth/o,l.rotation!=T){q.save(),q.translate(l.position.x,l.position.y),q.rotate(l.rotation);var d=A._data,_=d.getWidth(),e=d.getHeight(),n=l.scale,G=l.anchor;M={x:n.x*-_*G.x,y:n.y*-e*G.y,width:n.x*_,height:n.y*e}}Oo(q,l.selectType,{x:M.x-B,y:M.y-B,width:M.width+2*B,height:M.height+2*B}),l.rotation!=T&&q.restore(),q.stroke()}},_3O:function(){var N=this,t=N.s,l=N._data,n=l.getStyle(Gg),Z=N.getBodyColor(),e=N._83o=n?{shape:n,_53o:N.getBodyColor("shape.background"),_27Q:dq(t("shape.repeat.image"),Z),shapeGradientPack:t("shape.gradient.pack"),_54o:t("shape.border.width"),_55o:t("shape.border.color"),_56o:t("shape.border.3d"),_57o:t("shape.border.3d.color"),_58o:t("shape.border.3d.accuracy"),shapeGradient:t("shape.gradient"),_59o:t("shape.gradient.color"),_60o:t("shape.border.pattern"),_61o:t("shape.border.cap"),_62o:t("shape.border.join"),bodyColor:Z}:{img:dq(N.gv.getImage(l),Z),bodyColor:Z,stretch:t("image.stretch")};if(V&&!W);else{e.rect=l.getRect(),e.position=l.p(),e.scale=l.getScale(),e.anchor=l.getAnchor(),e.rotation=l.getRotation(),n===Lj&&(e._63o=t("shape.depth"));var p=0;if(n)p=wh(T,e._54o/2,e._62o),N.s("shape.dash")&&(p=x(p,(N.s("shape.dash.width")||e._54o)/2));else if(e.img&&e.img.boundExtend)if(p=Aq(e.img.boundExtend,l,N.gv),e.img.boundExtendAbsolute){var o=l.getScale();p/=N.gv._zoom*x(1,x(J(o.x),J(o.y)))}else if(!Aq(e.img.fitSize,l,N.gv)){var A=Aq(e.img.width,l,N.gv),b=Aq(e.img.height,l,N.gv);p*=x(l.getWidth()/A,l.getHeight()/b)}N._40O(e,p);var $=t("clip.percentage");if(1>$&&(0>$&&($=0),e.clipRect=Ci(l.getAnchorRect(),t("clip.direction"),$)),n){var j=t("shape.fill.clip.percentage");1>j&&(0>j&&(j=0),e.shapeClipRect=Ci(l.getAnchorRect(),t("shape.fill.clip.direction"),j))}}},getPosition:function(c,r,C,X){var g=eg(c,this._83o.rect,X);return g.x+=r,g.y+=C,g},_80o:function(g){var B=this,b=B.s,f=B.gv,_=B._data,w=B._83o,k=w.rect,W=w.position,d=w.rotation,C=w.anchor,r=w.scale,S=w.shape,O=w.clipRect;if(!B._checkEmptyRect||k.width>0&&k.height>0){var I=_.getSize();if(I.x=-I.width*C.x,I.y=-I.height*C.y,g.save(),Pc(g,W.x,W.y),js(g,d),pd(g,r.x,r.y),O&&(g.beginPath(),g.rect(O.x,O.y,O.width,O.height),g.clip()),B.freeDraw)B.freeDraw(g,I,w);else if(S){var l,j,q,K,v=w._60o,Q=Dk(g,v),F=w._53o,A=w._27Q,t=w._54o,E=w._55o,G=w.shapeGradientPack,a=g.lineJoin,N=g.lineCap;if("roundRect"===S?l=b("shape.corner.radius"):"polygon"===S?l=b("shape.polygon.side"):"arc"===S&&(l=b("shape.arc.from"),j=b("shape.arc.to"),q=b("shape.arc.close"),K=b("shape.arc.oval")),g.lineJoin=w._62o,g.lineCap=w._61o,F||A||G){var D=w.shapeClipRect;D&&(g.save(),g.beginPath(),g.rect(D.x,D.y,D.width,D.height),g.clip()),Oo(g,S,I,l,j,q,K),G?fc(g,G):A?Ob(g,A,w.bodyColor,null,_,f):Rh(g,F,w.shapeGradient,w._59o,I),g.fill(),D&&g.restore(),G&&g.restore(),g!==Q&&Oo(Q,S,I,l,j,q,K)}else Oo(Q,S,I,l,j,q,K);if(t>0){var L=b("shape.border.width.absolute");L&&(g.save(),g.setTransform(1,0,0,1,0,0)),g.lineWidth=t,g.strokeStyle=E,g.stroke(),L&&g.restore(),w._56o&&ps(g,E,w._57o,t,f._zoom,w._58o)}if(vk(g,v),b("shape.dash")){var R=b("shape.dash.width")||t;if(R>0){v=b("shape.dash.pattern");var Q=Dk(g,v,B._2Q("shape.dash.offset"));Q!==g&&Oo(Q,S,I,l,j,q,K),B._1Q(g,"shape",R,v)}}or(g,F,w._63o,I),g.lineJoin=a,g.lineCap=N}else{var s=B.interactiveInfo;s&&(g.interactiveInfo=s.bodyInfo={compInfos:[],stacks:[{t:[W.x,W.y]},{r:d},{s:[r.x,r.y]}]}),hh(g,w.img,w.stretch,I.x,I.y,I.width,I.height,_,f,w.bodyColor),g.interactiveInfo=T}g.restore()}B._39O(g,w)},_48O:function(){},_47O:function(){}});var id=function(J,m){fk(id,this,[J,m])},kl=function(P,f,N,W){var R=de(P,f);return N=W?d(N,R):Pp(N,R),R?N/=R:N=0,{x:P.x+(f.x-P.x)*N,y:P.y+(f.y-P.y)*N}};gb(id,jf,{_3O:function(){var e,Q=this,m=Q._data,h=Q.gv,L=Q.s,t=L(Dc),i=m.isLooped(),D=L("edge.width"),f=L("edge.center"),J=L("edge.offset"),u=h.getBorderColor(m),a=u?L("border.width"):0,G=Q.getSelectWidth(),I=m._40I,F=m._41I,v=Q._78o=I&&F?{looped:i,type:t,width:D,center:f,color:Q.getBodyColor("edge.color"),borderColor:u,borderWidth:a,_97o:G?L("select.color"):T,selectWidth:G,pattern:L("edge.pattern"),cap:L("edge.cap"),join:L("edge.join"),is3d:L("edge.3d"),_67o:L("edge.3d.color"),_66o:L("edge.3d.accuracy")}:T;if(v){var z=j.getEdgeType(t);if(z){var E=z(m,Ki(Q,h,m,i,t),h,Q._19Q);E.points&&E.points.size()>1?(v.edgeTypeInfo=E,e=Zc(v.edgeTypeInfo.points)):E[yg]&&E.rect&&(v.edgeTypeInfo=E,e=E.rect)}else{var y=L("edge.source.anchor.x"),w=L("edge.source.anchor.y"),b=L("edge.target.anchor.x"),o=L("edge.target.anchor.y"),d=Ec(h,I,L("edge.source.position"),L("edge.source.offset.x"),L("edge.source.offset.y"),y,w),Y=Ec(h,F,L("edge.target.position"),L("edge.target.offset.x"),L("edge.target.offset.y"),b,o);if(t===lq){var U=v.points=L(Ur)||_c,H=U.size();v.segments=L("edge.segments");var P=y!==p||w!==p,Z=b!==p||o!==p;if(!f)if(J)P||(d=kl(d,H?U.get(0):Y,J,H)),Z||(Y=kl(Y,H?U.get(H-1):d,J,H));else{var W;P||(W=nl(d,H?U.get(0):Y,Wk(h,I)),W&&(d={x:W[0],y:W[1]})),Z||(W=nl(H?U.get(H-1):d,Y,Wk(h,F)),W&&(Y={x:W[0],y:W[1]}))}e=zs(Zc(v.points),Zc(d,Y))}else{var X=Ki(Q,h,m,i,t);if(Q._19Q||(X=-X),i)d=tq(d),d.x=h.getNodeRect(I).x,v.radius=X,e={x:d.x-X,y:d.y-X,width:2*X,height:2*X};else{var l=de(d,Y),A=Pp(J,l),C={x:A,y:X},r={x:l-A,y:X},S=g(Y.y-d.y,Y.x-d.x),k=v.mat=new gh(S);if(v.orienAngle=S,v.angle=Y.x<d.x?S+B:S,v.rect={x:C.x,y:C.y,width:r.x-C.x,height:0},v.origin=d,C=k.tf(C),C.x+=d.x,C.y+=d.y,r=k.tf(r),r.x+=d.x,r.y+=d.y,f){var s={x:l,y:0};s=k.tf(s),s.x+=d.x,s.y+=d.y,e=Zc([d,C,r,s]),v.c1=d,v.c2=s}else e=Zc(C,r);d=C,Y=r}}v.sourcePoint=d,v.targetPoint=Y,m._lastSourcePoint=d,m._lastTargetPoint=Y}var R=0;L("edge.dash")&&(R=L("edge.dash.width")||D);var M="square"===v.cap?.71:.5;wh(e,x(R*M,D*M+a+G),v.join),Q._68o(e)}},getRotation:function(K,o,O){K=K||0;var Q=this._78o;if(Q){var m,B=Q.angle,z=Q.points,E=Q.edgeTypeInfo;if(B!=T)return o?Q.orienAngle+K:B+K;if(E&&E[yg])return E.getRotation?E.getRotation(this,K,o,O):0;if(E&&E.points){var U=E.points;return m=U.size(),tr[O]?m&&0===m%2?ul(U.get(m/2-1),U.get(m/2),o,K):K:Wr[O]?ul(U.get(0),U.get(1),o,K):ul(U.get(m-2),U.get(m-1),o,K)}if(z)return m=z.size(),tr[O]?m&&0===m%2?ul(z.get(m/2-1),z.get(m/2),o,K):K:Wr[O]?ul(Q.sourcePoint,m?z.get(0):Q.targetPoint,o,K):ul(m?z.get(m-1):Q.sourcePoint,Q.targetPoint,o,K)}return K},getPosition:function(j,U,E,O,$){var c=this._78o;if(c){var I,V=c.type,C=c.points,i=c.edgeTypeInfo,s=c.sourcePoint,y=c.targetPoint;if(!V)return c.looped?{x:s.x-c.radius+U,y:s.y+E}:($&&s&&y&&(s.x>y.x||s.x===y.x&&s.y>y.y)&&(j=fb[j],E=-E),I=eg(j,c.rect,O),I.x+=U,I.y+=E,I=c.mat.tf(I),I.x+=c.origin.x,I.y+=c.origin.y,I);if(i&&i[yg])return i.getPosition?i.getPosition(this,j,U,E,O,$):{x:(s.x+y.x)/2,y:(s.y+y.y)/2};if(C){var I,H=C.size();if(tr[j]){if(H){var m=H%2;if(0===m)return Nh(C.get(H/2-1),C.get(H/2),j,U,E,O,$);I=C.get((H-m)/2)}else I={x:(s.x+y.x)/2,y:(s.y+y.y)/2};return I=eg(j,{x:I.x,y:I.y,width:0,height:0},O),I.x+=U,I.y+=E,I}return Wr[j]?Nh(s,H?C.get(0):y,j,U,E,O,$):Nh(H?C.get(H-1):s,y,j,U,E,O,$)}if(i){var P=i.points,H=P.size();if(tr[j]){var m=H%2;return 0===m?Nh(P.get(H/2-1),P.get(H/2),j,U,E,O,$):(I=P.get((H-m)/2),I=eg(j,{x:I.x,y:I.y,width:0,height:0},O),I.x+=U,I.y+=E,I)}return Wr[j]?Nh(P.get(0),P.get(1),j,U,E,O,$):Nh(P.get(H-2),P.get(H-1),j,U,E,O,$)}}return _n},_42:function(h){this._78o&&id.superClass._42.call(this,h)},drawPath:function(V,h){V.beginPath();var n=h.type,r=h.points,D=h.segments,U=h.edgeTypeInfo;if(!n||r){var J=h.sourcePoint,y=J.x,A=J.y,H=h.targetPoint,T=H.x,k=H.y;if(n)if(D){var Z=new ep({x:y,y:A});Z.addAll(r),Z.add({x:T,y:k}),Eo(V,Z,D)}else V.moveTo(y,A),r.each(function(X){V.lineTo(X.x,X.y)}),V.lineTo(T,k);else h.looped?V.arc(y,A,h.radius,0,u,!0):h.center?(V.moveTo(h.c1.x,h.c1.y),V.lineTo(y,A),V.lineTo(T,k),V.lineTo(h.c2.x,h.c2.y)):(V.moveTo(y,A),V.lineTo(T,k))}else U&&(U.points?Eo(V,U.points,U.segments):U[yg]&&U[yg](V,U))},_80o:function(Z){var t=this,U=t.s,D=t._78o,X=D.width,G=D.selectWidth,h=D.borderWidth,A=D.color,o=Z.lineJoin,K=Z.lineCap,P=D.pattern;Z.lineJoin=D.join,Z.lineCap=D.cap,t.drawPath(Dk(Z,P),D);var W=U("edge.width.absolute");if(W&&(Z.save(),Z.setTransform(1,0,0,1,0,0)),G&&(Z.strokeStyle=D._97o,Z.lineWidth=X+2*(h+G),Z.stroke()),h&&(Z.strokeStyle=D.borderColor,Z.lineWidth=X+2*h,Z.stroke()),Z.strokeStyle=A,Z.lineWidth=X,Z.stroke(),D.is3d&&ps(Z,A,D._67o,X,t.gv._zoom,D._66o),W&&Z.restore(),vk(Z,P),U("edge.dash")){P=U("edge.dash.pattern");var f=Dk(Z,P,t._2Q("edge.dash.offset"));f!==Z&&t.drawPath(f,D),t._1Q(Z,"edge",U("edge.dash.width")||X,P)}Z.lineJoin=o,Z.lineCap=K},_48O:function(){},_47O:function(){},_71o:function(u,r){var D=this,q=D._data;if(D._19Q=!0,!q.getEdgeGroup())return u?q.s("edge.gap"):0;var B,Q=0,v=0,g=0;if(q.getEdgeGroup().getSiblings().each(function(E){E.each(function(w){if(D.gv.isVisible(w)&&w.s(Dc)==r){var y=w.s("edge.gap");B?(v+=g/2+y/2,g=y):(B=w,g=y),w===q&&(Q=v)}})}),u)return v-Q+g;var F=Q-v/2;return B&&q._40I!==B._40I&&(D._19Q=!1),F}});var Fg=function(T,_){fk(Fg,this,[T,_])};gb(Fg,rn,{_3O:function(){var t,U,w=this,k=w.s,n=w._data,i=w.gv;if(w._88I=T,n.isExpanded()&&n.eachChild(function(d){var A=i.getBoundsForGroup(d);A&&(U||(U=[]),U.push(A),t=zs(t,A))}),t){var q=i.getLabel(n),N=k("group.type");t=pe(N,U,t),Ug(t,n,"group.padding",1);var $=w._88I={type:N,rect:t,_64o:t};if(!N&&q!=T){var M,o=w.labelInfo={label:q,color:k("group.title.color"),font:k("group.title.font"),align:k("group.title.align")},D=jq(o,q),C=D.width,Q=D.height,X=k("group.title.align");C>t.width&&(t.width=C),o.rect={y:t.y-Q,width:D.width,height:Q},M=X===ud?t.x:X===Ij?t.x+t.width-C:t.x+t.width/2-C/2,o.rect.x=M,$.titleRect={x:t.x,y:t.y-Q,width:t.width,height:Q+1},$.rect={x:t.x,y:t.y-Q,width:t.width,height:t.height+Q}}w._40O($,k("group.border.width")/2)}else Fg.superClass._3O.call(w)},getPosition:function(G,z,$,E){var T=this._88I;if(T){var V=eg(G,T.rect,E);return V.x+=z,V.y+=$,V}return Fg.superClass.getPosition.apply(this,arguments)},_24O:function(d,R){var q=this._88I;(!q||q.type||"label2"===d)&&Fg.superClass._24O.call(this,d,R)},_80o:function($){var b=this,W=b._88I;if(W){var B=b._data,U=b.s,A=b.gv,P=W.type,h=W.rect,E=W._64o,t=W.titleRect,_=b.getBodyColor(),k=dq(U("group.image"),_),C=U("group.image.stretch"),d=b.getBodyColor("group.background"),S=dq(U("group.repeat.image"),_),l=U("group.gradient.pack"),Y=U("group.gradient"),q=U("group.gradient.color"),g=U("group.depth");if(P){var u=U("group.border.pattern"),Q=U("group.border.width"),L=$.lineJoin,G=$.lineCap;if($.lineJoin=U("group.border.join"),$.lineCap=U("group.border.cap"),k){if($.save(),Oo($,P,h),$.clip(),hh($,k,C,h.x,h.y,h.width,h.height,B,A,_),$.restore(),Q>0){var H=Dk($,u);Oo(H,P,h),$.lineWidth=Q,$.strokeStyle=U("group.border.color"),$.stroke(),vk($,u)}}else{var H=Dk($,u);d||S||l?(Oo($,P,h),l?fc($,l):S?Ob($,S,_,null,B,A):Rh($,d,Y,q,h),$.fill(),l&&$.restore(),$!==H&&Oo(H,P,h)):Oo(H,P,h),Q>0&&($.lineWidth=Q,$.strokeStyle=U("group.border.color"),$.stroke()),vk($,u),P===Lj&&or($,d,g,h)}$.lineJoin=L,$.lineCap=G}else if(k?hh($,k,C,E.x,E.y,E.width,E.height,B,A,b.getBodyColor()):(d||S)&&(S?Ob($,S,_,null,B,A):Rh($,d,Y,q,E),Oo($,Lj,E),$.fill(),or($,d,g,E)),t){var y=U("group.title.background");eo($,t.x,t.y,t.width,t.height,y),or($,y,g,t)}b._39O($,W)}else Fg.superClass._80o.call(b,$)}});var ub=function(T,o){fk(ub,this,[T,o])};gb(ub,rn,{_80o:function(F){this._39O(F,this._83o)}});var Yh=function(I,m){fk(Yh,this,[I,m])};gb(Yh,rn,{_3O:function(){var d=this,p=d._data,f=d.s,U=d.gv,q=p.getPoints(),r=U.getBorderColor(p),D=r?f("border.width"):0,j=d.getSelectWidth(),C=f("shape.border.width"),b=p.getRect(),g=U.getBodyColor(p),$=d._99o=q.isEmpty()?T:{rect:b,rotation:p.getRotation(),fillRule:f("shape.fill.rule"),scale:p.getScale(),position:p.p(),points:q,segments:p.getSegments(),bodyColor:g,borderColor:r,borderWidth:D,_94o:f("shape.border.3d"),_95o:f("shape.border.3d.color"),_96o:f("shape.border.3d.accuracy"),_97o:j?f("select.color"):T,selectWidth:j,_53o:f("shape.background"),_27Q:dq(f("shape.repeat.image"),g),shapeGradientPack:f("shape.gradient.pack"),_54o:C,_55o:f("shape.border.color"),shapeGradient:f("shape.gradient"),_59o:f("shape.gradient.color"),_60o:f("shape.border.pattern"),_61o:f("shape.border.cap"),_62o:f("shape.border.join")};if($){var i=p.getScale(),E=x(1,x(J(i.x),J(i.y)));f("shape.dash")&&f("shape.dash.width")>C&&(C=f("shape.dash.width"));var t=C*("square"===$._61o?.71:.5)+D+j/d.gv._zoom/E;t&&(t*=E,b=tq(b),wh(b,t,$._62o)),d._68o(b);var k=f("clip.percentage");1>k&&(0>k&&(k=0),$.clipRect=Ci(p.getAnchorRect(),f("clip.direction"),k));var u=f("shape.fill.clip.percentage");1>u&&(0>u&&(u=0),$.shapeClipRect=Ci(p.getAnchorRect(),f("shape.fill.clip.direction"),u))}},getPosition:function(N,Z,s,O){var y=this._99o;if(y){var x=eg(N,y.rect,O);return x.x+=Z,x.y+=s,x}return _n},_42:function(p){this._99o&&Yh.superClass._42.call(this,p)},_80o:function(w){var I,a=this,$=a.s,Y=a._99o,r=Y.position,D=Y.scale,X=Y.rotation,e=Y.bodyColor,t=Y.borderWidth,V=Y.selectWidth,P=Y._53o,x=Y._27Q,n=Y.shapeGradientPack,E=Y._54o,j=Y.clipRect,O=Y.shapeClipRect,Q=Y.points,M=Y.segments,L=a._data.isClosePath(),Z=Y.fillRule,d=P||x||n;w.save(),Pc(w,r.x,r.y),js(w,X),pd(w,D.x,D.y),j&&(w.beginPath(),w.rect(j.x,j.y,j.width,j.height),w.clip()),d&&O&&(w.save(),w.beginPath(),w.rect(O.x,O.y,O.width,O.height),w.clip()),Pc(w,-r.x,-r.y);var f=Y._60o,p=Dk(w,f),K=w.lineJoin,A=w.lineCap;w.lineJoin=Y._62o,w.lineCap=Y._61o,d?(Eo(w,Q,M,L),n?fc(w,n):x?Ob(w,x,e,null,a._data,a.gv):(I=e?e:P,Rh(w,I,Y.shapeGradient,Y._59o,Y.rect)),w.fill(Z),O&&(w.restore(),Pc(w,-r.x,-r.y)),n&&w.restore(),p!==w&&Eo(p,Q,M,L)):Eo(p,Q,M,L);var g=$("shape.border.width.absolute");if(g&&(w.save(),w.setTransform(1,0,0,1,0,0)),V&&(w.strokeStyle=Y._97o,w.lineWidth=E+2*(t+V),w.stroke()),t&&(w.strokeStyle=Y.borderColor,w.lineWidth=E+2*t,w.stroke()),E&&(I=Y._55o,!P&&e&&(I=e),w.strokeStyle=I,w.lineWidth=E,w.stroke(),Y._94o&&ps(w,I,Y._95o,E,a.gv._zoom,Y._96o)),g&&w.restore(),vk(w,f),$("shape.dash")){var y=$("shape.dash.width")||E;if(y>0){f=$("shape.dash.pattern");var p=Dk(w,f,a._2Q("shape.dash.offset"));p!==w&&Eo(p,Q,M,L),a._1Q(w,"shape",y,f)}}w.lineJoin=K,w.lineCap=A,w.restore()},_48O:function(){},_47O:function(){}});var oh=function(x,d){fk(oh,this,[x,d])};gb(oh,Yh,{getRotation:function(q,f,L){q=q||0;var v=this._data.getPoints(),y=v.size();return y>1?tr[L]?y&&0===y%2?ul(v.get(y/2-1),v.get(y/2),f,q):q:Wr[L]?ul(v.get(0),v.get(1),f,q):ul(v.get(y-2),v.get(y-1),f,q):q},getPosition:function(P,C,T,U,O){var b=this._data.getPoints(),v=b.size();if(v>1){if(tr[P]){var R=v%2;if(0===R)return Nh(b.get(v/2-1),b.get(v/2),P,C,T,U,O);var j=b.get((v-R)/2),E={x:j.x,y:j.y,width:0,height:0};return j=eg(P,E,U),j.x+=C,j.y+=T,j}return Wr[P]?Nh(b.get(0),b.get(1),P,C,T,U,O):Nh(b.get(v-2),b.get(v-1),P,C,T,U,O)}return _n}});var Xo=function(G,J){fk(Xo,this,[G,J])};gb(Xo,rn,{_3O:function(){var V=this;Xo.superClass._3O.call(V);var x=V.s,F=V._83o;V._82o=F.img||F.shape?T:{background:V.getBodyColor("grid.background"),depth:x("grid.depth"),rect:F.rect,_88o:x("grid.cell.depth"),cellBorderColor:x("grid.cell.border.color"),_89o:x("grid.row.count"),_90o:x("grid.column.count"),block:x("grid.block"),_91o:x("grid.block.color"),_92o:x("grid.block.padding"),_93o:x("grid.block.width")}},_80o:function(z){var b=this,k=b._82o;if(!k)return Xo.superClass._80o.call(b,z),void 0;var v,x,I=b._data,i=k.background,A=k.rect,q=k.block,R=k._91o,P=k._92o,f=k._93o,h=k._88o,c=k.cellBorderColor,l=k._89o,e=k._90o;if(i)if(eo(z,A.x,A.y,A.width,A.height,i),or(z,i,k.depth,A),h)for(v=0;l>v;v++)for(x=0;e>x;x++)A=I.getCellRect(v,x),A&&or(z,i,h,A);else if(c){for(z.beginPath(),v=0;l>v;v++)for(x=0;e>x;x++)A=I.getCellRect(v,x),A&&z.rect(A.x,A.y,A.width,A.height);z.strokeStyle=c,z.lineWidth=1,z.stroke()}if("h"===q)for(v=0;l>v;v++)A=zs(I.getCellRect(v,0),I.getCellRect(v,e-1)),fn(A,P),Jd(z,R,A.x,A.y,A.width,A.height,f);else if("v"===q)for(x=0;e>x;x++)A=zs(I.getCellRect(0,x),I.getCellRect(l-1,x)),fn(A,P),Jd(z,R,A.x,A.y,A.width,A.height,f);b._39O(z,b._83o)}});var xh=function(p,i){fk(xh,this,[p,i])};gb(xh,rn,{_checkEmptyRect:!1,_81o:function(){var c=this._data,J=xh.superClass._81o.call(this),r=c.s("text");if(r!=T){var f,V,i=c.s("text.font"),o=c.s("text.align"),e=c.s("text.vAlign"),s=Ql(i,r),k=s.width,m=s.height,R=c.getAnchor(),X=c.getWidth(),P=c.getHeight();"left"===o?f=-X*R.x:"center"===o?f=-X*R.x+(X-k)/2:"right"===o&&(f=X*(1-R.x)-s.width),"top"===e?V=-P*R.y:"middle"===e?V=-P*R.y+(P-m)/2:"bottom"===e&&(V=P*(1-R.y)-s.height);var a,U=c.getMatrix();if(a=Zc([U.tf(f,V),U.tf(f+k,V),U.tf(f+k,V+m),U.tf(f,V+m)]),J=zs(J,a),J&&c.s("text.shadow")){var C=tq(J);C.x+=c.s("text.shadow.offset.x"),C.y+=c.s("text.shadow.offset.y"),fn(C,c.s("text.shadow.blur")),J=zs(J,C)}}return J}});var pk=dh.Interactor=function(u){this.gv=this._graphView=u};kp("Interactor",o,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners(),this.clear()},clear:function(){},fi:function(I){this.gv.fi(I)},setCursor:function(K){Rp||this.gv.setCursor(K)},startDragging:function(U){var k=this;k._lastClientPoint=yq(U),k._lastLogicalPoint=k.gv.lp(U),rf(k,U)},clearDragging:function(){var z=this;z._lastClientPoint=z._lastLogicalPoint=z._logicalPoint=T},autoScroll:function(F){return this.gv.autoScroll(F,this._lastClientPoint)}});var Qr=function(c){var l=this;l.gv=c,l.filter=function(i){return c.isSelectable(i)&&c.isInteractive(i)},c.getView(),["mousedown","mousemove","touchstart","touchmove"].forEach(function(u){l.addListener(u)}),k.addEventListener($l,function(i){Mf(i)&&l.handleWindowMove(i)},!1),k.addEventListener(Hc,function(R){Mf(R)&&l.handleWindowUp(R)},!1),k.addEventListener(sp,function(K){Mf(K)&&l.handleWindowMove(K)},!1),k.addEventListener(mi,function(a){Mf(a)&&l.handleWindowUp(a)},!1)};gb(Qr,pk,{addListener:function(k){var s=this;s.gv.getView().addEventListener(k,function(B){j.preventDefault(B),Mf(B)&&!s.disabled&&s["handle_"+k](B)},!1)},handle:function(n,f,z){var w=this.gv;if(z=z||w.getDataInfoAt(f,this.filter)){var v=z.ui.interactiveInfo;if(v){var h,Z=z.data;if(Z.s(n)&&Z.s(n)(f,Z,w),"body"===z.part&&v.bodyInfo)h="body",z.hits=this.handleImage(h,w.getImage(Z),n,f,Z,z.point,v.bodyInfo);else if("icons"===z.part&&v._38o){var i=v._38o[z.name];i&&i[z.index]&&(h="icons|"+z.name+"|"+z.index,z.hits=this.handleImage(h,z.icon,n,f,Z,z.point,i[z.index]))}}return z}},handleImage:function($,X,e,G,D,C,u){var r={};if(X&&(X=dq(X))){var _=this.gv,i=u.rect,t=this.convertPoint(C,u);t.inRect&&(X[e]&&X[e](G,D,_,t,i.width,i.height),r[$+"|image"]={target:X,point:t,width:i.width,height:i.height});for(var Q=u.compInfos,n=Q.length-1;n>=0;n--){var p=Q[n],A=p.comp;t=this.convertPoint(C,p),t.inRect&&(i=p.rect,A[e]&&A[e](G,D,_,t,i.width,i.height),(X=i.image)&&X[e]&&X[e](G,D,_,t,i.width,i.height),r[$+"|"+n]={target:A,point:t,width:i.width,height:i.height},X&&(r[$+"|"+n+"|image"]={target:X,point:t,width:i.width,height:i.height}))}}return r},handle_mousedown:function(v){this.isDragging&&(this.handleDownInfo("onEndDrag",v),this.isDragging=!1),this.downInfo=this.handle("onDown",v)},handle_mousemove:function(q){var B=this,Z=B.gv;B._hoverTimer&&(K(B._hoverTimer),delete B._hoverTimer);var J,R,y,t=B.handle("onMove",q),$=this.currentInfo?this.currentInfo.data:T,A=this.currentInfo?this.currentInfo.hits:T;if(t&&(R=t.data,y=t.hits,B._hoverTimer=e(function(){K(B._hoverTimer),delete B._hoverTimer,B.handle("onHover",q,t)},Z.getHoverDelay()||j.hoverDelay)),R!==$){if(R&&R.s("onEnter")&&R.s("onEnter")(q,R,Z),$&&$.s("onLeave")&&$.s("onLeave")(q,$,Z),A)for(J in A)A[J].target.onLeave&&this.handleLeave(q,J);if(y)for(J in y)y[J].target.onEnter&&y[J].target.onEnter(q,R,Z,y[J].point,y[J].width,y[J].height)}else{if(A)for(J in A)y&&y[J]||A[J].target.onLeave&&this.handleLeave(q,J);if(y)for(J in y)A&&A[J]||y[J].target.onEnter&&y[J].target.onEnter(q,R,Z,y[J].point,y[J].width,y[J].height)}this.currentInfo=t},handleLeave:function(D,l){if(this.currentInfo){var f=this.currentInfo,G=f.ui.interactiveInfo;if(G){var g,s=this.gv.lp(D),N=f.data;if("body"===f.part&&G.bodyInfo)g="body",this.handleLeaveImage(l,g,this.gv.getImage(N),D,N,s,G.bodyInfo);else if("icons"===f.part&&G._38o){var p=G._38o[f.name];p&&p[f.index]&&(g="icons|"+f.name+"|"+f.index,this.handleLeaveImage(l,g,f.icon,D,N,s,p[f.index]))}}}},handleLeaveImage:function(d,O,v,N,K,e,C){if(v&&(v=dq(v))){var m=this.gv,t=C.rect,i=this.convertPoint(e,C);d===O+"|image"&&v.onLeave&&v.onLeave(N,K,m,i,t.width,t.height);for(var b=C.compInfos,r=b.length-1;r>=0;r--){var W=b[r],k=W.comp;i=this.convertPoint(e,W),t=W.rect,k.onLeave&&d===O+"|"+r&&k.onLeave(N,K,m,i,t.width,t.height),(v=t.image)&&v.onLeave&&d===O+"|"+r+"|image"&&v.onLeave(N,K,m,i,t.width,t.height)}}},handleMissingUp:function(Z){var D=this.downInfo;if(D){var c=D.ui.interactiveInfo;if(c){var s,w=this.gv.lp(Z),R=D.data;if("body"===D.part&&c.bodyInfo)s="body",this.handleMissingUpImage(s,this.gv.getImage(R),Z,R,w,c.bodyInfo);else if("icons"===D.part&&c._38o){var P=c._38o[D.name];P&&P[D.index]&&(s="icons|"+D.name+"|"+D.index,this.handleMissingUpImage(s,D.icon,Z,R,w,P[D.index]))}}}},handleMissingUpImage:function(c,e,Y,M,C,P){var a="onUp",R=this.downInfo.hits;if(R&&e&&(e=dq(e))){var $=P.rect,G=this.convertPoint(C,P);!G.inRect&&R[c+"|image"]&&e[a]&&e[a](Y,M,this.gv,G,$.width,$.height);for(var J=P.compInfos,p=J.length-1;p>=0;p--){var V=J[p],s=V.comp;G=this.convertPoint(C,V),G.inRect||($=V.rect,s[a]&&R[c+"|"+p]&&s[a](Y,M,this.gv,G,$.width,$.height),(e=$.image)&&e[a]&&R[c+"|"+p+"|image"]&&e[a](Y,M,this.gv,G,$.width,$.height))}}},handle_touchstart:function(j){this.handle_mousedown(j)},handle_touchmove:function(V){this.handle("onMove",V)},handleWindowMove:function(k){this.downInfo&&(this.isDragging?this.handleDownInfo("onDrag",k):(this.handleDownInfo("onBeginDrag",k),this.isDragging=!0))},handleWindowUp:function(o){this.isDragging&&(this.handleDownInfo("onEndDrag",o),this.isDragging=!1);var i=this.handle("onUp",o);this.downInfo&&(i&&i.data===this.downInfo.data?this.handleMissingUp(o):this.handleDownInfo("onUp",o),this.downInfo=T)},handleDownInfo:function(D,k){if(this.downInfo){var G=this.downInfo,U=G.ui.interactiveInfo;if(U){var s,K=this.gv.lp(k),T=G.data;if(T.s(D)&&T.s(D)(k,T,this.gv),"body"===G.part&&U.bodyInfo)s="body",this.handleDownInfoImage(s,this.gv.getImage(T),D,k,T,K,U.bodyInfo);else if("icons"===G.part&&U._38o){var J=U._38o[G.name];J&&J[G.index]&&(s="icons|"+G.name+"|"+G.index,this.handleDownInfoImage(s,G.icon,D,k,T,K,J[G.index]))}}}},handleDownInfoImage:function(D,F,h,c,i,m,T){var $=this.downInfo.hits;if($&&F&&(F=dq(F))){var _=this.gv,S=T.rect,R=this.convertPoint(m,T);$[D+"|image"]&&F[h]&&F[h](c,i,_,R,S.width,S.height);for(var j=T.compInfos,J=j.length-1;J>=0;J--){var E=j[J],W=E.comp;R=this.convertPoint(m,E),S=E.rect,W[h]&&$[D+"|"+J]&&W[h](c,i,_,R,S.width,S.height),(F=S.image)&&F[h]&&$[D+"|"+J+"|image"]&&F[h](c,i,_,R,S.width,S.height)}}},convertPoint:function(o,I){var V=o.x,U=o.y;I.stacks.forEach(function(X){if(X.t)V-=X.t[0],U-=X.t[1];else if(X.s)V/=X.s[0],U/=X.s[1];else if(X.r){var m=L(-X.r),i=A(-X.r),z=i*V-m*U,v=m*V+i*U;V=z,U=v}});var k=I.rect;return o={x:V-k.x,y:U-k.y},o.inRect=o.x>=0&&o.y>=0&&o.x<=k.width&&o.y<=k.height,o}});var ls=dh.DefaultInteractor=function(l){fk(ls,this,[l])};kp("DefaultInteractor",pk,{handle_mousedown:function(B){Gp(B);var G=this,w=G.gv,p=w.getDataAt(B);!w.setFocus(B)||w._editing||w._scrolling||(Lg(B)?w.handleDoubleClick(B,p):w.handleClick(B,p),!ir()&&p||!w.isPannable()||!Mf(B)||Jf(B)||(G._tx=w.tx(),G._ty=w.ty(),G.startDragging(B)))},handleWindowMouseUp:function(c){var s=this,O=s.gv;O._panning&&(delete O._panning,O.onPanEnded(),s.fi({kind:"endPan",event:c})),delete s._tx,delete s._ty,s.clearDragging()},handle_mousemove:function(N){var x=this,l=x.gv;x._hoverTimer&&(K(x._hoverTimer),delete x._hoverTimer),x._hoverTimer=e(function(){x.fi({kind:"hover",event:N}),K(x._hoverTimer),delete x._hoverTimer},l.getHoverDelay()||j.hoverDelay)},handle_touchmove:function(L){this.handle_mousemove(L)},handleWindowMouseMove:function(q){var i=this,k=i.gv,c=i._lastClientPoint;i.fi({kind:k._panning?"betweenPan":"beginPan",event:q}),k._panning=1,k.setTranslate(i._tx+q.clientX-c.x,i._ty+q.clientY-c.y)},handle_mousewheel:function(c){this.gv.handleScroll(c,c.wheelDelta)},handle_DOMMouseScroll:function(w){2===w.axis&&this.gv.handleScroll(w,-w.detail)},handle_keydown:function(M){this.gv.handleKeyDown(M)}});var Mr=dh.SelectInteractor=function(R){fk(Mr,this,[R])};kp("SelectInteractor",pk,{_42:function(){var O=this,_=O.gv,Y=_.getZoom(),X=O.mark,Q=O.div;Q||(Q=O.div=rs(),Pb(O.getView(),Q));var j={};j.x=X.x*Y+_.tx(),j.y=X.y*Y+_.ty(),j.width=X.width*Y,j.height=X.height*Y,yj(Q,j),this.intersects()?(Q.style.border="",Q.style.background=_.getRectSelectBackground()):(Q.style.background="",Q.style.border="1px solid "+_.getRectSelectBorderColor())
},handle_mousedown:function(H){var i=this,m=i.gv;if(i._57I=T,!(m._editing||m._scrolling||ir())){var U=m.getDataAt(H),Y=m.sm();if(U)if(Jf(H))Y.co(U)?Y.rs(U):Y.as(U);else if(Y.co(U)){if(Lg(H)&&U instanceof Hr&&U.isClickThroughEnabled()){var p=m.getDataAt(H,function(c){m._clickThroughChecking=!0;var H=c.getParent()===U&&m.isSelectable(c);return delete m._clickThroughChecking,H});p&&(H.clickThrough=!0,Y.ss(p))}}else Y.ss(U);else Jf(H)||!m.isPannable()?Mf(H)&&(Jf(H)||Y.cs(),m.isRectSelectable()&&(i.startDragging(H),m._77O=1)):Mf(H)&&(i._57I=yq(H))}},handle_mouseup:function(a){var R=this,B=R._57I;B&&(de(B,yq(a))<=1&&R.gv.sm().cs(),R._57I=T)},handleWindowMouseUp:function(U){this.clear(U)},handleWindowMouseMove:function(w){var F=this,V=F.gv;F._logicalPoint=V.lp(w),F.mark?(F.fi({kind:"betweenRectSelect",event:w}),V.isPannable()&&F.autoScroll(w),F.redraw()):F.fi({kind:"beginRectSelect",event:w}),F.mark=Zc(F._lastLogicalPoint,F._logicalPoint),F.redraw()},intersects:function(){var D=this,$=D._lastLogicalPoint,P=D._logicalPoint;return $.x>P.x||$.y>P.y},clear:function(Y){var S=this,k=S.gv,x=S.mark;if(S._57I=T,S._lastLogicalPoint){if(x){if(0!==x.width&&0!==x.height){var _=k.getDatasInRect(x,S.intersects());if(!_.isEmpty()){var r=k.sm(),f=r.toSelection();_.each(function(H){r.co(H)?f.remove(H):f.add(H)}),r.ss(f)}}ss(S.div),delete S.div,delete S.mark,S.redraw(),S.fi({kind:"endRectSelect",event:Y}),k.onRectSelectEnded()}S.clearDragging(),delete k._77O}},redraw:function(){var s=this;s._draw||(s._draw=1,e(function(){s.mark&&s._42(),delete s._draw},16))}});var om=dh.MoveInteractor=function(S){fk(om,this,[S])};kp("MoveInteractor",pk,{handle_mousedown:function(v){var H=this,A=H.gv;if(Mf(v)&&!A._editing&&!A._scrolling&&!ir()){var G=A.getSelectedDataAt(v);G?(H._data=G,A.handleMouseDown&&A.handleMouseDown(v,G),H.startDragging(v),A.isMovable(G)&&(A._moving=1)):A._focusData=T}},handleWindowMouseUp:function(j){var u=this,b=u.gv;b.handleMouseUp&&b.handleMouseUp(j,u._data),u.clear(j)},handleWindowMouseMove:function(T){var q=this,y=q._data,V=q.gv;if((!V._93O||!V._93O(T,y))&&V._moving){q._logicalPoint||q.fi({kind:"prepareMove",event:T});var b=q._logicalPoint?"betweenMove":"beginMove",n={kind:b,event:T},p=q._logicalPoint=V.lp(T);"beginMove"!==b||q._alreadyBeginTransaction||(q._alreadyBeginTransaction=!0,V.getDataModel().beginTransaction());var R=q._calcShift(b,T),I=R.x,N=R.y,$=q.gv.getMoveMode(T,y);$&&("x"===$?N=0:"y"===$?I=0:"xy"!==$&&(I=N=0)),V.moveSelection(I,N),q._lastLogicalPoint=p,q.autoScroll(T),q.fi(n)}},_calcShift:function(){var b=this,y=b._logicalPoint,S=b._lastLogicalPoint,R=y.x-S.x,E=y.y-S.y;return{x:R,y:E}},clear:function(i){var F=this,c=F.gv;F._lastLogicalPoint&&(F._lastLogicalPoint=F._data=c._moving=T,F._logicalPoint&&(F.fi({kind:"endMove",event:i}),c.onMoveEnded()),F.clearDragging()),F._alreadyBeginTransaction&&(F._alreadyBeginTransaction=!1,c.getDataModel().endTransaction())}});var Nc=dh.ScrollBarInteractor=function(m){fk(Nc,this,[m])};kp("ScrollBarInteractor",pk,{_41o:function(){return this.gv.getViewRect().height<this.gv.getScrollRect().height},_40o:function(){return this.gv.getViewRect().width<this.gv.getScrollRect().width},isV:function(q){var r=this.gv.getViewRect();return this._41o()&&(r.x+r.width-this.gv.lp(q).x)*this.gv.getZoom()<Pr},isH:function(D){var P=this.gv.getViewRect();return this._40o()&&(P.y+P.height-this.gv.lp(D).y)*this.gv.getZoom()<Pr},handle_mousemove:function(V){this.handle_touchmove(V)},handle_touchmove:function(f){if(!Zk&&Mf(f)&&this.gv.isScrollBarVisible()){var x=this,j=x.isV(f),C=x.isH(f);(j||C)&&x.gv.showScrollBar(),x.gv._scrolling=j||C}},handleWindowMouseUp:function(_){this.handleWindowTouchEnd(_)},handleWindowTouchEnd:function(c){this._state=this._cp=this._tx=this._ty=this.gv._scrolling=T,this.fi({kind:"endScroll",event:c})},handle_mousedown:function(L){this.handle_touchstart(L)},handle_touchstart:function(U){var s=this;if(s.gv.setFocus(U),Gp(U),s.handle_touchmove(U),!(Fj(U)>1)&&s.gv._scrolling&&s.gv.isScrollBarVisible()){s._cp=yq(U),s._tx=s.gv.tx(),s._ty=s.gv.ty();var z=s.isV(U);s._state=z?"vScroll":"hScroll",rf(s,U),s.fi({kind:"beginScroll",event:U})}},handleWindowMouseMove:function(l){this.handleWindowTouchMove(l)},handleWindowTouchMove:function(M){var A=yq(M),j=this.gv.getViewRect(),r=this.gv.getScrollRect();"vScroll"===this._state?this.gv.ty(this._ty+(this._cp.y-A.y)*r.height/j.height):"hScroll"===this._state&&this.gv.tx(this._tx+(this._cp.x-A.x)*r.width/j.width),this.fi({kind:"betweenScroll",event:M})}});var te=dh.TouchInteractor=function(D,E){E=E||{},E.selectable===p&&(E.selectable=!0),E.movable===p&&(E.movable=!0),E.pannable===p&&(E.pannable=!0),E.pinchable===p&&(E.pinchable=!0),E.editable===p&&(E.editable=!0),this.params=E,fk(te,this,[D])};kp("TouchInteractor",pk,{ms_edit:1,setUp:function(){var Z=this;te.superClass.setUp.call(Z),Rp&&Z.params.editable&&Z.gv.setEditInteractor(Z)},tearDown:function(){var u=this;te.superClass.tearDown.call(u),Rp&&u.params.editable&&u.gv.setEditInteractor(T)},clear:function(r){var q=this,M=q.gv;M._moving&&(q.fi({kind:"endMove",event:r}),delete M._moving,M.onMoveEnded(),M.dm().endTransaction()),M._panning&&(q.fi({kind:"endPan",event:r}),delete M._panning,M.onPanEnded()),M._pinching&&(q.fi({kind:"endPinch",event:r}),delete M._pinching,M.onPinchEnded()),M._editing&&(q._46O(r),q._77I=q._node=q._edge=q._shape=q._rect=q._89I=q._index=M._editing=T),q._moving=q._panning=q._pinching=q._editing=q._57I=q._data=q._beginHistory=T,q.clearDragging()},handle_touchstart:function(v){var P=this;if(!P.gv._editing){Gp(v),P._57I=T;var N=P.params,S=P.gv,J=S.sm(),U=S.getDataAt(v),m=Fj(v);if(1===m){if(Lg(v))return S.handleDoubleClick(v,U),void 0;S.handleClick(v,U),U&&(S.handleMouseDown&&S.handleMouseDown(v,U),P._data=U),N.selectable||(U=T),U?(J.co(U)||J.ss(U),N.editable&&S.isEditable(U)&&P._79I(v,U,!0)?(P._editing=1,P.startDragging(v)):N.movable&&S.isMovable(U)&&(P._moving=1,P.startDragging(v))):(P._57I=yq(v),N.pannable&&S.isPannable()&&(P._panning=1,P.startDragging(v),P._translate={x:S.tx(),y:S.ty()}))}else if(N.pinchable&&2===m){P._pinching=1,P.startDragging(v);var B=S.getView(),_=S.getZoom(),o=B.getBoundingClientRect(),n=v.touches[0],p=v.touches[1],V={x:(n.clientX+p.clientX)/2-o.left,y:(n.clientY+p.clientY)/2-o.top};V.x-=S.tx(),V.y-=S.ty(),V.x/=_,V.y/=_,P._p=V,P._d=Rq(v)}}},handle_touchend:function(O){var S=this,r=S.gv,y=S._57I,A=S._data;y&&(de(y,yq(O))<=1&&r.sm().cs(),S._57I=T),A&&r.handleMouseUp&&r.handleMouseUp(O,A)},handleWindowTouchEnd:function(D){this.clear(D)},handleWindowTouchMove:function(t){var U=this,$=U.gv,Y=Fj(t);if(1===Y){if(U._editing&&(U._beginHistory||(U._beginHistory=1,$.dm().beginTransaction()),$._editing=1,U._78I(t)),U._moving)U._beginHistory||(U._beginHistory=1,$.dm().beginTransaction()),U.handleMove(t);else if(U._panning){var K=yq(t);$.setTranslate(U._translate.x+K.x-U._lastClientPoint.x,U._translate.y+K.y-U._lastClientPoint.y),U.fi({kind:$._panning?"betweenPan":"beginPan",event:t}),$._panning=1}}else if(2===Y&&U._pinching){var n=Rq(t);$.handlePinch(U._p,n,U._d),U._d=n,U.fi({kind:$._pinching?"betweenPinch":"beginPinch",event:t}),$._pinching=1}},handleMove:function(f){var B=this,P=B.gv,z=P.lp(f);P._93O&&P._93O(f,B._data)||(P.moveSelection(z.x-B._lastLogicalPoint.x,z.y-B._lastLogicalPoint.y),B._lastLogicalPoint=z,B.autoScroll(f),B.fi({kind:P._moving?"betweenMove":"beginMove",event:f}),P._moving=1)}});var X=k.ht,xe=X.graph._editor={Math:X.Math,Guide:{}};xe.getStyle=function(o){var N,i=xe.StyleMap;return i&&(N=i[o],N!==p)?N:xe.DefaultStyleMap[o]},xe.setStyle=function(M,U){var y=xe.StyleMap;y||(y=xe.StyleMap={}),y[M]=U},xe.inEdit=function(b){return b._inXEdit===!0},xe.startEdit=function(R){R._inXEdit=!0,xe.Inject.doInject(R)},xe._46O=function(i){i._inXEdit=!1,xe.Inject.undoInject(i)},xe.toScreenPosition=function(c,l){var m=c.tx(),V=c.ty(),M=c._zoom;return new xe.Math.Vector2(l.x*M+m,l.y*M+V)},xe.checkHit=function(F,x,R){return F.distanceTo(x)<R?!0:!1},xe.toWorldPosition=function(A,d){var T=A.tx(),r=A.ty(),i=A._zoom;return{x:(d.x-T)/i,y:(d.y-r)/i}},xe.setAntialias=function(q,k){for(var J,B=["imageSmoothingEnabled","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","oImageSmoothingEnabled","msImageSmoothingEnabled"],A=0,I=B.length;I>A&&(J=B[A],!(J in q));A++);q[J],q[J]=k},xe.getTargetCornersOnScreen=function(r,G){if(!G)return null;var C,v=[];if(kq(G,r)){var V=Wk(r,G);C=[{x:V.x,y:V.y},{x:V.x+V.width,y:V.y},{x:V.x+V.width,y:V.y+V.height},{x:V.x,y:V.y+V.height}]}else{if(!G.getCorners)return null;C=G.getCorners()}return C.forEach(function(X){var x=xe.toScreenPosition(r,X);v.push(x.x,x.y)}),v},xe.log=function(){};var Oe=xe.Inject={_modules:[]};Oe.registAsModule=function(r,R){var X={},$={};for(var l in r){var Y=R.prototype[l];X[l]=Y}r.getBackup=function(o){return X[o]},r.getBackups=function(){return X},$.doInject=function(){for(var q in r)"getBackup"!==q&&(R.prototype[q]=r[q])},$.undoInject=function(){for(var G in r)"getBackup"!==G&&(R.prototype[G]=X[G])},Oe._modules.push($)},Oe.doInject=function(u){for(var l,G=Oe._modules,E=0,P=G.length;P>E;E++)l=G[E],l.doInject(u)},Oe.undoInject=function(T){for(var C,H=Oe._modules,f=0,k=H.length;k>f;f++)C=H[f],C.undoInject(T)};var pk=X.graph.EditInteractor=function(t){var k=this,A=M.createElement("canvas");A.className="editCanvas",A.style.position="absolute",k._styleMap={},k._canvas=A,k._context=A.getContext("2d"),pk.superClass.constructor.call(k,t),xe.setAntialias(k._context,!1),k._subModules=[new xe.Anchor(k),new xe.Rect(k),new xe.Curve(k),new xe.MoveHelper(k)],k._gridGuide=new xe.Guide.Grid(k),k._rectGuide=new xe.Guide.Rect(k)},nj=pk;X.Default.def(pk,X.graph.Interactor,{ms_edit:1,ms_fire:1}),o.defineProperties(pk.prototype,{editDetail:{get:function(){var s=!!this._editDetail;return s},set:function(D){var Q=this,b=Q._editDetail;b!==D&&(Q._editDetail=D,Q.gv._editing=D,Q.fp("editDetail",b,D),Q.fp("pointsEditingMode",b,D),Q.fi({kind:D?"beginEditPoints":"endEditPoints"}))}},gvEditing:{get:function(){return this.gv._editing},set:function(M){(!this._editDetail||M)&&(this.gv._editing=M,M||(this.editDetail=!1))}},editing:{get:function(){return this._editing},set:function(k){this._editing=k,this.gvEditing=k}},pointsEditingMode:{get:function(){return this.editDetail},set:function(r){var Y=this;Y.editDetail!==r&&(r?Y._tryEnterEditDetailMode():Y._tryQuitEditDetailMode())}},gridEnabled:{get:function(){var n=this._gridEnabled;if(!n)return!1;var B=this.gv;return B?!0:!0},set:function(k){k!==this._gridEnabled&&(this._gridEnabled=k,this._42())}},alignmentGuideEnabled:{get:function(){return this._agEnabled},set:function($){$!==this._agEnabled&&(this._agEnabled=$,this._42())}},gridGuide:{get:function(){return this._gridGuide}},rectGuide:{get:function(){return this._rectGuide}}}),pk.prototype.getSubModule=function(P){var C,i,X,G=this._subModules;for(i=0,X=G.length;X>i;i++)if(C=G[i],C.catalog===P)return C},pk.prototype.invokeSubModule=function(i,q){var I=this,H=I._subModules;if(H)for(var y,b,k,J=Array.prototype.slice.call(arguments,2),C=0,L=H.length;L>C;C++)if(y=H[C],b=y[i],b&&(k=b.apply(y,J),k!=p&&q))return y},pk.prototype.invokeSubModuleInverse=function(u,E){var f=this,P=f._subModules;if(P)for(var o,H,L,J=Array.prototype.slice.call(arguments,2),x=P.length-1;x>=0;x--)if(o=P[x],H=o[u],H&&(L=H.apply(o,J),L!=p&&E))return o},pk.prototype.setUp=function(){xe.log("setUp");var A=this,T=A.gv,v=T.getView(),r=A._canvas;pk.superClass.setUp.call(A),T.setEditInteractor(A),T._79O?v.insertBefore(r,T._79O):v.appendChild(r),xe.startEdit(T),A.invokeSubModule("setUp"),T.dm().mm(A._onDataModelChanged,A),T.dm().md(A._onDataPropertyChanged,A)},pk.prototype.tearDown=function(){xe.log("tearDown");var T=this,s=T.gv,r=s.getView();T._resetCustomCursorStyle(),pk.superClass.tearDown.call(T),s.dm().umm(T._onDataModelChanged,T),s.dm().umd(T._onDataPropertyChanged,T),s.setEditInteractor(null),r.removeChild(T._canvas),T._drawTimer&&(K(T._drawTimer),T._drawTimer=null),xe._46O(s),T.invokeSubModule("tearDown")},pk.prototype._onDataModelChanged=function(Q){var t=this;("clear"===Q.kind||"remove"===Q.kind&&t.editDetail&&Q.data===t.getSubModule("Curve").target)&&(t.editDetail=!1,t._42())},pk.prototype._onDataPropertyChanged=function(J){var L=this;if(L.editDetail){var D=L.getSubModule("Curve"),Z=J.data;Z===D.target&&(Z._writing||D._handleDataChanged())}},pk.prototype.clear=function(){xe.log("clear")},pk.prototype.redraw=function(){this._42()},pk.prototype._42=function(){var q=this;q._drawTimer||(q._drawTimer=e(function(){q._drawTimer=null,q.drawImpl()},0))},pk.prototype.drawImpl=function(){var r;for(r in{_42:!0})break;return function(){var O=this,Z=O._canvas,E=O.gv,c=E.getWidth(),i=E.getHeight(),f=O._context,h=X.Default.getInternal();(Z.width!==c||Z.height!==i)&&h.setCanvas(Z,c,i),f.clearRect(0,0,Z.width,Z.height);var q=O._getValidSelection();f.save();var T=X.Default.devicePixelRatio;f.scale(T,T),O._gridGuide._42(),O.invokeSubModuleInverse(r,!1,f,E,q),O._rectGuide._42(),f.restore()}}(),pk.prototype._getValidSelection=function(){var c=this,s=c.gv,W=s.sm().getSelection(),R=[];return W.each(function(T){s.isVisible(T)&&s.isEditable(T)&&R.push(T)}),R},pk.prototype.handle_touchmove=function(M){return this.handle_mousemove(M)},pk.prototype.handle_mousemove=function(G){if(!X.Default.isDragging()){var g=this;(g.editDetail||!ir())&&(g.gvEditing=!1,g._checkEdit(G)&&(g.gvEditing=!0))}},pk.prototype.handle_touchstart=function(w){return this.handle_mousedown(w)},pk.prototype.handle_mousedown=function(R){Gp(R);var A=this;if(A.editDetail||!ir()){if(Lg(R)&&!R.clickThrough){if(A.editDetail){if(A._tryQuitEditDetailMode(R))return}else if(A._tryEnterEditDetailMode())return;A.gv.dm().beginTransaction();var k=A.invokeSubModule("handleDoubleClick",!0,R);if(A.gv.dm().endTransaction(),k)return}var Y=A._checkEdit(R);Y&&(A._downPosition=A._getLogicalPoint(R),A.gv.dm().beginTransaction(),Y.startEdit(A,R),A.editing=!0)}},pk.prototype._checkEdit=function(h){var A=this,g=A.gv,z=A._getLogicalPoint(h),b=A.invokeSubModule("check",!0,g,h,z)||null;return A._editMod=b,b},pk.prototype.handleWindowTouchMove=function(n){return this.handleWindowMouseMove(n)},pk.prototype.handleWindowMouseMove=function(Z){var p=this,m=p._downPosition;if(m){var Y=p._getLogicalPoint(Z);if(Y.distanceTo(m)<p.getStyle("moveSensitivity"))return;delete p._downPosition}var S=p._editMod;S&&S.handleEdit(p.gv,Z)},pk.prototype._getLogicalPoint=function(_){var w=this,E=X.Default.getLogicalPoint(_,w._canvas);return new xe.Math.Vector2(E)},pk.prototype.handleWindowTouchEnd=function(m){return this.handleWindowMouseUp(m)},pk.prototype.handleWindowMouseUp=function(){var Y;for(Y in{_46O:!0})break;return function(b){var K=this;K.editing=!1,K.setCursor("default"),K.invokeSubModule(Y,!1,b),K._42(),K.gv.dm().endTransaction()}}(),pk.prototype.handle_mousewheel=function(O){var P=this;Gp(O),P.invokeSubModule("preHandleScroll",!0)||P.gv.handleScroll(O,O.wheelDelta)},pk.prototype.handleDelete=function(){var $=this;if(!$.editDetail){$.gv.dm().beginTransaction();var Q=$.invokeSubModule("handleNormalStateDelete",!0);return $.gv.dm().endTransaction(),Q||$.gv.removeSelection(),void 0}$.gv.dm().beginTransaction(),$.invokeSubModule("handleDelete",!0),$.gv.dm().endTransaction(),$._42()},pk.prototype.handle_keydown=function(e){var l=this;if((e.metaKey||e.ctrlKey)&&l._42(),ir(e)&&!l.editing)return l.gvEditing=!1,l.setCursor("default"),l._42(),void 0;var i=Cd(e);return l.editDetail?((i||Rd(e))&&(l.editDetail=!1,l._42()),l.gv.dm().beginTransaction(),l.invokeSubModule("handle_keydown",!0,e),l.gv.dm().endTransaction(),void 0):(l.gv.dm().beginTransaction(),l.invokeSubModule("handleNormalStateKeyDown",!0,e),l.gv.dm().endTransaction(),i&&l._tryEnterEditDetailMode(),void 0)},pk.prototype.handle_keyup=function(c){this.gv.dm().beginTransaction(),this.invokeSubModule("handle_keyup",!0,c),this.gv.dm().endTransaction()},pk.prototype._tryEnterEditDetailMode=function(){var q=this;return!q.editDetail&&q.invokeSubModule("canEnterEditDetailMode",!0)&&1===q._getValidSelection().length?(q.editDetail=!0,q._42(),!0):void 0},pk.prototype._tryQuitEditDetailMode=function(k){var d=this;if(d.editDetail){var I=d.gv,F=d.getSubModule("Curve").target;return k&&I.getDataAt(k)===F?void 0:(d.editDetail=!1,d._42(),!0)}},pk.prototype.setStyle=function(W,w,m){var N=this;m?xe.setStyle(W,w):N._styleMap[W]=w,N.fp("styleChanged",null,{key:W,value:w,base:m}),N._42()},pk.prototype.getStyle=function(Z){var c=this,_=c._styleMap[Z];return _!==p?_:xe.getStyle(Z)},pk.prototype.setCursor=function(C){this._resetCustomCursorStyle(),X.graph.EditInteractor.superClass.setCursor.call(this,C)},pk.prototype._resetCustomCursorStyle=function(){var s=this;if(s._customStyle){var A=this.gv.getView();A.classList&&A.classList.remove&&A.classList.remove(s._customStyle),s._customStyle=null}},pk.prototype._setRotateCursor=function(h){var r=this,n=r._cursorFactory;n||(n=r._cursorFactory=new xe.CursorFactory(r));var A=n.getRotateCursor(h),e=r.gv.getView();r._resetCustomCursorStyle(),r._customStyle=A,e.classList&&e.classList.add&&e.classList.add(A)};var Wl=xe.Group=function(k){var X=this;X._entities=k,X._64O=0,X._position={x:0,y:0},X._scale={x:1,y:1},X._anchor={x:.5,y:.5},X._anchor2={x:.5,y:.5}};Wl.prototype={},Wl.prototype.constructor=Wl;var eh=null;Wl.findOrCreateGroup=function(s){if(eh&&eh.checkIsMe(s))return eh;var S=new xe.Group(s);return S.getKeyOb()?(eh=S,S):void 0},Wl.prototype.checkIsMe=function(o){var q=this._entities;if(q.length!==o.length)return!1;var I,J={},j=o.length;for(I=0;j>I;I++)J[o[I]._id]=!0;for(I=0;j>I;I++)if(!J[q[I]._id])return!1;return!0},Wl.prototype.getRotation=function(){return this._64O},Wl.prototype.getPosition=function(){return this._position},Wl.prototype.getAnchor=function(){return this._anchor},Wl.prototype.getWidth=function(){return this._width},Wl.prototype.getScale=function(){return this._scale},Wl.prototype.getSize=function(){return{width:this._width,height:this._height}},Wl.prototype.getHeight=function(){return this._height},Wl.prototype.getKeyOb=function(){for(var A=this._entities,h=A.length-1;h>=0;h--){var N=A[h];if(this.isNode(N))return N}},Wl.prototype.getAnchor2=function(){var X=this,Z=X.rotateCenter;if(Z)return Z;var b=X.getKeyOb();if(!b)return X._anchor;var H=X._anchor2,O=b.getMatrix();return O.tf({x:b.getWidth()*(H.x-b.getAnchor().x),y:b.getHeight()*(H.y-b.getAnchor().y)})},Wl.prototype.setAnchor2=function(p,A){var w=this,l=w.getKeyOb();if(l){var Y,B=l.getMatrix();Y="number"==typeof p?{x:p,y:A}:p;var P=B.tfi(Y);w._anchor2={x:l.getAnchor().x+P.x/l.getWidth(),y:l.getAnchor().y+P.y/l.getHeight()}}},Wl.prototype.setRotation=function(){},Wl.prototype.beginRotate=function(K){this.rotateCenter=K.pos,this.rotateMode=K.groupRotateMode},Wl.prototype.endRotate=function(){delete this.rotateCenter,delete this.rotateMode},Wl.prototype.addRotation=function(W,U){return"batch"===U?this._addRotationInBatchMode(W):"block"===U?this._addRotationInBlockMode(W):void 0},Wl.prototype._addRotationInBlockMode=function(K){var V=this,o=V.rotateCenter||V.getPosition();V._entities.forEach(function(A){if(V.isNode(A)){var M=A.getMatrix();M.translate(-o.x,-o.y),M.rotate(K),M.translate(o.x,o.y);var v=Math.sign(A.getScale().x);A.setRotation(g(M.b*v,M.a*v)),A.setPosition(M.tx,M.ty)}})},Wl.prototype._addRotationInBatchMode=function(n){var Z=this,p=Z._anchor2;Z._entities.forEach(function(l){if(Z.isNode(l)){var m=l.getAnchor(),O=l.getMatrix(),Q=O.tf({x:l.getWidth()*(p.x-m.x),y:l.getHeight()*(p.y-m.y)}),u=new xe.Math.Matrix2;u.set(O.a,O.b,O.c,O.d,O.tx,O.ty),u.translate(-Q.x,-Q.y),u.rotate(n),u.translate(Q.x,Q.y);var X=Math.sign(l.getScale().x);l.setRotation(g(u.b*X,u.a*X)),l.setPosition(u.tx,u.ty)}})},Wl.prototype.setPosition=function(U){var i,Q,R,p,w=this,v=w._position,o=U.x-v.x,Y=U.y-v.y,e=w._entities;for(Q=0,R=e.length;R>Q;Q++)i=e[Q],ng(i)&&(p=i.getPosition(),i.setPosition(p.x+o,p.y+Y));w._position=U},Wl.prototype.setScale=function(n,t){var T=this,X=n/T._scale.x,y=t/T._scale.y;T._adjustChildScaleOrSize(X,y,"size"),T._scale={x:n,y:t}},Wl.prototype.getRect=function(){var W=this,e=W._position,h=W._width,Q=W._height;return{x:e.x-h/2,y:e.y-Q/2,width:h,height:Q}},Wl.prototype.setSize=function(u,s){var B=this,u=Math.max(1,u),s=Math.max(1,s),X=u/B._width,P=s/B._height;B._adjustChildScaleOrSize(X,P,"size"),B._width=u,B._height=s},Wl.prototype._adjustChildScaleOrSize=function(Q,R,X){var q,D,S,r,E,G,Y,n,d,B,H,s,f,C,Z=this,t=Z._position,x=Z._entities,c=new xe.Math.Matrix2;for(D=0,S=x.length;S>D;D++)if(q=x[D],Z.isNode(q)){if(r=q.getPosition(),E=q.getRotation(),G=q.getWidth(),Y=q.getHeight(),n=q.getScale(),H=n.x*G,s=n.y*Y,c.identity().scale(H,s).rotate(E).translate(r.x,r.y).translate(-t.x,-t.y).rotate(-Z._64O),E=g(c.b*Math.sign(H),c.a*Math.sign(H)),c.scale(Q,R),d=Math.cos(E),B=Math.sin(E),Math.abs(d)<.001?(f=c.b/B,C=-c.c/B):(f=c.a/d,C=c.d/d),"scale"===X)q.setScale(f/G,C/Y);else if("size"===X){var u=f/n.x,M=C/n.y;q.setScale(me(f)*Math.abs(n.x),me(C)*Math.abs(n.y)),q.setSize(Math.max(.1,Math.abs(u)),Math.max(.1,Math.abs(M)))}c.rotate(Z._64O).translate(t.x,t.y),q.setPosition(c.tx,c.ty)}},Wl.prototype.getMatrix=function(){var f=this,y=f._position,v=X.Default.getInternal(),G=f._scale;return new v.Mat(f._64O,y.x,y.y,G.x,G.y)},Wl.prototype.getCorners=function(){var h=this,i=h._width,p=h._height,L=h._anchor,Y=-i*L.x,t=-p*L.y,j=h.getMatrix();return[j.tf(Y,t),j.tf(Y,t+p),j.tf(Y+i,t+p),j.tf(Y+i,t)]},Wl.prototype.calcInfo=function(){var V,h,$,f,m,c,n=this,E=[],t=n._entities,T=n._64O;for(f=0,m=t.length;m>f;f++)c=t[f],n.isNode(c)&&c.getCorners&&E.push.apply(E,c.getCorners());if(E.length){var I=Math.cos(-T),G=Math.sin(-T),p=1/0,H=-1/0,X=1/0,Y=-1/0;for(f=0,m=E.length;m>f;f++)$=E[f],V=$.x,h=$.y,$.x=I*V-G*h,$.y=G*V+I*h,p=Math.min(p,$.x),H=Math.max(H,$.x),X=Math.min(X,$.y),Y=Math.max(Y,$.y);n._width=(H-p)/n._scale.x,n._height=(Y-X)/n._scale.y,I=Math.cos(T),G=Math.sin(T);var u=n._anchor;V=p+(H-p)*u.x,h=X+(Y-X)*u.y,n._position={x:I*V-G*h,y:G*V+I*h}}},Wl.prototype.isNode=function(o){return ng(o)?kq(o)?!1:!0:!1},Wl.prototype._42=function(q,a,z){var o,u,s,h,x,n,L,E,k=this,v=k._entities,Y=k.rotateMode;for("batch"===Y&&(E=k.getKeyOb()),o=0,u=v.length;u>o;o++)s=v[o],k.isNode(s)&&(n=s.getRect(),h=xe.toScreenPosition(z,{x:n.x,y:n.y}),x=xe.toScreenPosition(z,{x:n.x+n.width,y:n.y+n.height}),L={min:h,max:x},s===E&&(L.isKeyOb=!0),xe.Icons.DrawIcon(q,a,xe.Icons.GroupSubEntityRect,L))};var dd=xe.CurveActiving=function(m,V){this._curve=m,this._interactor=m._interactor;for(var Y in V)this[Y]=V[Y]};dd.prototype={},dd.prototype.constructor=dd,o.defineProperties(dd.prototype,{point:{get:function(){return this._point},set:function(d){var u=this;u._point=d,u.editingCtrl||u._firePointChange()}},pairs:{get:function(){return this._pairs},set:function(Y){var K=this;K._pairs=Y,K.editingCtrl&&K._firePointChange()}}}),dd.prototype._firePointChange=function(){var y=this,W=y.getCurrentEditingPoint();if(!W)return h.fi({kind:"selectPoint"}),void 0;var h=y._interactor,U=this._curve.target;if(U){var r=xe.getDataMatrix(U).invert(),S=W.e;W=r.apply(xe.toWorldPosition(h.gv,W)),W.e=S;var H=y._lastFirePoint;H&&Math.abs(W.x-H.x)<1e-5&&Math.abs(W.y-H.y)<1e-5&&(W.e==p&&H.e==p||Math.abs(W.e-H.e)<1e-5)||(y._lastFirePoint=W,h.fi({kind:"selectPoint",x:W.x,y:W.y,e:W.e}))}},dd.prototype.dispose=function(){this._interactor.fi({kind:"selectPoint"})},dd.prototype.getCurrentEditingPoint=function(){var c=this,e=c.editingCtrl;if(e){var K=c.pairs;if(K){var m=K[e.pairId],b=m[e.type];if(b)return b}}return c._point};var Vn=xe.CursorFactory=function(i){var m=this;m._interactor=i,m._rotateCursorStyles={}};Vn.prototype={},Vn.prototype.constructor=Vn,Vn.prototype.getRotateCursor=function(O){var S=this;0>O&&(O+=2*Math.PI);var W=S._interactor,U=W.getStyle("rotateCursorSize"),B=W.getStyle("rotateCursorRound"),i=Math.round(180*(O/Math.PI)/B);i*B>=360&&(i=0);var N=S._rotateCursorStyles,p="htCustomRotateStyle_"+U+"_"+B+"_"+i;return N[p]||(S._produceRotateCursor(p,U,B,i),N[p]=!0),p},Vn.prototype._produceRotateCursor=function(R,F,G,$){var t=this;t._interactor;var r=t._canvas;r||(r=t._canvas=M.createElement("canvas")),r.width=r.height=F*devicePixelRatio,r.style.width=r.style.height=F+" px";var i=r.getContext("2d");xe.setAntialias(i,!1),i.scale(devicePixelRatio,devicePixelRatio);var c,I,S,Q,A,C=Math.round(F/2),p=""+C+" "+C+",auto !important;";c=Math.PI/180*$*G,i.clearRect(0,0,F,F),i.save(),i.scale(F/32,F/32),i.translate(16,16),i.rotate(c+Math.PI/2),i.beginPath(),i.moveTo(-8,0),i.lineTo(-8,3),i.lineTo(-5,3),i.moveTo(8,0),i.lineTo(8,3),i.lineTo(5,3),i.moveTo(-8,3),i.quadraticCurveTo(0,-6,8,3),i.restore(),i.strokeStyle="white",i.lineWidth=4,i.stroke(),i.strokeStyle="black",i.lineWidth=2,i.stroke(),I=JSON.stringify(r.toDataURL()),Q="cursor:url("+I+")"+p,1!==devicePixelRatio&&(S='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+F+'px" height="'+F+'px"><image xlink:href='+I+' width="'+F+'" height="'+F+'"/></svg>',Q+="cursor:url(data:image/svg+xml;base64,"+btoa(S)+")"+p,Q+="cursor:-webkit-image-set(url("+I+")"+devicePixelRatio+"x,url("+I+")1x)"+p),A=M.createElement("style"),A.textContent="body."+R+" *, ."+R+"{"+Q+"}",M.head.appendChild(A)};var Zq=xe.Guide.Grid=function(z){var $=this;$._interactor=z,$._alignmentGuideId=0,$._xAlignmentGuide=[],$._yAlignmentGuide=[]};Zq.prototype={},Zq.prototype.constructor=Zq,o.defineProperties(Zq.prototype,{gridBlockSize:{get:function(){var A=this;return A._gridBlockSize||A._interactor.getStyle("gridBlockSize")},set:function(S){this._gridBlockSize=S,this._interactor._42()}},gridThickLinesEvery:{get:function(){var b=this;return b._gridThickLinesEvery||b._interactor.getStyle("gridThickLinesEvery")},set:function(Y){this._gridThickLinesEvery=Y,this._interactor._42()}},gridEnabled:{get:function(){var R=this,n=R._interactor;return n.gridEnabled&&R.isValidGrid()}}}),Zq.prototype._42=function(){var G=this,l=G._interactor;G.gridEnabled&&G.drawGrid(),l.alignmentGuideEnabled&&G.drawAlignmentGuide()},Zq.prototype.makeMatrix=function(){var l=this,B=l._interactor.getStyle("gridAngle"),J=l._interactor.getStyle("gridRotation"),s=new xe.Math.Matrix2,g=Math.sin(B),H=Math.cos(B);return s.set(1,0,H,g,0,0),s.rotate(J),s},Zq.prototype.isValidGrid=function(){var q=this,m=Math.PI,B=q._interactor,X=B.gv;if(X._zoom<B.getStyle("gridZoomThreshold"))return!1;var y=B.getStyle("gridAngle"),T=Math.abs(180*(y%m/m)),u=1-1e-8;return u>T||T>180-u?!1:!0},Zq.prototype.drawAlignmentGuide=function(){var x=this,W=x._interactor,Q=W.gv,G=W._canvas,s=W._context,e=G.width,A=G.height,E=Q.tx(),j=Q.ty(),a=Q._zoom;s.beginPath(),s.strokeStyle=W.getStyle("gridAlignmentGuideColor"),s.lineWidth=1,x._xAlignmentGuide.forEach(function(J){var k=J.p*a+E;s.moveTo(k,0),s.lineTo(k,A)}),x._yAlignmentGuide.forEach(function(A){var I=A.p*a+j;s.moveTo(0,I),s.lineTo(e,I)}),s.stroke()},Zq.prototype.drawGrid=function(){function K(K,g,W,q){var D=xe.toScreenPosition(e,r.apply({x:K,y:g})),V=xe.toScreenPosition(e,r.apply({x:W,y:q}));v.moveTo(D.x,D.y),v.lineTo(V.x,V.y)}var d=this,j=d._interactor,Z=d.gridBlockSize,E=d.gridThickLinesEvery,i=j.getStyle("gridThickColor"),R=j.getStyle("gridLightColor"),e=j.gv,V=j._canvas,v=j._context,W=V.width,q=V.height,r=d.makeMatrix(),P=r.applyInverse(xe.toWorldPosition(e,{x:0,y:0})),X=r.applyInverse(xe.toWorldPosition(e,{x:W,y:0})),O=r.applyInverse(xe.toWorldPosition(e,{x:0,y:q})),c=r.applyInverse(xe.toWorldPosition(e,{x:W,y:q})),t=Math.min(P.x,X.x,O.x,c.x),Y=Math.max(P.x,X.x,O.x,c.x),k=Math.min(P.y,X.y,O.y,c.y),n=Math.max(P.y,X.y,O.y,c.y);W=Y-t,q=n-k;var B=Math.ceil(t/Z),h=Math.floor(Y/Z),y=Math.ceil(k/Z),H=Math.floor(n/Z);e.tx(),e.ty(),e._zoom;var N,z,T;for(v.save(),v.lineWidth=1,v.beginPath(),v.strokeStyle=i,T=Math.ceil(B/E)*E;h>=T;T+=E)N=T*Z,K(N,k,N,n);for(T=Math.ceil(y/E)*E;H>=T;T+=E)z=T*Z,K(t,z,Y,z);for(v.stroke(),v.beginPath(),v.strokeStyle=R,T=B;h>=T;T++)0!==T%E&&(N=T*Z,K(N,k,N,n));for(T=y;H>=T;T++)0!==T%E&&(z=T*Z,K(t,z,Y,z));v.stroke(),v.restore()},Zq.prototype.getAlignmentGuides=function(){var M=this;return{x:M._xAlignmentGuide,y:M._yAlignmentGuide}},Zq.prototype.addAlignmentGuide=function(N,M,f){var U=this,F="x"===N?U._xAlignmentGuide:U._yAlignmentGuide,f=f?f:++U._alignmentGuideId,l={p:M,id:f};if(F.length){var W=U._findClosestAlignmentGuide(l.p,F);W.dis<0?F.splice(W.index+1,0,l):F.splice(W.index,0,l)}else F.push(l);return U._interactor._42(),f},Zq.prototype.findClosest=function(R,v,j){var b=this,D=b._interactor,N=D.gv;j&&(R=xe.toWorldPosition(N,R));var T,U,a,A=1/0,S=1/0,M=R.x,Y=R.y;if(b.gridEnabled){var w=b.gridBlockSize,E=b.makeMatrix(),m=E.applyInverse(R);m=E.apply({x:Math.round(m.x/w)*w,y:Math.round(m.y/w)*w}),A=m.x-M,S=m.y-Y,a=!0}if(D.alignmentGuideEnabled&&(T=b._findClosestAlignmentGuide(M,b._xAlignmentGuide).dis,U=b._findClosestAlignmentGuide(Y,b._yAlignmentGuide).dis,Math.abs(T)<Math.abs(A)&&(A=T,a=!0),Math.abs(U)<Math.abs(S)&&(S=U,a=!0)),a){a=!1;var $=N._zoom,J=D.getStyle("smartGuideSensitivity")/$,h={};if(Math.abs(A)<J&&"y"!==v&&(h.x=j?A*$:A,a=!0),Math.abs(S)<J&&"x"!==v&&(h.y=j?S*$:S,a=!0),a)return h}},Zq.prototype._findClosestAlignmentGuide=function(B,p){if(!p.length)return{dis:1/0};for(var u,s=0,y=p.length-1;y-s>1;)u=Math.floor((s+y)/2),p[u].p<B?s=u:y=u;var W=p[s].p-B,n=p[y].p-B;return Math.abs(W)<=Math.abs(n)?{line:p[s],dis:W,index:s}:{line:p[y],dis:n,index:y}},Zq.prototype.removeAllAlignmentGuide=function(W){var f=this;"y"!==W&&(f._xAlignmentGuide=[]),"x"!==W&&(f._yAlignmentGuide=[]),f._interactor._42()},Zq.prototype.removeAlignmentGuide=function(B){for(var L,F,A,N=this,D=N._xAlignmentGuide,p=0;2>p;p++)for(D=0===p?N._xAlignmentGuide:N._yAlignmentGuide,L=0,F=D.length;F>L;L++)if(A=D[L],A.id===B)return D.splice(L,1),N._interactor._42(),{axis:0===p?"x":"y",position:A.p};return!1},Zq.prototype.adjustAlignmentGuide=function(u,z){var w=this,X=w.removeAlignmentGuide(u);return X?(w.addAlignmentGuide(X.axis,z,u),!0):!1};var Si=xe.Guide.Rect=function(L){var K=this;K._interactor=L};Si.prototype={},Si.prototype.constructor=Si,Si.prototype.gatherRects=function(){var M,C,u,o,d=this,G=d._interactor.gv,N=[],O=[],D={x:N,y:O},U={},y=G.getDataModel(),x=y.a("width"),F=y.a("height");x&&F&&(M=0,C=0,u=x,o=F,N.push({node:y,type:0,p:M},{node:y,type:1,p:M+u/2},{node:y,type:2,p:M+u}),O.push({node:y,type:0,p:C},{node:y,type:1,p:C+o/2},{node:y,type:2,p:C+o}),U[y._id||0]={x:M,y:C,width:u,height:o}),y.each(function(S){if(ng(S)&&!G.isSelected(S)&&G.isVisible(S)){var Z=!1;if(G.sm().getSelection().each(function(U){Z||(S.isHostOn(U)?Z=!0:S.isDescendantOf(U)&&(Z=!0))}),!Z){var J=S.getRect();M=J.x,C=J.y,u=J.width,o=J.height,N.push({node:S,type:0,p:M},{node:S,type:1,p:M+u/2},{node:S,type:2,p:M+u}),O.push({node:S,type:0,p:C},{node:S,type:1,p:C+o/2},{node:S,type:2,p:C+o}),U[S._id]=J}}}),N.sort(function(u,B){return u.p-B.p}),O.sort(function(T,B){return T.p-B.p}),d._grid=D,d._87I=U},Si.prototype.gatherLines=function(t,F,b){var W,z,U,Q,g,S,f,y,E,u,i,m,R=this,Y=[R.findClosest({x:t.x,y:t.y},F),R.findClosest({x:t.x+t.w/2,y:t.y+t.h/2},F),R.findClosest({x:t.x+t.w,y:t.y+t.h},F)],l={},j=R._87I;b=b||255;var G,X;for(R._guideLine=[],W=0;2>W;W++)for(l={},0===W?(Q="y",y=t.x,E=y+t.w):(Q="x",y=t.y,E=y+t.h),z=0;3>z;z++)g=Y[z],g&&isFinite(g[Q])&&(G=1<<3*W+z,b&G&&(S=g[Q+"Line"],f=S.node,X=f._id||0,l[X]||(l[X]=!0,m=j[X],"y"===Q?(u=m.x,i=m.x+m.width):(u=m.y,i=m.y+m.height),U=S.p,R._guideLine.push({type:Q,a:y,b:E,c:u,d:i,p:U,center:1===S.type}))))},Si.prototype._binarySearchClosest=function(q,p){if(!p.length)return{dis:1/0};for(var k,c=0,T=p.length-1;T-c>1;)k=Math.floor((c+T)/2),p[k].p<q?c=k:T=k;var s=p[c].p-q,D=p[T].p-q;return Math.abs(s)<=Math.abs(D)?{line:p[c],dis:s}:{line:p[T],dis:D}},Si.prototype.findClosest=function(R,H,t){var V=this,X=V._interactor,z=X.gv,a=V._grid;t&&(R=xe.toWorldPosition(z,R));var d,s=V._binarySearchClosest(R.x,a.x),I=V._binarySearchClosest(R.y,a.y),g=s.dis,B=I.dis,W=z._zoom,i=X.getStyle("smartGuideSensitivity")/W,D={};return Math.abs(g)<i&&"y"!==H&&(D.x=t?g*W:g,D.xLine=s.line,d=!0),Math.abs(B)<i&&"x"!==H&&(D.y=t?B*W:B,D.yLine=I.line,d=!0),d?D:void 0},Si.prototype._42=function(){var r=this,K=r._guideLine;if(K&&!X.Default.isCtrlDown()){var B,$,p,U,P,j,m,z,S,W,N,v,R,q,h,F,g,J=r._interactor,s=J.gv,d=J._context,w=s.tx(),b=s.ty(),f=s._zoom,O=J.getStyle("guideLineTextSpacing");
for(B=0,$=K.length;$>B;B++)p=K[B],z=p.type,S=p.p,W=p.a,N=p.b,v=p.c,R=p.d,q=Math.min(W,v),h=Math.max(N,R),"x"===z?(U=S*f+w,P=q*f+b,j=U,m=h*f+b):(U=q*f+w,P=S*f+b,j=h*f+w,m=P),xe.Icons.DrawIcon(J,d,xe.Icons.MoveLineGuide,{rect:[U,P,j,m],center:p.center}),R>=W&&N>=v||(q=W>R?R:N,h=W>R?W:v,g=h-q,"x"===z?(p.center2center||(U-=O,j=U),P=q*f+b,m=h*f+b,F=xe.Icons.MoveLineGuideDistanceV):"y"===z&&(p.center2center||(P-=O,m=P),U=q*f+w,j=h*f+w,F=xe.Icons.MoveLineGuideDistanceH),xe.Icons.DrawIcon(J,d,F,{x0:U,y0:P,x1:j,y1:m,dis:g}))}},Si.prototype.clear=function(){this._guideLine=null},xe.DefaultStyleMap={pointSize:[24,9],checkSize:7,rotateCheckSize:10,moveSensitivity:10,rotateRound:Math.PI/2,rotateSensitivity:Math.PI/60,shiftRotateRound:Math.PI/12,shiftLineRotateRound:Math.PI/4,anchorMovable:!0,anchorVisible:!0,anchorHideThreshold:25,anchorOutsideVisibleThreshold:.25,anchorRound:.25,anchorSensitivity:.02,smartGuideSensitivity:8,curveIntersectSize:5,curvePointIntersectSize:8,edgeHostDetectPerFrame:!0,guideLineTextSpacing:0,gridBlockSize:40,gridThickLinesEvery:10,gridThickColor:"#5d5d5d",gridLightColor:"#d0d0d0",gridZoomThreshold:.25,gridAlignmentGuideColor:"#ff0000",gridAngle:Math.PI/2,gridRotation:0,groupRotateModeDefault:"block",groupRotateModeKey:["ctrlKey","metaKey"],rotateCursorSize:32,rotateCursorRound:45,tipTextColor:"#ffffff",tipBackground:"#333333",curveHighlightColor:"#30599e",rectPointBackground:"white",rectPointBorderColor:"#666666",rectPointShadowColor:"rgba(0,0,0,0.35)",shapeCtrlPointBackground:"white",shapeCtrlPointBorderColor:null,shapeCtrlPointHighlightBorder:null,shapeHighlighPointBackground:"#30599e",curveElevationVisible:!0,curveElevationIntersectSize:8,curveElevationGuideShift:[20,0],connectGuideVisible:!0,connectGuideShift:[1,.25,8,0],connectGuideIntersectSize:8,connectGuideGarbageIntersectsize:25,connectGuideGarbageShift:[1,1,-48,-48]};var Br=xe.Icons={},rk=1e4,In=null,bj="rgb(51,153,255)",Hn="rgb(183,232,135)",vo="rgb(255,204,153)",ph=6;X.Default.setImage("Icons.RectPoint",{width:ph,height:ph,comps:[{type:"rect",background:"rgb(247,247,247)",borderWidth:1,borderColor:bj,rect:[0,0,ph,ph]}]});var Ed="#e000e0";Br.GroupSubEntityRect={comps:[{type:"shape",points:{func:function(){var c=Br.GroupSubEntityRect.data;if(!c)return[];var F=c.min,v=c.max;return[F.x,F.y,F.x,v.y,v.x,v.y,v.x,F.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return Br.GroupSubEntityRect.data.isKeyOb?Ed:"#666666"}}}]},Br.Line={comps:[{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[Br.Line.data.P1.x,Br.Line.data.P1.y],ph,ph]}}},{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[Br.Line.data.P2.x,Br.Line.data.P2.y],ph,ph]}}}]},Br.NodeHoverGuide={comps:[{type:"shape",points:{func:function(){return Br.NodeHoverGuide.data}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:"#3399FF"}]},Br.Rect={comps:[{type:"shape",points:{func:function(){var v=Br.Rect.data;if(!v)return[];var M=v.LT,R=v.LB,D=v.RB,T=v.RT;return[M.x,M.y,R.x,R.y,D.x,D.y,T.x,T.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:bj},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Br.Rect.data.rotation}},rect:{func:function(){return[[Br.Rect.data.LT.x,Br.Rect.data.LT.y],ph,ph]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Br.Rect.data.rotation}},rect:{func:function(){return[[Br.Rect.data.LB.x,Br.Rect.data.LB.y],ph,ph]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Br.Rect.data.rotation}},rect:{func:function(){return[[Br.Rect.data.RB.x,Br.Rect.data.RB.y],ph,ph]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Br.Rect.data.rotation}},rect:{func:function(){return[[Br.Rect.data.RT.x,Br.Rect.data.RT.y],ph,ph]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Br.Rect.data.rotation}},visible:{func:function(){return Br.Rect.data.L?!0:!1}},rect:{func:function(){return[[Br.Rect.data.L.x,Br.Rect.data.L.y],ph,ph]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Br.Rect.data.rotation}},visible:{func:function(){return Br.Rect.data.R?!0:!1}},rect:{func:function(){return[[Br.Rect.data.R.x,Br.Rect.data.R.y],ph,ph]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Br.Rect.data.rotation}},visible:{func:function(){return Br.Rect.data.T?!0:!1}},rect:{func:function(){return[[Br.Rect.data.T.x,Br.Rect.data.T.y],ph,ph]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Br.Rect.data.rotation}},visible:{func:function(){return Br.Rect.data.B?!0:!1}},rect:{func:function(){return[[Br.Rect.data.B.x,Br.Rect.data.B.y],ph,ph]}}}]};var Fb=16;X.Default.setImage("Icons.Anchor",{width:12,height:12,comps:[{type:"shape",borderWidth:1,borderColor:bj,borderCap:"round",shadowColor:"#1ABC9C",points:[.50928,6,11.49072,6,6,6,6,.50928,6,11.49072]},{type:"circle",borderWidth:1,borderColor:bj,shadowColor:"#1ABC9C",rect:[2.84391,2.84391,6.53697,6.53697]}]}),Br.Anchor={comps:[{type:"image",name:"Icons.Anchor",rect:{func:function(){return[[Br.Anchor.data.POS.x,Br.Anchor.data.POS.y],Fb,Fb]}}}]},Br.TipShiftX=12,Br.TipShiftY=12;var Qf=[8,28];Br.TipHelper={comps:[{type:"roundRect",rect:{func:function(){return[Br.TipHelper.data.helperPos.x,Br.TipHelper.data.helperPos.y,Qf[0]*Br.TipHelper.data.size,Qf[1]]}},background:{func:function(){return In.getStyle("tipBackground")}},opacity:.6},{type:"text",text:{func:function(){return Br.TipHelper.data.text}},rect:{func:function(){return[Br.TipHelper.data.helperPos.x,Br.TipHelper.data.helperPos.y,Qf[0]*Br.TipHelper.data.size,Qf[1]]}},color:{func:function(){return In.getStyle("tipTextColor")}},font:"bold 12px Arial",align:"center"}]};var Ze=7;Br.ShapePoint={comps:[{type:"circle",rect:{func:function(){var V=Br.ShapePoint.data;return[V,Ze,Ze]}},background:"#ffffff",borderWidth:1,borderColor:bj}]},Br.ShapeBgCurve={comps:[{type:"shape",points:{func:function(){return Br.ShapeBgCurve.data.P}},segments:{func:function(){return Br.ShapeBgCurve.data.S}},background:null,borderWidth:1,borderColor:bj}]};var Db=8;Br.ShapeHighlighPoint={comps:[{type:"circle",rect:{func:function(){var p=Br.ShapeHighlighPoint.data;return[[p.x,p.y],Db,Db]}},background:{func:function(){return In.getStyle("shapeHighlighPointBackground")}},borderWidth:0}]};var cm=10;Br.ShapeHighlighRealPoint={comps:[{type:"circle",rect:{func:function(){var C=Br.ShapeHighlighRealPoint.data;return[[C.x,C.y],cm,cm]}},background:"#ffffff",borderWidth:2,borderColor:bj}]};var Gi=8;Br.ShapeHighlighCtrlPoint={comps:[{type:"shape",points:{func:function(){var L=Br.ShapeHighlighCtrlPoint.data,v=L.x,K=L.y,U=Gi/2;return[v-U,K-U,v-U,K+U,v+U,K+U,v+U,K-U]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return In.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return In.getStyle("shapeCtrlPointBorderColor")||bj}}}]};var Od=3;Br.ShapeHighlightCurve={comps:[{type:"shape",points:{func:function(){return Br.ShapeHighlightCurve.data}},segments:[1,4],background:null,borderWidth:Od,borderColor:{func:function(){return In.getStyle("curveHighlightColor")}}}]},Br.ShapeGuideLine={comps:[{type:"shape",points:{func:function(){return Br.ShapeGuideLine.data}},background:null,borderWidth:1,borderColor:"rgb(255,204,153)"}]},Br.MoveLineGuide={comps:[{type:"shape",points:{func:function(){return Br.MoveLineGuide.data.rect}},background:null,borderWidth:1,borderColor:{func:function(){return Br.MoveLineGuide.data.center?Hn:vo}}}]};var _r=5;Br.MoveLineGuideDistanceH={comps:[{type:"shape",points:{func:function(){var u=Br.MoveLineGuideDistanceH.data,o=u.x0,Q=u.y0;return[o,Q-_r,o,Q+_r]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:vo},{type:"shape",points:{func:function(){var w=Br.MoveLineGuideDistanceH.data,t=w.x1,v=w.y1;return[t,v-_r,t,v+_r]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:vo},{type:"text",text:{func:function(){return Math.round(Br.MoveLineGuideDistanceH.data.dis)}},rect:{func:function(){var q=Br.MoveLineGuideDistanceH.data;return[[(q.x0+q.x1)/2,q.y0-10],20,20]}},color:vo,font:"12px Arial",align:"center"}]},Br.MoveLineGuideDistanceV={comps:[{type:"shape",points:{func:function(){var g=Br.MoveLineGuideDistanceV.data,e=g.x0,r=g.y0;return[e-_r,r,e+_r,r]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:vo},{type:"shape",points:{func:function(){var x=Br.MoveLineGuideDistanceV.data,v=x.x1,R=x.y1;return[v-_r,R,v+_r,R]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:vo},{type:"text",text:{func:function(){return Math.round(Br.MoveLineGuideDistanceV.data.dis)}},rect:{func:function(){var M=Br.MoveLineGuideDistanceV.data;return[[M.x0-10,(M.y0+M.y1)/2],20,20]}},color:vo,font:"12px Arial",align:"center"}]},X.Default.setImage("Icons.EdgeElevationGuideImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[.5,.5,15,15]},{type:"shape",borderWidth:2,borderColor:"rgb(44,44,44)",borderCap:"round",points:[4,8,8,4,12,8,8,4,8,13],segments:[1,2,2,1,2]}]}),Br.EdgeElevationGuide={comps:[{type:"image",name:"Icons.EdgeElevationGuideImage",rect:{func:function(){var p=Br.EdgeElevationGuide.data,E=p.x,x=p.y,w=In.getStyle("curveElevationIntersectSize"),X=In.getStyle("curveElevationGuideShift");return E+=X[0],x+=X[1],[E-w,x-w,2*w,2*w]}}}]},X.Default.setImage("Icons.ConnectGuideBgImage",{width:12,height:12,comps:[{type:"shape",background:"#3399ff",fillRule:"evenodd",shadowColor:"#1ABC9C",rotation:3.14159,points:[6.00001,11.99999,6.00001,11.99999,2.6863,11.99999,1e-5,9.30695,1e-5,5.99999,1e-5,5.99999,1e-5,2.68628,2.69305,-1e-5,6.00001,-1e-5,12.00001,-1e-5,11.99998,12.00001,6.00001,11.99999],segments:[1,2,4,2,4,2,2,2]}]}),X.Default.setImage("Icons.ConnectGuideHeaderImage",{width:12,height:12,comps:[{type:"oval",background:"#3399FF",borderColor:"#3399FF",shadowColor:"#1ABC9C",rect:[0,0,12,12]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[4.76,2.56,8.2,5.98,4.76,9.44]}]}),Br.ConnectGuide={comps:[{type:"image",name:"Icons.ConnectGuideBgImage",rotation:{func:function(){return Br.ConnectGuide.data.rotation}},rect:{func:function(){var c=Br.ConnectGuide.data.connect;c.x,c.y;var e=In.getStyle("connectGuideIntersectSize");return[[c.x,c.y],2*e,2*e]}}},{type:"image",name:"Icons.ConnectGuideHeaderImage",rect:{func:function(){var y=Br.ConnectGuide.data.cursorPos||Br.ConnectGuide.data.connect,G=In.getStyle("connectGuideIntersectSize");return[[y.x,y.y],2*G-2,2*G-2]}}},{type:"shape",background:null,borderColor:"#3399ff",borderWidth:2,segments:[1,4],points:{func:function(){var g=Br.ConnectGuide.data.connect,p=Br.ConnectGuide.data.cursorPos||g;return[g.x,g.y,g.x+.5*(p.x-g.x),g.y,p.x+.5*(g.x-p.x),p.y,p.x,p.y]}}}]},X.Default.setImage("Icons.ConnectGuideGarbageImage",{width:48,height:48,comps:[{type:"oval",background:"rgba(0,0,0,0.1)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,48,48]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[19.84721,19.69091,19.84721,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[24.10371,19.69091,24.10371,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[28.15279,19.69091,28.15279,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[11.23055,15.22377,36.76945,15.189,19.12302,15.17121,20.94722,11.5228,26.41985,11.5228,28.24406,15.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[15.48702,15.22377,17.02595,21.25344]}]}),X.Default.setImage("Icons.ConnectGuideDeletingImage",{width:56,height:56,comps:[{type:"oval",background:"rgba(232,0,0,0.75)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,56,56]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[22.67939,27.69091,22.67939,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[26.93588,27.69091,26.93588,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[30.98497,27.69091,30.98497,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",anchorX:0,anchorY:1,rotation:5.65062,points:[14.06272,23.22377,39.60163,23.189,21.9552,23.17121,23.7794,19.5228,29.25203,19.5228,31.07623,23.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[18.3192,23.22377,17.02595,21.25344]}]}),Br.ConnectGuideGarbage={comps:[{type:"image",name:{func:function(){var v=Br.ConnectGuideGarbage.data.hover;return v?"Icons.ConnectGuideDeletingImage":"Icons.ConnectGuideGarbageImage"}},rect:{func:function(){var Y=Br.ConnectGuideGarbage.data,l=In.getStyle("connectGuideGarbageIntersectsize");return Y.hover&&(l+=5),[[Y.x,Y.y],2*l,2*l]}}}]};var dr=6;Br.ShapeActivingCtrl={comps:[{type:"shape",visible:{func:function(){return Br.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var d=Br.ShapeActivingCtrl.data;return[d.point.x,d.point.y,d.c1.x,d.c1.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:bj},{type:"shape",visible:{func:function(){return Br.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var J=Br.ShapeActivingCtrl.data;return[J.point.x,J.point.y,J.c2.x,J.c2.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:bj},{type:"shape",visible:{func:function(){return Br.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var e=Br.ShapeActivingCtrl.data.c1,w=e.x,W=e.y,r=dr/2;return"c1"===Br.ShapeActivingCtrl.data.hl&&(r+=.5),[w-r,W-r,w-r,W+r,w+r,W+r,w+r,W-r]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return In.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c1"===Br.ShapeActivingCtrl.data.hl?In.getStyle("shapeCtrlPointHighlightBorder")||bj:In.getStyle("shapeCtrlPointBorderColor")||bj}}},{type:"shape",visible:{func:function(){return Br.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var l=Br.ShapeActivingCtrl.data.c2,Z=l.x,c=l.y,Y=dr/2;return"c2"===Br.ShapeActivingCtrl.data.hl&&(Y+=.5),[Z-Y,c-Y,Z-Y,c+Y,Z+Y,c+Y,Z+Y,c-Y]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return In.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c2"===Br.ShapeActivingCtrl.data.hl?In.getStyle("shapeCtrlPointHighlightBorder")||bj:In.getStyle("shapeCtrlPointBorderColor")||bj}}}]},xe.Icons.DrawIcon=function(W,M,i,V){i.width=i.height=rk,i.data=V,In=W,X.Default.drawImage(M,i,0,0,rk,rk)},xe.Icons.MapPoints=function(T,r){for(var C=0,y=T.length;y>C;C++)T[C]/=r},xe.roundTo=function(b,S,q){var J=Math.abs(b%S);return q>J||q>S-J?S*Math.round(b/S):b},xe.toFixed=function(n){return Math.round(100*n)/100},xe.getDataMatrix=function(M){if(M instanceof X.Shape){var W=new xe.Math.Matrix2,A=M.getPosition();return W.translate(-A.x,-A.y).scale(M.getScale().x,M.getScale().y).rotate(M.getRotation()).translate(A.x,A.y),W}return M.getMatrix?M.getMatrix():new xe.Math.Matrix2};var ie=xe.Math.Curve=function(){this._curves=[]};ie.prototype={},ie.prototype.constructor=ie,ie.prototype.createFromHtShape=function(L,e,$){e instanceof X.List&&(e=e.toArray());var y,N,J,k,O,o,F,m=this,P=null,D=null,r=0,w=xe.Math.Vector2,M=xe.Math.CubicBezier,t=function(G){return new w(L[G],L[G+1],$?$[G/2]:p)};for(N=0,J=e.length;J>N;N++){switch(k=e[N],O=null,k){case 1:D=t(r),P=D,r+=2;break;case 2:y=t(r),r+=2,O=new M(D,D.clone(),y.clone(),y),D=y;break;case 3:o=t(r),y=t(r+2),r+=4,O=new M(D,o.clone().sub(D).multiplyScalar(2/3).add(D),o.clone().sub(y).multiplyScalar(2/3).add(y),y),D=y;break;case 4:o=t(r),F=t(r+2),y=t(r+4),r+=6,O=new M(D,o,F,y),D=y;break;case 5:if(!P)break;O=new M(D,D.clone(),P.clone(),P),D=null,P=null}O&&(O._index=m._curves.length,m._curves.push(O))}},ie.prototype.checkPoint=function(D,Q){var N,x,f,q,o,R=this,r=R._curves;for(N=0,x=r.length;x>N;N++)if(q=r[N],o=q.intersectRect(D,Q,Q),o.length)return f=0,o.forEach(function(R){f+=R.t}),f/=o.length,D=q.getPointAt(f),D.t=f,{bezier:q,intersection:D}},ie.prototype.insertKnot=function(Z,E){var e=Z.insertKnot(E),o=this,Y=o._curves;Y.splice(Z._index,1,e[0],e[1])},ie.prototype._isCloseEnough=function(j,g){return Math.abs(j.x-g.x)<1e-6&&Math.abs(j.y-g.y)<1e-6},ie.prototype._isSamePoint=function(I,e){return I===e},ie.prototype.moveRealPoint=function(U,Z){var N=this,K=N._curves,p=Z.clone().sub(U);K.forEach(function(l){var L=l._p1;l._p2,l._p3;var E=l._p4;N._isSamePoint(L,U)&&(l._p2.add(p),l._p1=Z),N._isSamePoint(E,U)&&(l._p3.add(p),l._p4=Z)})},ie.prototype.moveCtrlDueToRealPointMovement=function(j,t){var b=this,S=b._curves,A=function(G){G.add(t),G.e&&t.e&&(G.e+=t.e)};S.forEach(function(u){var g=u._p1;u._p2,u._p3;var D=u._p4;b._isSamePoint(g,j)&&A(u._p2),b._isSamePoint(D,j)&&A(u._p3)})},ie.prototype.moveCtrlPoint=function(Z,N,I){var e=Z[I];if(e){e.e!==p&&(N.e=e.e);var r=this,l=r._curves;N.clone().sub(e),l.forEach(function(W){var B;"c2"===I?B="_p2":"c1"===I&&(B="_p3"),r._isSamePoint(W[B],e)&&(W[B]=N)}),Z[I]=N}},ie.prototype.deleteRealPoint=function(m,P){var D,J,y,U,z,j,l,W=this,g=W._curves,O={},T=[],S=xe.Math.CubicBezier;for(J=0,y=g.length;y>J;J++)D=g[J],U=D._p1,z=D._p2,j=D._p3,l=D._p4,(O[J]||!W._isSamePoint(U,m))&&(W._isSamePoint(l,m)?y>J+1&&W._isSamePoint(g[J+1]._p1,m)&&(P||T.push(new S(U,z,g[J+1]._p3,g[J+1]._p4))):T.push(D));W._curves=T},ie.prototype.findPairs=function(h,w){var P,V,v,H,d,F,f,p,y=this,M=y._curves,K={},s=[];for(V=0,v=M.length;v>V;V++)P=M[V],H=P._p1,d=P._p2,F=P._p3,f=P._p4,!K[V]&&y._isSamePoint(H,h)&&(w?s.push({point:H,r2:f}):s.push({point:H,c2:d})),y._isSamePoint(f,h)&&(p=w?{point:f,r1:H}:{point:f,c1:F},v>V+1&&y._isSamePoint(M[V+1]._p1,h)&&(w?p.r2=M[V+1]._p4:p.c2=M[V+1]._p2,K[V+1]=!0),s.push(p));return s},ie.prototype.toHtShape=function(){var b=this,M=b._curves,r=[],N=[],k={x:1/0,y:1/0};return M.forEach(function(H){var Z=H._p1,o=H._p2,f=H._p3,p=H._p4;return b._isCloseEnough(Z,k)||(r.push(1),N.push(Z.clone())),k=p,b._isCloseEnough(Z,o)&&b._isCloseEnough(f,p)?(r.push(2),N.push(p.clone()),void 0):(r.push(4),N.push(o.clone(),f.clone(),p.clone()),void 0)}),{segments:r,points:N}};var Hf=xe.Math.CubicBezier=function($,h,r,E){var C=this;C._id=xe.Math.CubicBezier._globalId++,C._p1=$,C._p2=h,C._p3=r,C._p4=E};Hf._globalId=1,Hf.prototype={},Hf.prototype.constructor=Hf,Hf.prototype.toString=function(){return this._id},Hf.prototype.intersectRect=function(v,i,f){var c=i/2,u=f/2,Y=v.x,s=v.y,m=xe.Math.Vector2,G=new m(-c+Y,-u+s),j=new m(c+Y,u+s),H=new m(j.x,G.y),D=new m(G.x,j.y),Q=this,U=Q.intersectLine(G,H),z=Q.intersectLine(H,j),S=Q.intersectLine(j,D),C=Q.intersectLine(D,G),g=U.concat(z).concat(S).concat(C);return g},Hf.prototype.intersectLine=function(e,y){var g,k,t,j,l,A,h,D,F,$,p,B,b,f=this,O=e.clone().min(y),x=e.clone().max(y);j=f._p1,l=f._p2,A=f._p3,h=f._p4,g=j.clone().multiplyScalar(-1),k=l.clone().multiplyScalar(3),t=A.clone().multiplyScalar(-3),p=g.add(k).add(t).add(h),g=j.clone().multiplyScalar(3),k=l.clone().multiplyScalar(-6),t=A.clone().multiplyScalar(3),$=g.add(k).add(t),g=j.clone().multiplyScalar(-3),k=l.clone().multiplyScalar(3),F=g.add(k),D=j.clone(),b=new xe.Math.Vector2(e.y-y.y,y.x-e.x),B=e.x*y.y-y.x*e.y;for(var o=f.getRoots(b.dot(p),b.dot($),b.dot(F),b.dot(D)+B),N=new Array,R=0,X=o.length;X>R;R++){var P=o[R];if(!(0>P||P>1)){var n=j.clone().lerp(l,P),z=l.clone().lerp(A,P),S=A.clone().lerp(h,P),w=n.lerp(z,P),M=z.lerp(S,P),u=w.lerp(M,P);u.t=P,e.x==y.x?O.y<=u.y&&u.y<=x.y&&N.push(u):e.y==y.y?O.x<=u.x&&u.x<=x.x&&N.push(u):u.x>=O.x&&u.y>=O.y&&u.x<=x.x&&u.y<=x.y&&N.push(u)}}return N},Hf.prototype.solveTForPoint=function(Z){var P,o,G,h,z=this;P=z._p1.x-Z.x,o=z._p2.x-Z.x,G=z._p3.x-Z.x,h=z._p4.x-Z.x;for(var O=z.getRoots(h-3*G+3*o-P,3*G-6*o+3*P,3*o-3*P,P),k=p,b=1/0,e=0,n=O.length;n>e;e++){var F=O[e];if(!(0>F||F>1)){var K=z._p1.clone().lerp(z._p2,F),l=z._p2.clone().lerp(z._p3,F),Q=z._p3.clone().lerp(z._p4,F),B=K.lerp(l,F),N=l.lerp(Q,F),J=B.lerp(N,F);J.t=F;var H=Math.abs(J.y-Z.y);b>H&&(b=H,k=J)}}return k},Hf.prototype.getPointAt=function(A){var a=this,r=a._p1,E=a._p2,e=a._p3,w=a._p4,C=r.clone().lerp(E,A),N=E.clone().lerp(e,A),L=e.clone().lerp(w,A),y=C.lerp(N,A),v=N.lerp(L,A);return y.lerp(v,A)},Hf.prototype.getRoots=function(Z,X,q,B){var m,V,U,Y,j,r=new Array;if(Math.abs(Z)<1e-6){var m=X,V=q/m,U=B/m,Y=V*V-4*U;if(Y>0){var j=Math.sqrt(Y);r.push(.5*(-V+j)),r.push(.5*(-V-j))}else 0==Y&&r.push(.5*-V)}X/=Z,q/=Z,B/=Z,m=(3*q-X*X)/3,V=(2*X*X*X-9*q*X+27*B)/27;var J=X/3,K=V*V/4+m*m*m/27,x=V/2;if(Math.abs(K)<=1e-6&&(K=0),K>0){var A,n,j=Math.sqrt(K);A=-x+j,n=A>=0?Math.pow(A,1/3):-Math.pow(-A,1/3),A=-x-j,A>=0?n+=Math.pow(A,1/3):n-=Math.pow(-A,1/3),r.push(n-J)}else if(0>K){var h=Math.sqrt(-m/3),W=Math.atan2(Math.sqrt(-K),-x)/3,_=Math.cos(W),F=Math.sin(W),b=Math.sqrt(3);r.push(2*h*_-J),r.push(-h*(_+b*F)-J),r.push(-h*(_-b*F)-J)}else{var A;A=x>=0?-Math.pow(x,1/3):Math.pow(-x,1/3),r.push(2*A-J),r.push(-A-J)}return r},Hf.prototype._70I=function(){var n=this;return n._p1.distanceToSquared(n._p2)<1e-10&&n._p3.distanceToSquared(n._p4)<1e-10},Hf.prototype.insertKnot=function(T){var W=this,E=W._p1,v=W._p2,x=W._p3,D=W._p4,O=E.clone().lerp(v,T),q=v.clone().lerp(x,T),L=x.clone().lerp(D,T),U=O.clone().lerp(q,T),f=q.clone().lerp(L,T),z=U.clone().lerp(f,T);return W._70I()?(E.clone().lerp(D,T),[new xe.Math.CubicBezier(E,E.clone(),z.clone(),z),new xe.Math.CubicBezier(z,z.clone(),D.clone(),D)]):[new xe.Math.CubicBezier(E,O,U,z),new xe.Math.CubicBezier(z,f,L,D)]};var id=X.Default.getInternal().ui().EdgeUI,fo={_47O:function(s){var o=this,l=fo.getBackups()._47O;xe.inEdit(o.gv)||l.call(o,s)}};xe.Inject.registAsModule(fo,id);var rn=X.Default.getInternal().ui().NodeUI,nn={_47O:function(k){var M=this,P=nn.getBackups()._47O;xe.inEdit(M.gv)||P.call(M,k)},getSelectWidth:function(){var R=this,N=R.gv,Q=R._data;if(N.isEditable(Q)&&xe.inEdit(N))return 0;var D=nn.getBackup("getSelectWidth");return D.call(R)}};xe.Inject.registAsModule(nn,rn);var Nf=X.graph.GraphView,ur={_editPointSize:function(){var R=X.Default.isTouchable,a=xe.getStyle("pointSize");return a[R?0:1]}(),isPointEditable:function(m){var p=this;if(xe.inEdit(p))return p._pointEditableFunc?p._pointEditableFunc(m):!0;var g=ur.getBackup("isPointEditable");g.call(p,m)},isEditable:function(U){var Q,r=this,W=ur.getBackup("isEditable");if(Q=U instanceof xe.Group?!0:W.call(r,U),!xe.inEdit(r))return Q;if(!(U instanceof X.Edge))return Q;if(!U.s("2d.editable"))return!1;var x=r.getEditableFunc();return x?x(U):!0},_42:function(N,K){var q=this,X=ur.getBackups()._42;if(X.call(q,N,K),xe.inEdit(q)){var z=q.getEditInteractor();z.drawImpl()}}};xe.Inject.registAsModule(ur,Nf);var Yh=X.Default.getInternal().ui().ShapeUI,_k={_47O:function(H){var m=this,i=_k.getBackups()._47O;xe.inEdit(m.gv)||i.call(m,H)}};xe.Inject.registAsModule(_k,Yh);var ls=X.graph.DefaultInteractor,Nb={handle_mousewheel:function(q){var t=this,$=Nb.getBackup("handle_mousewheel");xe.inEdit(t.gv)||$.call(t,q)}};xe.Inject.registAsModule(Nb,ls);var om=X.graph.MoveInteractor,Dm={_calcShift:function(q,A){var i=this,r=Dm.getBackup("_calcShift"),b=i.gv;if(!xe.inEdit(b))return r.call(i,q,A);var K=b.getEditInteractor(),x=K.getSubModule("Move").calcShift(q,A,i);return x||r.call(i,q,A)},clear:function(Z){var I=this,p=Dm.getBackup("clear");p.call(I,Z);var H=I.gv;if(xe.inEdit(H)){var O=H.getEditInteractor();O.getSubModule("Move").clear(Z)}}};xe.Inject.registAsModule(Dm,om);var Si=xe.Rect=function(N){this.catalog="Rect",this._interactor=N};Si.prototype={},Si.prototype.constructor=Si,Si.prototype.gatherInfo=function(S,t){var u=this;if(1===t.length){var B=t[0];return B instanceof X.Shape&&B._70I()?u.gatherLine(S,B):kq(B,S)?!1:u.gatherSingleTarget(S,B)}return t.length>1?u.gatherMultiTargets(S,t):!1},Si.prototype.gatherSingleTarget=function(j,W){if(W.getCorners){var $,s=this,u=s.info;s.target=W,$=s.screenInfo={};var M=W.getCorners();u.LT=new xe.Math.Vector2(M[0]),u.LB=new xe.Math.Vector2(M[1]),u.RB=new xe.Math.Vector2(M[2]),u.RT=new xe.Math.Vector2(M[3]),u.T=u.LT.clone().add(u.RT).divideScalar(2),u.B=u.LB.clone().add(u.RB).divideScalar(2),u.L=u.LT.clone().add(u.LB).divideScalar(2),u.R=u.RT.clone().add(u.RB).divideScalar(2);for(var c in u)$[c]=xe.toScreenPosition(j,u[c]);var Q=s._interactor,G=Q.getStyle("checkSize"),q=function(o,c,S){var A=c.clone().sub(o).setLength(-G),T=S.clone().sub(o).setLength(-G),u=A.add(T).add(o);return u};return $.rotLT=q($.LT,$.RT,$.LB),$.rotLB=q($.LB,$.LT,$.RB),$.rotRB=q($.RB,$.LB,$.RT),$.rotRT=q($.RT,$.LT,$.RB),$.rotT=$.rotLT.clone().add($.rotRT).divideScalar(2),$.rotB=$.rotLB.clone().add($.rotRB).divideScalar(2),$.rotL=$.rotLT.clone().add($.rotLB).divideScalar(2),$.rotR=$.rotRT.clone().add($.rotRB).divideScalar(2),$.rotation=W.getRotation(),s.gatherConnectInfo(),!0}},Si.prototype.gatherConnectInfo=function(){var p=this,L=p.target,J=p._interactor,f=p.screenInfo,O=J.gv;if(L instanceof X.Node&&J.getStyle("connectGuideVisible")){var N=L.s("connectGuideShift")||J.getStyle("connectGuideShift"),s=L.getAnchor(),j=L.getSize(),e=L.toGlobal({x:j.width*(N[0]-s.x),y:j.height*(N[1]-s.y)});e=xe.toScreenPosition(O,e),f.P1?e.add(f.P2.clone().sub(f.P1).setLength(N[2])):(e.add(f.RT.clone().sub(f.LT).setLength(N[2])),e.add(f.LB.clone().sub(f.LT).setLength(N[3]))),f.connect=e}},Si.prototype.gatherMultiTargets=function(x,w){var j=xe.Group.findOrCreateGroup(w);if(!j)return!1;var r=this;return r.editing&&"rotate"!==r.editing.mode||j.calcInfo(),r.gatherSingleTarget(x,j)},Si.prototype.gatherLine=function(q,h){this.target=h;var n=this.screenInfo={},R=h.getPoints(),z=xe.getDataMatrix(h);return n.P1=xe.toScreenPosition(q,z.apply(R.get(0))),n.P2=xe.toScreenPosition(q,z.apply(R.get(1))),this.gatherConnectInfo(),!0},Si.ResizeKeys=["LT","RB","LB","RT","L","R","B","T"],Si.ResizeDirection=[{x:-1,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:0},{x:1,y:0},{x:0,y:1},{x:0,y:-1}],Si.RotateKeys=["rotLT","rotRB","rotLB","rotRT","rotL","rotR","rotB","rotT"],Si.prototype.check=function(f,k,y){if(X.Default.isLeftButton(k)){var A=this;if(A.editing=null,A.tipInfo=null,A.screenInfo){var N=A.target,T=f.isEditable(N),C=A.screenInfo;if(T&&C.connect){var m=A._checkConnect(y);if(m)return m}if(C.P1)return A._checkLine(y);var Q,r,c,x=null,V=A._interactor,t=V.getStyle("checkSize");if(T&&f.isRectEditable(N))for(r=0;r<xe.Rect.ResizeKeys.length;r++)if(c=xe.Rect.ResizeKeys[r],xe.checkHit(y,C[c],t)){x=c,Q="resize";break}if(!x&&T&&f.isRotationEditable(N)){var U=V.getStyle("rotateCheckSize");for(r=0;r<xe.Rect.RotateKeys.length;r++)if(c=xe.Rect.RotateKeys[r],xe.checkHit(y,C[c],U)){x=c,Q="rotate";break}}if(!x)return V.setCursor("default"),void 0;if("rotate"===Q){var K,o=f.lp(k);if(N instanceof xe.Group){var d=V.getStyle("groupRotateModeKey");"string"==typeof d&&(d=[d]);for(var n=!1,e=0,g=d.length;g>e;e++)if(k[d[e]]){n=!0;break}var F=V.getStyle("groupRotateModeDefault");K=n?"batch"===F?"block":"batch":F}var z="batch"===K?N.getAnchor2():N.getPosition(),Z=Math.atan2(o.y-z.y,o.x-z.x);V._setRotateCursor(Z),A.editing={mode:Q,key:x,pos:z,flipY:N.getScale().y<0,rotation:N.getRotation(),hitRot:Z},K&&(A.editing.groupRotateMode=K)}else{var w=xe.Rect.ResizeKeys.indexOf(x),v=xe.Rect.ResizeDirection[w],W=Math.cos(N.getRotation()),S=Math.sin(N.getRotation()),L=v.x*Math.sign(N.getScale().x),M=v.y*Math.sign(N.getScale().y),I=Math.atan2(-S*L-W*M,W*L-S*M),B=(Math.round(I/(Math.PI/4))+8)%8,P=["ew-resize","nesw-resize","ns-resize","nwse-resize","ew-resize","nesw-resize","ns-resize","nwse-resize"][B];this._interactor.setCursor(P);var p=N.getWidth(),$=N.getHeight(),Y=N.getAnchor();A.editing={mode:Q,key:x,rect:{x:-p*Y.x,y:-$*Y.y,width:p,height:$},anchor:Y,matrix:N.getMatrix()}}return x}}},Si.prototype._checkLine=function(U){var J=this;J.screenInfo;var D,n=J._interactor.getStyle("checkSize");if(xe.checkHit(U,J.screenInfo.P1,n))D="P1";else{if(!xe.checkHit(U,J.screenInfo.P2,n))return this._interactor.setCursor("default"),void 0;D="P2"}return J.editing={mode:"line",key:D},D},Si.prototype._checkConnect=function(P){var n=this,e=n.screenInfo,p=n._interactor,S=p.getStyle("connectGuideIntersectSize"),b=e.connect,H=P.x,Q=b.x;if(Q>H&&S>Q-H&&Math.abs(b.y-P.y)<S||H>=Q&&xe.checkHit(P,b,S)){var A="connect",w=j.getConnectAction(p.gv);return n.editing={mode:A},w&&w.delete&&w.delete.visible.call(null,p.gv,n.target)&&(n.editing.hasDeleteAction=!0),p.setCursor("default"),A}},Si.prototype._fireEditEvent=function(u,L){var r=this._interactor,t=this.editing;if(t){var G=t.mode;G="rotate"===G?"Rotation":"connect"===G?"Connection":G[0].toUpperCase()+G.slice(1),r.fi({kind:u+"Edit"+G,event:L})}},Si.prototype.startEdit=function(o,w){o.startDragging(w);var x=this;x._interactor.fi({kind:"prepareEdit",event:w});var c=x.editing,E=x.target;if(c){if(x._fireEditEvent("begin",w),"rotate"===c.mode)return c.groupRotateMode&&E.beginRotate(c),void 0;if("connect"!==c.mode)("line"===c.mode||E&&0===E.getRotation())&&(x._inSmartGuide=!0,x._interactor.rectGuide.gatherRects());else if(c.hasDeleteAction){var e=o.gv,X=x._interactor.getStyle("connectGuideGarbageShift");c.garbageInfo={x:e.getWidth()*X[0]+X[2],y:e.getHeight()*X[1]+X[3],size:x._interactor.getStyle("connectGuideGarbageIntersectsize")},o._42()}}},Si.prototype._46O=function(X){var w,T=this,b=T.editing;if(b){if("connect"===b.mode&&!b.canceled&&!b.deleted)try{b.garbageInfo&&b.garbageInfo.hover?j.doDeleteConnectionAction(T._interactor.gv,T.target):j.doConnectAction(T._interactor.gv,T.target,b.target)}catch(S){console.error(S)}w=T.editing.groupRotateMode,T._fireEditEvent("end",X),T.editing=null}T.tipInfo=null,T._inSmartGuide&&(T._interactor.rectGuide.clear(),T._inSmartGuide=!1),w&&T.target&&T.target.endRotate()},Si.prototype.handleNormalStateDelete=function(){var h=this,o=h.editing;if(o&&"connect"===o.mode&&!o.canceled&&!o.deleted){if(o.garbageInfo){try{j.doDeleteConnectionAction(h._interactor.gv,h.target)}catch(H){console.error(H)}o.garbageInfo=null}return o.cursorPos=null,o.targetCorners=null,o.deleted=!0,h._interactor._42(),!0}},Si.prototype.handleNormalStateKeyDown=function(P){var t=this,e=t.editing;return!e||"connect"!==e.mode||e.canceled||e.deleted?void 0:X.Default.isEsc(P)?(e.cursorPos=null,e.targetCorners=null,e.canceled=!0,t._interactor._42(),!0):void 0},Si.prototype.handleEdit=function(Y,U){var P=this,j=P.editing;if(j){var S,q,w,v,y,M=P.target,Q=j.key,b=j.mode,O=Y.lp(U),$=P._interactor;if("connect"===b){if(j.canceled)return;if(j.deleted)return;j.cursorPos=$._getLogicalPoint(U);var m=j.garbageInfo;return m&&xe.checkHit(j.cursorPos,m,m.size)?(m.hover=!0,j.target=null,j.targetCorners=null):(m&&(m.hover=!1),j.target=Y.getDataAt(O,function(P){return Y.isSelectable(P)?ng(P)?!0:!1:!1})||null,j.targetCorners=xe.getTargetCornersOnScreen(Y,j.target)),$._42(),void 0}if("rotate"===b){var o,C,h=j.pos,I=Math.atan2(O.y-h.y,O.x-h.x);if(j.groupRotateMode?C=I-j.hitRot:(o=I-j.hitRot,C=j.rotation+o),C%=2*Math.PI,0>C&&(C+=2*Math.PI),!X.Default.isCtrlDown(U)){var F,s;wc(U)?(F=$.getStyle("shiftRotateRound"),s=F/2):(F=$.getStyle("rotateRound"),s=$.getStyle("rotateSensitivity")),C=xe.roundTo(C,F,s)}j.groupRotateMode?(o=C-(j.lastRotation||0),0!==o&&(M.addRotation(o,j.groupRotateMode),j.lastRotation=C)):M.setRotation(C),$._setRotateCursor(I),C>Math.PI&&(C-=2*Math.PI);var f=180*(C/Math.PI);f=f.toFixed(2),S=""+f+"°"}else if("resize"===b){var T=j.rect;w=T.x,v=T.y;var r,g=T.width,W=T.height,G=j.anchor,Z=j.matrix,k=wc(U),d=P._unionPointMode1,H=P._unionPointMode2;if(P._inSmartGuide&&!X.Default.isCtrlDown(U)&&!k){var J;"L"===Q||"R"===Q?J="x":("T"===Q||"B"===Q)&&(J="y"),P._adsorbedToClosest(O,J),y=!0}r=Z.tfi(O);var V;"LT"===Q?(T=d(r,{x:w+g,y:v+W},g,W,k),V=9):"T"===Q?(T=H({x:w,y:r.y},{x:w+g,y:v+W},g,W,k,"v"),V=1):"RT"===Q?(T=d(r,{x:w,y:v+W},g,W,k),V=33):"L"===Q?(T=H({x:r.x,y:v},{x:w+g,y:v+W},g,W,k,"h"),V=8):"R"===Q?(T=H({x:w,y:v},{x:r.x,y:v+W},g,W,k,"h"),V=32):"LB"===Q?(T=d(r,{x:w+g,y:v},g,W,k),V=12):"B"===Q?(T=H({x:w,y:v},{x:w+g,y:r.y},g,W,k,"v"),V=4):"RB"===Q&&(T=d(r,{x:w,y:v},g,W,k),V=36);
var _=Z.tf(T.x+T.width*G.x,T.y+T.height*G.y);M.setPosition(_),M.setSize(T.width,T.height),y&&(q=M.getRect(),$.rectGuide.gatherLines({node:M,x:q.x,y:q.y,w:q.width,h:q.height},J,V)),S=""+Math.round(T.width)+" * "+Math.round(T.height)}else if("line"===b){if(wc(U)){var l=M.getPoints(),D="P1"===Q?l.get(1):l.get(0),u={x:O.x-D.x,y:O.y-D.y},a=$.getStyle("shiftLineRotateRound"),N=P._shiftDirList;if(!N||P._shiftRotateRound!==a){P._shiftRotateRound=a,P._shiftDirList=N=[];for(var p=0;p<Math.PI;p+=a)N.push({x:L(p),y:A(p)})}for(var x,e=0,i=0,c=N.length;c>i;i++){var K=N[i],z=K.x*u.x+K.y*u.y;Math.abs(z)>Math.abs(e)&&(e=z,x=K)}O={x:D.x+x.x*e,y:D.y+x.y*e},$.rectGuide.clear()}else P._inSmartGuide&&!X.Default.isCtrlDown(U)&&(P._adsorbedToClosest(O),y=!0);var E=xe.getDataMatrix(M).applyInverse(O);M.setPoint("P1"===Q?0:1,E,!0);var n=M.getPoints(),B=n.get(0),R=n.get(1);w=B.x-R.x,v=B.y-R.y,S=" "+Math.round(Math.sqrt(w*w+v*v))+" ",y&&(q=M.getRect(),$.rectGuide.gatherLines({node:M,x:q.x,y:q.y,w:q.width,h:q.height}))}if(S){var t=X.Default.getLogicalPoint(U,$._canvas);t.x+=xe.Icons.TipShiftX,t.y+=xe.Icons.TipShiftY,P.tipInfo={helperPos:t,text:S,size:S.length}}P._fireEditEvent("between",U)}},Si.prototype._unionPointMode1=function(J,Q,t,y,Y){if(Y&&t&&y){var $=J.x-Q.x,T=J.y-Q.y;Math.abs($*y)<Math.abs(T*t)?(T=Math.sign(T)*Math.abs($*y/t),J.y=Q.y+T):($=Math.sign($)*Math.abs(T*t/y),J.x=Q.x+$)}return X.Default.unionPoint(J,Q)},Si.prototype._unionPointMode2=function(D,g,k,H,P,M){var m=X.Default.unionPoint(D,g);if(P&&k&&H){var W;"v"===M?(W=m.x+m.width/2,m.width=k*m.height/H,m.x=W-m.width/2):(W=m.y+m.height/2,m.height=H*m.width/k,m.y=W-m.height/2)}return m},Si.prototype._adsorbedToClosest=function($,V){var P=this,G=P._interactor,S=G.rectGuide.findClosest($,V),Y=G.gridGuide.findClosest($,V),n=1/0,h=1/0;S&&(isFinite(S.x)&&(n=S.x),isFinite(S.y)&&(h=S.y)),Y&&(isFinite(Y.x)&&Math.abs(Y.x)<Math.abs(n)&&(n=Y.x),isFinite(Y.y)&&Math.abs(Y.y)<Math.abs(h)&&(h=Y.y)),isFinite(n)&&($.x+=n),isFinite(h)&&($.y+=h)},Si.prototype._42=function(C,I,g){var B=this;B.info={},B.screenInfo=null;var Y=B._interactor;if(!Y.editDetail&&B.gatherInfo(I,g)){var F=B.editing,p=F?F.groupRotateMode:null,O=B.screenInfo;"block"!==p&&(O.P1?xe.Icons.DrawIcon(Y,C,xe.Icons.Line,O):xe.Icons.DrawIcon(Y,C,xe.Icons.Rect,O),O.connect&&(xe.Icons.DrawIcon(Y,C,xe.Icons.ConnectGuide,{rotation:O.rotation,connect:O.connect,cursorPos:F?F.cursorPos:null}),F&&(F.targetCorners&&xe.Icons.DrawIcon(Y,C,xe.Icons.NodeHoverGuide,F.targetCorners),F.garbageInfo&&xe.Icons.DrawIcon(Y,C,xe.Icons.ConnectGuideGarbage,F.garbageInfo))),B.tipInfo&&xe.Icons.DrawIcon(Y,C,xe.Icons.TipHelper,B.tipInfo)),B.target instanceof xe.Group&&B.target._42(Y,C,I)}};var sj=xe.Anchor=function(c){this.catalog="Anchor",this._interactor=c};sj.prototype={},sj.prototype.constructor=sj,sj.prototype.gatherInfo=function(I,e){var m=this;if(1===e.length){var p=e[0];if(!p.getAnchor)return;if(p instanceof X.Shape&&p._70I())return;if(kq(p,I))return;return m.gatherSingleTarget(I,e[0])}return e.length>1?m.gatherMultiTargets(I,e):!1},sj.prototype.gatherSingleTarget=function(v,A){var P=this;return P.info.POS=A.getPosition(),P.screenInfo.POS=xe.toScreenPosition(v,P.info.POS),P.target=A,!0},sj.prototype.gatherMultiTargets=function(P,w){var r=this,V=xe.Group.findOrCreateGroup(w);return V?(r.screenInfo.POS=xe.toScreenPosition(P,V.getAnchor2()),r.target=V,!0):!1},sj.prototype.isVisible=function(){var E=this,U=E._interactor;if(U.getStyle("anchorVisible")===!1)return!1;var H=E.target;if(H){if(this.editing)return!0;var P=H.getAnchor(),L=U.getStyle("anchorOutsideVisibleThreshold");if(P.x<-L||P.x>1+L||P.y<-L||P.y>1+L)return!0;var N=H.getSize(),u=H.getScale(),w=Math.min(Math.abs(N.width*u.x),Math.abs(N.height*u.y));if(w*U.gv._zoom<U.getStyle("anchorHideThreshold"))return!1}return!0},sj.prototype.check=function(h,A,s){if(X.Default.isLeftButton(A)){var C=this,i=C._interactor;if(C.isVisible()&&i.getStyle("anchorMovable")!==!1){C.editing=null,C.tipInfo=null;var Y=C.target;if(Y&&h.isAnchorEditable(Y)&&h.isEditable(Y)){var e;if(C.screenInfo&&(e=C.screenInfo.POS)&&xe.checkHit(s,new xe.Math.Vector2(e),i.getStyle("checkSize"))){if(Y instanceof xe.Group)return C.editing={},!0;var k=Y.getWidth(),O=Y.getHeight(),L=Y.getAnchor();return C.editing={rect:{x:-k*L.x,y:-O*L.y,width:k,height:O},anchor:L,matrix:Y.getMatrix()},!0}}}}},sj.prototype.startEdit=function(p,N){p.startDragging(N),p.fi({kind:"beginEditAnchor",event:N})},sj.prototype._46O=function(d){var u=this;u.editing&&(u.editing=null,u._interactor.fi({kind:"endEditAnchor",event:d})),u.tipInfo=null},sj.prototype.handleEdit=function(W,F){var q=this,$=q.target;if($){var G=q.editing;if(G){var Q=W.lp(F),H=q._interactor;if($ instanceof xe.Group)return $.setAnchor2(Q),H._42(),void 0;var e=G.matrix,Y=e.tfi(Q),k=G.rect,o=(Y.x-k.x)/k.width,I=(Y.y-k.y)/k.height;if(!X.Default.isCtrlDown(F)){var V=H.getStyle("anchorRound"),Z=H.getStyle("anchorSensitivity");o=xe.roundTo(o,V,Z),I=xe.roundTo(I,V,Z)}$.setAnchor(o,I,!0);var y=X.Default.getLogicalPoint(F,H._canvas);y.x+=xe.Icons.TipShiftX,y.y+=xe.Icons.TipShiftY;var P=""+o.toFixed(2)+", "+I.toFixed(2);q.tipInfo={helperPos:y,text:P,size:P.length},H.fi({kind:"betweenEditAnchor",event:F})}}},sj.prototype._42=function(X,R,D){var t=this;t.info={},t.screenInfo={};var J=t._interactor;J.editDetail||t.gatherInfo(R,D)&&t.isVisible()&&(xe.Icons.DrawIcon(J,X,xe.Icons.Anchor,t.screenInfo),t.tipInfo&&xe.Icons.DrawIcon(J,X,xe.Icons.TipHelper,t.tipInfo))};var ie=xe.Curve=function(g){this.catalog="Curve",this._interactor=g};ie.prototype={},ie.prototype.constructor=ie,o.defineProperties(ie.prototype,{activing:{get:function(){return this._activing},set:function(W){var C=this;if(W)C._activing=new xe.CurveActiving(this,W);else{var s=C._activing;s&&s.dispose(),C._activing=null}}}}),ie.PointType={Mirrored:0,Straight:1,Disconnected:2,Asymmetric:3},ie.prototype.setUp=function(){var z=this,t=z._interactor;t&&t.gv.mp(z._onGraphviewPropertyChanged,z)},ie.prototype._onGraphviewPropertyChanged=function(A){("zoom"===A.property||"translateX"===A.property||"translateY"===A.property)&&this._handleDataChanged()},ie.prototype.tearDown=function(){var P=this,E=P._interactor;E&&E.gv.ump(P._onGraphviewPropertyChanged,P)},ie.prototype.canEnterEditDetailMode=function(){var x=this,E=x._interactor,m=E._getValidSelection();if(1===m.length){var A=m[0],g=A instanceof X.Edge;if(A instanceof X.Shape||g){if(g){var n=A.s("edge.type");if(n&&"points"!==n)return}var Z=E.gv;if(Z.isPointEditable(A)&&Z.isEditable(A))return x.target=A,!0}}},ie.prototype.preHandleScroll=function(){var p=this.editing;return p&&p.inEdit?!0:void 0},ie.prototype.getCurrentSelectintStatus=function(){var R=this;if(R.activing&&!R.activing.selections){if(R.activing.status!=p)return R.activing.status;var P=function(p){var Y=R.activing.status;R.activing.status=p,R._interactor.fp("shapePointStatus",Y,p)},s=xe.Curve.PointType,l=R.activing.point,U=R.activing.pairs;if(!U||1!==U.length)return P(s.Mirrored);var d=U[0],e=d.c1&&d.c1.isNearEnough(l),C=d.c2&&d.c2.isNearEnough(l);if(!d.c1||!d.c2)return e||C?P(s.Straight):P(s.Disconnected);if(e&&C)return P(s.Straight);if(e||C)return P(s.Asymmetric);var j=d.c1.clone().sub(l),t=d.c2.clone().sub(l);return Math.abs(j.x*t.y-j.y*t.x)>1e-5||j.x*t.x>0?P(s.Disconnected):Math.abs(j.length()-t.length())>1e-5?P(s.Asymmetric):P(s.Mirrored)}},ie.prototype.handle_keydown=function(m){var O=this;if(O._interactor.editDetail){var x=xe.Curve.PointType;"1"===m.key?O.setCurrentSelectionStatus(x.Straight):"2"===m.key?O.setCurrentSelectionStatus(x.Mirrored):"3"===m.key?O.setCurrentSelectionStatus(x.Disconnected):"4"===m.key&&O.setCurrentSelectionStatus(x.Asymmetric)}},ie.prototype.setCurrentSelectionStatus=function(W){var B=this,D=B.activing;if(D){var t=B.getCurrentSelectintStatus();if(null!==t&&t!==W){D.status=W;var g=B.activing.point,h=B.activing.pairs;if(h&&1===h.length){var U=h[0],Y=B.screenInfo.curve,f=xe.Curve.PointType,J=function(){B._writeToHt(),B._interactor.fp("shapePointStatus",t,W)};if(W===f.Straight)return Y.moveCtrlPoint(U,g,"c1"),Y.moveCtrlPoint(U,g,"c2"),J(),void 0;if(t===f.Straight){var I=Y.findPairs(g,!0),C=I[0],c=C.r1||g,$=C.r2||g,i=$.clone().sub(c).multiplyScalar(.25);return Y.moveCtrlPoint(U,g.clone().sub(i),"c1"),Y.moveCtrlPoint(U,g.clone().add(i),"c2"),J(),void 0}var S=U.c1,v=U.c2;if(S&&v){if(W===f.Mirrored)return Y.moveCtrlPoint(U,g.clone().multiplyScalar(2).sub(v),"c1"),J(),void 0;if(W===f.Asymmetric&&t===f.Disconnected){var M=S.clone().sub(g).length(),i=g.clone().sub(v).setLength(M).add(g);return Y.moveCtrlPoint(U,i,"c1"),J(),void 0}}D._firePointChange(),B._interactor.fp("shapePointStatus",t,W)}}}},ie.prototype._handleDataChanged=function(X){var Q=this;if(Q.screenInfo&&Q.target){var S=Q._interactor;Q.gatherSingleTarget(S.gv,Q.target,!0),Q.check(S.gv,null,X?S._getLogicalPoint(X):new xe.Math.Vector2(S._lastClientPoint)),S._42()}},ie.prototype.gatherSingleTarget=function(p,l,H){var V,s,Q=this;Q.screenInfo&&Q.screenInfo.curve&&(s=Q.screenInfo.curve._curves);var w=Q.editing;V=w?Q.screenInfo:Q.screenInfo={};var T,n,a=l instanceof X.Edge;a?(T=l.s("edge.segments"),n=l.s("edge.points")||new X.List):(T=l._58O,n=l._59O),V.S=T;var B,N=V.P=[],Z=xe.getDataMatrix(l);if(l instanceof X.Polyline&&(B=l.getElevation()||0,V.E=[]),n.each(function(W){V.E&&V.E.push(W.e||B),W=Z.apply(W);var y=xe.toScreenPosition(p,W);N.push(y.x,y.y)}),a){var I=xe.toScreenPosition(p,l._lastSourcePoint),J=xe.toScreenPosition(p,l._lastTargetPoint);N.splice(0,0,I.x,I.y),N.push(J.x,J.y)}if(!V.S||!V.S.size()){V.S=new X.List,V.S.add(1);for(var u=0;u<N.length/2-1;u++)V.S.add(2)}if((!w||H)&&Q.convertToCubicBezier(s),Q.activing&&(H||!Q.editing||"realPoint"===Q.editing.type)){var e=V.curve.findPairs(Q.activing.point);Q.activing.pairs=e}a&&"points"!==l.s("edge.type")&&Q._writeToHt()},ie.prototype._convertToNewPoint=function(Q,s,p){var M,k,B;for(M=0,k=s.length;k>M;M++){if(B=s[M],B._p1.isNearEnough(Q))return B._p1;if(B._p4.isNearEnough(Q))return B._p4}if(p)for(M=0,k=Math.min(p.length,k);k>M;M++){if(B=p[M],B._p1===Q)return s[M]._p1;if(B._p4===Q)return s[M]._p4}},ie.prototype.convertToCubicBezier=function(S){var E,H,z=this,e=new xe.Math.Curve,D=z.screenInfo;if(e.createFromHtShape(D.P,D.S,D.E),D.curve=e,z.activing){var N=e._curves;if(E=z.activing.point,H=z._convertToNewPoint(E,N,S),H&&(z.activing.point=H),z.activing.selections){var I=-1,U=z.activing.selections;U.forEach(function(J){I++,H=z._convertToNewPoint(J,N,S),H&&(U[I]=H)})}}},ie.prototype.check=function(Z,e,a){if(!e||X.Default.isLeftButton(e)){var c=this;if(c._interactor.setCursor("default"),c.editing=null,c.highlight=null,c.tipInfo=null,c.screenInfo){if(ir())return c._interactor._42(),!0;if(c._checkEditCtrlPoint(a))return c._interactor._42(),!0;if(c._checkEditRealPoint(a))return c._interactor._42(),!0;if(c._checkEditElevation(a))return c._interactor._42(),!0;var x=c.screenInfo.curve,u=x.checkPoint(a,c._interactor.getStyle("curveIntersectSize"));if(u){var L=c.highlight={};L.type="insertKnot",L.bezier=u.bezier,L.point=u.intersection}return c._interactor._42(),!0}}},ie.prototype._checkEditRealPoint=function(x){var n,D,q,L,Y,P,K=this,c=K.screenInfo.curve._curves,M=K._interactor.getStyle("curvePointIntersectSize"),O=1/0;for(M*=M,q=0,L=c.length;L>q;q++)n=c[q],Y=n._p1,P=x.distanceToSquared(Y),O>P&&(O=P,D=Y),Y=n._p4,P=x.distanceToSquared(Y),O>P&&(O=P,D=Y);if(O>M)return!1;var S=K.highlight={};return S.type="changeRealPoint",S.point=D,K.editing={type:"realPoint",point:D,shiftGuide:{point:D.clone(),dir:"x",limit:0}},K._interactor.setCursor("crosshair"),!0},ie.prototype._checkEditElevation=function(S){var R=this;if(!R._interactor.getStyle("curveElevationVisible"))return!1;var J=R.activing;if(!J)return!1;var t=J.getCurrentEditingPoint();if(!t)return!1;var B=R._interactor,X=B.getStyle("curveElevationGuideShift"),j=B.getStyle("curveElevationIntersectSize"),Y=S.distanceToSquared({x:t.x+X[0],y:t.y+X[1]});if(!(Y>j*j)){var Z=R.highlight={};Z.type="elevation";var I=new xe.Math.Vector2(S.x,S.y,t.e);return R.editing={type:"elevation",startPoint:I},R._interactor.setCursor("crosshair"),!0}},ie.prototype._checkEditCtrlPoint=function(y){var f=this;if(f.activing&&!f.activing.selections){var x=f.getCurrentSelectintStatus();if(x!==xe.Curve.PointType.Straight){var s=f.activing.pairs;if(s){var z=f._interactor.getStyle("curvePointIntersectSize");z*=z;var w,B,n,G,g,u,U,T,J,p=1/0;for(U=0,J=s.length;J>U;U++)for(G=s[U],T=0;2>T;T++)g=0===T?"c1":"c2",G[g]&&(u=y.distanceToSquared(G[g]),p>u&&(p=u,w=G,B=U,n=g));if(p>z)return!1;f.activing.hlpair=w,f.activing.hltype=n;var r=f.highlight={};return r.type="changeCtrlPoint",r.point=w[n],f.editing={type:"ctrlPoint",pair:w,pairId:B,ctrlType:n,direction:w[n].clone().sub(f.activing.point).normalize()},f._interactor.setCursor("crosshair"),!0}}}},ie.prototype.startEdit=function(C,l){C.startDragging(l);var K=this;K.highlight&&"insertKnot"===K.highlight.type&&(K.insertKnot(),K.gatherSingleTarget(K._interactor.gv,K.target),K.activing=null,K._checkEditRealPoint(K._interactor._getLogicalPoint(l)));var A=K._activing;if(A){var V=K.editing?K.editing.type:null;"ctrlPoint"===V?A.editingCtrl={pairId:K.editing.pairId,type:A.hltype}:"realPoint"===V&&(A.editingCtrl=!1)}var H=K.highlight,e=X.Default.isCtrlDown(l);if(!H||ir()){var f=K._interactor.gv;if(!f.setFocus(l)||f._scrolling)return;return f.isPannable()&&Mf(l)&&!e&&(K._pan={tx:f.tx(),ty:f.ty()},C.fi({kind:"beginPan",event:l})),void 0}if("changeRealPoint"===H.type){var D,U=K.activing?K.activing.point:null,J=K.activing?K.activing.selections:null;if(e&&K.activing)U===H.point?(J?(K.activing={point:J[0]},J.length>1&&(J.splice(0,1),K.activing.selections=J)):K.activing=null,K.editing=null):J&&(D=J.indexOf(H.point))>=0?(J.length>1?J.splice(D,1):delete K.activing.selections,K.editing=null):J?(J.push(U),K.activing={point:H.point,selections:J}):K.activing={point:H.point,selections:[U]};else if(J)U===H.point||((D=J.indexOf(H.point))>=0?(J.splice(D,1,U),K.activing={point:H.point,selections:J}):K.activing={point:H.point});else{var n;U===H.point&&(n=K.activing.status),K.activing={point:H.point},n&&(K.activing.status=n)}C.fi({kind:"beginEditPoint",event:l})}},ie.prototype.insertKnot=function(){var R=this,y=R.highlight,L=R.screenInfo.curve;L.insertKnot(y.bezier,y.point.t),R._writeToHt()},ie.prototype._writeToHt=function(){var c,z,R,d,m=this,t=m.screenInfo.curve,O=t.toHtShape(),f=O.points,F=[],v=O.segments,$=m._interactor.gv,N=m.target,Q=N instanceof X.Edge,j=xe.getDataMatrix(N).invert();d=N instanceof X.Polyline,d&&(R=N.getElevation());for(var S=0,h=f.length;h>S;S++)c=f[S],z=xe.toWorldPosition($,c),z=j.apply(z),c.e!=p&&c.e!==R&&(z.e=c.e),F.push(z);if(N._writing=!0,Q){N.s("edge.type","points"),N.setStyle("edge.segments",v),N.setStyle("edge.points",F.slice(1,F.length-1)),N.setStyle("edge.source.offset.x",0),N.setStyle("edge.source.offset.y",0),N.setStyle("edge.target.offset.x",0),N.setStyle("edge.target.offset.y",0);var B=m._nextChangeEdgeHost;delete m._nextChangeEdgeHost,B&&("source"===B.type?N.setSource(B.host):N.setTarget(B.host)),m._writeEdgeHostAnchor("source",F[0]),m._writeEdgeHostAnchor("target",F[F.length-1])}else F.length?(N.setSegments(v),N.setPoints(F,!0)):N.removeFromDataModel();delete N._writing},ie.prototype._writeEdgeHostAnchor=function(p,$){var n=this,B=n.target,E=n._calcHostAnchor(B,p,$);B.s("edge."+p+".anchor.x",E.x),B.s("edge."+p+".anchor.y",E.y)},ie.prototype._calcHostAnchor=function(R,y,P,Q){Q||(Q="source"===y?R.getSource():R.getTarget());var V=Q.getRotation(),r=Q.getAnchor(),M=this._interactor.gv;if(kq(Q,M)&&(V=0),V){var Z=Q.getMatrix(),c=Z.tfi(P),z=Q.getSize();return{x:c.x/z.width+r.x,y:c.y/z.height+r.y}}var q=Wk(M,Q),o={x:(P.x-q.x)/q.width,y:(P.y-q.y)/q.height};return o},ie.prototype._handlePanning=function(u){var K=this,S=K._pan;if(S){S.started=!0;var I=K._interactor,w=I.gv,l=I._lastClientPoint,L=yq(u);w.setTranslate(S.tx+L.x-l.x,S.ty+L.y-l.y),K.gatherSingleTarget(I.gv,K.target),I._42(),I.fi({kind:"betweenPan",event:u})}},ie.prototype.handleEdit=function(o,e){var c=this,R=c.editing;if(c._pan)return c._handlePanning(e),void 0;if(R){R.inEdit=!0;var S,E,h,O=c._interactor._getLogicalPoint(e),C=X.Default.isCtrlDown(e),j=X.Default.isShiftDown(e),q=R.type,L=c.activing;if(c._guideInfo=null,"ctrlPoint"===q&&j){var s=c.editing.direction.clone();S=L.point;var J=s.dot(O.clone().sub(S));O=s.setLength(J).add(S)}else if("ctrlPoint"===q||"realPoint"===q){var s;if("realPoint"===q&&j){var x=c.editing.shiftGuide;E=x.point;var K=Math.abs(O.x-E.x),b=Math.abs(O.y-E.y);K>b&&K>x.limit&&"y"===x.dir&&(x.dir="x"),b>K&&b>x.limit&&"x"===x.dir&&(x.dir="y"),s=x.dir,"x"===s?(O.y=E.y,x.limit=Math.max(x.limit,K)):"y"===s&&(O.x=E.x,x.limit=Math.max(x.limit,b))}var G=c._isEditEdgeSourceTarget();if(G){var F=c._editEdgeSourceTarget(G,O,C);F&&(h=F.tipText)}else if(!C){var A=c._guidingToEdit(O,s),m="realPoint"===q?c._interactor.gridGuide.findClosest(O,s,!0):null,f=1/0,d=1/0;m&&(m.x&&(f=m.x),m.y&&(d=m.y));var w=!1;A&&(A.xList&&(Math.abs(A.x)<=Math.abs(f)?(w=!0,f=A.x):delete A.xList),A.yList&&(Math.abs(A.y)<=Math.abs(d)?(w=!0,d=A.y):delete A.yList),w&&(c._guideInfo=A)),isFinite(f)&&(O.x+=f),isFinite(d)&&(O.y+=d),w&&(A.v=O)}}var M=c.screenInfo.curve;if("realPoint"===R.type){S=R.point,S.e!==p&&(O.e=S.e),M.moveRealPoint(S,O),R.point=O,c.highlight.point=O;var y=L.status,I=L.selections;if(c.activing={point:O,status:y},I){var Z=O.clone().sub(S),a=0;I.forEach(function(U){var v=U.clone().add(Z);M.moveRealPoint(U,v),I[a++]=v}),c.activing.selections=I}}else if("ctrlPoint"===R.type){var u=L.pairs,t=u[R.pairId];M.moveCtrlPoint(t,O,R.ctrlType);var T=L.status,i=xe.Curve.PointType;if((T===i.Mirrored||T===i.Asymmetric)&&t.c1&&t.c2){var S=new xe.Math.Vector2(L.point),$="c1"===R.ctrlType?"c2":"c1";if(T===xe.Curve.PointType.Mirrored)M.moveCtrlPoint(t,S.clone().multiplyScalar(2).sub(O),$);else if(T===i.Asymmetric){var J=t[$].clone().sub(S).length(),Q=S.clone().sub(t[R.ctrlType]).setLength(J).add(S);isNaN(Q.x)||M.moveCtrlPoint(t,Q,$)}}L._firePointChange()}else if("elevation"===R.type){E=R.startPoint;var _=E.e+(E.y-O.y)/o._zoom;c._setCurrentPointImpl("e",_),L._firePointChange(),h="E: "+xe.toFixed(_)}var r=X.Default.getLogicalPoint(e,c._interactor._canvas);if(r.x+=xe.Icons.TipShiftX,r.y+=xe.Icons.TipShiftY,!h){var W=xe.toWorldPosition(o,O);h=""+xe.toFixed(W.x)+", "+xe.toFixed(W.y)}c.tipInfo={helperPos:r,text:h,size:h.length},c._writeToHt(),c._interactor.fi({kind:"betweenEditPoint",event:e})}},ie.prototype._setCurrentPointImpl=function(Z,i){var B=this,U=B._activing;if(!U)return!1;var J=B.target;if(!J)return!1;var M=U.getCurrentEditingPoint();if(!M)return!1;var d=U.editingCtrl;if(!d)var l=M.clone();if("e"===Z)M.e=i;else{var h;if("x"===Z||"y"===Z){var V=U._lastFirePoint;h="x"===Z?{x:i,y:V?V.y:0}:{x:V?V.x:0,y:i}}else"object"==typeof Z?(h=Z,Z.e!==p&&(M.e=Z.e)):(h={x:arguments[0],y:arguments[1]},arguments[2]!==p&&(M.e=arguments[2]));var S=xe.getDataMatrix(J);h=xe.toScreenPosition(B._interactor.gv,S.apply(h)),M.x=h.x,M.y=h.y}if(!d){var D=l.multiplyScalar(-1).add(M);M.e&&l.e&&(D.e=M.e-l.e),B.screenInfo.curve.moveCtrlDueToRealPointMovement(M,D)}return!0},ie.prototype.setCurrentPoint=function(H,w){return this._setCurrentPointImpl(H,w)?(this._writeToHt(),!0):!1},ie.prototype._isEditEdgeSourceTarget=function(){var B=this,V=B.target;if(!(V instanceof X.Edge))return!1;var v=B.editing.point,l=B.screenInfo.curve._curves;return v===l[0]._p1?"source":v===l[l.length-1]._p4?"target":!1},ie.prototype._editEdgeSourceTarget=function(d,G,r){var f,Z=this,m=Z.target;if(f="source"===d?m.getSource():m.getTarget()){var W=Z._interactor.gv,M=xe.toWorldPosition(W,G),h=Z._calcHostAnchor(m,d,M,f);if(!r){var g=Z._interactor.getStyle("anchorRound"),b=Z._interactor.getStyle("anchorSensitivity");h.x=xe.roundTo(h.x,g,b),h.y=xe.roundTo(h.y,g,b)}if(Z._interactor.getStyle("edgeHostDetectPerFrame")||h.x<0||h.x>1||h.y<0||h.y>1){var O=W.getDataAt(M,function(z){return W.isSelectable(z)?ng(z)?!0:!1:!1});if(O){var T=Z._calcHostAnchor(m,d,M,O);f=O,Z._nextChangeEdgeHost={type:d,host:O},h=T,r||(h.x=xe.roundTo(h.x,g,b),h.y=xe.roundTo(h.y,g,b))}}if(!r){var o=Ec(W,f,0,0,0,h.x,h.y),Q=xe.toScreenPosition(W,o);G.x=Q.x,G.y=Q.y}return Z._edgeHostGuideInfo=xe.getTargetCornersOnScreen(W,f),{host:f,anchor:h,tipText:""+h.x.toFixed(2)+", "+h.y.toFixed(2)}}},ie.prototype._guidingToEdit=function(Q,C){var t,E,G=this;if(t=G.screenInfo.curve){E=t._curves;var Y,e,d,T,$,g,c,L,A=1/0,B=1/0,w=[];for(G.editing&&"realPoint"===G.editing.type&&(L=G.editing.point),$=0,g=2*E.length;g>$;$++)c=E[Math.floor($/2)][$%2?"_p4":"_p1"],w.indexOf(c)>=0||(w.push(c),L&&L===c||(d=c.x-Q.x,T=c.y-Q.y,Math.abs(d)<Math.abs(A)?(A=d,Y=[c]):d===A&&Y.push(c),Math.abs(T)<Math.abs(B)?(B=T,e=[c]):T===B&&e.push(c)));var D=G._interactor.getStyle("smartGuideSensitivity");if((Math.abs(A)>D||"y"===C)&&(Y=null),(Math.abs(B)>D||"x"===C)&&(e=null),Y||e){var r=!1,X={};if(Y&&(r=!0,X.xList=Y,X.x=A),e&&(r=!0,X.yList=e,X.y=B),r)return X}}},ie.prototype._46O=function(f){var x=this;x.editing&&(x.editing=null,x._interactor.fi({kind:"endEditPoint",event:f})),x._guideInfo=null,x._edgeHostGuideInfo=null,x._pan&&(x._pan=null,x._interactor.fi({kind:"endPan",event:f})),x.tipInfo=null},ie.prototype._canDeletePoint=function(M,Z){var x=this.target;if(!(x instanceof X.Edge))return!0;var d=M._curves[0],Y=M._curves[M._curves.length-1];return d._p1===Z||Y._p4===Z?!1:!0},ie.prototype.handleDelete=function(){var $=this;if($.activing&&$.screenInfo){var E=X.Default.isShiftDown(),y=$.screenInfo.curve;$._canDeletePoint(y,$.activing.point)&&y.deleteRealPoint($.activing.point,E),$.activing.selections&&$.activing.selections.forEach(function(p){$._canDeletePoint(y,p)&&y.deleteRealPoint(p,E)}),$.activing=null,delete $.editing,delete $.tipInfo,delete $._pan,$._writeToHt(),$._interactor.fp("deleteShapePoint",!1,!0)}},ie.prototype.handleDoubleClick=function(F){var K=this,p=K._interactor._getLogicalPoint(F);if(K.screenInfo&&K._checkEditRealPoint(p)){var W=K.getCurrentSelectintStatus(),h=xe.Curve.PointType;return W=W===h.Mirrored?h.Straight:h.Mirrored,K.setCurrentSelectionStatus(W),K._interactor._42(),!0}},ie.prototype._drawHighlight=function(H){var e=this,L=e.highlight;if(L){var d=L.bezier,f=e._interactor;d&&xe.Icons.DrawIcon(f,H,xe.Icons.ShapeHighlightCurve,[d._p1.x,d._p1.y,d._p2.x,d._p2.y,d._p3.x,d._p3.y,d._p4.x,d._p4.y]);var s=L.point;s&&"insertKnot"===L.type&&xe.Icons.DrawIcon(f,H,xe.Icons.ShapeHighlighPoint,s)}},ie.prototype._drawGuide=function(y){var o=this,u=o._guideInfo;if(u){var W,S,x,l,s=u.v;for(W=0;2>W;W++)if(l=0===W?u.xList:u.yList)for(S=0,x=l.length;x>S;S++)xe.Icons.DrawIcon(o._interactor,y,xe.Icons.ShapeGuideLine,[s.x,s.y,l[S].x,l[S].y])}},ie.prototype._drawCurrentPoint=function(b){var j=this;if(j.activing){var B=j.activing,M=j.getCurrentSelectintStatus(),G=j._interactor;if(M!==xe.Curve.PointType.Straight){var o=B.pairs;B.hlpair,B.hltype;var k=B.selections,e=B.editingCtrl;if(o&&!k){var T,E,m;for(E=0,m=o.length;m>E;E++)T=o[E],e&&E===e.pairId&&T[e.type]?xe.Icons.DrawIcon(G,b,xe.Icons.ShapeActivingCtrl,{point:T.point,c1:T.c1,c2:T.c2,hl:e.type}):xe.Icons.DrawIcon(G,b,xe.Icons.ShapeActivingCtrl,T)}}xe.Icons.DrawIcon(G,b,xe.Icons.ShapeHighlighRealPoint,j.activing.point),k&&k.forEach(function(V){xe.Icons.DrawIcon(G,b,xe.Icons.ShapeHighlighRealPoint,V)})}},ie.prototype.clear=function(){var o=this;o.editing=null,o._guideInfo=null,o.activing=null,o.highlight=null},ie.prototype._42=function(I){var Z=this;Z.info={},Z.editing||(Z.screenInfo=null);var j=Z._interactor;if(!j.editDetail)return Z.clear(),void 0;if(!Z.target||!Z._interactor.gv.isSelected(Z.target)||!Z._interactor.gv.isVisible(Z.target))return j.editDetail=!1,Z.clear(),void 0;if(Z.gatherSingleTarget(j.gv,Z.target),xe.Icons.DrawIcon(j,I,xe.Icons.ShapeBgCurve,Z.screenInfo),Z._drawHighlight(I),Z._drawCurrentPoint(I),Z._getRealPoint().forEach(function(D){xe.Icons.DrawIcon(j,I,xe.Icons.ShapePoint,D)}),Z._drawGuide(I),Z.tipInfo&&xe.Icons.DrawIcon(j,I,xe.Icons.TipHelper,Z.tipInfo),Z._edgeHostGuideInfo&&xe.Icons.DrawIcon(j,I,xe.Icons.NodeHoverGuide,Z._edgeHostGuideInfo),Z._interactor.getStyle("curveElevationVisible")&&Z.target instanceof X.Polyline&&Z.activing){var k=Z.activing.getCurrentEditingPoint();k&&xe.Icons.DrawIcon(j,I,xe.Icons.EdgeElevationGuide,k)}},ie.prototype._getRealPoint=function(){var R=this.screenInfo,C=R.P,t=R.S,r=-1,i=[];return t.each(function(w){var o=1;if(3===w)o=2;else if(4===w)o=3;else if(5===w)return;r+=o,i.push({x:C[2*r],y:C[2*r+1]})}),i};var Vc=xe.MoveHelper=function(M){var b=this;b.catalog="Move",b._interactor=M};Vc.prototype={},Vc.prototype.constructor=Vc,Vc.prototype.calcShift=function(r,T,R){var f,u,b=this,p=b._interactor.gv,G=p.lp(T);if("beginMove"===r&&b._gatherGridInfo(R._lastLogicalPoint||G),f=b._target){var U=f.downPosition;if(U){var E=b._interactor.getStyle("moveSensitivity")/p._zoom;if(U.distanceTo(G)<E)return{x:0,y:0};delete f.downPosition}var I;u=X.Default.isShiftDown(T),u&&(G=b._dealShiftDown(G),I=f.shiftGuide.dir);var e,_=f.rawPos={x:f.pos.x+G.x-f.lp.x,y:f.pos.y+G.y-f.lp.y};if(X.Default.isCtrlDown(T)){if(e=b._calcShiftByAddon(),b._target.node instanceof xe.Group){var n=b._target.node;n._position.x+=e.x,n._position.y+=e.y}return e}for(var F,$=f.x+_.x,Q=f.y+_.y,i={x:$,y:Q},y={x:$+f.w/2,y:Q+f.h/2},W={x:$+f.w,y:Q+f.h},g=b._interactor.rectGuide,A=b._interactor.gridGuide,z=[g.findClosest(i,I),g.findClosest(y,I),g.findClosest(W,I),A.findClosest(i,I),A.findClosest(y,I),A.findClosest(W,I)],N=1/0,s=1/0,J=0,P=z.length;P>J;J++)F=z[J],F&&($=F.x,Q=F.y,isFinite($)&&Math.abs($)<Math.abs(N)&&(N=$),isFinite(Q)&&Math.abs(Q)<Math.abs(s)&&(s=Q));if(isFinite(N)||(N=0),isFinite(s)||(s=0),e=b._calcShiftByAddon(N,s),b._target.node instanceof xe.Group){var n=b._target.node;n._position.x+=e.x,n._position.y+=e.y}var q=f.node;if(!kq(q,p)){var w=_.x+N,Y=_.y+s;b._interactor.rectGuide.gatherLines({node:q,x:f.x+w,y:f.y+Y,w:f.w,h:f.h},I)}return e}},Vc.prototype._calcShiftByAddon=function(v,$){var O=this._target,l=O.rawPos,G=O.node.getPosition();return v=v||0,$=$||0,{x:l.x-G.x+v,y:l.y-G.y+$}},Vc.prototype._dealShiftDown=function(J){var K=this,G=K._target.shiftGuide,W=K._target.lp,k=Math.abs(J.x-W.x),Y=Math.abs(J.y-W.y);k>Y&&k>G.limit&&"y"===G.dir&&(G.dir="x"),Y>k&&Y>G.limit&&"x"===G.dir&&(G.dir="y");var B=G.dir;return"x"===B?(J.y=W.y,G.limit=Math.max(G.limit,k)):"y"===B&&(J.x=W.x,G.limit=Math.max(G.limit,Y)),J},Vc.prototype._gatherGridInfo=function(n){var b,y=this,j=y._interactor,g=j._getValidSelection();if(1===g.length){if(b=g[0],!b.getRect)return y._target=null,void 0}else if(b=xe.Group.findOrCreateGroup(g),!b)return y._target=null,void 0;var E=b.getPosition(),B=b.getRect();y._target={node:b,x:B.x-E.x,y:B.y-E.y,w:B.width,h:B.height,lp:{x:n.x,y:n.y},pos:{x:E.x,y:E.y},shiftGuide:{dir:"x",limit:0},downPosition:new xe.Math.Vector2(n)},j.rectGuide.gatherRects()},Vc.prototype.clear=function(){var H=this;H._interactor.rectGuide.clear(),H._interactor._42()};var nr="directional",lb="point",$c="spot",rh="light.color",jr=function(m,J){Td(J)&&Ih.test(J)?dn(m,J):Tf(J)&&J.modelType?Go(m,J):eb[m]=J},ch=function(t){if(Tf(t))return t;var G=eb[t];return t&&G===p&&Ih.test(t)&&(Vf&&Vf[t]||dn(t,t)),G};Rl(j,{graph3dViewAttributes:T,graph3dViewFirstPersonMode:!1,graph3dViewMouseRoamable:!0,graph3dViewMoveStep:15,graph3dViewRotateStep:B/60,graph3dViewEditHelperDisabled:!1,graph3dViewPannable:!0,graph3dViewRotatable:!0,graph3dViewWalkable:!0,graph3dViewResettable:!0,graph3dViewZoomable:!0,graph3dViewRectSelectable:!0,graph3dViewRectSelectBackground:zg,graph3dViewGridVisible:!1,graph3dViewGridSize:50,graph3dViewGridGap:50,graph3dViewGridColor:[.4,.75,.85,1],graph3dViewOriginAxisVisible:!1,graph3dViewCenterAxisVisible:!1,graph3dViewAxisXColor:[1,0,0,1],graph3dViewAxisYColor:[0,1,0,1],graph3dViewAxisZColor:[0,0,1,1],graph3dViewEditSizeColor:[1,1,0,1],graph3dViewOrtho:!1,graph3dViewOrthoWidth:2e3,graph3dViewFovy:B/4,graph3dViewNear:10,graph3dViewFar:1e4,graph3dViewEye:[0,300,1e3],graph3dViewCenter:[0,0,0],graph3dViewUp:[0,1,-1e-7],graph3dViewHeadlightRange:0,graph3dViewHeadlightColor:[1,1,1,1],graph3dViewHeadlightIntensity:1,graph3dViewHeadlightDisabled:!1,graph3dViewFogDisabled:!0,graph3dViewFogColor:"white",graph3dViewFogNear:1,graph3dViewFogFar:2e3,graph3dViewDashDisabled:!0,graph3dViewBatchBlendDisabled:!0,graph3dViewBatchBrightnessDisabled:!0,graph3dViewBatchColorDisabled:!1,setShape3dModel:jr,getShape3dModel:ch,createMatrix:function(S,h){Lq(S)||(S=[S]);for(var P=S.length-1;P>=0;P--){var M=S[P];h=yo(M.mat,M.s3,M.r3,M.rotationMode,M.t3,h)}return h},transformVec:function(A,x){return pg(A,x)},createBoxModel:function(){return{vs:Ml,ns:Cl,uv:ok,is:cb}},createRoundRectModel:function(Z,I){return _b.roundRect(Z,I)},createStarModel:function(Q,F){return _b.star(Q,F)},createRectModel:function(y,m){return _b.rect(y,m)},createTriangleModel:function(D,d){return _b.triangle(D,d)},createRightTriangleModel:function(q,k){return _b.rightTriangle(q,k)},createParallelogramModel:function(D,$){return _b.parallelogram(D,$)},createTrapezoidModel:function(i,h){return _b.trapezoid(i,h)},createSmoothSphereModel:function(w,s,f,c,W,V,d){return Bo(new jd(w,s,f,c,W,V,d))},createSphereModel:function(s,y,G,I,h,D){return s?Ac(s,y,G,I,h,D):j.createSmoothSphereModel()},createSmoothConeModel:function(U,_,m,l,h){return hr(U,_,m,l,h)},createConeModel:function(b,v,E,s,O,w){return b?ke(b,v,E,s,O,w):hr(w)},createSmoothCylinderModel:function(u,i,o,Z,Y,G,l,r){return Bo(new gm(u,i,o,Z,Y,G,l,r))},createCylinderModel:function(m,h,E,y,S,U,_){return m?tc(m,h,E,y,S,U,_):Ll(U,_)},createSmoothTorusModel:function(v,R,p,J,H,h){return Bo(new Rr(v,R,p,J,H,h))},createTorusModel:function(r,A,E,Z,G,I,V){return r?No(r,A,E,Z,G,I,V):vm(I,V)},createExtrusionModel:function($,Z,d,J,t,v,b,X){return oo($,Z,d,J,t,v,b,X)},createSmoothRingModel:function(p,N,n,x,v,F){for(var s=[],q=0;q<p.length-1;q+=2)s.push({x:p[q],y:p[q+1]});for(p=dl(s,N,n)[0],s=[],q=0;q<p.length;q++){var G=p[q];s.push(new _q(G.x,0,G.y))}return Bo(new Ve(s,F,x,v))},createTextGeometry:function(k,c){return Bo(new Nn(k,c))},loadFontFace:function(k,L){j.xhrLoad(k,function(u){if(!u)return L();var Y;try{Y=JSON.parse(u)}catch(B){Y=JSON.parse(u.substring(65,u.length-2))}kj.loadFace(Y),L&&L(Y.familyName.toLowerCase())},L?null:{sync:!0})},getRotationFromMatrix4:function(u,H){var f=a,T=u[0],$=u[4],Z=u[8],I=u[1],m=u[5],P=u[9],i=u[2],d=u[6],p=u[10];H=H||"xyz",H=H[2]+H[1]+H[0],H=H.toUpperCase();var S={};if("XYZ"===H)S._y=Math.asin(f(Z,-1,1)),Math.abs(Z)<.99999?(S._x=Math.atan2(-P,p),S._z=Math.atan2(-$,T)):(S._x=Math.atan2(d,m),S._z=0);else if("YXZ"===H)S._x=Math.asin(-f(P,-1,1)),Math.abs(P)<.99999?(S._y=Math.atan2(Z,p),S._z=Math.atan2(I,m)):(S._y=Math.atan2(-i,T),S._z=0);else if("ZXY"===H)S._x=Math.asin(f(d,-1,1)),Math.abs(d)<.99999?(S._y=Math.atan2(-i,p),S._z=Math.atan2(-$,m)):(S._y=0,S._z=Math.atan2(I,T));else if("ZYX"===H)S._y=Math.asin(-f(i,-1,1)),Math.abs(i)<.99999?(S._x=Math.atan2(d,p),S._z=Math.atan2(I,T)):(S._x=0,S._z=Math.atan2(-$,m));else if("YZX"===H)S._z=Math.asin(f(I,-1,1)),Math.abs(I)<.99999?(S._x=Math.atan2(-P,m),S._y=Math.atan2(-i,T)):(S._x=0,S._y=Math.atan2(Z,p));else{if("XZY"!==H)return null;S._z=Math.asin(-f($,-1,1)),Math.abs($)<.99999?(S._x=Math.atan2(d,m),S._y=Math.atan2(Z,T)):(S._x=Math.atan2(-P,p),S._y=0)}return[S._x,S._y,S._z]},createRingModel:function(r,t,Y,W,G,S,_,X,E,m){for(var p=[],B=0;B<r.length-1;B+=2)p.push({x:r[B],y:r[B+1]});S=S||j.shapeSide,_=_||0,X=X||S;var M,h,n,u,i,k,I,w,P,y,B,J,D,v,C,s,K,g,N=[],z=[],R=E?[]:T,x=E?[]:T,f=m?[]:T,H=m?[]:T,Q=W?[]:T,c=W?[]:T,Z=G?[]:T,a=G?[]:T,r=dl(p,t,Y),o=iq(r),l=0,$=2*Math.PI/S;return r.forEach(function(e){if(n=e.length,n>1){if(u=e[0],W)for(k=u.x,w=u.y,B=_;X>B;B++)J=B+1,D=B*$,v=J*$,C=A(D),s=L(D),K=A(v),g=L(v),Q.push(C*k,w,-s*k,K*k,w,-g*k,0,w,0),c.push(.5-.5*C,.5-.5*s,.5-.5*K,.5-.5*g,.5,.5);for(y=0;n>y;y++){for(i=e[y],k=u.x,I=i.x,w=u.y,P=i.y,M=l/o,l+=de(u,i),h=l/o,B=_;X>B;B++)J=B+1,D=B*$,v=J*$,C=A(D),s=L(D),K=A(v),g=L(v),N.push(C*I,P,-s*I,K*I,P,-g*I,C*k,w,-s*k,K*I,P,-g*I,K*k,w,-g*k,C*k,w,-s*k),z.push(B/S,h,J/S,h,B/S,M,J/S,h,J/S,M,B/S,M),E&&B===_&&(R.push(0,w,0,0,P,0,C*I,P,-s*I,C*I,P,-s*I,C*k,w,-s*k,0,w,0),x.push(0,.5-w,0,.5-P,2*I,.5-P,2*I,.5-P,2*k,.5-w,0,.5-w)),m&&J===X&&(f.push(0,w,0,K*I,P,-g*I,0,P,0,K*I,P,-g*I,0,w,0,K*k,w,-g*k),H.push(1,.5-w,1-2*I,.5-P,1,.5-P,1-2*I,.5-P,1,.5-w,1-2*k,.5-w));
u=i}if(G)for(k=u.x,w=u.y,B=_;X>B;B++)J=B+1,D=B*$,v=J*$,C=A(D),s=L(D),K=A(v),g=L(v),Z.push(K*k,w,-g*k,C*k,w,-s*k,0,w,0),a.push(.5-.5*K,.5+.5*g,.5-.5*C,.5+.5*s,.5,.5)}}),{vs:N,uv:z,bottom_vs:Z,bottom_uv:a,top_vs:Q,top_uv:c,from_vs:R,from_uv:x,to_vs:f,to_uv:H}}},!0),Rl(y,{"3d.move.mode":p,"3d.selectable":!0,"3d.visible":!0,"3d.movable":!0,"3d.editable":!0,"shape.border.gradient.color":p,"edge.gradient.color":p,"edge.source.t3":p,"edge.target.t3":p,"light.type":lb,"light.center":[0,0,0],"light.color":[1,1,1,1],"light.disabled":!1,"light.angle":B/4,"light.range":0,"light.exponent":1,"light.intensity":1,"wf.visible":!1,"wf.width":1,"wf.color":tp,"wf.short":!1,"wf.mat":p,"wf.geometry":!1,batch:p,"transparent.mask":!1,brightness:p,"select.brightness":.7,"repeat.uv.length":p,alphaTest:.4,"label.face":Am,"label.t3":p,"label.r3":p,"label.texture.scale":2,"label.rotationMode":se,"label.light":!1,"label.blend":p,"label.reverse.flip":!1,"label.reverse.color":yp,"label.reverse.cull":!1,"label.transparent":!1,"label.autorotate":!1,"label2.face":Am,"label2.t3":p,"label2.r3":p,"label2.texture.scale":2,"label2.rotationMode":se,"label2.light":!1,"label2.blend":p,"label2.reverse.flip":!1,"label2.reverse.color":yp,"label2.reverse.cull":!1,"label2.transparent":!1,"label2.autorotate":!1,"note.face":Am,"note.t3":p,"note.r3":p,"note.texture.scale":2,"note.rotationMode":se,"note.light":!1,"note.blend":p,"note.reverse.flip":!1,"note.reverse.color":yp,"note.reverse.cull":!1,"note.transparent":!1,"note.autorotate":!1,"note2.face":Am,"note2.t3":p,"note2.r3":p,"note2.texture.scale":2,"note2.rotationMode":se,"note2.light":!1,"note2.blend":p,"note2.reverse.flip":!1,"note2.reverse.color":yp,"note2.reverse.cull":!1,"note2.transparent":!1,"note2.autorotate":!1,shape3d:p,"shape3d.color":wg,"shape3d.top.color":p,"shape3d.bottom.color":p,"shape3d.from.color":p,"shape3d.to.color":p,"shape3d.image":p,"shape3d.top.image":p,"shape3d.bottom.image":p,"shape3d.from.image":p,"shape3d.to.image":p,"shape3d.light":!0,"shape3d.side":0,"shape3d.side.from":p,"shape3d.side.to":p,"shape3d.visible":!0,"shape3d.from.visible":!0,"shape3d.to.visible":!0,"shape3d.top.visible":!0,"shape3d.bottom.visible":!0,"shape3d.torus.radius":.17,"shape3d.resolution":0,"shape3d.blend":p,"shape3d.opacity":p,"shape3d.reverse.flip":!1,"shape3d.reverse.color":yp,"shape3d.reverse.cull":!1,"shape3d.transparent":!1,"shape3d.uv.offset":p,"shape3d.uv.scale":p,"shape3d.top.uv.offset":p,"shape3d.top.uv.scale":p,"shape3d.bottom.uv.offset":p,"shape3d.bottom.uv.scale":p,"shape3d.from.uv.offset":p,"shape3d.from.uv.scale":p,"shape3d.to.uv.offset":p,"shape3d.to.uv.scale":p,"shape3d.top.cap":p,"shape3d.bottom.cap":p,"shape3d.start.angle":0,"shape3d.sweep.angle":u,"shape3d.discard.selectable":!0,"shape3d.top.discard.selectable":!0,"shape3d.bottom.discard.selectable":!0,"shape3d.from.discard.selectable":!0,"shape3d.to.discard.selectable":!0,"shape3d.scaleable":!0,"shape3d.autorotate":!1,"shape3d.fixSizeOnScreen":p,"shape3d.image.cache":!1,"shape3d.alwaysOnTop":!1,"all.light":!0,"all.visible":!0,"all.color":wg,"all.image":p,"all.blend":p,"all.opacity":p,"all.reverse.flip":!1,"all.reverse.color":yp,"all.reverse.cull":!1,"all.transparent":!1,"all.uv":p,"all.uv.offset":p,"all.uv.scale":p,"all.discard.selectable":!0,mat:p,"left.mat":p,"right.mat":p,"top.mat":p,"bottom.mat":p,"front.mat":p,"back.mat":p},!0);var Gc,hm=!1,on=[0,0,0,0],mm={left:[1/255,0,0,1],right:[2/255,0,0,1],top:[3/255,0,0,1],bottom:[4/255,0,0,1],front:[5/255,0,0,1],back:[6/255,0,0,1],m:{1:ud,2:Ij,3:ob,4:fi,5:Am,6:Ol}},sd=function(T,J,O,y){if(J.getFaceVisible(T,O)){Ep(J,cn(T,J.getFaceMat(T,O)||J.getMat(T)));var U=J._26I;J.getFaceReverseCull(T,O)?U.enable(U.CULL_FACE):U.disable(U.CULL_FACE),Qh(U,J._prg.uFixPickReverseColor,mm[O]),gs(U),Ke(U,y,6),_d(U),Eg(J)}},xo=function(u){return u instanceof Fo},qf=function(l){return[l.x,l.e||0,l.y]},Jj=function(o,p,g){for(var p=ql(p),n=p[0],c=p[1],A=p[2];g--;)o.push(n,c,A)},li=function(t,X,g){for(var X=ql(X),_=X[0],Q=X[1],d=X[2],k=X[3];g--;)t.push(_,Q,d,k)},qe=function($,t,A){if(t)for(var w,d,R,M=t[0],X=t[1],v=t[2],N=t[4],G=t[5],T=t[6],C=t[8],o=t[9],j=t[10],H=t[12],c=t[13],m=t[14],g=A.length,Y=0,Y=0;g>Y;Y+=3)w=A[Y],d=A[Y+1],R=A[Y+2],$.push(M*w+N*d+C*R+H,X*w+G*d+o*R+c,v*w+T*d+j*R+m);else qj($,A)},ek=function(T,V){var q=V.s("light.intensity"),n=ql(V.s(rh)),f=n[0],j=n[1],O=n[2];1!==q&&(f*=q,j*=q,O*=q),T.push(f,j,O,V.s("light.disabled")?1:0)},jj=function(v,p,x){Qh(p,x.uHeadlightRange,v._headlightRange);var r=v._headlightIntensity,D=ql(v._headlightColor);1!==r&&(D=[D[0]*r,D[1]*r,D[2]*r]),Qh(p,x.uHeadlightColor,[D[0],D[1],D[2],v._headlightDisabled?1:0]);var R=v._59O,y=v._spots,Z=v._dirs;if(R.length){var i=[],j=[],b=[];R.forEach(function(Y){ek(i,Y),qj(j,v._transformPointToViewSpace(Y.p3())),b.push(Y.s("light.range"))}),p.uniform4fv(x.uPointColor,i),p.uniform1fv(x.uPointRange,b),p.uniform3fv(x.uPointPosition,j)}if(y.length){var u=[],C=[],I=[],m=[],O=[],B=[];y.forEach(function(X){ek(u,X),qj(C,v._transformPointToViewSpace(X.p3())),qj(O,v._transformDirectionToViewSpace(X.p3(),X.s("light.center"))),I.push(X.s("light.range")),m.push(A(X.s("light.angle")/2)),B.push(X.s("light.exponent"))}),p.uniform4fv(x.uSpotColor,u),p.uniform1fv(x.uSpotRange,I),p.uniform1fv(x.uSpotAngle,m),p.uniform1fv(x.uSpotExponent,B),p.uniform3fv(x.uSpotPosition,C),p.uniform3fv(x.uSpotDirection,O)}if(Z.length){var o=[],U=[];Z.forEach(function(T){ek(o,T),qj(U,v._transformDirectionToViewSpace(T.p3()))}),p.uniform4fv(x.uDirColor,o),p.uniform3fv(x.uDirDirection,U)}},To=function(X){return X>0&&0===(X-1&X)},yi=function(W){return W=x(0,d(B,W)),W=x(Sq,d(B-Sq,W))},jg=function(){return.05+H()/2},Dd=function(m,R,j,z){var T,L=m.getEye();return m.isOrtho()?(T=Op(m.getCenter(),L),T[0]+=z[0],T[1]+=z[1],T[2]+=z[2]):T=L,db(R,j,z,T)},db=function(P,N,n,F){var I=hc(P,N),y=Op(F,n,!0),u=hc(y,N);if(J(u)<Sq)return T;var l=(I-hc(n,N))/u;return[n[0]+y[0]*l,n[1]+y[1]*l,n[2]+y[2]*l]},en=function($,m){return{x:2*$.x-m.x,y:2*$.y-m.y}},cc=function(G,W,S,e){var h,q;if(!G)return h=g(W.y-S.y,S.x-W.x),{x:W.x+e*L(h),y:W.y+e*A(h)};if(!S)return h=g(G.y-W.y,W.x-G.x),{x:W.x+e*L(h),y:W.y+e*A(h)};var X=Op([G.x,G.y,0],[W.x,W.y,0],!0),k=Op([S.x,S.y,0],[W.x,W.y,0],!0),M=-(X[0]+k[0])/2,T=-(X[1]+k[1])/2,C=v(M*M+T*T);if(Sq>C)return h=g(G.y-W.y,W.x-G.x),{x:W.x+e*L(h),y:W.y+e*A(h)};var Q=G.x-W.x,i=G.y-W.y,l=S.x-W.x,V=S.y-W.y,w=v(Q*Q+i*i),J=v(l*l+V*V);h=r(hc(X,k))/2,q=X[1]*k[0]-X[0]*k[1]>0?-1:1,M/=C,T/=C;var N=e/L(h),d=x(w,J)/A(h);C=Math.min(N,d);var m={x:W.x+q*C*M,y:W.y+q*C*T};return S.b&&N>J/A(h)&&(m.adjust=!0),m},Og=function(U){var S=U[1],p=U[2],r=U[3],V=U[6],q=U[7],g=U[11];U[1]=U[4],U[2]=U[8],U[3]=U[12],U[4]=S,U[6]=U[9],U[7]=U[13],U[8]=p,U[9]=V,U[11]=U[14],U[12]=r,U[13]=q,U[14]=g},gf=function(N){var r=N[0],u=N[1],$=N[2],z=N[3],p=N[4],n=N[5],D=N[6],H=N[7],W=N[8],m=N[9],j=N[10],t=N[11],R=N[12],E=N[13],k=N[14],X=N[15],C=r*n-u*p,y=r*D-$*p,b=r*H-z*p,_=u*D-$*n,U=u*H-z*n,c=$*H-z*D,e=W*E-m*R,M=W*k-j*R,Y=W*X-t*R,Q=m*k-j*E,f=m*X-t*E,G=j*X-t*k,L=C*G-y*f+b*Q+_*Y-U*M+c*e;return L?(L=1/L,N[0]=(n*G-D*f+H*Q)*L,N[1]=($*f-u*G-z*Q)*L,N[2]=(E*c-k*U+X*_)*L,N[3]=(j*U-m*c-t*_)*L,N[4]=(D*Y-p*G-H*M)*L,N[5]=(r*G-$*Y+z*M)*L,N[6]=(k*b-R*c-X*y)*L,N[7]=(W*c-j*b+t*y)*L,N[8]=(p*f-n*Y+H*e)*L,N[9]=(u*Y-r*f-z*e)*L,N[10]=(R*U-E*b+X*C)*L,N[11]=(m*b-W*U-t*C)*L,N[12]=(n*M-p*Q-D*e)*L,N[13]=(r*Q-u*M+$*e)*L,N[14]=(E*y-R*_-k*C)*L,N[15]=(W*_-m*y+j*C)*L,void 0):T},Kl=function(N,z){if(z){var f=z[0],K=z[1],d=z[2];N[12]=N[0]*f+N[4]*K+N[8]*d+N[12],N[13]=N[1]*f+N[5]*K+N[9]*d+N[13],N[14]=N[2]*f+N[6]*K+N[10]*d+N[14],N[15]=N[3]*f+N[7]*K+N[11]*d+N[15]}},Ef=function(M,G){if(G){var J=G[0],c=G[1],o=G[2];M[0]=M[0]*J,M[1]=M[1]*J,M[2]=M[2]*J,M[3]=M[3]*J,M[4]=M[4]*c,M[5]=M[5]*c,M[6]=M[6]*c,M[7]=M[7]*c,M[8]=M[8]*o,M[9]=M[9]*o,M[10]=M[10]*o,M[11]=M[11]*o}},Qg=function(O,Y,L){var M=Y[0],D=Y[1],p=Y[2],x=Y[3],T=Y[4],m=Y[5],s=Y[6],C=Y[7],F=Y[8],z=Y[9],E=Y[10],V=Y[11],c=Y[12],l=Y[13],y=Y[14],i=Y[15],K=L[0],P=L[1],o=L[2],a=L[3];return O[0]=K*M+P*T+o*F+a*c,O[1]=K*D+P*m+o*z+a*l,O[2]=K*p+P*s+o*E+a*y,O[3]=K*x+P*C+o*V+a*i,K=L[4],P=L[5],o=L[6],a=L[7],O[4]=K*M+P*T+o*F+a*c,O[5]=K*D+P*m+o*z+a*l,O[6]=K*p+P*s+o*E+a*y,O[7]=K*x+P*C+o*V+a*i,K=L[8],P=L[9],o=L[10],a=L[11],O[8]=K*M+P*T+o*F+a*c,O[9]=K*D+P*m+o*z+a*l,O[10]=K*p+P*s+o*E+a*y,O[11]=K*x+P*C+o*V+a*i,K=L[12],P=L[13],o=L[14],a=L[15],O[12]=K*M+P*T+o*F+a*c,O[13]=K*D+P*m+o*z+a*l,O[14]=K*p+P*s+o*E+a*y,O[15]=K*x+P*C+o*V+a*i,O},ci=function(L,n,N,c){var U,O,w,i,g,Y,k,H,t,E,l=n[0],I=n[1],W=n[2],G=c[0],x=c[1],p=c[2],Z=N[0],o=N[1],_=N[2];return J(l-Z)<Sq&&J(I-o)<Sq&&J(W-_)<Sq?Oj(L):(k=l-Z,H=I-o,t=W-_,E=1/v(k*k+H*H+t*t),k*=E,H*=E,t*=E,U=x*t-p*H,O=p*k-G*t,w=G*H-x*k,E=v(U*U+O*O+w*w),E?(E=1/E,U*=E,O*=E,w*=E):(U=0,O=0,w=0),i=H*w-t*O,g=t*U-k*w,Y=k*O-H*U,E=v(i*i+g*g+Y*Y),E?(E=1/E,i*=E,g*=E,Y*=E):(i=0,g=0,Y=0),L[0]=U,L[1]=i,L[2]=k,L[3]=0,L[4]=O,L[5]=g,L[6]=H,L[7]=0,L[8]=w,L[9]=Y,L[10]=t,L[11]=0,L[12]=-(U*l+O*I+w*W),L[13]=-(i*l+g*I+Y*W),L[14]=-(k*l+H*I+t*W),L[15]=1,L)},Tj=function(q,b,g,H,O){var U=1/P(b/2),p=1/(H-O);return q[0]=U/g,q[1]=0,q[2]=0,q[3]=0,q[4]=0,q[5]=U,q[6]=0,q[7]=0,q[8]=0,q[9]=0,q[10]=(O+H)*p,q[11]=-1,q[12]=0,q[13]=0,q[14]=2*O*H*p,q[15]=0,q},fr=function(a,u,w,C,p,q,J){var L=1/(u-w),G=1/(C-p),x=1/(q-J);return a[0]=-2*L,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*G,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*x,a[11]=0,a[12]=(u+w)*L,a[13]=(p+C)*G,a[14]=(J+q)*x,a[15]=1,a},Me=function(b,H){var K=H[0],Q=H[1],O=H[2],C=H[3],f=K*K+Q*Q+O*O+C*C,F=f?1/f:0;return b[0]=-K*F,b[1]=-Q*F,b[2]=-O*F,b[3]=C*F,b},Fl=function(_,k){var O=k[0]+k[5]+k[10],T=0;return O>0?(T=2*Math.sqrt(O+1),_[3]=.25*T,_[0]=(k[6]-k[9])/T,_[1]=(k[8]-k[2])/T,_[2]=(k[1]-k[4])/T):k[0]>k[5]&k[0]>k[10]?(T=2*Math.sqrt(1+k[0]-k[5]-k[10]),_[3]=(k[6]-k[9])/T,_[0]=.25*T,_[1]=(k[1]+k[4])/T,_[2]=(k[8]+k[2])/T):k[5]>k[10]?(T=2*Math.sqrt(1+k[5]-k[0]-k[10]),_[3]=(k[8]-k[2])/T,_[0]=(k[1]+k[4])/T,_[1]=.25*T,_[2]=(k[6]+k[9])/T):(T=2*Math.sqrt(1+k[10]-k[0]-k[5]),_[3]=(k[1]-k[4])/T,_[0]=(k[8]+k[2])/T,_[1]=(k[6]+k[9])/T,_[2]=.25*T),_},Ri=function(B,F,f){var m=F[0],W=F[1],P=F[2],t=F[3],E=m+m,s=W+W,A=P+P,c=m*E,D=m*s,I=m*A,y=W*s,k=W*A,d=P*A,u=t*E,g=t*s,l=t*A;return B[0]=1-(y+d),B[1]=D+l,B[2]=I-g,B[3]=0,B[4]=D-l,B[5]=1-(c+d),B[6]=k+u,B[7]=0,B[8]=I+g,B[9]=k-u,B[10]=1-(c+y),B[11]=0,B[12]=f[0],B[13]=f[1],B[14]=f[2],B[15]=1,B},Dj=j.getRotationFromMatrix4,Yi=function(){var L=[0,0,0],$=[0,0,0],e=[0,0,0],d=function(k,I,o){k[0]=I[1]*o[2]-I[2]*o[1],k[1]=I[2]*o[0]-I[0]*o[2],k[2]=I[0]*o[1]-I[1]*o[0]},G=function(b){return b[0]*b[0]+b[1]*b[1]+b[2]*b[2]},R=function(k){var _=Math.sqrt(G(k));k[0]/=_,k[1]/=_,k[2]/=_},y=function(O,y,V){O[0]=y[0]-V[0],O[1]=y[1]-V[1],O[2]=y[2]-V[2]};return function(A,Q,O){var X=ge();return y(e,A,Q),0===G(e)&&(e[2]=1),R(e),d(L,O,e),0===G(L)&&(1===Math.abs(O[2])?e[0]+=1e-4:e[2]+=1e-4,R(e),d(L,O,e)),R(L),d($,e,L),X[0]=L[0],X[4]=$[0],X[8]=e[0],X[1]=L[1],X[5]=$[1],X[9]=e[1],X[2]=L[2],X[6]=$[2],X[10]=e[2],X}}(),Cq=function(X,Y){if(X.vr.enable){var u=X.vr.getViewMatrix(Y);if(u)return u}return ci(Y?Y:ge(),X._eye,X._center,X._up)},ai=function(h){if(h.vr.enable){var o=h.vr.getProjectMatrix();if(o)return o}var b=h.getAspect(),m=h._near,y=h._far,u=ge();if(h._ortho){var P=h._orthoWidth/2,e=P/b;fr(u,-P,P,-e,e,m,y)}else Tj(u,h._fovy,b,m,y);return u},Oi=function(X,u){if(!X)return T;var D=0,a=1,o=2,w=[],E=0,W=X.length,h=W/3;if(u){for(;W>E;E++)w[E]=0;for(E=0;E<u.length;E+=3){var A=[],U=[],m=[];A[D]=X[3*u[E+1]+D]-X[3*u[E]+D],A[a]=X[3*u[E+1]+a]-X[3*u[E]+a],A[o]=X[3*u[E+1]+o]-X[3*u[E]+o],U[D]=X[3*u[E+2]+D]-X[3*u[E+1]+D],U[a]=X[3*u[E+2]+a]-X[3*u[E+1]+a],U[o]=X[3*u[E+2]+o]-X[3*u[E+1]+o],m[D]=A[a]*U[o]-A[o]*U[a],m[a]=A[o]*U[D]-A[D]*U[o],m[o]=A[D]*U[a]-A[a]*U[D];for(var f=0;3>f;f++)w[3*u[E+f]+D]+=m[D],w[3*u[E+f]+a]+=m[a],w[3*u[E+f]+o]+=m[o]}}else for(E=0;h>E;E+=3){var A=[],U=[],m=[];A[D]=X[3*(E+1)+D]-X[3*E+D],A[a]=X[3*(E+1)+a]-X[3*E+a],A[o]=X[3*(E+1)+o]-X[3*E+o],U[D]=X[3*(E+2)+D]-X[3*(E+1)+D],U[a]=X[3*(E+2)+a]-X[3*(E+1)+a],U[o]=X[3*(E+2)+o]-X[3*(E+1)+o],m[D]=A[a]*U[o]-A[o]*U[a],m[a]=A[o]*U[D]-A[D]*U[o],m[o]=A[D]*U[a]-A[a]*U[D];for(var f=0;3>f;f++)w[3*(E+f)+D]=m[D],w[3*(E+f)+a]=m[a],w[3*(E+f)+o]=m[o]}for(E=0;W>E;E+=3){var K=[];K[D]=w[E+D],K[a]=w[E+a],K[o]=w[E+o];var n=v(K[D]*K[D]+K[a]*K[a]+K[o]*K[o]);0===n&&(n=Sq),K[D]=K[D]/n,K[a]=K[a]/n,K[o]=K[o]/n,w[E+D]=K[D],w[E+a]=K[a],w[E+o]=K[o]}return new Cj(w)},Yl=function(A,r,z,H){if(z||(z=A.createTexture()),r){var l=A.TEXTURE_2D,o=A.REPEAT,M=A.CLAMP_TO_EDGE,t=A.TEXTURE_MIN_FILTER;H!==A.NEAREST&&(H=A.LINEAR),mk(A,z),A.texImage2D(l,0,A.RGBA,A.RGBA,A.UNSIGNED_BYTE,r),yd(A,A.TEXTURE_MAG_FILTER,H),To(r.width)&&To(r.height)&&!r.clampToEdge?(yd(A,A.TEXTURE_WRAP_S,o),yd(A,A.TEXTURE_WRAP_T,o),yd(A,t,A.LINEAR_MIPMAP_LINEAR),A.generateMipmap(l)):(yd(A,A.TEXTURE_WRAP_S,M),yd(A,A.TEXTURE_WRAP_T,M),yd(A,t,H)),mk(A,T)}return z},Ii=function(r,n){var I=new Uint8Array(3);return n=n||r.createTexture(),mk(r,n),yd(r,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texImage2D(r.TEXTURE_2D,0,r.RGB,1,1,0,r.RGB,r.UNSIGNED_BYTE,I),n},uq=function(A){A._26I&&A._prg&&(A._26I.deleteProgram(A._prg),A._prg=T)},vd=function(z,A,T,X){var $=z.createShader(T);return z.shaderSource($,X),z.compileShader($),z.attachShader(A,$),$},xm=function(T){return T.createBuffer()},mk=function(g,_){g.bindTexture(g.TEXTURE_2D,_)},Yr=function(k,v){k.bindFramebuffer(k.FRAMEBUFFER,v)},yd=function(g,R,t){g.texParameteri(g.TEXTURE_2D,R,t)},oj=function(E,b){if(b){var b=ql(b);E.clearColor(b[0],b[1],b[2],b[3])}},Yp=function(X,m){Qh(X,m.uFix,!0),nf(X,m.aNormal)},zf=function(t,M){Qh(t,M.uFix,!1),Ui(t,M.aNormal)},Sn=function(A,w,y,t,e,k,o,i){A._picking||(y?(Qh(A,w.uBlend,!0),Qh(A,w.uBlendColor,y)):Qh(A,w.uBlend,!1),Qh(A,w.uLight,t==T?!0:t),wi(e)&&1!==e&&Qh(A,w.uPartOpacity,e),Qh(A,w.uReverseFlip,k==T?!1:k),Qh(A,w.uFixPickReverseColor,o||yp)),i?A.enable(A.CULL_FACE):A.disable(A.CULL_FACE)},xk=function(X,u){X._picking||Qh(X,u.uPartOpacity,1)},gs=function(M,p,C,a,x,v,d,S,G){if(!C)return M.activeTexture(M.TEXTURE0),mk(M,M._emptyTexture),M.activeTexture(M.TEXTURE1),mk(M,M._emptyBlendTexture),void 0;Qh(M,p.uTexture,!0),Qh(M,p.uDiscardSelectable,uc(a)?a:!0),Ui(M,p.aUv),Xg(M,x,v,p.aUv,2),G?(Qh(M,p.uBlendTexture,!0),M.activeTexture(M.TEXTURE1),mk(M,G),M.uniform1i(p.uBlendSampler,1)):(Qh(M,p.uBlendTexture,!1),M.activeTexture(M.TEXTURE1),mk(M,M._emptyBlendTexture)),M.activeTexture(M.TEXTURE0),mk(M,C),M.uniform1i(p.uSampler,0);var s=[0,0,1,1];d&&(s[0]=d[0],s[1]=d[1]),S&&(s[2]=S[0],s[3]=S[1]),Qh(M,p.uOffsetScale,s)},_d=function(r,u,t){r.activeTexture(r.TEXTURE0),mk(r,T),r.activeTexture(r.TEXTURE1),mk(r,T),t&&(nf(r,u.aUv),Qh(r,u.uTexture,!1),Qh(r,u.uBlendTexture,!1))},zr=function(_,X,W,L,z,x){!W||w||n||_.lineWidth(W),L&&!_._picking&&Qh(_,X.uFixPickReverseColor,L),z&&Xg(_,z,x,X.aPosition)},Ni=function(R,Y,k,A){Gc&&(A=R[Gc]),R.drawArrays(A==T?R.TRIANGLES:A,Y,k);var w=R._renderInfo;w&&(w.calls++,w.vertices+=k,(A==T||A===R.TRIANGLES)&&(w.faces+=k/3),A===R.LINES&&(w.lines+=k/2))},Ke=function(u,I,b,Y){Gc&&(Y=u[Gc]),u.drawElements(Y==T?u.TRIANGLES:Y,b,u.UNSIGNED_SHORT,I==T?0:2*I);var Q=u._renderInfo;Q&&(Q.calls++,Q.vertices+=b,(Y==T||Y===u.TRIANGLES)&&(Q.faces+=b/3),Y===u.LINES&&(Q.lines+=b/2))},zp=function(s,v,c,b,O){var L=s.ARRAY_BUFFER;s.bindBuffer(L,v),c&&s.bufferData(L,c,s.STATIC_DRAW),b!=T&&s.vertexAttribPointer(b,O?O:3,s.FLOAT,!1,0,0)},Xg=function(q,X,d,x,V){return d?(of(q,q.ARRAY_BUFFER,X,d),x!=T&&q.vertexAttribPointer(x,V?V:3,q.FLOAT,!1,0,0),void 0):zp(q,X,d,x,V)},qm=function(S,O,u){var c=S.ELEMENT_ARRAY_BUFFER;S.bindBuffer(c,O),u&&S.bufferData(c,u,S.STATIC_DRAW)},is=function(R,k,_){of(R,R.ELEMENT_ARRAY_BUFFER,k,_)},of=function(r,F,o,$){var o,a=$.glBuf,c=r._id;a&&(o=a[c])&&o._buf?r.bindBuffer(F,o._buf):(o={_buf:xm(r)},r._bufPool.push(o),r.bindBuffer(F,o._buf),r.bufferData(F,$,r.STATIC_DRAW),a||(a=$.glBuf={}),a[c]=o),o._fid=r._renderInfo.frame},Qh=function(E,F,d){if(d!=T&&F!=T){d=ql(d);var A=d.length;3===A?E.uniform3fv(F,d):4===A?E.uniform4fv(F,d):16===A?E.uniformMatrix4fv(F,!1,d):uc(d)?E.uniform1i(F,d?1:0):2===A?E.uniform2fv(F,d):E.uniform1f(F,d)}},Ui=function(v,Y){Y!=T&&Y>=0&&v.enableVertexAttribArray(Y)},nf=function(a,F){F!=T&&F>=0&&a.disableVertexAttribArray(F)},Eg=function(V,e){var q=V.getGL(),y=V._prg;V._7O=V._8O.pop(),e&&(Qh(q,y.uMVMatrix,V._7O),V._6O=e,Qh(q,y.uNMatrix,e))},Wb=function(T,$){return $||($=ge()),kk($,T),gf($),Og($),$},Ep=function(V,h){var u=V.getGL(),e=V._prg,I=V._7O;h&&(V._8O.push(lo(I)),Qg(I,I,h)),Qh(u,e.uMVMatrix,I),Qh(u,e.uNMatrix,Wb(I,V._6O))},$i=function(L,T,R,_,W,O){if(R){if(_){var u=R.value++,t=2147483648|u,A=[(255&t>>16)/255,(255&t>>8)/255,(255&t)/255,(255&t>>24)/255];R[u]={data:W,part:O}}else A=on;return Qh(L,T.uFixPickReverseColor,A),A}},qr=function(){var F={center:function($,y,F,J,w){var f=-y[1]/2,o={x:-y[0]/2,y:f,width:y[0],height:y[1]},z=eg($,o,F);return[z.x+J,-z.y-w,jg()]},front:function(o,l,s,i,E){var k=-l[1]/2,Z={x:-l[0]/2,y:k,width:l[0],height:l[1]},L=eg(o,Z,s);return[L.x+i,-L.y-E,l[2]/2+jg()]},back:function(H,t,U,g,V){var J=-t[0]/2,A=-t[1]/2,z={x:J,y:A,width:t[0],height:t[1]},a=eg(H,z,U);return[-a.x-g,-a.y-V,-t[2]/2-jg()]},left:function(b,m,p,z,B){var c=-m[1]/2,x={x:-m[2]/2,y:c,width:m[2],height:m[1]},O=eg(b,x,p);return[-m[0]/2-jg(),-O.y-B,O.x+z]},right:function(D,O,W,g,K){var d=-O[2]/2,o=-O[1]/2,R={x:d,y:o,width:O[2],height:O[1]},V=eg(D,R,W);return[O[0]/2+jg(),-V.y-K,-V.x-g]},top:function(P,O,_,G,V){var W={x:-O[0]/2,y:-O[2]/2,width:O[0],height:O[2]},p=eg(P,W,_);return[p.x+G,O[1]/2+jg(),p.y+V]},bottom:function(A,N,e,d,O){var H=-N[2]/2,$={x:-N[0]/2,y:H,width:N[0],height:N[2]},W=eg(A,$,e);return[W.x+d,-N[1]/2-jg(),-W.y-O]}};return function(y,U,l,D,O,V){return F[D](y,U,l,O||0,V||0)}}(),jk=function(F,Y,j,x,T,M,_,g,u,a){if(T&&(Y[0]+=T[0],Y[1]+=T[1],Y[2]+=T[2]),Kl(F,j),g){var I=ge();if(Pf(I,u,a),pg(Y,I),Kl(F,Y),F.auto=g,F.pos=pg([0,0,0],F),M){var p=F.mat2=ge();Pf(p,M,_)}}else Pf(F,u,a),Kl(F,Y),x===ud?fh(F,-f):x===Ij?fh(F,f):x===ob?Vd(F,-f):x===fi?Vd(F,f):x===Ol&&fh(F,B),Pf(F,M,_);return F},wr=function(y,G){var b=G.auto,U=G.mat2,Y=y.gv;if(b){var Z,D=ge(),t=[0,0,0,0];Z="string"==typeof b?[b.indexOf("x")<0?Y._eye[0]:Y._center[0],b.indexOf("y")<0?Y._eye[1]:Y._center[1],b.indexOf("z")<0?Y._eye[2]:Y._center[2]]:Y._eye,Fl(t,ci(ge(),Z,Y._center,Y._up)),Ri(D,Me(t,t),G.pos),U&&Qg(D,D,U),Ep(Y,D)}else Ep(Y,G)},el=function(z,n,g,X,O){var t=z.s,o=z.gv,M=o.getGL(),G=o._prg,m=o._buffer,p=o._1O;Yl(M,Zn,p),wr(z,g),Sn(M,G,t(n+".blend"),t(n+".light"),t(n+".opacity"),t(n+".reverse.flip"),t(n+".reverse.color"),t(n+".reverse.cull")),gs(M,G,p,O,m.uv,Nm),Xg(M,m.vs,X,G.aPosition),Xg(M,m.ns,Tl,G.aNormal),is(M,m.is,ab),Ke(M,0,ab.length),_d(M,G,p),xk(M,G),Eg(o)},kg=function(Y,h,w){var B=Y.gv,q=Y.data,m=Y[h]={blend:B.getBodyColor(q)||B.getFaceBlend(q,h),light:B.getFaceLight(q,h),color:B.getFaceColor(q,h),opacity:B.getFaceOpacity(q,h),transparent:B.getFaceTransparent(q,h),reverseFlip:B.getFaceReverseFlip(q,h),reverseColor:B.getFaceReverseColor(q,h),reverseCull:B.getFaceReverseCull(q,h),texture:B.getFaceImage(q,h),blendTexture:B.getFaceBlendImage(q,h),discardSelectable:B.getFaceDiscardSelectable(q,h)};if("csg"!==h){m.uv=B.getFaceUv(q,h)||w&&w[h+"Uv"],m.uvScale=B.getFaceUvScale(q,h)||w&&w[h+"UvScale"],m.uvOffset=B.getFaceUvOffset(q,h)||w&&w[h+"UvOffset"];var D=B.getFaceMat(q,h);D&&(m.mat=cn(q,D))}return m},wd=function(k,s,$,D,b){if(D){if(!b(D.transparent))return;var B=k.data,d=k.gv,M=d._buffer,S=d.getTexture(D.texture,B),x=d.getTexture(D.blendTexture,B);gs(s,$,S,D.discardSelectable,M.uv,D.tuv,D.uvOffset,D.uvScale,x),Sn(s,$,D.blend,D.light,D.opacity,D.reverseFlip,D.reverseColor,D.reverseCull),Qh(s,$.uDiffuse,D.color),Xg(s,M.vs,D.vs,$.aPosition),Xg(s,M.ns,D.ns,$.aNormal),Ni(s,0,D.vs.length/3),xk(s,$),_d(s,$,S)}},vp=function(l,U,Q,L,o,K){var i,m,F,z,P,x,w,t,y,C,f,g=[L-U,o-Q],u=l?l.length:0;for(F=0;u>F;F++){for(z=2,i=l[F],P=i[0],x=i[1];z+1<i.length;){if(w=i[z],t=i[z+1],m=hq(U,Q,L,o,P,x,w,t,!0)){y=[w-P,t-x],C=de(y),y[0]/=C,y[1]/=C,C=hc(g,y),C=C>0?K:-K,f=[y[0]*C,y[1]*C];break}P=w,x=t,z+=2}if(f)break}if(f)for(L=U+f[0],o=Q+f[1],F=0;u>F;F++)for(z=2,i=l[F],P=i[0],x=i[1];z+1<i.length;){if(w=i[z],t=i[z+1],m=hq(U,Q,L,o,P,x,w,t,!0))return[0,0];P=w,x=t,z+=2}return f?f:[L-U,o-Q]},jn=X.graph3d={},gq=function(S,o,V){gb(G+".graph3d."+S,o,V)},kn="~<yfusfw!+!yjsubNQv!>!opjujtpQ`mh!gjeof$!~<fdobutjEfojMb!>!fdobutjEfojMw|*itbEv)gj!ITBE!gfegj$!!gjeof$!~<ttfouihjsCidubCb!>!ttfouihjsCidubCw|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!~<eofmCidubCb!>!eofmCidubCw|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!!gjeof$!~<spmpDidubCb!>!spmpDidubCw|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!~<wVb!>!wVs|*fsvuyfUeofmCv)gj~<x{/fmbdTuftggPv!+!wVb!,!zy/fmbdTuftggPv!>!wVw|*fsvuyfUv)gj~<*yfusfw)4dfw!>!yfusfWw<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw|*ldjQva!%%!yjGva)gj<*1/2!-opjujtpQb)5dfw!+!yjsubNWNv!>!yfusfw!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEfojMb!ubpmg!fuvcjsuub<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCb!4dfw!fuvcjsuub<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCb!ubpmg!fuvcjsuub<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCb!5dfw!fuvcjsuub<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<yjGv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjsubNxfjWv!5ubn!nspgjov<yjsubNOv!5ubn!nspgjov<yjsubNQv!5ubn!nspgjov<yjsubNWNv!5ubn!nspgjov<opjujtpQb!4dfw!fuvcjsuub<mbnspOb!4dfw!fuvcjsuub<wVs!3dfw!hojzsbw<wVw!3dfw!hojzsbw<wVb!3dfw!fuvcjsuub<fmbdTuftggPv!5dfw!nspgjov<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov!YJGFSQ^#CBRBEJxTT87hJFI,,bX1XrIwcn3UM{ZeZ,M6HEN6nLxe2Z72s2:3johr6foKrpqwxNKYkdbJ2CN[mBbf[wXU,T0oGuSEd190ohLZkEn8IuCe[OHoWeKz:Sf,VS7xdSLw23W1YJLU:jdv2{hiDbhDzNNEh9tp3xsuEp94Sl4c3wRzqwShMDRhCLRjCDEBOH5BBVRBCFRE4cJTHrTDH1BNgHJN",Gn="~~<eJ!>!spmpDhbsG`mh~<spmpDsfmqnbTwv!>+!eJ<*wVs!-sfmqnbTeofmCv)E3fsvuyfu!>!spmpDsfmqnbTwv!5dfw|!*fsvuyfUeofmCv)!gj!!gjeof$!~<ttfouihjsCidubCw!>+!chs/eJ!!!|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!~<ttfouihjsCv!>+!chs/eJ!!!|*1/2!>a!ttfouihjsCv)gj~~<zujdbqPusbQv!>+!b/eJ!!!|*1/2!>a!zujdbqPusbQv)gj~!gjeof$!<*spudbGhpg!-*x/eJ!-chs/spmpDhpGv)5dfw!-eJ)yjn!>!eJ<*iuqfe!-sbGhpGv!-sbfOhpGv)qfutiuppnt!>!spudbGhpg!ubpmg<x/esppDhbsG`mh0{/esppDhbsG`mh!>!iuqfe!ubpmg!HPG!gfegj$!!gjeof$!~~~~<chs/^j]spmpDupqTv!+!udfggFupqt!+!fhobSm!+!*1/1!-*mbnspOm.!-O)upe)ybn!>,!chs/eJ<*1/1!-*^j]uofopqyFupqTv!-udfggFupqt)xpq)ybn!>!udfggFupqt|*^j]fmhoBupqTv!?!udfggFupqt)gj<*mbnspOm!-^j]opjudfsjEupqTv)upe!>!udfggFupqt!ubpmg<*spudfWm)f{jmbnspo!>!mbnspOm!4dfw|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSupqTv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSupqTv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQupqTv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDupqTv)gj|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!!gjeof$!~~~<chs/^j]spmpDuojpQv!+!fhobSm!+!*1/1!-**spudfWm)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSuojpQv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSuojpQv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQuojpQv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDuojpQv)gj|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!!gjeof$!~~<chs/^j]spmpDsjEv!+!*1/1!-**^j]opjudfsjEsjEv)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!>>!x/^j]spmpDsjEv)gj|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!~<chs/spmpDuihjmebfIv!+!nsfUusfcnbm!>+!chs/eJ~<*1/2!-fhobSuihjmebfIv0*yfusfWw)iuhofm)ojn!.!1/2!!>+!nsfUusfcnbm|*1/1!?!fhobSuihjmebfIv)gj<*1/1!-6/1!,!6/1!+!*M.!-O)upe)ybn!>!nsfUusfcnbm!ubpmg|*1/1!>>!x/spmpDuihjmebfIv)gj|*uihjMv)gj~!gjeof$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf~<eofmCidubCw!>+!chs/eJ|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!~<spmpd!>!eJ|ftmf~<spmpDwv!>!eJ|*fsvuyfUv)gj|!ftmf~<spmpDftsfwfSldjQyjGv!>!eJ|*qjmGftsfwfSva!%%!ldbCtj)gj~<fvsu!>!ldbCtj<O.!>!O|*1/1!=!*O!-F)upe)gj<ftmbg!>!ldbCtj!mppc<F.!>!M!4dfw<*yfusfWw.)f{jmbnspo!>!F!4dfw<*mbnspOw)f{jmbnspo!>!O!4dfw!gjeof$!<ftvggjEv!>!spmpd!ftmf$!~<ftvggjEv!>!spmpd|ftmf~<spmpDidubCw!>!spmpd|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!<spmpd!5dfw|!ftmf~!gjeof$!~~<ftvggjEv!>!eJ|ftmf~<esbdtje|*1/1!>>!x/ftvggjEv)gj|!*!fdobutjEitbEv!?!*!fdobutjEqbHitbEv!-fdobutjEfojMw!)epn!%%!itbEv)!gj!ITBE!gfegj$!!gjeof$!<spmpDftsfwfSldjQyjGv!>!eJ!ftmf$!~<spmpDftsfwfSldjQyjGv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*yjGv)gj<eJ!5dfw|ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDhbsG`mh)!gj!gjeof$!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!ftmf$!~<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh|ftmf~<spmpDidubCw!>!spmpDhbsG`mh|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*ldjQv)gj~~~!<esbdtje!|!*utfUbiqmBv!>=!b/spmpDwv)!gj!!!!|!ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDwv)!gj!!!!|!*uofsbqtobsUv)!gj<*wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv|**fmcbudfmfTesbdtjEv!%%!ldjQv)a!%%!fsvuyfUv)gj<spmpDwv!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEqbHitbEv!ubpmg!nspgjov<fdobutjEitbEv!ubpmg!nspgjov<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<sbGhpGv!ubpmg!nspgjov<sbfOhpGv!ubpmg!nspgjov<spmpDhpGv!5dfw!nspgjov!HPG!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]fhobSupqTv!ubpmg!nspgjov<^UPQT`YBN]fmhoBupqTv!ubpmg!nspgjov<^UPQT`YBN]uofopqyFupqTv!ubpmg!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]fhobSuojpQv!ubpmg!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<spmpDuihjmebfIv!5dfw!nspgjov<fhobSuihjmebfIv!ubpmg!nspgjov<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<ftvggjEv!5dfw!nspgjov<zujdbqPusbQv!ubpmg!nspgjov<ttfouihjsCv!ubpmg!nspgjov<uihjMv!mppc!nspgjov<spmpDeofmCv!5dfw!nspgjov<eofmCv!mppc!nspgjov<wVs!3dfw!hojzsbw<sfmqnbTeofmCv!E3sfmqnbt!nspgjov<sfmqnbTv!E3sfmqnbt!nspgjov<wVw!3dfw!hojzsbw<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov<uofsbqtobsUv!mppc!nspgjov<utfUbiqmBv!ubpmg!nspgjov<spmpDftsfwfSldjQyjGv!5dfw!nspgjov<qjmGftsfwfSv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjGv!mppc!nspgjov<fmcbudfmfTesbdtjEv!mppc!nspgjov!YJGFSQ!gjeof$!!gjeof$!!<ubpmg!qnvjefn!opjtjdfsq!!ftmf$!!<ubpmg!qihji!opjtjdfsq!!IHJI`OPJTJDFSQ`UOFNHBSG`MH!gfegj$!!TF`MH!gfegj$!";Rl(j,{setBatchInfo:function(t,I){op[t]=I},getBatchInfo:function(T){return op[T]}},!0);var Ah=[1,1,1],ln=[1,0,0,0,0,1,0,1,1,1,1,0],al=[-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5],qp=[.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5],Hd=[.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5],Te=[.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5],Bm=[.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5],kb=[-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5],Bn=function(_,s){jm(_,s,"_batchModelMap","_batchIndexMap"),gp(_,s,"_wireframeModelMap","_wireframeIndexMap"),gp(_,s,"_polylineModelMap","_polylineIndexMap"),gp(_,s,"_wireframeModelMapSwap","_wireframeIndexMapSwap"),gp(_,s,"_polylineModelMapSwap","_polylineIndexMapSwap")},jm=function(t,d,A,U){if(!d)return t[A]={},t[U]={},void 0;var W=d._id,g=t[U],C=g[W];if(C){var T=t[A],V=C.batch,X=T[V],B=X.ds,p=C.index;if(X.invalidate=!0,delete g[W],B.splice(p,1),ee(B))return delete T[V],void 0;for(var z=C.begin,R=C.size,r=3*z,o=3*R,e=4*z,H=4*R,q=X.vs,S=X.ps,O=X.uv,G=X.cs,_=X.bs,E=X.rs,n=X.ns,k=X.ls;p<B.length;p++)C=g[B[p]._id],C.index--,C.begin-=R;q.splice(r,o),S.splice(e,H),O&&O.splice(2*z,2*R),G&&G.splice(e,H),_&&_.splice(r,o),E&&E.splice(z,R),n&&n.splice(r,o),k&&k.splice(z,R)}},gp=jm,od=function(t,q,b,G){if(!G)return T;var Y=q[G];if(!Y){var C=op[G]||qs,r=C.image?[]:T;Y=q[G]={vs:[],ns:[],uv:r,cs:r?T:C.color?T:[],bs:C.blend?[]:T,ps:[],rs:C.brightness?[]:T,ds:[]}}return Y.invalidate=!0,t[b._id]={index:Y.ds.length,begin:Y.vs.length/3,batch:G},Y.ds.push(b),Y},sg=function(x,g){return g!=T&&1!==g?[x[0]*g,x[1]*g,x[2]*g,x[3]]:x},Ho=function(E,s,Y){var M=E.getBrightness(s),K=ql(Y.color||"white"),V=K[3]<1,w=Math.ceil(Y.width)||1,o=(V?"T":"O")+w,k=E._wireframeIndexMap,$=E._wireframeModelMap,A=$[o];A||(A=$[o]={vs:[],cs:[],ps:[],ds:[],T:V,W:w});var j,J=E.getData3dUI(s),m=nc(J);if(Y.geometry){if(!m)return;if(j=ld(m),!j)return}else j=Y.short?tk:bl;A.invalidate=!0;var y=A.vs,l=A.cs,e=A.ds,H=k[s._id]={index:e.length,begin:y.length/3,batch:o};e.push(s);var S=cn(s,Y.mat),z=J._calcAnchorMat(s);z&&Qg(S,S,z),qe(y,S,j);var g=H.size=y.length/3-H.begin;li(l,sg(K,M),g)},pj=function(o,f,P,R,j,m,D,U,b){var c=o.getBrightness(f);c==T&&(c=1);var I=sg(ql(R),c),v=I[3]<1;m=Math.ceil(m)||1;var A=(v?"T":"O")+m;if(D){var p=D[0],F=(D[1]||p)+p;A+="-"+p+"-"+F,b&&(A+="-"+Xd(b)+"-"+c,b=sg(ql(b),c))}var t=o._polylineIndexMap,i=o._polylineModelMap,Q=i[A];Q||(Q=i[A]={vs:[],cs:[],ps:[],ds:[],ls:D?[]:T,T:v,W:m},D&&(Q.D=p,Q.G=F,Q.A=b)),Q.invalidate=!0;var E,u=Q.vs,W=Q.cs,S=Q.ds,y=Q.ls,V=t[f._id]={index:S.length,begin:u.length/3,batch:A};S.push(f),qj(u,P);var l,C=V.size=u.length/3-V.begin,K=P.length,q=0,h=[];if(D||j)for(E=0;K>E;E+=6)l=de([P[E],P[E+1],P[E+2]],[P[E+3],P[E+4],P[E+5]]),h.push(l),q+=l;if(q&&j){var B,z=sg(ql(j),c),Z=[z[0]-I[0],z[1]-I[1],z[2]-I[2],z[3]-I[3]],N=0;for(E=0;K>E;E+=6)B=N/q,li(W,[I[0]+Z[0]*B,I[1]+Z[1]*B,I[2]+Z[2]*B,I[3]+Z[3]*B],1),N+=h[E/6],B=N/q,li(W,[I[0]+Z[0]*B,I[1]+Z[1]*B,I[2]+Z[2]*B,I[3]+Z[3]*B],1)}else li(W,I,C);if(D)for(N=U||0,E=0;K>E;E+=6)y.push(N),N+=h[E/6],y.push(N)},Xp=function(H,s,G){if(s)for(var x=4*s.begin,I=G[s.batch].ps,P=0;P<s.size;P++)I[x++]=H[0],I[x++]=H[1],I[x++]=H[2],I[x++]=H[3]},bq=function(w,F){var H=F+["32"],q=w[F],J=w[H];q?J&&J.length===q.length?(J.set(q),J.glBuf=null):w[H]=new Cj(q):delete w[H]},sc=function(E,u,y,k,l,s,b,z,C){if(Lq(y))y.forEach(function(Z){sc(E,u,Z,k,l,s,b,z,C)});else if(Td(y))sc(E,u,nc(k,y),k,l,s,b,z,C);else if(Tf(y)){var q,x=Aq(y.mat,u,E),F=Aq(y.s3,u,E),R=Aq(y.t3,u,E),d=Aq(y.r3,u,E);if((F||d||R||x)&&(q=yo(x,F,d,Aq(y.rotationMode,u,E),R),s.push(q)),y.shape3d)sc(E,u,y.shape3d,k,l,s,b,z,y);else{var n=k.s;C=C||qs;var h=s[0],o=s.length,I=n("shape3d.color",y.color,C.color);if(l||(l=n("shape3d.blend",y.blend,C.blend)),o>1){h=lo(h);for(var S=1;o>S;S++)Qg(h,h,s[S])}y.vs&&n(vf,y.visible,C.visible)&&hp(h,b,z,y.vs,y.uv,y.is,l,I),y.top_vs&&n(Qq,y.topVisible,C.topVisible)&&hp(h,b,z,y.top_vs,y.top_uv,y.top_is,l,n("shape3d.top.color",y.topColor,C.topColor)||I),y.bottom_vs&&n(sh,y.bottomVisible,C.bottomVisible)&&hp(h,b,z,y.bottom_vs,y.bottom_uv,y.bottom_is,l,n("shape3d.bottom.color",y.bottomColor,C.bottomColor)||I),y.from_vs&&n(Yg,y.fromVisible,C.fromVisible)&&hp(h,b,z,y.from_vs,y.from_uv,y.from_is,l,n("shape3d.from.color",y.fromColor,C.fromColor)||I),y.to_vs&&n(nh,y.toVisible,C.toVisible)&&hp(h,b,z,y.to_vs,y.to_uv,y.to_is,l,n("shape3d.to.color",y.toColor,C.toColor)||I)}q&&s.pop()}},hp=function(u,Z,m,Q,f,c,H,C){var O,G=Z.cs,$=Z.uv,k=Z.bs;if(c){O=c.length;for(var d=0;O>d;d++){var K=c[d];qe(m,u,[Q[3*K],Q[3*K+1],Q[3*K+2]]),$&&qj($,[f[2*K],f[2*K+1]])}}else O=Q.length/3,qe(m,u,Q),$&&qj($,f);G&&li(G,C,O),k&&(H?Jj(k,H,O):qj(k,Ah,O))},Fe=function(B,X,Z,U){var H=[];U?sc(B.gv,B.data,U,B,B.getBodyColor(),[X],Z,H):(Io(B,ud,X,Z,H),Io(B,Ij,X,Z,H),Io(B,Am,X,Z,H),Io(B,Ol,X,Z,H),Io(B,ob,X,Z,H),Io(B,fi,X,Z,H),Io(B,"csg",X,Z,H)),H.length&&(qj(Z.vs,H),qj(Z.ns,Oi(H)))},Io=function(k,M,c,m,x){var j=k[M];if(j){var B=j.tuv;if(B){var $,Y,_,q,f=j.uvScale,t=j.uvOffset;if(f)for($=B.length,Y=f[0],_=f[1],q=0;$>q;q+=2)B[q]*=Y,B[q+1]*=_;if(t)for($=B.length,Y=t[0],_=t[1],q=0;$>q;q+=2)B[q]+=Y,B[q+1]+=_}hp(c,m,x,j.vs,B,T,j.blend,j.color)}},Pi=function(W,O,f,v,k,Y,F,D){var X,o=f.cs,r=f.uv,J=f.bs;if(W.getFaceVisible(O,Y)){var K=W.getFaceMat(O,Y);if(K&&(k=cn(O,K)),qe(F,k,D),o&&li(o,W.getFaceColor(O,Y),6),r){var w=W.getFaceUv(O,Y)||v[Y+"Uv"],l=W.getFaceUvScale(O,Y)||v[Y+"UvScale"],c=W.getFaceUvOffset(O,Y)||v[Y+"UvOffset"];
w=w?[w[6],w[7],w[0],w[1],w[2],w[3],w[2],w[3],w[4],w[5],w[6],w[7]]:ln;var P=w[0],p=w[1],L=w[2],M=w[3],t=w[4],G=w[5],q=w[6],E=w[7],y=w[8],m=w[9],d=w[10],a=w[11];if(l){var j=l[0],V=l[1];P*=j,p*=V,L*=j,M*=V,t*=j,G*=V,q*=j,E*=V,y*=j,m*=V,d*=j,a*=V}if(c){var C=c[0],Q=c[1];P+=C,p+=Q,L+=C,M+=Q,t+=C,G+=Q,q+=C,E+=Q,y+=C,m+=Q,d+=C,a+=Q}r.push(P,p,L,M,t,G,q,E,y,m,d,a)}J&&(X=W.getBodyColor(O)||W.getFaceBlend(O,Y),X?Jj(J,X,6):qj(J,Ah,6))}},Md=function(M,w,c,k){var l=M.getGL(),R=M._prg,b=M._buffer;if(!hg(w)){Ep(M),Yp(l,R);for(var a in w){var E=w[a];if(!(k&&!E.T||!k&&E.T)){E.invalidate?(E.invalidate=!1,bq(E,"vs"),bq(E,"cs"),bq(E,"ls"),bq(E,"ps")):c&&bq(E,"ps");var J=E.vs32,t=c?E.ps32:E.cs32;zr(l,R,E.W,T,b.vs,J);var n=E.D,v=!M._dashDisabled&&n;Qh(l,R.uAlphaTest,y.alphaTest),v&&(Qh(l,R.uDash,!0),Qh(l,R.uDashDistance,n),Qh(l,R.uDashGapDistance,E.G),Ui(l,R.aLineDistance),Xg(l,b.lineDistance,E.ls32,R.aLineDistance,1),Qh(l,R.uDiffuse,E.A||Mo));var m=!M._batchColorDisabled;m&&(Qh(l,R.uBatchColor,!0),Ui(l,R.aBatchColor),Xg(l,b.batchColor,t,R.aBatchColor,4)),gs(l),Ni(l,0,J.length/3,l.LINES),_d(l),m&&(Qh(l,R.uBatchColor,!1),nf(l,R.aBatchColor)),v&&(Qh(l,R.uDash,!1),nf(l,R.aLineDistance))}}zf(l,R)}},cd=function(m,X,H){var i,c,G,g,t,Z,I,L,E,S,Q,k=m.getGL(),v=m._prg,x=m._buffer,s=m._batchModelMap;if(!hg(s)){Ep(m);for(i in s)if(c=op[i]||qs,!(H&&!c.transparent||!H&&c.transparent)&&(G=s[i],X||!c.transparentMask)){var D=H&&c.autoSort!==!1&&(m._33Q||G.invalidate);if(G.invalidate?(G.invalidate=!1,bq(G,"vs"),bq(G,"ns"),bq(G,"cs"),bq(G,"rs"),bq(G,"ps"),bq(G,"bs"),bq(G,"uv")):X&&bq(G,"ps"),t=G.vs32,Z=X?G.ps32:G.cs32,E=G.uv32,I=G.bs32,L=G.rs32,Q=t.length/3,D&&(G.is=ao(t,m.getEye())),Q){g=c.light,S=m.getTexture(c.image),Sn(k,v,T,c.light,c.opacity,c.reverseFlip,c.reverseColor,c.reverseCull),Z?m._batchColorDisabled||(Qh(k,v.uBatchColor,!0),Ui(k,v.aBatchColor),Xg(k,x.batchColor,Z,v.aBatchColor,4)):Qh(k,v.uDiffuse,c.color);var V=c.alphaTest;Qh(k,v.uAlphaTest,V===p?y.alphaTest:V);var M=I&&!m._batchBlendDisabled;M&&(Qh(k,v.uBatchBlend,!0),Ui(k,v.aBatchBlend),Xg(k,x.batchBlend,I,v.aBatchBlend));var j=L&&!m._batchBrightnessDisabled;j&&(Qh(k,v.uBatchBrightness,!0),Ui(k,v.aBatchBrightness),Xg(k,x.batchBrightness,L,v.aBatchBrightness,1)),E?gs(k,v,S,c.discardSelectable,x.uv,E,c.uvOffset,c.uvScale):gs(k),Xg(k,x.vs,t,v.aPosition),Xg(k,x.ns,G.ns32,v.aNormal),G.is?(qm(k,x.is,G.is),Ke(k,0,Q)):Ni(k,0,Q),E?_d(k,v,S):_d(k),Z&&!m._batchColorDisabled&&(Qh(k,v.uBatchColor,!1),nf(k,v.aBatchColor)),M&&(Qh(k,v.uBatchBlend,!1),nf(k,v.aBatchBlend)),j&&(Qh(k,v.uBatchBrightness,!1),nf(k,v.aBatchBrightness)),xk(k,v)}}}},ao=function(d,s){for(var O=d.length/3,k=new Array(O),B=O/3,L=new Array(B),W=0;B>W;W++)L[W]=W;L.sort(function(L,B){var C=9*L,Z=[(d[C]+d[C+3]+2*d[C+6])/4,(d[C+1]+d[C+4]+2*d[C+7])/4,(d[C+2]+d[C+5]+2*d[C+8])/4];C=9*B;var M=[(d[C]+d[C+3]+2*d[C+6])/4,(d[C+1]+d[C+4]+2*d[C+7])/4,(d[C+2]+d[C+5]+2*d[C+8])/4],r=de(s,Z)-de(s,M);return r>0?-1:0>r?1:0});for(var W=0;B>W;W++){var $=3*W,p=3*L[W];k[$]=p,k[$+1]=p+1,k[$+2]=p+2}return new ds(k)},Nl={obj:function(f,R){var s={mat:f.mat,s3:f.s3,r3:f.r3,rotationMode:f.rotationMode,t3:f.t3,cube:f.cube==T?!0:f.cube,center:f.center==T?!0:f.center,ignoreMtls:f.ignoreMtls,ignoreTransparent:f.ignoreTransparent,ignoreColor:f.ignoreColor,ignoreImage:f.ignoreImage,ignoreNormal:f.ignoreNormal,prefix:f.prefix,flipY:f.flipY,flipFace:f.flipFace,reverseFlipMtls:f.reverseFlipMtls,finishFunc:function(x,s){if(x){var s=[];for(var v in x){var P=x[v];s.rawS3=P.rawS3,s.push(P),f.eachModel&&f.eachModel(v,P)}s.json=f,R(s)}else R()}};j.loadObj(f.obj,f.mtl,s)}};j.getModelTypeHandlers=function(){return Nl},j.setModelTypeHandler=function(b,P){Nl[b]=P},j.getModelTypeHandler=function(F){return Nl[F]},j.handleModelLoaded=function(){},j.handleUnfoundModel=function(){};var Vf=T,Vp=T,Fq=function(r){Vf&&!r._loadingModelView_&&(Vp||(Vp={}),Vp[r._loadingModelView_=xi()]=r)},dn=function(t,A){Vf||(Vf={});var b=Vf[t];if(b){if(b.url===A)return;b.request.onload=Qc,b.request.onerror=Qc}var B=new XMLHttpRequest;if(Vf[t]={request:B,url:A},B.overrideMimeType&&B.overrideMimeType("text/plain"),A=j.beforeLoadURL(A),A.data){var N=j.parse(A.data);Go(t,N,A)}else B.open("GET",encodeURI(A),!0),B.onload=function(D){if(200===this.status||0===this.status){var V=j.parse(D.target.response||D.target.responseText);Go(t,V,A)}else _e(t,j.handleUnfoundModel(t,A)||T)},B.onerror=function(){_e(t,j.handleUnfoundModel(t,A)||T)},B.send(null)},Go=function(M,s,B){var D=s.modelType;if(!D)return _e(M,s),j.handleModelLoaded(M,s),void 0;var p=j.getModelTypeHandler(D);if(p){var U=function(k){k?(_e(M,k),j.handleModelLoaded(M,k)):_e(M,j.handleUnfoundModel(M,B)||T)};p(s,U)}else _e(M,j.handleUnfoundModel(M,B)||T)},_e=function(K,q){if(eb[K]=q,delete Vf[K],hg(Vf)&&(Vf=T,Vp)){for(var y in Vp){var s=Vp[y];s._2O&&(s._2O={}),s.invalidateAll&&s.invalidateAll(p,"modelLoaded",K),s.redraw&&s.redraw(),s.iv(),delete s._loadingModelView_}Vp=T}if(q&&Vp)for(var y in Vp){var s=Vp[y];s.invalidateAll&&s.invalidateAll(p,"modelLoading",K),s.redraw&&s.redraw(),s.iv()}},Nm=new Cj([0,0,0,1,1,1,1,0]),Tl=new Cj([0,0,1,0,0,1,0,0,1,0,0,1]),ab=new ds([0,1,2,2,3,0]),Ml=new Cj([-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5]),cb=new ds([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),ok=new Cj([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]),Cl=Oi(Ml,cb),bl=(new Cj([-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5]),new ds([0,1,2,3,0,7,5,4,6,7,5,3,2,4,6,1]),[-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5]),tk=[-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4],Ac=function(j,t,T,r,i,c){c=c||16,j=j||16,t=t||0,T=T||j;var s,h,H,O,E,y,J,l,S=.5,o=[],C=[],p=u/j,N=B/c;for(s=0;c>s;s++)for(E=s+1,O=s*N,l=E*N,h=t;T>h;h++)y=h+1,H=h*p,J=y*p,o.push(S*L(O)*A(H),S*A(O),-S*L(O)*L(H),S*L(l)*A(J),S*A(l),-S*L(l)*L(J),S*L(O)*A(J),S*A(O),-S*L(O)*L(J),S*L(O)*A(H),S*A(O),-S*L(O)*L(H),S*L(l)*A(H),S*A(l),-S*L(l)*L(H),S*L(l)*A(J),S*A(l),-S*L(l)*L(J)),C.push(h/j,s/c,y/j,E/c,y/j,s/c,h/j,s/c,h/j,E/c,y/j,E/c);if(r){var F=[],z=[];for(H=t*p,s=0;c>s;s++)E=s+1,O=s*N,l=E*N,F.push(0,0,0,S*L(l)*A(H),S*A(l),-S*L(l)*L(H),S*L(O)*A(H),S*A(O),-S*L(O)*L(H)),z.push(0,.5,t/j,E/c,t/j,s/c)}if(i){var U=[],Z=[];for(H=T*p,s=0;c>s;s++)E=s+1,O=s*N,l=E*N,U.push(0,0,0,S*L(O)*A(H),S*A(O),-S*L(O)*L(H),S*L(l)*A(H),S*A(l),-S*L(l)*L(H)),Z.push(1,.5,T/j,s/c,T/j,E/c)}return{vs:o,uv:C,from_vs:F,from_uv:z,to_vs:U,to_uv:Z}},vm=function(T,E,x){T=T||.17,E=E||12,x=x||18,0>T?T=0:T>.25&&(T=.25);var M,w,z,v,t,o,j,D=.5,r=[],p=[],K=[],C=u/x,Q=u/E,e=D-T;for(w=0;E>=w;w++)for(v=-B+w*Q,o=A(v),t=L(v),M=0;x>=M;M++)z=M*C,j=e+T*o,r.push(A(z)*j,t*T,-L(z)*j),p.push(M/x,1-w/E);for(w=0;E>w;w++){var i=w*(x+1),S=(w+1)*(x+1);for(M=0;x>M;M++)K.push(i+M,S+M+1,S+M,i+M,i+M+1,S+M+1)}return{vs:r,uv:p,is:K}},No=function(a,O,M,J,p,s,G){G=G||12,a=a||18,O=O||0,M=M||a,s=s||.17,0>s?s=0:s>.25&&(s=.25);var $,y,U,R,X,g,N,b,I,o,z=.5,w=[],j=[],S=u/a,t=u/G,c=z-s;for(U=0;G>U;U++)for(R=U+1,N=-B+U*t,b=-B+R*t,$=O;M>$;$++)y=$+1,X=$*S,g=y*S,I=c+s*A(N),o=c+s*A(b),w.push(A(X)*I,L(N)*s,-L(X)*I,A(g)*I,L(N)*s,-L(g)*I,A(g)*o,L(b)*s,-L(g)*o,A(X)*I,L(N)*s,-L(X)*I,A(g)*o,L(b)*s,-L(g)*o,A(X)*o,L(b)*s,-L(X)*o),j.push($/a,1-U/G,y/a,1-U/G,y/a,1-R/G,$/a,1-U/G,y/a,1-R/G,$/a,1-R/G);if(J){var e=[],Y=[];for(U=0;G>U;U++)R=U+1,N=-B+U*t,b=-B+R*t,X=O*S,I=c+s*A(N),o=c+s*A(b),e.push(A(X)*I,L(N)*s,-L(X)*I,A(X)*o,L(b)*s,-L(X)*o,A(X)*c,0,-L(X)*c),Y.push(.5+.5*A(N),.5-.5*L(N),.5+.5*A(b),.5-.5*L(b),.5,.5)}if(p){var m=[],F=[];for(U=0;G>U;U++)R=U+1,N=-B+U*t,b=-B+R*t,X=M*S,I=c+s*A(N),o=c+s*A(b),m.push(A(X)*I,L(N)*s,-L(X)*I,A(X)*c,0,-L(X)*c,A(X)*o,L(b)*s,-L(X)*o),F.push(.5-.5*A(N),.5-.5*L(N),.5,.5,.5-.5*A(b),.5-.5*L(b))}return{vs:w,uv:j,from_vs:e,from_uv:Y,to_vs:m,to_uv:F}},Ll=function(M,D){for(var N,e,l,I=.5,s=16,T=[],G=[],$=[],c=u/s,n=0;s>=n;n++)N=n*c,e=A(N)*I,l=L(N)*I,T.push(e,-I,l,e,I,l),G.push(1-n/s,1,1-n/s,0);for(n=0;s>n;n++)$.push(2*n,2*n+1,2*n+3,2*n,2*n+3,2*n+2);if(D){var S=[],V=[],y=[];for(S.push(0,-I,0),V.push(.5,.5),n=0;s>=n;n++)N=n*c,e=A(N),l=L(N),S.push(e*I,-I,-l*I),V.push(.5+.5*e,.5+.5*l);for(n=0;s>n;n++)y.push(0,n+2,n+1)}if(M){var _=[],w=[],m=[];for(_.push(0,I,0),w.push(.5,.5),n=0;s>=n;n++)N=n*c,e=A(N),l=L(N),_.push(e*I,I,-l*I),w.push(.5+.5*e,.5-.5*l);for(n=0;s>n;n++)m.push(0,n+1,n+2)}return{vs:T,uv:G,is:$,bottom_vs:S,bottom_uv:V,bottom_is:y,top_vs:_,top_uv:w,top_is:m}},tc=function(H,v,T,d,h,Q,k){H=H||12,v=v||0,T=T||H;for(var b,C,V,f,o,E,m,U,P=.5,F=[],B=[],w=u/H,n=v;T>n;n++)b=n+1,C=n*w,V=b*w,f=A(C)*P,o=L(C)*P,E=A(V)*P,m=L(V)*P,F.push(f,-P,-o,E,-P,-m,f,P,-o,E,-P,-m,E,P,-m,f,P,-o),B.push(n/H,1,b/H,1,n/H,0,b/H,1,b/H,0,n/H,0);if(k){var t=[],j=[];for(n=v;T>n;n++)C=w*n,V=w*(n+1),f=A(C),o=L(C),E=A(V),m=L(V),t.push(f*P,-P,-o*P,0,-P,0,E*P,-P,-m*P),j.push(.5+.5*f,.5+.5*o,.5,.5,.5+.5*E,.5+.5*m)}if(Q){var $=[],I=[];for(n=v;T>n;n++)C=w*n,V=w*(n+1),f=A(C),o=L(C),E=A(V),m=L(V),$.push(f*P,P,-o*P,E*P,P,-m*P,0,P,0),I.push(.5+.5*f,.5-.5*o,.5+.5*E,.5-.5*m,.5,.5)}if(d){var R=[],K=[];C=w*v,f=A(C)*P,o=L(C)*P,U=v/H,R.push(0,P,0,0,-P,0,f,-P,-o,f,-P,-o,f,P,-o,0,P,0),K.push(0,0,0,1,U,1,U,1,U,0,0,0)}if(h){var M=[],N=[];C=w*T,f=A(C)*P,o=L(C)*P,U=T/H,M.push(0,-P,0,0,P,0,f,P,-o,f,P,-o,f,-P,-o,0,-P,0),N.push(1,1,1,0,U,0,U,0,U,1,1,1)}return{vs:F,uv:B,bottom_vs:t,bottom_uv:j,top_vs:$,top_uv:I,from_vs:R,from_uv:K,to_vs:M,to_uv:N}},hr=function(X,g,P,M,D){g=g||18,P=P||0,M=M==T?u:M,D=D==T?.5:D;for(var V,s,F,h,_,J,B=[0,.5,.75,.875,.9375],E=[],Y=[],K=[],w=M/g,l=0;l<B.length;l++){var r=0===l%2?0:.5;for(V=0;g>=V;V++)s=(V+r)*w+P,F=1-B[l],E.push(A(s)*D*F,-D+2*B[l]*D,-L(s)*D*F),Y.push((V+r)/g,F)}for(l=0;l<B.length-1;l++){var U=l*(g+1),b=(l+1)*(g+1);for(V=0;g>V;V++)K.push(U+V,b+V+1,b+V,U+V,U+V+1,b+V+1)}for(J=E.length/3-(g+1),V=0;g>V;V++)E.push(0,D,0),Y.push((V+.5)/g,0);for(V=0;g>V;V++)K.push(J+V,J+V+1,J+(g+1)+V);if(X){var O=[],v=[],e=[];for(O.push(0,-D,0),v.push(.5,.5),V=0;g>=V;V++)s=V*w+P,h=A(s),_=L(s),O.push(h*D,-D,-_*D),v.push(.5+.5*h,.5+.5*_);for(V=0;g>V;V++)e.push(0,V+2,V+1)}return{vs:E,uv:Y,is:K,bottom_vs:O,bottom_uv:v,bottom_is:e}},ke=function(N,M,W,U,p,X){N=N||16,M=M||0,W=W||N;for(var E=.5,S=[],Y=[],e=u/N,b=M;W>b;b++){var q=b+1,F=e*b,I=e*q;S.push(A(F)*E,-E,-L(F)*E,A(I)*E,-E,-L(I)*E,0,E,0),Y.push(b/N,1,q/N,1,(b+q)/2/N,0)}if(X){var n=[],h=[];for(b=M;W>b;b++){F=e*b,I=e*(b+1);var O=A(F),C=L(F),y=A(I),o=L(I);n.push(O*E,-E,-C*E,0,-E,0,y*E,-E,-o*E),h.push(.5+.5*O,.5+.5*C,.5,.5,.5+.5*y,.5+.5*o)}}if(U){var z=[],H=[];F=e*M,z.push(0,E,0,0,-E,0,A(F)*E,-E,-L(F)*E),H.push(0,0,0,1,M/N,1)}if(p){var a=[],P=[];F=e*W,a.push(0,-E,0,0,E,0,A(F)*E,-E,-L(F)*E),P.push(1,1,1,0,W/N,1)}return{vs:S,uv:Y,bottom_vs:n,bottom_uv:h,from_vs:z,from_uv:H,to_vs:a,to_uv:P}},oo=function(o,c,X,x,l,E,I,h){for(var w=[],j=0;j<o.length-1;j+=2)w.push({x:o[j],y:o[j+1]});return Kg(w,c,X,x,l,E,I,h,!1)},_b={roundRect:function(l,r){return oo([.5,.4,.5,.442,.471,.471,.442,.5,.4,.5,-.4,.5,-.442,.5,-.471,.471,-.5,.442,-.5,.4,-.5,-.4,-.5,-.442,-.471,-.471,-.442,-.5,-.4,-.5,.4,-.5,.442,-.5,.471,-.471,.5,-.442,.5,-.4,.5,.4],[1,3,3,2,3,3,2,3,3,2,3,3,2],l,r,3)},star:function(k,f){return oo([.193,.079,.333,.5,0,.233,-.333,.5,-.194,.079,-.5,-.167,-.112,-.167,0,-.5,.111,-.167,.5,-.167],[1,2,2,2,2,2,2,2,2,2,5],k,f)},rect:function(Q,F){return oo([.5,-.5,.5,.5,-.5,.5,-.5,-.5],[1,2,2,2,5],Q,F)},billboard:function(){return{vs:[-.5,.5,0,-.5,-.5,0,.5,.5,0,.5,.5,0,-.5,-.5,0,.5,-.5,0],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]}},plane:function(){return{vs:[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,-.5,-.5,0,.5,.5,0,.5],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0]}},triangle:function(k,L){return oo([0,-.5,.5,.5,-.5,.5],[1,2,2,5],k,L)},rightTriangle:function(Z,W){return oo([.5,.5,-.5,.5,-.5,-.5],[1,2,2,5],Z,W)},parallelogram:function(I,Y){return oo([.5,-.5,.25,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],I,Y)},trapezoid:function(t,o){return oo([.25,-.5,.5,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],t,o)}},ws={sphere:1,cylinder:1,cone:1,torus:1},ti={torus:1,sphere:1},bc=Rl(tq(_b),{cylinder:1}),Mg=Rl(tq(_b),{cylinder:1,cone:1}),Jh=function(j,Y,H){var u,Q=Aq(j.mat,H,Y),V=Aq(j.s3,H,Y),S=Aq(j.t3,H,Y),c=Aq(j.r3,H,Y);return(V||c||S||Q)&&(u=lo(Y._6O),Ep(Y,yo(Q,V,c,Aq(j.rotationMode,H,Y),S))),u},_l=function(w,f,v,u,g,z,$){if(Lq(v))v.forEach(function(I){_l(w,f,I,u,g,z,$)});else if(Td(v))_l(w,f,nc(u,v),u,g,z,$);else if(Tf(v))if(v.shape3d){var i=Jh(v,w,f);_l(w,f,v.shape3d,u,g,z,v),i&&Eg(w,i)}else vn(w,f,v,u.s,g,z,$)},vn=function(o,K,I,v,C,s,D){if(D=D||qs,!s||s(v("shape3d.transparent",I.transparent,D.transparent))){var N=Jh(I,o,K);Xc(I);var r=o._26I,e=o._prg,z=o._buffer,P=v("shape3d.color",I.color,D.color);C||(C=v("shape3d.blend",I.blend,D.blend));var F,Q=I.opacity==T?D.opacity:I.opacity,f=v("shape3d.opacity");F=f!=T&&Q!=T?Q*f:Q!=T?Q:f,Sn(r,e,C,v("shape3d.light",I.light,D.light),F,v("shape3d.reverse.flip",I.reverseFlip,D.reverseFlip),v("shape3d.reverse.color",I.reverseColor,D.reverseColor),v("shape3d.reverse.cull",I.reverseCull,D.reverseCull)),I.vs&&v(vf,I.visible,D.visible)&&oq(r,e,z,P,o.getTexture(v("shape3d.image",I.image,D.image),K),v("shape3d.discard.selectable",I.discardSelectable,D.discardSelectable),I.vs,I.uv,I.ns,I.is,v("shape3d.uv.offset",I.uvOffset,D.uvOffset),v("shape3d.uv.scale",I.uvScale,D.uvScale)),I.top_vs&&v(Qq,I.topVisible,D.topVisible)&&oq(r,e,z,v("shape3d.top.color",I.topColor,D.topColor)||P,o.getTexture(v("shape3d.top.image",I.topImage,D.topImage),K),v("shape3d.top.discard.selectable",I.topDiscardSelectable,D.topDiscardSelectable),I.top_vs,I.top_uv,I.top_ns,I.top_is,v("shape3d.top.uv.offset",I.topUvOffset,D.topUvOffset),v("shape3d.top.uv.scale",I.topUvScale,D.topUvScale)),I.bottom_vs&&v(sh,I.bottomVisible,D.bottomVisible)&&oq(r,e,z,v("shape3d.bottom.color",I.bottomColor,D.bottomColor)||P,o.getTexture(v("shape3d.bottom.image",I.bottomImage,D.bottomImage),K),v("shape3d.bottom.discard.selectable",I.bottomDiscardSelectable,D.bottomDiscardSelectable),I.bottom_vs,I.bottom_uv,I.bottom_ns,I.bottom_is,v("shape3d.bottom.uv.offset",I.bottomUvOffset,D.bottomUvOffset),v("shape3d.bottom.uv.scale",I.bottomUvScale,D.bottomUvScale)),I.from_vs&&v(Yg,I.fromVisible,D.fromVisible)&&oq(r,e,z,v("shape3d.from.color",I.fromColor,D.fromColor)||P,o.getTexture(v("shape3d.from.image",I.fromImage,D.fromImage),K),v("shape3d.from.discard.selectable",I.fromDiscardSelectable,D.fromDiscardSelectable),I.from_vs,I.from_uv,I.from_ns,I.from_is,v("shape3d.from.uv.offset",I.fromUvOffset,D.fromUvOffset),v("shape3d.from.uv.scale",I.fromUvScale,D.fromUvScale)),I.to_vs&&v(nh,I.toVisible,D.toVisible)&&oq(r,e,z,v("shape3d.to.color",I.toColor,D.toColor)||P,o.getTexture(v("shape3d.to.image",I.toImage,D.toImage),K),v("shape3d.to.discard.selectable",I.toDiscardSelectable,D.toDiscardSelectable),I.to_vs,I.to_uv,I.to_ns,I.to_is,v("shape3d.to.uv.offset",I.toUvOffset,D.toUvOffset),v("shape3d.to.uv.scale",I.toUvScale,D.toUvScale)),xk(r,e),N&&Eg(o,N)}},oq=function(s,f,j,y,p,u,Y,Z,M,l,S,a){Y&&(Qh(s,f.uDiffuse,y),Z?gs(s,f,p,u,j.uv,Z,S,a):gs(s),Xg(s,j.vs,Y,f.aPosition),Xg(s,j.ns,M,f.aNormal),l?(is(s,j.is,l),Ke(s,0,l.length)):Ni(s,0,Y.length/3),Z?_d(s,f,p):_d(s))},nc=function(M,s){var y=M.s;if(s||(s=y(Po)),!s)return T;var e=ch(s);if(e)return e;if("text"===s){var v={amount:y("shape3d.text.amount"),size:y("shape3d.text.size"),font:y("shape3d.text.font"),style:y("shape3d.text.style"),weight:y("shape3d.text.weight"),fill:y("shape3d.text.fill"),curveSegments:y("shape3d.text.curveSegments"),spacing:y("shape3d.text.spacing")},l=M.gv.getShape3dText(M.data),N=l;for(var a in v)N+="_"+(v[a]===p?"U":v[a]);return M._cachedTextKey===N?M._cachedTextGeometry:(M._cachedTextKey=N,M._cachedTextGeometry=j.createTextGeometry(l,v))}var a=s;if(ws[s]){var m=y("shape3d.side"),Y=y("shape3d.side.from"),O=y("shape3d.side.to"),f=y(Yg),d=y(nh);3>m?(m=0,Y=0,O=0,f=!1,d=!1):((Y==T||0>Y)&&(Y=0),(O==T||O>m)&&(O=m),0===Y&&O===m&&(f=!1,d=!1)),a+="-"+m+"-"+Y+"-"+O+"-"+f+"-"+d}if(bc[s]){var P=y(Qq);a+="-"+P}if(Mg[s]){var F=y(sh);a+="-"+F}if("torus"===s){var z=y("shape3d.torus.radius");0>z?z=0:z>.25&&(z=.25),a+="-"+z}if(ti[s]){var R=y(Ff);a+="-"+R}return e=Qk[a],e||("box"===s?e=j.createBoxModel():_b[s]?e=_b[s](P,F):"sphere"===s?e=j.createSphereModel(m,Y,O,f,d,R):s===cs?e=j.createCylinderModel(m,Y,O,f,d,P,F):"cone"===s?e=j.createConeModel(m,Y,O,f,d,F):"torus"===s&&(e=j.createTorusModel(m,Y,O,f,d,z,R)),Qk[a]=e),e},Xc=function(){var B=["vs","ns","uv","top_vs","top_ns","top_uv","bottom_vs","bottom_ns","bottom_uv","from_vs","from_ns","from_uv","to_vs","to_ns","to_uv","er","al"],X=["is","top_is","bottom_is","from_is","to_is"];return m=ne(kn.substr(kn.indexOf("^#")+2)),Rj(j[Vq(Zd+B[15]+"n"+B[16])]())&&wn()?function(n){n&&!n._complete_&&(n._complete_=!0,n.vs&&ee(n.ns)&&(n.ns=Oi(n.vs,n.is)),n.top_vs&&ee(n.top_ns)&&(n.top_ns=Oi(n.top_vs,n.top_is)),n.bottom_vs&&ee(n.bottom_ns)&&(n.bottom_ns=Oi(n.bottom_vs,n.bottom_is)),n.from_vs&&ee(n.from_ns)&&(n.from_ns=Oi(n.from_vs,n.from_is)),n.to_vs&&ee(n.to_ns)&&(n.to_ns=Oi(n.to_vs,n.to_is)),B.forEach(function(l){var P=n[l];Lq(P)&&(n[l]=new Cj(P))}),X.forEach(function(O){var y=n[O];Lq(y)&&(n[O]=new ds(y))}))}:void 0}(),Yd=function(l,h){var M=l[h];Lq(M)&&(l[h]=new Cj(M))};Rl(Vl,{_25Q:function(B){B._16O=function(L,I,z,B,J,F,$,f,V){var Q=this.info;if(Q){var D,M,X,i,e,T,y=ge();if(tr[I]?(D=Q.p3,M=Q.c1,X=Q.c2):Wr[I]?(M=Q.s1||Q.c1,X=Q.s2||Q.c2):(M=Q.t1||Q.c1,X=Q.t2||Q.c2),D)T=qr(I,zn,z,B,f,V);else{var K=Op(X,M),O=de(M,X);i=[0,-g(K[2],K[0]),h(K[1]/O)],e="zyx",D=[(M[0]+X[0])/2,(M[1]+X[1])/2,(M[2]+X[2])/2],T=qr(I,[O,0,0],z,B,f,V)}return jk(y,T,D,B,J,F,$,L,i,e)}return qo},B._80o=function(_,S,n){var E=this,c=E.shapeModel;if(c){var I=E.gv;Ep(I),_l(I,E.data,c,E,E.getBodyColor(),n)}},B.createLineModel=function(w,O,m,z,n){for(var B=this,v=B.s,H=Nd(w,O,v(Ff)),Q=[],R=0;R<H.length;R++){var U=H[R],e=U.length;if(e>1){var d=U[0];Q.push(d.x,d.y,d.z);for(var c=1;e-1>c;c++)d=U[c],Q.push(d.x,d.y,d.z),Q.push(d.x,d.y,d.z);d=U[e-1],Q.push(d.x,d.y,d.z)}}var I,h,x,X=v(z+".color"),y=v(n),P=0;return y&&(h=v(n+".color"),I=v(n+".pattern"),P=v(n+".offset"),x=X),pj(B.gv,B.data,Q,h||X,x?T:v(z+".gradient.color"),m,I||v(z+".pattern"),P,x),H},B.createTubeModel=function(d,C,g,X){for(var r=this,w=r.s,u=w("shape3d.side")||Bi,L=w("shape3d.start.angle"),a=w("shape3d.sweep.angle"),m=w(Qq)?w("shape3d.top.cap"):T,v=w(sh)?w("shape3d.bottom.cap"):T,M="flat"===m,k="flat"===v,y=M&&(X?X.uv:w("shape3d.top.image")),i=k&&(X?X.uv:w("shape3d.bottom.image")),$=X?X.uv:w("shape3d.image"),B={vs:[],uv:$?[]:T,top_vs:M?[]:T,top_uv:y?[]:T,bottom_vs:k?[]:T,bottom_uv:i?[]:T},H=Nd(d,C,w(Ff),g),h=0,t=H.length;t>h;h++)Kr(B,H[h],w(si),g,u,L,a,m,v);if(X){var Z=[];sc(r.gv,r.data,B,r,r.getBodyColor(),[],X,Z),Z.length&&(qj(X.vs,Z),qj(X.ns,Oi(Z)))}else r.shapeModel=B;return H},B.getCache=function(){var j=this.info;if(j){var A=j.list;if(A){var k=j.cache;return k||(k=j.cache=md(A)),k}}return T}}});var Eh=function(C,T){for(var z,E=0,w=C.length,i=0,k=w-1;k>=i;)if(E=I(i+(k-i)/2),z=C[E].length-T,0>z)i=E+1;else{if(!(z>0)){k=E;break}k=E-1}E=k;var Z=C[E],x=Z.point;return E===w-1||Z.length===T||(x=(new _q).subVectors(C[E+1].point,x).normalize().multiplyScalar(T-Z.length).add(x)),{point:x,tangent:Z.tangent}},md=function(M){for(var C,G,q=[],A=0,S=0;S<M.length;S++){for(var Q=M[S],O=0;O<Q.length;O++){C=Q[O],G&&(A+=G.distanceTo(C));var F=new _q,l=Q[O+1];l?F.subVectors(l,C):G?F.subVectors(C,G):F.x=1,F.normalize(),q.push({point:C,length:A,tangent:F}),G=C}G=null}return q},Nd=function(U,j,H,E){H=H||hl;for(var V=[],b=0,e=U.size();e>b;b++){var r=U.get(b);V.push(new _q(r.x,r.e||0,r.y))}j&&(um(j)&&(j=j._as),j.length||(j=null));for(var p,Q,N,C,Y,q=[],B=0,Z=0,n=j?j.length:e;n>Z;Z++)if(Y=j?j[Z]:0===Z?1:2,1===Y)q.push(N=[]),N.push(V[B++]);else if(2===Y||5===Y)if(C=2===Y?V[B++]:N[0],E){var I=j?j[Z+1]:n>Z+1?2:T;if(2===I||5===I){var w=N[N.length-1],h=2===I?V[B]:N[0],m=(new _q).subVectors(w,C),K=(new _q).subVectors(h,C),f=m.length(),i=K.length();if(f&&i)if(E>f/2&&E>i/2)N.push(C);else for(m.multiplyScalar(d(E,f/2)/f).add(C),K.multiplyScalar(d(E,i/2)/i).add(C),p=new Kf(m,C,K).getPoints(H),Q=0;H>=Q;Q++)N.push(p[Q])}else N.push(C)}else N.push(C);else if(3===Y)for(p=new Kf(N[N.length-1],V[B++],V[B++]).getPoints(H),Q=1;H>=Q;Q++)N.push(p[Q]);else if(4===Y)for(p=new Km(N[N.length-1],V[B++],V[B++],V[B++]).getPoints(H),Q=1;H>=Q;Q++)N.push(p[Q]);return q},Pd=function(j){for(var m,U,H=new _q,q=[],K=[],s=[],D=0,o=j.length;o>D;D++)m=j[D],U=j[D+1],U?H.subVectors(U,m):H.subVectors(m,j[D-1]),q.push(H.normalize().clone());var C,S,B,t,y=new _q,L=new _q,f=new rj,u=1e-4,k=Number.MAX_VALUE,v=q[0],R=K[0]=new _q,W=s[0]=new _q;for(S=J(v.x),B=J(v.y),t=J(v.z),k>=S&&(k=S,y.set(1,0,0)),k>=B&&(k=B,y.set(0,1,0)),k>=t&&y.set(0,0,1),L.crossVectors(v,y).normalize(),R.crossVectors(v,L),W.crossVectors(v,R),D=1;o>D;D++)K[D]=K[D-1].clone(),s[D]=s[D-1].clone(),L.crossVectors(q[D-1],q[D]),L.length()>u&&(L.normalize(),C=r(Hb(q[D-1].dot(q[D]),-1,1)),K[D].applyMatrix4(f.makeRotationAxis(L,C))),s[D].crossVectors(q[D],K[D]);return{B:s,T:q,N:K}},Kr=function(){var t=function(p){for(var H=1;H<arguments.length;H++){var $=arguments[H];p.push($.x,$.y,$.z)}},$=function(v){for(var F=1;F<arguments.length;F++){var i=arguments[F].uv;v.push(i[0],i[1])}},f=function(z,Q,f,O,h){var n=-O*A(h),$=O*L(h);return new _q(z.x+n*f.x+$*Q.x,z.y+n*f.y+$*Q.y,z.z+n*f.z+$*Q.z)},e=function(Y,O,q,$,d,c,Z,N){Z=Z||u;for(var m=[],H=Z/d,W=0;d>=W;W++){var z=f(Y,O,q,$,W*H+c);m.push(z),N!=T&&(z.uv=[N,W/d])}return m},x=function(o,I,s,D,x,l,Q,c,Z){Z=Z||u;var p=I?o.top_vs:o.bottom_vs;if(p)for(var g=I?o.top_uv:o.bottom_uv,S=Z/Q,i=0;Q>i;i++){var N,G;I?(N=i*S+c,G=(i+1)*S+c):(G=i*S+c,N=(i+1)*S+c),t(p,f(s,D,x,l,N),f(s,D,x,l,G),s),g&&g.push(.5-.5*A(N),.5-.5*L(N),.5-.5*A(G),.5-.5*L(G),.5,.5)}};return function(n,h,f,P,r,V,J,y,I){var o=h.length;if(o>1){var K,g,L,E,b,s,U,l=Pd(h),Z=l.T,X=l.N,H=l.B;"flat"===y&&x(n,!0,h[0],H[0],X[0],P,r,V,J),"flat"===I&&x(n,!1,h[o-1],H[o-1],X[o-1],P,r,V,J);var j,i,c=[],w=D(r/2),M="round"===y,B="round"===I,G=h[0],R=Z[0],d=H[0],W=X[0],k=h[o-1],O=Z[o-1],m=H[o-1],u=X[o-1];if(M){for(L=1;w>=L;L++)X.splice(0,0,W),H.splice(0,0,d),Z.splice(0,0,R),i=-L/w*P,h.splice(0,0,R.clone().multiplyScalar(i).add(G)),c[w-L]=v(P*P-i*i);o+=w}if(B){for(L=1;w>=L;L++)X.push(u),H.push(m),Z.push(O),i=L/w*P,h.push(O.clone().multiplyScalar(i).add(k)),c[h.length-1]=v(P*P-i*i);o+=w}if(n.uv){var F=0,N=0,q=[];for(f&&(F=f),b=h[0],q[0]=0,L=1;o>L;L++)E=h[L],q[L]=b.distanceTo(E),b=E,f||(F+=q[L]);for(j=[],L=0;o>L;L++)N+=q[L],j[L]=F?N/F:0}for(L=0;o>L;L++){if(E=h[L],s=H[L],U=X[L],K=e(E,s,U,c[L]===p?P:c[L],r,V,J,j?j[L]:T),g)for(var C=0;r>C;C++){var Q=g[C],_=g[C+1]||g[0],S=K[C],a=K[C+1]||K[0];t(n.vs,_,Q,S,S,a,_),n.uv&&$(n.uv,_,Q,S,S,a,_)}g=K}}}}();Rl(j,{getLineLength:function(R){return R[R.length-1].length},getLineOffset:function(L,W){return Eh(L,W)},getLineCacheInfo:function(F,e,Z,s){return md(Nd(F,e,Z,s))}});var Fo=X.Light=function(){fk(Fo,this),this.s(rh,y[rh]),this.s(Po,"sphere"),this.s3(20,20,20)};zq("Light",qg,{_image:"light_icon",_icon:"light_icon",onStyleChanged:function(r,M,m){Fo.superClass.onStyleChanged.apply(this,arguments),r===rh&&this.s("shape3d.color",m)}});var ip=jn.Graph3dView=function(Q,V){var S=this;S._attributes=V||j.graph3dViewAttributes,S._25I={},S._view=tm(1,S);var m=S._canvas=im(S._view);m.addEventListener("webglcontextlost",function(X){X.preventDefault(),uq(S),S._26I&&S._doBufferGC(S._26I,!0),S._26I=T,S._1o.texture=T,S._35O=!0},!1),m.addEventListener("webglcontextrestored",function(){S._35O=!1,S.iv()},!1),S._batchIndexMap={},S._batchModelMap={},S._wireframeIndexMap={},S._wireframeModelMap={},S._wireframeIndexMapSwap={},S._wireframeModelMapSwap={},S._polylineIndexMap={},S._polylineIndexMap={},S._polylineIndexMapSwap={},S._polylineIndexMapSwap={},S._8O=[],S._7O=ge(),S._6O=ge(),S._1o=new $j(S),S._30O=new Jo(S),S._31O=new Ck(S),S._32O=new Sd(S),S._raycaster=new Tq(S),S.vr=new vl(S),S._33Q=!0,S._eye=tq(j.graph3dViewEye),S._center=tq(j.graph3dViewCenter),S._up=tq(j.graph3dViewUp),S._lightChanged=!1,S._59O=[],S._spots=[],S._dirs=[],S._frameId=0,S.overlappingBox=new hf(S),S.dm(Q?Q:new ih),S.setInteractors([new pc(S)])},ei={fogDisabled:1,dashDisabled:1,batchColorDisabled:1,batchBlendDisabled:1,batchBrightnessDisabled:1},Xh=0;gq("Graph3dView",o,{ms_v:1,ms_tip:1,ms_gv:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_51o:1,ms_ac:["devicePixelRatio","boundaries","moveStep","rotateStep","editHelperDisabled","sizeEditableFunc","rotationEditableFunc","editableFunc","rotatable","zoomable","pannable","walkable","resettable","mouseRoamable",Qe,ri,"firstPersonMode",Vo,"movableFunc","gridVisible","gridSize","gridGap","gridColor","originAxisVisible","centerAxisVisible","axisXColor","axisYColor","axisZColor","editSizeColor","rectSelectable","rectSelectBackground","headlightRange","headlightColor","headlightIntensity","headlightDisabled","ortho","orthoWidth","fovy","near","far",Wp,Kb,"up","aspect","fogDisabled","fogColor","fogNear","fogFar","dashDisabled","batchColorDisabled","batchBlendDisabled","batchBrightnessDisabled"],_editable:!1,_editHelperDisabled:j.graph3dViewEditHelperDisabled,_devicePixelRatio:p,_boundaries:p,_moveStep:j.graph3dViewMoveStep,_rotateStep:j.graph3dViewRotateStep,_pannable:j.graph3dViewPannable,_rotatable:j.graph3dViewRotatable,_walkable:j.graph3dViewWalkable,_resettable:j.graph3dViewResettable,_zoomable:j.graph3dViewZoomable,_firstPersonMode:j.graph3dViewFirstPersonMode,_mouseRoamable:j.graph3dViewMouseRoamable,_gridVisible:j.graph3dViewGridVisible,_gridSize:j.graph3dViewGridSize,_gridGap:j.graph3dViewGridGap,_gridColor:j.graph3dViewGridColor,_originAxisVisible:j.graph3dViewOriginAxisVisible,_centerAxisVisible:j.graph3dViewCenterAxisVisible,_axisXColor:j.graph3dViewAxisXColor,_axisYColor:j.graph3dViewAxisYColor,_axisZColor:j.graph3dViewAxisZColor,_ortho:j.graph3dViewOrtho,_orthoWidth:j.graph3dViewOrthoWidth,_fovy:j.graph3dViewFovy,_near:j.graph3dViewNear,_far:j.graph3dViewFar,_headlightColor:j.graph3dViewHeadlightColor,_headlightIntensity:j.graph3dViewHeadlightIntensity,_headlightRange:j.graph3dViewHeadlightRange,_headlightDisabled:j.graph3dViewHeadlightDisabled,_rectSelectable:j.graph3dViewRectSelectable,_rectSelectBackground:j.graph3dViewRectSelectBackground,_editSizeColor:j.graph3dViewEditSizeColor,_autoMakeVisible:sl,_fogDisabled:j.graph3dViewFogDisabled,_fogColor:j.graph3dViewFogColor,_fogNear:j.graph3dViewFogNear,_fogFar:j.graph3dViewFogFar,_dashDisabled:j.graph3dViewDashDisabled,_batchColorDisabled:j.graph3dViewBatchColorDisabled,_batchBlendDisabled:j.graph3dViewBatchBlendDisabled,_batchBrightnessDisabled:j.graph3dViewBatchBrightnessDisabled,setEye:function(B,F,D){1===arguments.length&&(F=B[1],D=B[2],B=B[0]);var i=this._eye;i[0]=B,i[1]=F,i[2]=D,this.fp(Wp,T,i)},setCenter:function(p,t,Z){1===arguments.length&&(t=p[1],Z=p[2],p=p[0]);var $=this._center;$[0]=p,$[1]=t,$[2]=Z,this.fp(Kb,T,$)},setUp:function(s,f,a){1===arguments.length&&(f=s[1],a=s[2],s=s[0]);var J=this._up;J[0]=s,J[1]=f,J[2]=a,this.fp("up",T,J)},isTransparentMask:function(k){return k.s("transparent.mask")},getAspect:function(){var z=this,K=z._aspect;return K?K:z.getWidth()/z.getHeight()},getCanvas:function(){return this._canvas},setDataModel:function(y){var v=this,B=v._dataModel,j=v._selectionModel;B!==y&&(B&&(B.ump(v.handleDataModelPropertyChange,v),B.umm(v.handleDataModelChange,v),B.umd(v.handleDataPropertyChange,v),j||B.sm().ums(v.handleSelectionChange,v)),v._dataModel=y,y.mp(v.handleDataModelPropertyChange,v),y.mm(v.handleDataModelChange,v),y.md(v.handleDataPropertyChange,v),j?j._21I(y):y.sm().ms(v.handleSelectionChange,v),v.invalidateAll(!0),v.invalidateLight(),v.fp(Uo,B,y),v._canvas.style.background=y.getBackground()||"")},handleDataModelPropertyChange:function(i){if("background"===i.property){var B=this._canvas.style.background,$=i.newValue||"";this._canvas.style.background=$,this.fp("canvasBackground",B,$)}},handleDataPropertyChange:function(h){var V=h.data;this.invalidateData(V),xo(V)&&"s:light.type"===h.property&&this.invalidateLight()},invalidateLight:function(){this._lightChanged||(this._lightChanged=!0,this.iv())},onPropertyChanged:function(j){var g=this,f=j.property;g.iv(),g._18Q=T,"eye"===f?g._33Q=!0:"devicePixelRatio"===f?g._42(T,g._devicePixelRatio||fs):ei[f]&&uq(g)},_5O:function(S){var E=S._22Q();return E?new E(this,S):T},getData3dUI:function(m){var $=this._25I[m._id];return $===p&&($=this._5O(m),this._25I[m._id]=$),$},invalidateAll:function(u){var T=this;if(u){for(var p in T._25I){var y=T._25I[p];y&&y.dispose()}T._25I={},T.iv(),Bn(T)}else T.dm().each(function(D){T.invalidateData(D)})},invalidateSelection:function(){var Q=this;Q.sm().each(function(p){Q.invalidateData(p)})},invalidateData:function(a){var z=this,L=z.getData3dUI(a);L&&(L.iv(),z.iv()),Bn(z,a)},getShape3dText:function(_){return _.getStyle("shape3d.text")||this.getLabel(_)},invalidateBatch:function(t){var g=this,X=g._batchModelMap,c=X[t],R=[],A={};if(c){c.ds.forEach(function($){var n=g.getData3dUI($);n&&n.iv(),delete g._batchIndexMap[$._id],R.push($._id)}),delete X[t];for(var b,v,k,F,G,z,r,j,B,$=["_wireframeModelMap","_polylineModelMap","_wireframeModelMapSwap","_polylineModelMapSwap"],W=["_wireframeIndexMap","_polylineIndexMap","_wireframeIndexMapSwap","_polylineIndexMapSwap"],e=0;e<$.length;e++){var Y=g[$[e]],Q=g[W[e]];for(A={},j=0;j<R.length;j++){var _=Q[R[j]];if(_){delete Q[R[j]],B=_.batch,b=Y[B];var S=_.begin,q=_.size,d=3*S,O=3*q,D=4*S,l=4*q;for(v=b.ds,k=b.vs,F=b.cs,G=b.ps,z=b.ls,r=_.index,b.invalidate=!0,v[r]=p,r=d;d+O>r;r++)k[r]=p;for(r=D;D+l>r;r++)F[r]=p;for(r=D;D+l>r;r++)G[r]=p;if(z)for(r=d;d+O>r;r++)z[r]=p;A[B]=!0}}for(B in A){b=Y[B],v=b.ds,k=b.vs,F=b.cs,G=b.ps,z=b.ls;var H=[];for(r=0;r<v.length;r++)v[r]!==p&&H.push(v[r]);if(0===H.length)delete Y[B];else{for(b.ds=H,H=[],r=0;r<k.length;r++)k[r]!==p&&H.push(k[r]);for(b.vs=H,H=[],r=0;r<F.length;r++)F[r]!==p&&H.push(F[r]);for(b.cs=H,H=[],r=0;r<G.length;r++)G[r]!==p&&H.push(G[r]);if(b.ps=H,z){for(H=[],r=0;r<z.length;r++)z[r]!==p&&H.push(z[r]);b.ls=H}}}}g.iv()}},handleDataModelChange:function(v){var I=this,m=v.kind,l=v.data;if("add"===m)I.invalidateData(l),le(l)&&l.getEdgeGroup()&&l.getEdgeGroup().eachSiblingEdge(I.invalidateData,I),xo(l)&&I.invalidateLight();else if(m===ym){var x=l._id,G=I._25I[x];G&&(G.dispose(),delete I._25I[x],I.iv()),l===I._currentSubGraph&&I.setCurrentSubGraph(T),Bn(I,l),xo(l)&&I.invalidateLight()}else m===Sb&&(I.invalidateAll(!0),I.setCurrentSubGraph(T),Bn(I),I.invalidateLight())},toCanvas:function(u){var v=this,g=v.getGL();if(v.validate(),u){var X=g.getParameter(g.COLOR_CLEAR_VALUE);oj(g,u)}v._42(T,1);var B=v.getWidth(),R=v.getHeight(),Z=new Uint8Array(4*B*R),E=im(),C=E.getContext("2d");g.readPixels(0,0,B,R,g.RGBA,g.UNSIGNED_BYTE,Z),Df(E,B,R,1);for(var r=C.getImageData(0,0,B,R),b=r.data,o=0;o<b.length;o+=4){var f=o/4,d=I(f/B),$=f-d*B;f=4*((R-1-d)*B+$),b[f]=Z[o],b[f+1]=Z[o+1],b[f+2]=Z[o+2],b[f+3]=Z[o+3]}return C.putImageData(r,0,0),u&&oj(g,X),v._42(T,v._devicePixelRatio||fs),E},toDataURL:function(l,C){var m=this,$=m.getGL();if(m.validate(),l){var i=$.getParameter($.COLOR_CLEAR_VALUE);oj($,l)}m._42(T,1);var Y=m._canvas.toDataURL(C||"image/png",1);return l&&oj($,i),m._42(T,m._devicePixelRatio||fs),Y},getGL:function(){var G=this,O=G._26I,F=G._prg;if(!O)try{G._2O={},O=G._26I=G._canvas.getContext("webgl",G._attributes)||G._canvas.getContext("experimental-webgl",G._attributes),O._emptyTexture=Ii(O),O._emptyBlendTexture=Ii(O),O._bufPool=[],O._id=++Xh,G._buffer={vs:xm(O),ns:xm(O),is:xm(O),uv:xm(O),batchColor:xm(O),batchBlend:xm(O),batchBrightness:xm(O),lineDistance:xm(O)},G._1O=Yl(O);
var K=G._cube={vs:xm(O),ns:xm(O),is:xm(O),uv:xm(O)};zp(O,K.vs,Ml),zp(O,K.ns,Cl),zp(O,K.uv,ok),qm(O,K.is,cb)}catch(j){}if(O&&!F){if(F=G._prg=O.createProgram(),!F)return T;var p=G._dirs.length,h=G._spots.length,U=G._59O.length,s=["uPMatrix","uMVMatrix","uNMatrix","uViewMatrix","aNormal","aUv","uOffsetScale","uDiffuse","uBlend","uBlendColor","uBrightness","uPartOpacity","uAlphaTest","uTransparent","uTexture","uBlendTexture","uSampler","uBlendSampler","uDiscardSelectable","uFix","uPick","uReverseFlip","uFixPickReverseColor","uBatchBrightness","aBatchBrightness","uBatchColor","aBatchColor","uBatchBlend","aBatchBlend","uDash","aLineDistance","uDashDistance","uDashGapDistance","uLight","uHeadlightRange","uHeadlightColor","uFogColor","uFogNear","uFogFar"];p&&s.push("uDirColor","uDirDirection"),h&&s.push("uSpotColor","uSpotRange","uSpotAngle","uSpotExponent","uSpotPosition","uSpotDirection"),U&&s.push("uPointColor","uPointRange","uPointPosition"),oj(O,[0,0,0,0]),O.clearDepth(1),O.enable(O.DEPTH_TEST),O.depthFunc(O.LEQUAL),O.enable(O.BLEND),O.blendFuncSeparate(O.SRC_ALPHA,O.ONE_MINUS_SRC_ALPHA,O.ONE,O.ONE_MINUS_SRC_ALPHA),hm||(kn=ne(kn.substring(0,kn.indexOf("^#"))),Gn=ne(Gn),hm=!0);var y=["#define MAX_DIR "+p,"#define MAX_SPOT "+h,"#define MAX_POINT "+U,G._fogDisabled?"":"#define FOG",G._dashDisabled?"":"#define DASH",G._batchColorDisabled?"":"#define BATCHCOLOR",G._batchBlendDisabled?"":"#define BATCHBLEND",G._batchBrightnessDisabled?"":"#define BATCHBRIGHTNESS",""].join("\n"),r=vd(O,F,O.VERTEX_SHADER,kn.replace("PREFIX",y)),Z=vd(O,F,O.FRAGMENT_SHADER,Gn.replace("PREFIX",y));w?s.push("aPosition"):(F.aPosition=0,O.bindAttribLocation(F,0,"aPosition")),O.linkProgram(F),s.forEach(function(J){F[J]=/^u/.test(J)?O.getUniformLocation(F,J):O.getAttribLocation(F,J)}),O.useProgram(F),O.deleteShader(r),O.deleteShader(Z)}return O},getBrightness:function(x){var N=x.s("brightness"),q=this.isSelected(x)?x.s("select.brightness"):T;return N==T?q:q==T?N:N*q},getWireframe:function(d){var V=d.s("wf.visible"),z=d.s("wf.width");return V===!0||z>0&&"selected"===V&&this.isSelected(d)?{color:d.s("wf.color"),width:z,"short":d.s("wf.short"),mat:d.s("wf.mat")}:void 0},_transformPointToViewSpace:function(G){var d=[G[0],G[1],G[2]];return pg(d,this._viewMatrix),d},_transformDirectionToViewSpace:function(q,N){var l=[q[0],q[1],q[2]];pg(l,this._viewMatrix);var o=N?[N[0],N[1],N[2]]:[0,0,0];pg(o,this._viewMatrix);var r=o[0]-l[0],$=o[1]-l[1],J=o[2]-l[2],X=Math.sqrt(r*r+$*$+J*J);return X?[r/X,$/X,J/X]:[r,$,J]},getWireframeGeometry:function(z){return z.s("wf.geometry")?{color:z.s("wf.color"),width:z.s("wf.width"),mat:z.s("wf.mat"),geometry:!0}:void 0},getBodyColor:function(P){return P.s("body.color")},getMat:function(t){return t.getMat?t.getMat():t.s("mat")},getFaceMat:function(e,P){return e.getFaceMat?e.getFaceMat(P):e.s(P+".mat")},getFaceBlend:function(P,M){return P.s(M+".blend")||P.s("all.blend")},getFaceColor:function(P,B){return P.s(B+".color")||P.s("all.color")},getFaceImage:function(R,f){return R.s(f+".image")||R.s("all.image")},getFaceBlendImage:function(J,s){return J.s(s+".blend.image")||J.s("all.blend.image")},getFaceDiscardSelectable:function(e,q){var n=e.s(q+".discard.selectable");return n==T?e.s("all.discard.selectable"):n},getFaceUv:function(J,A){return J.s(A+".uv")||J.s("all.uv")},getFaceUvOffset:function(x,f){return x.s(f+".uv.offset")||x.s("all.uv.offset")},getFaceUvScale:function(M,n){return M.s(n+".uv.scale")||M.s("all.uv.scale")},getFaceLight:function($,k){var Q=$.s(k+".light");return Q==T?$.s("all.light"):Q},getFaceVisible:function(s,b){var G=s.s(b+".visible");return G==T?s.s("all.visible"):G},getFaceOpacity:function(U,r){var L=U.s(r+".opacity");return L==T?U.s("all.opacity"):L},getFaceTransparent:function(I,_){var w=I.s(_+".transparent");return w==T?I.s("all.transparent"):w},getFaceReverseColor:function(I,V){return I.s(V+".reverse.color")||I.s("all.reverse.color")},getFaceReverseFlip:function(E,_){var B=E.s(_+".reverse.flip");return B==T?E.s("all.reverse.flip"):B},getFaceReverseCull:function(G,Y){var r=G.s(Y+".reverse.cull");return r==T?G.s("all.reverse.cull"):r},getTextureMap:function(){return this._2O},deleteTexture:function(O){var d=this,v=d._2O[O];v&&(delete d._2O[O],d.getGL().deleteTexture(v))},invalidateShape3dCachedImage:function(i){var z=this.getData3dUI(i);z.invalidateCachedTexture(this.getGL())},getTexture:function(w,d){if(!w)return T;var _=this,F=_.getGL(),k=_._2O[w];if(!k){var m=dq(w);if(m)if(m.tagName){if(m.dynamic)return Yl(F,m,_._1O);k=_._2O[w]=Yl(F,m)}else{var Z,v=d&&d.s("shape3d.image.cache");if(v&&(Z=_.getData3dUI(d),k=Z.getCachedTexture()),!k){var D=d&&d.s("shape3d.fixSizeOnScreen"),p=D?F.NEAREST:F.LINEAR;D||d&&d.s("shape3d.vector.dynamic")&&(Z||(Z=_.getData3dUI(d)),D=Z.getVectorDynamicSize());var e=d&&d.s("shape3d.texture.scale")||1,n=D&&D[0]>0?D[0]:e*mc(m,d),V=D&&D[1]>0?D[1]:e*lh(m,d);if(n>=1&&V>=1){n*=devicePixelRatio,V*=devicePixelRatio;var x=Dg(n,V);$f(x,m,0,0,n,V,d,_),x.restore(),v&&Do(m,d)?(k=Yl(F,Zn,null,p),Z.setCachedTexture(k),Zn=null):k=Yl(F,Zn,_._1O,p)}}}}return k},redraw:function(){this.iv()},validateImpl:function(){var K=this;if(K._lightChanged){K._lightChanged=!1;var l=[],m=[],U=[];K.dm().each(function(g){if(xo(g)){var J=g.s("light.type");J===lb?l.push(g):J===$c?m.push(g):J===nr&&U.push(g)}}),(l.length!==K._59O.length||m.length!==K._spots.length||U.length!==K._dirs.length)&&uq(K),K._59O=l,K._spots=m,K._dirs=U}K._42(),K._1o.iv()},getRenderInfo:function(){var K=this.getGL();return K?K._renderInfo:void 0},showDebugTip:function(){var n=this,r=n._debugDiv;if(!r){r=n._debugDiv=M.createElement("div"),r.style.position="absolute",r.style.overflow="hidden",r.style.backgroundColor="white",r.style.color="black";var Y=n.getView();n._79O?Y.insertBefore(r,n._79O):Y.appendChild(r),n._debugTipTimerId=setInterval(function(){var V=n.getRenderInfo();if(V){var f=n.getGL()._bufPool,s=f.length-(f._ivCount||0),K="Draw Calls: "+V.calls+"<br/>"+"Vertices: "+V.vertices+"<br/>"+"Faces: "+V.faces+"<br/>"+"Lines: "+V.lines+"<br/>"+"Buffer Count: "+s;r.innerHTML=K}},10)}},hideDebugTip:function(){var H=this,v=H._debugDiv;v&&(delete H._debugDiv,cancelAnimationFrame(H._debugTipTimerId),delete H._debugTipTimerId,H.getView().removeChild(v))},_42:function(I,r){var R=this;if(!R._35O&&(!Cc||Zo(Cc))){var U,Q;I&&(I instanceof qg?Q=I:U=I);var X=R._canvas,a=R.getWidth(),J=R.getHeight(),m=R.getGL(),W=R._prg;if(m){r?I||Df(X,a,J,r):(r=R._devicePixelRatio||fs,I||a===X.clientWidth&&J===X.clientHeight||Df(X,a,J,r)),m.clear(m.COLOR_BUFFER_BIT);var c=function(){if(m._renderInfo={calls:0,vertices:0,faces:0,lines:0,frame:++R._frameId},R.overlappingBox.clear(),R._81O=T,m.clear(m.DEPTH_BUFFER_BIT),Qh(m,W.uBrightness,1),Qh(m,W.uOpacity,1),Qh(m,W.uPartOpacity,1),m._picking=!!I,Qh(m,W.uPick,!!I),Qh(m,W.uTexture,!1),Qh(m,W.uBlendTexture,!1),Qh(m,W.uAlphaTest,y.alphaTest),Qh(m,W.uTransparent,!1),Qh(m,W.uFix,!1),Qh(m,W.uBatchColor,!1),Qh(m,W.uBatchBlend,!1),Qh(m,W.uBatchBrightness,!1),Qh(m,W.uPMatrix,R._projectMatrix=ai(R)),Qh(m,W.uViewMatrix,Cq(R,R._7O)),R._viewMatrix=lo(R._7O),I||(jj(R,m,W),R._fogDisabled||(Qh(m,W.uFogColor,R._fogColor),Qh(m,W.uFogNear,R._fogNear),Qh(m,W.uFogFar,R._fogFar))),Ui(m,W.aPosition),Ui(m,W.aNormal),nf(m,W.aUv),nf(m,W.aBatchColor),nf(m,W.aBatchBlend),nf(m,W.aBatchBrightness),nf(m,W.aLineDistance),Q){var g=m.getParameter(m.COLOR_CLEAR_VALUE);m.clearColor(0,0,0,0),m.disable(m.BLEND),nf(m,W.aNormal),zp(m,R._cube.vs,T,W.aPosition),qm(m,R._cube.is),sd(Q,R,ud,0),sd(Q,R,Am,6),sd(Q,R,Ij,12),sd(Q,R,Ol,18),sd(Q,R,ob,24),sd(Q,R,fi,30),Ui(m,W.aNormal),oj(m,g)}else if(U){U.value=2;var g=m.getParameter(m.COLOR_CLEAR_VALUE);m.clearColor(0,0,0,0),m.disable(m.BLEND),R._95I(m,W,U),cd(R,U),Md(R,R._polylineModelMap,U),Md(R,R._wireframeModelMap,U),Qh(m,W.uTransparent,!0),R._95I(m,W,U,!0),cd(R,U,!0),Md(R,R._polylineModelMap,U,!0),Md(R,R._wireframeModelMap,U,!0),Qh(m,W.uTransparent,!1),m.clear(m.DEPTH_BUFFER_BIT),R._swapLineMap(),R._95I(m,W,U,!1,!0),Md(R,R._polylineModelMap,U),Md(R,R._wireframeModelMap,U),R._swapLineMap(),m.disable(m.DEPTH_TEST),R._30O._42(m,W,U),m.enable(m.DEPTH_TEST),oj(m,g)}else m.disable(m.BLEND),R.drawSky(m,W),R._31O._42(m,W),R._95I(m,W),cd(R),Md(R,R._polylineModelMap),Md(R,R._wireframeModelMap),m.enable(m.BLEND),Qh(m,W.uTransparent,!0),m.depthMask(!1),R._95I(m,W,T,!0),cd(R,T,!0),Md(R,R._polylineModelMap,T,!0),Md(R,R._wireframeModelMap,T,!0),m.depthMask(!0),Qh(m,W.uTransparent,!1),m.clear(m.DEPTH_BUFFER_BIT),R._swapLineMap(),R._95I(m,W,T,!1,!0),Md(R,R._polylineModelMap),Md(R,R._wireframeModelMap),R._swapLineMap(),m.disable(m.DEPTH_TEST),m.disable(m.BLEND),R._32O._42(m,W),R._30O._42(m,W),m.enable(m.DEPTH_TEST);zp(m,T),qm(m,T)},u=!1,d=a*r,N=J*r,l=R.vr;l.enable&&l._42(m,d,N,c)&&(u=!0);var Z=R.envRenderer;Z&&Z.enable&&Z._42(m,d,N,c)&&(u=!0),u||(m.viewport(0,0,a*r,J*r),c()),R._33Q=!1,R._doBufferGC(m)}}},setBufferGCInterval:function(D){this._bufferGCInterval=D},_doBufferGC:function(P,r){var p=P._bufPool,z=p.length;if(z){var V,i,n=P._renderInfo.frame,T=this._bufferGCInterval||10,S=0;for(V=0;z>V;V++)i=p[V],i?(r||n-i._fid>T)&&(S++,P.deleteBuffer(i._buf),i._buf=null,p[V]=null):S++;if(S>z/2&&S>128){var Z=[];for(V=0;z>V;V++)p[V]&&Z.push(p[V]);P._bufPool=Z}else p._ivCount=S}},_swapLineMap:function(){var p=this;Q=p._polylineModelMap,p._polylineModelMap=p._polylineModelMapSwap,p._polylineModelMapSwap=Q,Q=p._wireframeModelMap,p._wireframeModelMap=p._wireframeModelMapSwap,p._wireframeModelMapSwap=Q,Q=p._polylineIndexMap,p._polylineIndexMap=p._polylineIndexMapSwap,p._polylineIndexMapSwap=Q,Q=p._wireframeIndexMap,p._wireframeIndexMap=p._wireframeIndexMapSwap,p._wireframeIndexMapSwap=Q},_updateSkyBoxPosition:function(P){if(this._skyBox&&P&&"eye"===P.property){var L=P.newValue;this._skyBox.p3(L[0],L[1],L[2]),this.invalidateData(this._skyBox)}},setSkyBox:function(H){this._skyBox=H,this.ump(this._updateSkyBoxPosition,this),this.invalidateAll(),H&&(this.mp(this._updateSkyBoxPosition,this),this._updateSkyBoxPosition())},drawSky:function(e,$,h){var V=this,x=V._skyBox;if(x){var s=V._headlightIntensity,v=ql(V._headlightColor),$=V._prg;1!==s&&(v=[v[0]*s,v[1]*s,v[2]*s]),Qh(e,$.uHeadlightColor,[v[0],v[1],v[2],1]);var J=V.getData3dUI(x);J&&J._42(e,$,h,function(){return!0}),e.clear(e.DEPTH_BUFFER_BIT),Qh(e,$.uHeadlightColor,[v[0],v[1],v[2],V._headlightDisabled?1:0])}},_95I:function(a,$,r,x,z){function A(M){if(!!M.s("shape3d.alwaysOnTop")==!!z&&i.isVisible(M)&&(!V||W)){if(!r&&i.isTransparentMask(M))return;var R=i.getData3dUI(M);R&&R._42(a,$,r,P)}}var i=this,P=function(H){return x?H:!H};i.sky&&a.clear(a.DEPTH_BUFFER_BIT),i.dm().each(A)},getLogicalPoint:function(I){return ag(I,this._canvas)},isRectOverlapping:function(V){var v=this.getData3dUI(V);return v._rectOverlapping},getHitFaceInfo:function(i){i.target&&(i=this.lp(i));var I=this.getDataInfoAt(i);if(I){var l=this._1o.face(I.data,os(i.x,i.y));if(l)return{data:I.data,face:l}}return T},unproject:function(B,A){var E=this,a=E.getWidth(),b=E.getHeight(),t=B.target?E.lp(B):B,k=t.x-a/2,z=t.y-b/2,v=2*(k/a),V=2*(-1*z/b);A=A||0;var h=ge(),Z=ai(E),m=Cq(E);Qg(h,Z,m),gf(h);var e=mh([v,V,A,1],h);return[e[0]/e[3],e[1]/e[3],e[2]/e[3]]},getDataAt:function(h){var i=this.getDataInfoAt(h);return i?i.data:T},getDataInfoAt:function(Z,r){return Z.target&&(Z=this.lp(Z)),this._1o.get(os(Z.x,Z.y,r),!0)},getDatasInRect:function(P){return this._1o.get(P)},setEditable:function(t){var s=this,X=s._editable;s._editable=t,this.fp(kd,X,t)},isEditable:function(o){var P=this;return P._editable?ng(o)?o.s("3d.editable")?P._editableFunc?P._editableFunc(o):!0:!1:!1:!1},isSelectable:function(b){return b.s("3d.selectable")&&this.sm().isSelectable(b)},isMovable:function(A){var H=this;return le(A)&&A.getStyle(Dc)!==lq?!1:A.s("3d.movable")?H._movableFunc?H._movableFunc(A):!0:!1},isSizeEditable:function($){return ng($)?this._sizeEditableFunc?this._sizeEditableFunc($):!0:!1},isRotationEditable:function(V){return ng(V)&&V.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(V):!0:!1},handleDelete:function(){this._editable&&this.removeSelection()},zoomIn:function(n){this.setZoom(gd,n)},zoomOut:function(s){this.setZoom(1/gd,s)},setZoom:function(M,b){if(1!==M){var K=this;if(K._ortho)return K.setOrthoZoom(M,b),void 0;K._14o&&K._14o.stop(!0);var H=1/M,v=K._eye,N=K._center,X=N[0]+(v[0]-N[0])*H-v[0],q=N[1]+(v[1]-N[1])*H-v[1],d=N[2]+(v[2]-N[2])*H-v[2];if(!(de(v,N)<K._moveStep&&1>H)){if(b=$m(b)){var o=tq(v);return b.action=function(V){K.fi({kind:K._zooming?"betweenZoom":"beginZoom"}),K._zooming=1,v[0]=o[0]+X*V,v[1]=o[1]+q*V,v[2]=o[2]+d*V,K.fp(Wp,T,v)},b._37o=function(){delete K._14o,delete K._zooming,K.fi({kind:"endZoom"}),K.onZoomEnded()},K._14o=Rm(b)}v[0]+=X,v[1]+=q,v[2]+=d,K.fp(Wp,T,v)}}},setOrthoZoom:function(u,R){if(1!==u){var $=this;$._14o&&$._14o.stop(!0);var E=$._orthoWidth,V=E/u-E;if(!(E<$._moveStep&&u>1))return(R=$m(R))?(R.action=function(J){$.fi({kind:$._zooming?"betweenZoom":"beginZoom"}),$._zooming=1,$.setOrthoWidth(E+V*J)},R._37o=function(){delete $._14o,delete $._zooming,$.fi({kind:"endZoom"}),$.onZoomEnded()},$._14o=Rm(R)):($.setOrthoWidth(E/u),void 0)}},getPositionInfo:function(W){var D=this,Z=D._eye,C=D._center,F=D.getAspect(),A=W?hc(Op(C,Z,!0),Op(W,Z)):de(Z,C);if(D._ortho){var z=D._orthoWidth;return{length:A,height:z/F,width:z}}var O=2*P(D._fovy/2)*A;return{length:A,height:O,width:O*F}},getCenterInfo:function(){var n=this;return n._81O||(n._81O=n.getPositionInfo()),tq(n._81O)},rotate:function(m,E,i,t){var f=this;if(m||E){t==T&&(t=f._firstPersonMode),f._88O&&f._88O.stop(!0);var z=f._center,e=f._eye,c=f.getCenterInfo().length,F=t?z:e,$=t?e:z,j=Op(F,$),B=g(j[0],j[2]),G=g(v(j[0]*j[0]+j[2]*j[2]),j[1]),X=t?Kb:Wp;return t&&(E=-E),(i=$m(i))?(i.action=function(H){f.fi({kind:f._rotating?"betweenRotate":"beginRotate"}),f._rotating=1;var y=B+m*H,d=G+E*H;d=yi(d),j[0]=c*L(d)*L(y),j[1]=c*A(d),j[2]=c*L(d)*A(y),F[0]=$[0]+j[0],F[1]=$[1]+j[1],F[2]=$[2]+j[2],f.fp(X,T,F)},i._37o=function(){delete f._88O,delete f._rotating,f.fi({kind:"endRotate"}),f.onRotateEnded()},f._88O=Rm(i)):(B+=m,G+=E,G=yi(G),j[0]=c*L(G)*L(B),j[1]=c*A(G),j[2]=c*L(G)*A(B),F[0]=$[0]+j[0],F[1]=$[1]+j[1],F[2]=$[2]+j[2],f.fp(X,T,F),void 0)}},pan:function(E,O,l,V){if(E||O){var F=this;V==T&&(V=F._firstPersonMode),F._89O&&F._89O.stop(!0);var $=Cq(F),u=[$[0]*E,$[4]*E,$[8]*E],A=[$[1]*O,$[5]*O,$[9]*O],M=u[0]+A[0],L=u[1]+A[1],R=u[2]+A[2],H=F._center,G=F._eye;if(V){var J=vp(F.getBoundaries(),G[0],G[2],G[0]+M,G[2]+R,v(M*M+R*R));M=J[0],R=J[1]}if(l=$m(l)){var W=tq(G),P=tq(H);return l.action=function(u){F.fi({kind:F._panning?"betweenPan":"beginPan"}),F._panning=1,H[0]=P[0]+M*u,H[1]=P[1]+L*u,H[2]=P[2]+R*u,G[0]=W[0]+M*u,G[1]=W[1]+L*u,G[2]=W[2]+R*u,F.fp(Wp,T,G),F.fp(Kb,T,H)},l._37o=function(){delete F._89O,delete F._panning,F.fi({kind:"endPan"}),F.onPanEnded()},F._89O=Rm(l)}H[0]+=M,H[1]+=L,H[2]+=R,G[0]+=M,G[1]+=L,G[2]+=R,F.fp(Wp,T,G),F.fp(Kb,T,H)}},walk:function(u,L,S){if(u){var E=this;S==T&&(S=E._firstPersonMode),E._90O&&E._90O.stop(!0);var F=E._center,X=E._eye,n=Op(F,X,!0);if(S){var V=vp(E.getBoundaries(),X[0],X[2],X[0]+n[0]*u,X[2]+n[2]*u,J(u));if(u=de(V),!u)return;n=[V[0]/u,0,V[1]/u]}if(L=$m(L)){var o=tq(X),t=tq(F);return L.action=function(m){E.fi({kind:E._walking?"betweenWalk":"beginWalk"}),E._walking=1;var N=u*m;X[0]=o[0]+n[0]*N,X[1]=o[1]+n[1]*N,X[2]=o[2]+n[2]*N,F[0]=t[0]+n[0]*N,F[1]=t[1]+n[1]*N,F[2]=t[2]+n[2]*N,E.fp(Wp,T,X),E.fp(Kb,T,F)},L._37o=function(){delete E._90O,delete E._walking,E.fi({kind:"endWalk"}),E.onWalkEnded()},E._90O=Rm(L)}X[0]+=n[0]*u,X[1]+=n[1]*u,X[2]+=n[2]*u,F[0]+=n[0]*u,F[1]+=n[1]*u,F[2]+=n[2]*u,E.fp(Wp,T,X),E.fp(Kb,T,F)}},handleScroll:function(s,B){s.preventDefault();var Y=this,D=Y._moveStep;Y.isFirstPersonMode()?Y.isPannable()&&Y.pan(0,B>0?D:-D):Y.isZoomable()&&Y.setZoom(0>B?1/Bq:Bq)},handlePinch:function(b,f){this.isZoomable()&&this.setZoom(f>b?1/Cn:Cn)},reset:function(){this.setCenter(j.graph3dViewCenter),this.setEye(j.graph3dViewEye),this.setUp(j.graph3dViewUp)},moveSelection:function(D,g,N){var P=this;P.dm().beginTransaction(),Nk(this.sm().toSelection(this.isMovable,this),D,g,N),P.dm().endTransaction()},getMoveMode:function(y,z){var L=z.s("3d.move.mode");if(L)return L;var Y="88",x="89",W="90";return wc(y)||Qm[Y]&&Qm[x]&&Qm[W]?"xyz":Qm[Y]&&Qm[x]?"xy":Qm[Y]&&Qm[W]?"xz":Qm[x]&&Qm[W]?"yz":Qm[Y]?"x":Qm[x]?"y":Qm[W]?"z":"xz"},handleTick:function(){var K=this,d=!1,n=K._moveStep,T=n,Z=!1,U=!0,V=K._rotateStep*(U?-1:1);if(K.isWalkable()||(T=0),K.isPannable()||(n=0),K.isRotatable()||(V=0),K._32Q){var W=(hk()-K._32Q)/50;T*=W,n*=W,V*=W}K._31Q&&(Zi(K._31Q),delete K._31Q,delete K._32Q),Ao()&&(d=!0,K.pan(-n,0,Z,U)),Im()&&(d=!0,K.pan(n,0,Z,U)),Cr()&&(d=!0,wc()?K.pan(0,n,Z,U):K.walk(T,Z,U)),Dl()&&(d=!0,wc()?K.pan(0,-n,Z,U):K.walk(-T,Z,U)),Ip()&&(d=!0,K.rotate(-V,0,Z,U)),Xk()&&(d=!0,K.rotate(V,0,Z,U)),ig()&&(d=!0,K.rotate(0,-V/2,Z,U)),We()&&(d=!0,K.rotate(0,V/2,Z,U)),d&&(K._32Q=hk(),K._31Q=gc(K.handleTick,K))},handleKeyDown:function(B){var $=this;!Jf(B)&&qi[B.keyCode]?$.handleTick():mq(B)?$.selectAll():vc(B)?$.handleDelete(B):ir(B)&&this.isResettable()&&$.reset()},checkDoubleClickOnNote:function(p,Z,r){var s=this;if(r===ys){if(Z.s("note.toggleable"))return Z.s(Em,!Z.s(Em)),s.fi({kind:"toggleNote",event:p,data:Z,part:r}),!0}else if(r===af&&Z.s("note2.toggleable"))return Z.s(lg,!Z.s(lg)),s.fi({kind:"toggleNote2",event:p,data:Z,part:r}),!0;return!1},checkDoubleClickOnRotation:function(m,l,z){return z===bg?(l.setRotationX(0),!0):z===fl?(l.setRotationY(0),!0):z===Kk?(l.setRotationZ(0),!0):!1},onRotateEnded:function(){},onWalkEnded:function(){},toViewPosition:function(j){var v=this,t=v.getWidth()/2,y=v.getHeight()/2,P=v._18Q;return P&&P._wh===t/y||(P=ai(v),v._18Q=Qg(P,P,Cq(v)),v._18Q._wh!==t/y),j=mh([j[0],j[1],j[2],1],P),{x:t+t*j[0]/j[3],y:y-y*j[1]/j[3]}},getHitPosition:function(b,M,$){var x=this,B=x.getWidth(),z=x.getHeight(),W=b.target?x.lp(b):b,c=W.x-B/2,G=W.y-z/2,g=x.getCenterInfo(),q=Cq(x);M=M?M:[0,0,0],$=$?$:[0,1,0],c=c/B*g.width,G=-1*G/z*g.height;var U=[q[0]*c,q[4]*c,q[8]*c],Q=[q[1]*G,q[5]*G,q[9]*G],s=[U[0]+Q[0],U[1]+Q[1],U[2]+Q[2]],I=x.getCenter(),D=Dd(x,M,$,[s[0]+I[0],s[1]+I[1],s[2]+I[2]]);return D?D:[0,0,0]},intersectObject:function(G,X){return this._raycaster.intersectObject(G,X)},getLineLength:function(V){this.validate();var v=this.getData3dUI(V);if(v&&v.getCache){var n=v.getCache();if(n)return n[n.length-1].length}return 0},getLineOffset:function(E,y){var S=this.getData3dUI(E);if(S&&S.getCache){var U=S.getCache();if(U)return Eh(U,y)}return T},isLabelVisible:function(){return!0},isNoteVisible:function(){return!0}}),jn.RenderEnv=function(M){this.gv=M,this.enable=!1},o.defineProperties(jn.RenderEnv.prototype,{debugOn:{get:function(){return this._debugOn},set:function(C){this._debugOn=C,this.capture&&this.capture()}}}),o.assign(jn.RenderEnv.prototype,{renderEnvToCube:function(K,w,q,p){var n=this,H=n.gv;if(!K||!w||!q)return n.enable=!1,n._42=null,void 0;n.enable=!0;var t=Math.floor(p/K*w),z=H.getGL(),k=n._renderTargets;k?k.length<q&&(k=n._renderTargets=k.concat(new Array(q-k.length))):k=n._renderTargets=new Array(q);for(var E=0;q>E;E++)k[E]?k[E].setSize(z,p,t):k[E]=new jn.RenderTarget(H,z,p,t);var J=!1;n.capture=function(){J=!0,H._42(),J=!1};var l=new ap,o=new ap,Q=new ap,v=new ap,y=(new ap).setY(0),m=2*Math.PI/q,c=K/2/Math.tan(Math.PI/q),A=2*Math.atan2(w/2,c),f=K/w;n._42=function(w,h,u,L){var z=n._debugOn;if(!J&&!z)return!1;l.copy(H.getEye()),v.copy(H.getCenter()).sub(l);var Z=Math.atan2(v.z,v.x),r=H.getNear(),V=H.getFovy(),W=H.getAspect();o.copy(H.getCenter());for(var p,C=0;q>C;C++)if(p=k[C],y.setZ(Math.cos(Z)).setX(Math.sin(Z)).multiplyScalar(c),Z-=m,Q.addVectors(l,y),H.setNear(c),H.setCenter([Q.x,Q.y,Q.z]),H.setFovy(A),H.setAspect(f),z){var x=Math.round(h/q);w.viewport(x*C,0,x,u),L()}else Yr(w,p.frame),w.viewport(0,0,p.width,p.height),w.clear(w.COLOR_BUFFER_BIT),L(),Yr(w,T),p.assureTexture();return H.setNear(r),H.setCenter([o.x,o.y,o.z]),H.setFovy(V),H.setAspect(W),!0},n.capture()},getTextureInfo:function(k){var d=this._renderTargets;if(!d)return null;var Z=this._renderTargets[k];return Z?{index:k,texture:Z.texture,textureName:Z.uuid}:null}}),o.assign(jn.Graph3dView.prototype,{renderEnvToCube:function(M,J,L,w){var $=this;$.envRenderer||($.envRenderer=new jn.RenderEnv($)),$.envRenderer.renderEnvToCube(M,J,L,w)}}),jn.RenderTarget=function(L,s,w,S){var V=this;V.uuid=X.Math.generateUUID(),V.gv=L,V.init(L,s),V.setSize(s,w,S)},o.assign(jn.RenderTarget.prototype,{init:function(F,W){var Y=this,v=Y.texture=W.createTexture();W.activeTexture(W.TEXTURE0),W.bindTexture(W.TEXTURE_2D,v),W.texParameteri(W.TEXTURE_2D,W.TEXTURE_WRAP_S,W.CLAMP_TO_EDGE),W.texParameteri(W.TEXTURE_2D,W.TEXTURE_WRAP_T,W.CLAMP_TO_EDGE),W.texParameteri(W.TEXTURE_2D,W.TEXTURE_MIN_FILTER,W.NEAREST),W.texParameteri(W.TEXTURE_2D,W.TEXTURE_MAG_FILTER,W.NEAREST),W.bindTexture(W.TEXTURE_2D,null),Y.render=W.createRenderbuffer(),Y.frame=W.createFramebuffer(),F._2O[Y.uuid]=v},assureTexture:function(){var E=this,q=E.uuid,m=E.gv._2O;m[q]||(m[q]=E.texture)},setSize:function(d,t,c){var q=this;if(q.width!==t||q.height!==c){var o=d.RGBA,x=d.TEXTURE_2D,N=d.RENDERBUFFER,I=d.FRAMEBUFFER;mk(d,q.texture),d.texImage2D(x,0,o,t,c,0,o,d.UNSIGNED_BYTE,T),yd(d,d.TEXTURE_MIN_FILTER,d.LINEAR),d.bindRenderbuffer(N,q.render),d.renderbufferStorage(N,d.DEPTH_COMPONENT16,t,c),Yr(d,q.frame),d.framebufferTexture2D(I,d.COLOR_ATTACHMENT0,x,q.texture,0),d.framebufferRenderbuffer(I,d.DEPTH_ATTACHMENT,N,q.render),mk(d,T),d.bindRenderbuffer(N,T),Yr(d,T),q.width=t,q.height=c}},toCanvas:function(){var S=this,Z=S.gv.getGL();Z.bindFramebuffer(Z.FRAMEBUFFER,S.frame);var P=S.width,q=S.height,e=new Uint8Array(4*P*q);Z.readPixels(0,0,P,q,Z.RGBA,Z.UNSIGNED_BYTE,e),Z.bindFramebuffer(Z.FRAMEBUFFER,null);var t=M.createElement("canvas");t.width=P,t.height=q;var C=t.getContext("2d"),B=C.createImageData(P,q);return B.data.set(e),C.putImageData(B,0,0),t}});var $o=jn.Interactor=function(w){this.gv=w};gq("Interactor",o,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners()}});var pc=jn.DefaultInteractor=function(k){fk(pc,this,[k])};gq("DefaultInteractor",$o,{handle_contextmenu:function(n){Gp(n)},handle_mousewheel:function(R){this.gv.handleScroll(R,R.wheelDelta/40)},handle_DOMMouseScroll:function(P){2===P.axis&&this.gv.handleScroll(P,-P.detail)},handle_keydown:function(M){this.gv.handleKeyDown(M)},handle_mousedown:function(c){this.handle_touchstart(c)},handle_touchstart:function(x){Gp(x);var S=this,Q=S.gv,U=Mf(x),X=Q.getDataInfoAt(x),M=X?X.data:T,s=X?X.part:T,B=Q.sm(),g=$b(x),b=Fj(x);Q.setFocus(x)&&(S._62O=T,S._57I=T,M?Jf(x)?B.co(M)?B.rs(M):B.as(M):B.co(M)||B.ss(M):U&&(Jf(x)?Q.isRectSelectable()&&(S._62O=Pm):S._57I=yq(x)),S._31Q&&(Zi(S._31Q),delete S._31Q,delete S._32Q),S._62O||(Q.isFirstPersonMode()&&(wc(x)||b>2?S._62O="pan":Q.isMouseRoamable()||Rp?(S._62O="roaming",S.foward=g&&Mf(x),S._32Q=hk(),S._31Q=gc(S.tick,S)):U||(S._62O="roaming")),S._62O||(U&&g&&_p[s]?(S._62O=s,S.p3=M.p3()):U&&g&&ng(M)&&Q.isSelected(M)&&Q.isMovable(M)?(S._62O="move",S.p3=M.p3(),S.movedata=M):Rp&&(b>2?S._62O="pan":2===b&&(S.dist=Rq(x),S._62O="pinch")))),S.point=Q.lp(x),rf(S,x),Lg(x)?Q.handleDoubleClick(x,M,s):Q.handleClick(x,M,s))},tick:function(){var h=this,i=h.gv,I=i._moveStep;h.point&&i.isWalkable()&&(h._32Q&&(I*=(hk()-h._32Q)/50),i.walk(h.foward?I:-I),h._32Q=hk(),h._31Q=gc(h.tick,h))},handle_mouseup:function(r){this.handle_touchend(r)},handle_touchend:function(P){var t=this._57I;t&&(de(t,yq(P))<=1&&this.gv.sm().cs(),this._57I=T)},handleWindowMouseMove:function(y){this.handleWindowTouchMove(y)},handleWindowTouchMove:function(y){var P,N,R=this,o=R.gv,r=R._62O,H=R.point,Q=o.dm(),g=o.lp(y),X=g.x-H.x,d=g.y-H.y,M=-u*X/o.getWidth(),D=-u*d/o.getHeight();if("roaming"===r)R.rotate(y,M/2,D/2);else if(r===bg||r===fl||r===Kk)o._86O||Q.beginTransaction(),o.fi({kind:o._86O?"betweenEditRotation":"beginEditRotation",event:y}),o._86O=1,o.sm().each(function(H){if(ng(H)&&o.isRotationEditable(H)){var u=J(M)>J(D)?M:D;r===bg?H.setRotationX(H.getRotationX()+u):r===fl?H.setRotationY(H.getRotationY()+u):r===Kk&&H.setRotationZ(H.getRotationZ()+u)}});else if("move"===r||_p[r]){r===_i||r===mr||r===mn?(o._87O||Q.beginTransaction(),o.fi({kind:o._87O?"betweenEditSize":"beginEditSize",event:y}),o._87O=1):(o._moving||Q.beginTransaction(),o.fi({kind:o._moving?"betweenMove":"beginMove",event:y}),o._moving=1);var A,L=R.p3,h=o.getPositionInfo(L),m=Cq(o);A=r===Bj?"x":r===Rf?"y":r===Uc?"z":r===_i?"sx":r===mr?"sy":r===mn?"sz":o.getMoveMode(y,R.movedata),X=X/o.getWidth()*h.width,d=-1*d/o.getHeight()*h.height;var T,q,G=[m[0]*X,m[4]*X,m[8]*X],p=[m[1]*d,m[5]*d,m[9]*d],i=G[0]+p[0],t=G[1]+p[1],W=G[2]+p[2],b=[L[0]+i,L[1]+t,L[2]+W],V=Op(o.getEye(),b,!0);if("xyz"===A?(T=b,o.moveSelection(i,t,W)):"xz"===A?(T=Dd(o,L,[0,1,0],b),T&&o.moveSelection(T[0]-L[0],0,T[2]-L[2])):"xy"===A?(T=Dd(o,L,[0,0,1],b),T&&o.moveSelection(T[0]-L[0],T[1]-L[1],0)):"yz"===A?(T=Dd(o,L,[1,0,0],b),T&&o.moveSelection(0,T[1]-L[1],T[2]-L[2])):"x"===A||"sx"===A?(V[0]=0,T=Dd(o,L,V,b),T&&(q=T[0]-L[0],"x"===A?o.moveSelection(q,0,0):o.sm().each(function(e){ng(e)&&o.isSizeEditable(e)&&(P=x(Sq,e.getWidth()+q),N=P/e.getWidth(),e.setWidth(P),wc(y)&&(e.setHeight(e.getHeight()*N),e.setTall(e.getTall()*N)))}))):"y"===A||"sy"===A?(V[1]=0,T=Dd(o,L,V,b),T&&(q=T[1]-L[1],"y"===A?o.moveSelection(0,q,0):o.sm().each(function(J){ng(J)&&o.isSizeEditable(J)&&(P=x(Sq,J.getTall()+q),N=P/J.getTall(),J.setTall(P),wc(y)&&(J.setHeight(J.getHeight()*N),J.setWidth(J.getWidth()*N)))}))):("z"===A||"sz"===A)&&(V[2]=0,T=Dd(o,L,V,b),T&&(q=T[2]-L[2],"z"===A?o.moveSelection(0,0,q):o.sm().each(function(W){ng(W)&&o.isSizeEditable(W)&&(P=x(Sq,W.getHeight()+q),N=P/W.getHeight(),W.setHeight(P),wc(y)&&(W.setTall(W.getTall()*N),W.setWidth(W.getWidth()*N)))}))),!T)return;R.p3=T}else if(r===Pm){var I=R.div;I||(I=R.div=rs(),Pb(R.getView(),I),I.op=H,I.style.background=o.getRectSelectBackground()),o.fi({kind:o._rectSelecting?"betweenRectSelect":"beginRectSelect",event:y}),o._rectSelecting=1,I.rect=Zc(I.op,g),yj(I,I.rect)}else if("pinch"===r&&2===Fj(y)){o.fi({kind:o._pinching?"betweenPinch":"beginPinch",event:y}),o._pinching=1;var q=Rq(y);o.handlePinch(q,R.dist),R.dist=q}else"pan"===r||wc(y)?R.pan(y,X,d):o.isFirstPersonMode()||(Mf(y)?R.rotate(y,M,D):(R.pan(y,X,0),o.isWalkable()&&(o.fi({kind:o._walking?"betweenWalk":"beginWalk",event:y}),o._walking=1,o.walk(d/o.getHeight()*o.getCenterInfo().height))));R.point=g},pan:function(m,w,Q){var B=this.gv;if(B.isPannable()){var d=B.getCenterInfo(),b=w/B.getWidth()*d.width,V=-1*Q/B.getHeight()*d.height;B.fi({kind:B._panning?"betweenPan":"beginPan",event:m}),B._panning=1,B.pan(-b,-V)}},rotate:function(P,V,L){var X=this.gv;X.isRotatable()&&(X.fi({kind:X._rotating?"betweenRotate":"beginRotate",event:P}),X._rotating=1,X.rotate(V,L))},handleWindowMouseUp:function($){this.handleWindowTouchEnd($)},handleWindowTouchEnd:function(t){var W=this,D=W.gv,b=D.dm(),A=W.div;if(A){var o=D.getDatasInRect(A.rect);if(!o.isEmpty()){var Q=D.sm(),Y=Q.toSelection();o.each(function($){Q.co($)?Y.remove($):Y.add($)}),Q.ss(Y)}ss(A)}D._moving&&(delete D._moving,D.fi({kind:"endMove",event:t}),D.onMoveEnded(),b.endTransaction()),D._panning&&(delete D._panning,D.fi({kind:"endPan",event:t}),D.onPanEnded()),D._rotating&&(delete D._rotating,D.fi({kind:"endRotate",event:t}),D.onRotateEnded()),D._86O&&(delete D._86O,D.fi({kind:"endEditRotation",event:t}),b.endTransaction()),D._87O&&(delete D._87O,D.fi({kind:"endEditSize",event:t}),b.endTransaction()),D._pinching&&(delete D._pinching,D.fi({kind:"endPinch",event:t}),D.onPinchEnded()),D._rectSelecting&&(delete D._rectSelecting,D.fi({kind:"endRectSelect",event:t}),D.onRectSelectEnded()),D._walking&&(delete D._walking,D.fi({kind:"endWalk",event:t}),D.onWalkEnded()),W.dist=W.point=W._62O=W.p3=W.movedata=W.div=W._57I=W._32Q=W._31Q=W.foward=T}});var Wh=jn.MapInteractor=function(y){fk(Wh,this,[y]),this._minPhi=0,this._maxPhi=5*B/12,this._keepHorizon=!0,this._threshold=2,this._touchScaleThreshold=.05,this._touchRotateThreshold=.03,this._touchScaleCheckAccuracy=.01};gq("MapInteractor",$o,{handle_contextmenu:function(K){Gp(K)},handle_mousewheel:function(I){this.gv.handleScroll(I,I.wheelDelta/40)},handle_DOMMouseScroll:function(J){2===J.axis&&this.gv.handleScroll(J,-J.detail)},handle_keydown:function(b){this.gv.handleKeyDown(b)},handle_mousedown:function(f){this.handle_touchstart(f)},handle_touchstart:function(N){Gp(N);var m=this,T=m.gv;if(T.setFocus(N)){T.lp(N);var f=m.editing={point:T.lp(N)};Rp?f.touch=!0:(f.touch=!1,f.pan=Mf(N)),rf(m,N)}},handle_mouseup:function(H){this.handle_touchend(H)},handle_touchend:function(){},handleWindowMouseMove:function(A){this.handleWindowTouchMove(A)},handleWindowTouchMove:function(K){var V=this,s=V.gv,C=V.editing;if(C){var O=s.lp(K),_=C.point,H=O.x-_.x,I=O.y-_.y;if(!C.moved){if(Math.abs(H)<V.threshold&&Math.abs(I)<V.threshold&&!(K.touches&&K.touches.length>1))return;C.moved=!0}if(C.point=O,C.touch){var z=K.touches.length;if(2!==z)V.pan(K,H,I);else{if(1>=z)return;var W=K.touches,D={x:W[0].clientX,y:W[0].clientY},t={x:W[1].clientX,y:W[1].clientY},i={x:t.x-D.x,y:t.y-D.y},M=C.lastCenter,E=Math.atan2(i.y,i.x),n=C.theta,c=0;n==T?n=C.theta=E:(c=E-n,C.thetaStarted||Math.abs(c)>V.touchRotateThreshold?(C.thetaStarted=!0,C.theta=E):c=0);var Z=B*(D.y+t.y)/2/s.getHeight(),d=C.phi,N=0;d==T?d=C.phi=Z:(N=Z-d,C.phiStarted||Math.abs(N)>V.touchRotateThreshold?(C.phiStarted=!0,C.phi=Z):N=0);var k,b=Math.sqrt(i.x*i.x+i.y*i.y),Y=C.vlen;if(Y){var U=D.x-M.x,q=D.y-M.y,h=t.x-M.x,A=t.y-M.y,a=Math.sqrt(U*U+q*q),P=Math.sqrt(h*h+A*A),l=Y/2,Q=V._sign2(a-l),F=V._sign2(P-l);0>Q*F||0===Q&&0===F?(k=1,C.vlen=b):(k||(k=b/Y),C.scaleStarted||Math.abs(k-1)>V.touchScaleThreshold?(C.vlen=b,C.scaleStarted=!0):k=1)}else Y=C.vlen=b,k=1;1!==k&&s.setZoom(k),(N||c)&&V.rotate(K,c,-N),C.lastCenter={x:(t.x+D.x)/2,y:(t.y+D.y)/2}}}else if(C.pan)V.pan(K,H,I);else{var R=-u*H/s.getWidth(),f=-u*I/s.getHeight();V.rotate(K,R,f)}}},_sign2:function(l){return Math.abs(l)<this._touchScaleCheckAccuracy?0:l>0?1:-1},handleWindowMouseUp:function(p){this.handleWindowTouchEnd(p)},handleWindowTouchEnd:function(j){var w=this,R=w.editing;if(w.editing=null,R&&!R.moved&&R.pan){var J=w.gv,v=J.getDataAt(j);v?J.sm().setSelection([v]):J.sm().clearSelection()}},pan:function(b,j,g){var D=this,E=D.gv;if(E.isPannable()){var F=E.getCenterInfo(),i=-j/E.getWidth()*F.width,v=1*g/E.getHeight()*F.height;E.fi({kind:E._panning?"betweenPan":"beginPan",event:b}),E._panning=1;var Q=D.keepHorizon,s=D.editing.touch;if((s&&b.touches&&b.touches.length>1||!s&&wc(b))&&(Q=!Q),!Q)return E.pan(i,v);if(i||v){var C=Cq(E),o=[C[0]*i,C[4]*i,C[8]*i],M=[C[1],0,C[9]],p=Math.sqrt(M[0]*M[0]+M[2]*M[2]);M=[M[0]/p*v,0,M[2]/p*v];var B=o[0]+M[0],Z=o[1]+M[1],k=o[2]+M[2],z=E._center,J=E._eye;z[0]+=B,z[1]+=Z,z[2]+=k,J[0]+=B,J[1]+=Z,J[2]+=k,E.fp(Wp,T,J),E.fp(Kb,T,z)}}},rotate:function(x,i,H){var C=this,D=C.gv;if(D.isRotatable()){var r=D._center,J=D._eye,V=Op(J,r),t=g(v(V[0]*V[0]+V[2]*V[2]),V[1]),s=t+H;s=Math.max(C.minPhi,Math.min(C.maxPhi,s)),H=s-t,D.fi({kind:D._rotating?"betweenRotate":"beginRotate",event:x}),D._rotating=1,D.rotate(i,H)}}}),o.defineProperties(Wh.prototype,{minPhi:{get:function(){return this._minPhi},set:function(k){this._minPhi=k}},maxPhi:{get:function(){return this._maxPhi},set:function(R){this._maxPhi=R}},keepHorizon:{get:function(){return this._keepHorizon},set:function(l){this._keepHorizon=l}},threshold:{get:function(){return this._threshold},set:function(W){this._threshold=W}},touchScaleThreshold:{get:function(){return this._touchScaleThreshold},set:function(T){this._touchScaleThreshold=T}},touchRotateThreshold:{get:function(){return this._touchRotateThreshold},set:function(A){this._touchRotateThreshold=A}}});var $j=function(m){this.gv=m};gb($j,o,{_iv:!0,iv:function(){this._iv=!0},face:function(m,n){var Y=this,x=Y.gv.getGL();if(!x||!ng(m))return T;var W=n.x,O=n.width,X=n.height,P=Y.height-n.y-X,i=I(O/2),U=new Uint8Array(4*O*X),z=0;for(Y.iv(),Y.validate(m),Yr(x,Y.frame),x.readPixels(W,P,O,X,x.RGBA,x.UNSIGNED_BYTE,U),Yr(x,T),Y.iv();i>=z;z++)for(var C=i-z,F=i+z,L=C;F>=L;L++)for(var u=C;F>=u;u++)if(L===C||L===F||u===C||u===F){var M=mm.m[U[4*(L*O+u)]];
if(M)return M}},get:function(A,Z){this.validate();var V=this,w=V.gv.getGL();if(!w)return T;var m,W,P=A.x,s=A.width,K=A.height,h=V.height-A.y-K,G=I(s/2),o=new Uint8Array(4*s*K),x=0,c=o.length,R=Z?T:new ep,E=Z?T:{};if(Yr(w,V.frame),w.readPixels(P,h,s,K,w.RGBA,w.UNSIGNED_BYTE,o),Yr(w,T),Z){for(;G>=x;x++)for(var L=G-x,$=G+x,j=L;$>=j;j++)for(var y=L;$>=y;y++)if((j===L||j===$||y===L||y===$)&&(m=V.info(o,4*(j*s+y))))return m}else for(;c>x;x+=4)m=V.info(o,x),m&&(W=m.data,E[W._id]||(R.add(W),E[W._id]=W));return R},info:function(L,N){return this.colorMap[(L[N]<<16)+(L[N+1]<<8)+L[N+2]+((127&L[N+3])<<24)]},validate:function(N){var A=this,Q=A.gv,v=Q.getGL();if(v){var s=Q.getWidth(),k=Q.getHeight(),u=v.RGBA,o=v.TEXTURE_2D,S=v.RENDERBUFFER,d=v.FRAMEBUFFER;A.texture||(A.texture=Yl(v),A.render=v.createRenderbuffer(),A.frame=v.createFramebuffer()),(A.width!==s||A.height!==k)&&(mk(v,A.texture),v.texImage2D(o,0,u,s,k,0,u,v.UNSIGNED_BYTE,T),yd(v,v.TEXTURE_MIN_FILTER,v.LINEAR),v.bindRenderbuffer(S,A.render),v.renderbufferStorage(S,v.DEPTH_COMPONENT16,s,k),Yr(v,A.frame),v.framebufferTexture2D(d,v.COLOR_ATTACHMENT0,o,A.texture,0),v.framebufferRenderbuffer(d,v.DEPTH_ATTACHMENT,S,A.render),mk(v,T),v.bindRenderbuffer(S,T),Yr(v,T),A.width=s,A.height=k),A._iv&&(A._iv=!1,Yr(v,A.frame),Q._42(N||(A.colorMap={}),1),Yr(v,T))}}});var Ck=function(M){this.gv=M};gb(Ck,o,{gap:0,size:0,_42:function(r,R){var _=this,a=_.gv,c=a._gridGap,w=a._gridSize;if(a._gridVisible){if(_.gap!==c||_.size!==w){for(var P=[],L=a._gridSize/2,B=c*L,h=0;2*L+1>h;h++){var x=6*h,$=6*(2*L+1)+x;P[x]=-B,P[x+1]=0,P[x+2]=-B+h*c,P[x+3]=B,P[x+4]=0,P[x+5]=-B+h*c,P[$]=-B+h*c,P[$+1]=0,P[$+2]=-B,P[$+3]=-B+h*c,P[$+4]=0,P[$+5]=B}_.vs=new Cj(P),_.gap=c,_.size=w}Ep(a),Yp(r,R),gs(r),zr(r,R,1,a._gridColor,a._buffer.vs,_.vs),Ni(r,0,_.vs.length/3,r.LINES),_d(r),zf(r,R)}else _.vs=_.gap=_.size=T}});var Sd=function(T){this.gv=T};gb(Sd,o,{_42:function(r,y){var m=this.gv,Q=m._buffer.vs,H=m._axisXColor,I=m._axisYColor,R=m._axisZColor,C=m._originAxisVisible,S=m._centerAxisVisible;if(C||S){var t=w?r.TRIANGLES:r.TRIANGLE_FAN,E=r.LINES;if(Ep(m),Yp(r,y),gs(r),C){var U=m.getCenterInfo(),e=d(U.width,U.height)/5,X=.8*e,L=.05*e;zr(r,y,1.5,H,Q,new Cj([0,0,0,e,0,0,X,L,0,X,0,L,X,-L,0,X,0,-L,X,L,0,0,0,0,0,e,0,L,X,0,0,X,L,-L,X,0,0,X,-L,L,X,0,0,0,0,0,0,e,L,0,X,0,L,X,-L,0,X,0,-L,X,L,0,X])),Ni(r,0,2,E),Ni(r,1,6,t),zr(r,y,T,I),Ni(r,7,2,E),Ni(r,8,6,t),zr(r,y,T,R),Ni(r,14,2,E),Ni(r,15,6,t)}if(S){var Y=m._center,D=Y[0],p=Y[1],c=Y[2],U=m.getPositionInfo(Y);e=d(U.width,U.height)/20,zr(r,y,1.5,H,Q,new Cj([D,p,c,D+e,p,c,D,p,c,D,p+e,c,D,p,c,D,p,c+e])),Ni(r,0,2,E),zr(r,y,T,I),Ni(r,2,2,E),zr(r,y,T,R),Ni(r,4,2,E)}_d(r),zf(r,y)}}});var Jo=function(e){this.gv=e},Bj="edit_tx",Rf="edit_ty",Uc="edit_tz",bg="edit_rx",fl="edit_ry",Kk="edit_rz",_i="edit_sx",mr="edit_sy",mn="edit_sz",_p={};_p[Bj]=1,_p[Rf]=1,_p[Uc]=1,_p[bg]=1,_p[fl]=1,_p[Kk]=1,_p[_i]=1,_p[mr]=1,_p[mn]=1,gb(Jo,o,{_42:function(M,q,h){var C=this,e=C.gv,x=e.sm().ld();if(e.isEditable(x)&&!e.isEditHelperDisabled()&&ng(x)&&(!e.isFirstPersonMode()||!e.isMouseRoamable()&&!Rp)){Ep(e);var L,Y,V=e.isMovable(x),v=e.isRotationEditable(x),a=e.isSizeEditable(x),D=e._axisXColor,A=e._axisYColor,$=e._axisZColor,k=e._editSizeColor,i=e.getCenterInfo(),j=d(i.width,i.height)/10,B=j/(h?5:10),N=.7*j,T=.4*N,O=x.p3(),g=O[0],y=O[1],P=O[2];L=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],V&&C._17O(M,q,x,h,Bj,D,L,[g,y-B,P,g+N,y-B,P,g+N,y,P,g+N,y,P,g,y,P,g,y-B,P,g,y-B,P+B,g+N,y-B,P+B,g+N,y-B,P,g+N,y-B,P,g,y-B,P,g,y-B,P+B]),Y=g+N,a&&C._17O(M,q,x,h,_i,k,L,[Y,y-B,P,Y+T,y-B,P,Y+T,y,P,Y+T,y,P,Y,y,P,Y,y-B,P,Y,y-B,P+B,Y+T,y-B,P+B,Y+T,y-B,P,Y+T,y-B,P,Y,y-B,P,Y,y-B,P+B]),Y+=T,v&&C._17O(M,q,x,h,bg,D,L,[Y,y-B,P,Y+T,y-B,P,Y+T,y,P,Y+T,y,P,Y,y,P,Y,y-B,P,Y,y-B,P+B,Y+T,y-B,P+B,Y+T,y-B,P,Y+T,y-B,P,Y,y-B,P,Y,y-B,P+B]),L=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0],V&&C._17O(M,q,x,h,Rf,A,L,[g,y,P,g,y+N,P,g-B,y+N,P,g-B,y+N,P,g-B,y,P,g,y,P,g,y,P,g,y,P-B,g,y+N,P-B,g,y+N,P-B,g,y+N,P,g,y,P]),Y=y+N,a&&C._17O(M,q,x,h,mr,k,L,[g,Y,P,g,Y+T,P,g-B,Y+T,P,g-B,Y+T,P,g-B,Y,P,g,Y,P,g,Y,P,g,Y,P-B,g,Y+T,P-B,g,Y+T,P-B,g,Y+T,P,g,Y,P]),Y+=T,v&&C._17O(M,q,x,h,fl,A,L,[g,Y,P,g,Y+T,P,g-B,Y+T,P,g-B,Y+T,P,g-B,Y,P,g,Y,P,g,Y,P,g,Y,P-B,g,Y+T,P-B,g,Y+T,P-B,g,Y+T,P,g,Y,P]),L=[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],V&&C._17O(M,q,x,h,Uc,$,L,[g,y,P,g,y,P+N,g,y-B,P+N,g,y-B,P+N,g,y-B,P,g,y,P,g,y-B,P,g-B,y-B,P,g-B,y-B,P+N,g-B,y-B,P+N,g,y-B,P+N,g,y-B,P]),Y=P+N,a&&C._17O(M,q,x,h,mn,k,L,[g,y,Y,g,y,Y+T,g,y-B,Y+T,g,y-B,Y+T,g,y-B,Y,g,y,Y,g,y-B,Y,g-B,y-B,Y,g-B,y-B,Y+T,g-B,y-B,Y+T,g,y-B,Y+T,g,y-B,Y]),Y+=T,v&&C._17O(M,q,x,h,Kk,$,L,[g,y,Y,g,y,Y+T,g,y-B,Y+T,g,y-B,Y+T,g,y-B,Y,g,y,Y,g,y-B,Y,g-B,y-B,Y,g-B,y-B,Y+T,g-B,y-B,Y+T,g,y-B,Y+T,g,y-B,Y])}},_17O:function(m,w,O,Q,s,I,a,X){var Z=this.gv._buffer;$i(m,w,Q,!0,O,s),Sn(m,w,T,!0,T,!0,T,!1),Qh(m,w.uDiffuse,I),zp(m,Z.vs,new Cj(X),w.aPosition),zp(m,Z.ns,new Cj(a),w.aNormal),gs(m),Ni(m,0,12),_d(m),xk(m,w)}});var Tq=X.Raycaster=function(D){this.gv=D};zq("Raycaster",o,{intersect:function(p){var l=this,E=l.gv,N=E.getDataAt(p);return N?l.intersectObject(p,N):null},intersectObject:function(b,f){var C,i,E=this,F=E.gv;i=F.unproject(b);var I=F.getEye();F.isOrtho()?(C=Op(F.getCenter(),I),C[0]+=C[0],C[1]+=C[1],C[2]+=C[2]):C=I,C=new ap(C);var g=new ap(i).sub(C).normalize(),Q=new X.Math.Ray(C,g);return E._intersectObjectImpl(Q,f)},_intersectObjectImpl:function(){var t=new Cm,J=new Cm,x=new rd,Y=new ap,o=new ap,E=new ap,z=new ap;return function(d,m){t.fromArray(m.mat),J.getInverse(t),x.copy(d).applyMatrix4(J);var $=this.gv.getData3dUI(m),b=nc($);if(!b)return null;Lq(b)||(b=[b]);var p,g,G,V,y,M,U,u,F=1/0;for(p=0,g=b.length;g>p;p++)if(y=b[p].vs)for(G=0,V=y.length;V>G;G+=9)o.fromArray(y,G),E.fromArray(y,G+3),z.fromArray(y,G+6),M=x.intersectTriangle(o,E,z,!1,Y),M&&(u=x.origin.distanceTo(M),F>u&&(F=u,U=M.clone()));if(!U)return null;var O=U.clone().applyMatrix4(t);return{world:O,local:U}}}()});var Kp=function(U,Q){this.gv=U,this.s=function(b,c,D){return c==T&&(c=D),c==T?Q.getStyle(b):Aq(c,Q,U)},this.data=Q};gb(Kp,o,{I3d:!0,ms_icons:1,_iv:!0,iv:function(){this._iv=!0},_42:function($,z,v,J){var I=this,f=I.data;if(!(f instanceof Hr)){var x,K,n,g,M,o,e,X=I.gv,l=f._id,b=I.s("shape3d.alwaysOnTop")?null:I.s("batch"),B=X._batchIndexMap,d=X._batchModelMap,p=X.isSelectable(f),s=X.getBrightness(f),A=s!=T&&1!==s;if(I.needValidate($)){if(n=od(B,d,f,b),I.validate(n,b?op[b]||qs:T),n&&(g=B[l],M=g.size=n.vs.length/3-g.begin,e=n.rs))for(s=A?s:1,o=0;M>o;o++)e.push(s);if(ng(f)){var h=X.getWireframeGeometry(f);if(h)Ho(X,f,h);else{var k=X.getWireframe(f);k&&Ho(X,f,k)}}I.labelInfo=I.label2Info=I.noteInfo=I.note2Info=I._38o=T,I._24O(as,"getLabel"),I._24O(ki,"getLabel2"),I._26O(ys,"getNote"),I._26O(af,"getNote2"),I._15O(),I._iv=!1}A&&Qh($,z.uBrightness,s),Qh($,z.uAlphaTest,I.s("alphaTest")),K=$i($,z,v,p,f,jc),K&&(Xp(K,B[l],d),Xp(K,X._polylineIndexMap[l],X._polylineModelMap),Xp(K,X._wireframeIndexMap[l],X._wireframeModelMap)),B[l]||I._80o($,z,J),X.isLabelVisible(f)&&((x=I.labelInfo)&&($i($,z,v,p,f,as),I._28O(x,as,J)),(x=I.label2Info)&&($i($,z,v,p,f,ki),I._28O(x,ki,J))),X.isNoteVisible(f)&&((x=I.noteInfo)&&($i($,z,v,p,f,ys),I._29O(x,ys,J)),(x=I.note2Info)&&($i($,z,v,p,f,af),I._29O(x,af,J))),(x=I._38o)&&I._99O($,z,x,v,p,J),A&&Qh($,z.uBrightness,1)}},needValidate:function(){return this._iv},validate:function(){},_16O:function(){return qo},_80o:function(){},dispose:function(){},_calcAnchorMat:function(V){if(V.hasOwnProperty("_anchor")||V.hasOwnProperty("_anchorElevation")){var n=V.getAnchor3d(),Q={x:n.x-.5,y:n.y-.5,z:n.z-.5},M=ge();return Kl(M,[-Q.x,-Q.y,-Q.z]),M}},getBodyColor:function(W){var A=this.data,K=this.gv.getBodyColor(A);return K?K:W?A.getStyle(W):T},_24O:function(Z,z){var S=this,J=S.data,e=S.gv,c=S.s,p=e[z](J);if(p!=T){var m=c(Z+".scale"),x=c(Z+".max"),E=S[Z+"Info"]={label:p,textureScale:c(Z+".texture.scale"),color:e[z+"Color"](J),font:c(Z+".font"),align:c(Z+".align"),background:e[z+"Background"](J)},L=E.rect=jq(E,p);x>0&&x<L.width&&(E.labelWidth=L.width,L.width=x),L.x=L.y=0,L.width*=m,L.height*=m,E.mat=S._16O(c(Z+".autorotate"),c(Z+".position"),L,c(Z+".face"),c(Z+".t3"),c(Z+".r3"),c(Z+".rotationMode"));var C=L.width/2,I=L.height/2;E.vs=new Cj([-C,I,0,-C,-I,0,C,-I,0,C,I,0]),L.width/=m,L.height/=m}},_26O:function(C,H){var B=this,b=B.data,f=B.gv,A=B.s,d=f[H](b);if(d!=T){var l=A(C+".scale"),G=this[C+"Info"]={note:d,textureScale:A(C+".texture.scale"),expanded:A(C+".expanded"),font:A(C+".font"),color:A(C+".color"),align:A(C+".align"),borderWidth:A(C+".border.width"),borderColor:A(C+".border.color"),background:f[H+"Background"](b)};if(G.expanded){var z=A(C+".max"),R=jq(G,d);R.width+=6,R.height+=2,z>0&&z<R.width&&(G.labelWidth=R.width,R.width=z);var Z={x:-R.width/2,y:-8-R.height,width:R.width,height:R.height+8}}else Z={x:-6,y:-18,width:12,height:18};G.mat=B._16O(A(C+".autorotate"),A(C+".position"),T,A(C+".face"),A(C+".t3"),A(C+".r3"),A(C+".rotationMode")),G.rect=Z,1!==l&&(Z=tq(Z),Z.x*=l,Z.height*=l,Z.y=-Z.height,Z.width*=l);var D=Z.x,s=Z.y,y=Z.width,Y=Z.height;G.vs=new Cj([D,-s,0,D,-s-Y,0,D+y,-s-Y,0,D+y,-s,0])}},_28O:function(x,b,j){if(j(this.s(b+".transparent"))){var M=x.rect,G=x.textureScale,C=M.width*G,d=M.height*G;if(C>=1&&d>=1){var r=Dg(C,d);1!==G&&(r.translate(r,M.x,M.y),r.scale(G,G),r.translate(r,-M.x,-M.y)),Nq(r,x),r.restore(),el(this,b,x.mat,x.vs,!0)}}},_29O:function(K,q,X){if(X(this.s(q+".transparent"))){var G=K.rect,n=K.textureScale,t=G.x,Z=G.y,x=G.width*n,j=G.height*n;if(x>=1&&j>=1){G.x=G.y=0;var r=Dg(x,j);1!==n&&r.scale(n,n),bp(r,K),r.restore(),G.x=t,G.y=Z,el(this,q,K.mat,K.vs,!1)}}},_99O:function(l,P,p,F,o,v){if(p){var y=this,S=y.gv,x=y.data,w=S._buffer,Z=S._1O,u=p.icons;for(var U in u){var C=u[U],g=p.rects[U];if(g&&v(Aq(C.transparent,x,S))){$i(l,P,F,o,x,U);var B=Aq(C.shape3d,x,S),D=B?[B]:Aq(C.names,x,S),q=D?D.length:0,f=Aq(C.textureScale,x,S)||1,Y=Aq(C.light,x,S);Y==T&&(Y=B?!0:!1),Sn(l,P,Aq(C.blend,x,S),Y,Aq(C.opacity,x,S),Aq(C.reverseFlip,x,S),Aq(C.reverseColor,x,S),Aq(C.reverseCull,x,S));for(var G=0;q>G;G++){var m=D[G],n=g[G];if(wr(y,n.mat),B)_l(S,x,nc(y,B),y);else{var K=dq(m);if(K){var X=n.width*f,b=n.height*f;if(X>=1&&b>=1){var A=Dg(X,b);hh(A,K,Aq(C.stretch,x,S),0,0,X,b,x,S),A.restore(),Yl(l,Zn,Z),gs(l,P,Z,Aq(C.discardSelectable,x,S),w.uv,Nm),zp(l,w.vs,n.vs,P.aPosition),Xg(l,w.ns,Tl,P.aNormal),is(l,w.is,ab),Ke(l,0,ab.length),_d(l,P,Z)}}}Eg(S)}xk(l,P)}}}}});var gj=function(U,j){fk(gj,this,[U,j])};gb(gj,Kp,{_16O:function(T,k,h,$,p,z,x,G,b){var B=this.data,L=B.getFinalScale3d(),F=qr(k,L,h,$,G,b);if(B.hasOwnProperty("_anchor")||B.hasOwnProperty("_anchorElevation")){var K=B.getAnchor3d();F[0]-=(K.x-.5)*L[0],F[1]-=(K.y-.5)*L[1],F[2]-=(K.z-.5)*L[2]}return jk(ge(),F,B.p3(),$,p,z,x,T,B.r3(),B.getRotationMode())},clear:function(){var U=this;U.faceMat=U.mat=U.shapeModel=U.left=U.right=U.front=U.back=U.top=U.bottom=U.csg=T},needValidate:function(i){if(this._iv)return this._validateFrameId=i._renderInfo.frame,!0;if(this.s("shape3d.autorotate")||this.s("shape3d.fixSizeOnScreen")||this.s("hide.overlapping.group")){var b=i._renderInfo.frame;if(this._validateFrameId!==b)return this._validateFrameId=b,!0}return!1},validate:function(s,d){var D=this,y=D.gv,M=D.data,X=nc(D);D._updateAutoRotation(),D._updateFixSize2d(),D._updateOverlapping(),(this.s("shape3d.autorotate")||this.s("shape3d.fixSizeOnScreen"))&&(gp(y,M,"_wireframeModelMap","_wireframeIndexMap"),gp(y,M,"_wireframeModelMapSwap","_wireframeIndexMapSwap"));var m=cn(M,y.getMat(M),X?D.s("shape3d.scaleable"):!0),H=D._calcAnchorMat(M);if(H&&Qg(m,m,H),M.mat=m,D.clear(),s){var b=[];X?sc(y,M,X,D,D.getBodyColor(),[m],s,b):(Pi(y,M,s,d,m,ud,b,al),Pi(y,M,s,d,m,Ij,b,qp),Pi(y,M,s,d,m,ob,b,Hd),Pi(y,M,s,d,m,fi,b,Te),Pi(y,M,s,d,m,Am,b,Bm),Pi(y,M,s,d,m,Ol,b,kb)),b.length&&(qj(s.vs,b),qj(s.ns,Oi(b)))}else D.mat=m,(D.shapeModel=X)||(D._cubeUvs=null,D.vf(ud,0),D.vf(Ij,16),D.vf(Am,8),D.vf(Ol,24),D.vf(ob,32),D.vf(fi,40))},_updateAutoRotation:function(){var o=this,K=o.s("shape3d.autorotate");if(K){var F,x=o.gv,s=o.data;F="string"==typeof K?[K.indexOf("x")<0?x._eye[0]:x._center[0],K.indexOf("y")<0?x._eye[1]:x._center[1],K.indexOf("z")<0?x._eye[2]:x._center[2]]:x._eye;var d=x._center,t=[F[0]-d[0],F[1]-d[1],F[2]-d[2]],J=s.p3(),i=Yi([J[0]+t[0],J[1]+t[1],J[2]+t[2]],J,x._up),C=s.r3(),E=Dj(i,s.getRotationMode());Math.abs(C[0]-E[0])<1e-5&&Math.abs(C[1]-E[1])<1e-5&&Math.abs(C[2]-E[2])<1e-5||s.r3(E)}},_updateFixSize2d:function(){var C=this,u=C.data,y=C.s("shape3d.fixSizeOnScreen");if(!y)return u._dynamicScale3d&&delete u._dynamicScale3d,void 0;var i=C.gv;u.getFinalScale3d();var x=cn(u,i.getMat(u)),m=pg([0,0,0],x),F=i.toViewPosition(m);if(!isNaN(F.x)&&!isNaN(F.y)){var s=pg([1,0,0],x),w=i.toViewPosition(s),k=pg([0,1,0],x),T=i.toViewPosition(k),r=w.x-F.x,U=T.y-F.y,V=u._dynamicScale3d||[1,1,1],l=dq(u.s("shape3d.image")),H=y[0]>0?y[0]:l?mc(l,C):20,Y=y[1]>0?y[1]:l?lh(l,C):20,Q=Math.abs(r/H),o=Math.abs(U/Y);Math.abs(Q-1)<.001&&Math.abs(o-1)<.001||(u._dynamicScale3d=[V[0]/Q,V[1]/o,V[2]])}},_updateOverlapping:function(){var W=this,r=W.s("hide.overlapping.group");if(!r)return W._rectOverlapping&&(W._rectOverlapping=p),void 0;var K,q,L,h=W.gv,J=W.data,Q=cn(J,h.getMat(J)),H=1/0,z=1/0,t=-1/0,u=-1/0,C=J.getAnchor3d(),S=C.x,f=C.y,x=C.z;for(K=0;8>K;K++){if(q=pg([(K>>2)-S,(1&K>>1)-f,(1&K)-x],Q),L=h.toViewPosition(q),isNaN(L.x)||isNaN(L.y))return;H=Math.min(H,L.x),t=Math.max(t,L.x),z=Math.min(z,L.y),u=Math.max(u,L.y)}var R={x:H,y:z,w:t-H,h:u-z};W._rectOverlapping=h.overlappingBox.isOverlapping(r,R)},getVectorDynamicSize:function(){var R,D=this,u=D.s("shape3d"),y=D.data;if("billboard"===u||"plane"===u||(R=y._currentCubeElementId)!=T){var e,g,l=D.gv,S=cn(y,l.getMat(y)),I=function(w,x){var C=l.toViewPosition(pg(w,S)),t=l.toViewPosition(pg(x,S)),k=C.x-t.x,Q=C.y-t.y;return Math.min(2048,Math.sqrt(k*k+Q*Q))};if("billboard"===u)e=I([-.5,0,0],[.5,0,0]),g=I([0,-.5,0],[0,.5,0]);else if("plane"===u)e=I([-.5,0,0],[.5,0,0]),g=I([0,0,-.5],[0,0,.5]);else if(y._currentCubeElementId!=T){var q=3*cb[R+1],x=3*cb[R],r=3*cb[R+2];e=I([Ml[q],Ml[q+1],Ml[q+2]],[Ml[r],Ml[r+1],Ml[r+2]]),g=I([Ml[q],Ml[q+1],Ml[q+2]],[Ml[x],Ml[x+1],Ml[x+2]])}return[e,g]}},getCachedTexture:function(){var g=this,j=g.data,Y=j._currentCubeElementId;return Y!=T?g._cubeCachedImage?g._cubeCachedImage[Y]:null:g._shape3dCachedImage},setCachedTexture:function(O){var N=this,M=N.data,g=M._currentCubeElementId;if(g!=T){if(!N._cubeCachedImage)return N._cubeCachedImage={};N._cubeCachedImage[g]=O}else N._shape3dCachedImage=O},invalidateCachedTexture:function(b){var M,V,d,x=this;if((d=x._shape3dCachedImage)&&(b.deleteTexture(d),x._shape3dCachedImage=null),V=x._cubeCachedImage){for(M in V)b.deleteTexture(V[M]);x._cubeCachedImage=null}},vf:function(W,Y){var S=this;if(S.gv.getFaceVisible(S.data,W)){var F=kg(S,W);F.mat&&(S.faceMat=!0);var _=F.uv;if(_){var Z=S._cubeUvs;Z||(Z=S._cubeUvs=new Cj([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]));for(var X=0;8>X;X++)Z[Y+X]=_[X]}return F}},_80o:function(N,g,y){var b=this;if(b._rectOverlapping)return!0;var E=b.gv,f=b.data,$=E._cube,a=b.shapeModel;Ep(E,b.mat),a?_l(E,f,a,b,b.getBodyColor(),y):(zp(N,$.vs,T,g.aPosition),zp(N,$.ns,T,g.aNormal),qm(N,$.is),b._18O(N,g,b.left,0,y),b._18O(N,g,b.front,6,y),b._18O(N,g,b.right,12,y),b._18O(N,g,b.back,18,y),b._18O(N,g,b.top,24,y),b._18O(N,g,b.bottom,30,y)),Eg(E),b.faceMat&&(b._18O(N,g,b.left,0,y,!0),b._18O(N,g,b.front,6,y,!0),b._18O(N,g,b.right,12,y,!0),b._18O(N,g,b.back,18,y,!0),b._18O(N,g,b.top,24,y,!0),b._18O(N,g,b.bottom,30,y,!0))},_18O:function($,c,y,Q,N,S){if(y){if(!N(y.transparent))return;if(S&&!y.mat||!S&&y.mat)return;S&&Ep(this.gv,y.mat);var q=this,x=q.data;x._currentCubeElementId=Q;var J=q.gv,p=J.getTexture(y.texture,x),e=y.uv,n=y.uvScale,D=y.uvOffset,m=y.discardSelectable;p?e?gs($,c,p,m,J._buffer.uv,q._cubeUvs,D,n):gs($,c,p,m,J._cube.uv,T,D,n):gs($),Sn($,c,y.blend,y.light,y.opacity,y.reverseFlip,y.reverseColor,y.reverseCull),Qh($,c.uDiffuse,y.color),Ke($,Q,6),xk($,c),_d($,c,p),S&&Eg(J),x._currentCubeElementId=null}}});var Ej=function(d,K){fk(Ej,this,[d,K])};gb(Ej,Kp,{_25Q:1,validate:function(J){var m=this,a=m.gv,p=m.data,z=m.s,f=z("edge.width"),h=p._40I,X=p._41I;if(m.shapeModel=m.info=T,h&&X){var v,D,C,s,F,K,E,w,Y,V,Q=p.isLooped(),r=z(Dc),i=j.getEdgeType(r);if(i){var S=i(p,Ki(m,a,p,Q,r),a,m._19Q);if(!S.points||S.points.isEmpty())return;K=m.info={},E=S.segments,F=S.points,w=F.size();for(var g=h.getElevation(),R=X.getElevation(),P=0;w>P;P++){var y=F.get(P);y.e==T&&(y.e=g+(R-g)*P/(w-1))}Y=qf(F.get(0)),V=qf(F.get(w-1));var q=w%2;0===q?(K.c1=qf(F.get(w/2-1)),K.c2=qf(F.get(w/2))):K.p3=qf(F.get((w-q)/2)),K.s1=Y,K.s2=qf(F.get(1)),K.t1=qf(F.get(w-2)),K.t2=V}else{F=new ep,K=m.info={};var e=z("edge.offset"),B=z("edge.center"),U=z("edge.source.t3"),N=z("edge.target.t3"),o=h.p3(),_=X.p3();if(U&&(o[0]+=U[0],o[1]+=U[1],o[2]+=U[2]),N&&(_[0]+=N[0],_[1]+=N[1],_[2]+=N[2]),r===lq){E=z("edge.segments");var Z=K.points=z(Ur)||_c;if(w=Z.size()){Y=qf(Z.get(0)),V=qf(Z.get(w-1)),!B&&e&&(C=Op(Y,o,!0),e=d(e,de(o,Y)),o=[o[0]+C[0]*e,o[1]+C[1]*e,o[2]+C[2]*e],C=Op(_,V,!0),e=d(e,de(V,_)),_=[_[0]-C[0]*e,_[1]-C[1]*e,_[2]-C[2]*e]);var q=w%2;0===q?(v=qf(Z.get(w/2-1)),D=qf(Z.get(w/2))):K.p3=qf(Z.get((w-q)/2)),K.s1=o,K.s2=Y,K.t1=V,K.t2=_}else!B&&e&&(C=Op(_,o,!0),s=de(o,_),e=Pp(e,s),o=[o[0]+C[0]*e,o[1]+C[1]*e,o[2]+C[2]*e],_=[_[0]-C[0]*e,_[1]-C[1]*e,_[2]-C[2]*e]),v=o,D=_;F.add({x:o[0],y:o[2],e:o[1]}),F.addAll(Z),F.add({x:_[0],y:_[2],e:_[1]})}else{var O=Ki(m,a,p,Q,r);if(m._19Q||(O=-O),Q){var l=o[0],W=o[1],A=o[2],G=h.getTall()/2+O;v=[l-O,W+G,A],D=[l+O,W+G,A],F.add({x:l-O,y:A,e:W}),F.add({x:l-O,y:A,e:W+G}),F.add({x:l+O,y:A,e:W+G}),F.add({x:l+O,y:A,e:W})}else{C=Op(_,o,!0),s=de(o,_);var I={x:o[0],y:o[2]},M={x:_[0],y:_[2]},t=cc(T,I,M,O),c=t.x-I.x,H=t.y-I.y;e=Pp(e,s),C[0]*=e,C[1]*=e,C[2]*=e,v=[o[0]+C[0]+c,o[1]+C[1],o[2]+C[2]+H],D=[_[0]-C[0]+c,_[1]-C[1],_[2]-C[2]+H],B?(F.add({x:o[0],y:o[2],e:o[1]}),F.add({x:v[0],y:v[2],e:v[1]}),F.add({x:D[0],y:D[2],e:D[1]}),F.add({x:_[0],y:_[2],e:_[1]})):(F.add({x:v[0],y:v[2],e:v[1]}),F.add({x:D[0],y:D[2],e:D[1]}))}}K.c1=v,K.c2=D}K.list=z(Po)===cs?m.createTubeModel(F,E,f/2,J):m.createLineModel(F,E,f,"edge","edge.dash")}}});var Fc=function(O,F){fk(Fc,this,[O,F])};gb(Fc,gj,{_80o:function(H,F,x){var S=this,v=S.gv,c=S.shapeModel;Ep(v,S.mat),c?_l(v,S.data,c,S,S.getBodyColor(),x):(wd(S,H,F,S.left,x),wd(S,H,F,S.front,x),wd(S,H,F,S.right,x),wd(S,H,F,S.back,x),wd(S,H,F,S.top,x),wd(S,H,F,S.bottom,x)),Eg(v)},validate:function(K,V){var R,m,W=this,h=W.s,S=W.data,Z=S.p3(),e=S._thickness/2,j=S.isClosePath(),D=S.getPoints(),O=S.getSegments(),G=h(Ff),o=K&&K.uv;if(W.clear(),0>e)m=W.shapeModel=Kg(D,O,h(Qq),h(sh),G,h(si),S.getTall(),S.getShapeElevation(),j),h(vf)?h("shape3d.image")||delete m.uv:(delete m.vs,delete m.ns,delete m.uv),h("shape3d.top.image")||delete m.top_uv,h("shape3d.bottom.image")||delete m.bottom_uv;else if(h(Po)===cs)R=dl(D,O,G,j),m=W.shapeModel={vs:[]},h("shape3d.image")&&(m.uv=[],m.sum=h(si)||iq(R)||1,m.len=0),h(Qq)&&!j&&(m.top_vs=[],h("shape3d.top.image")&&(m.top_uv=[])),h(sh)&&!j&&(m.bottom_vs=[],h("shape3d.bottom.image")&&(m.bottom_uv=[])),W._12O(R,e);else{var v,w,q,x,L,P,F,N,p,g;if(R=dl(D,O,G,j),L=W.vf(Am,o,!1,V),e&&(P=W.vf(Ol,o,!1,V),F=j?T:W.vf(ud,o,!1,V),N=j?T:W.vf(Ij,o,!1,V),p=W.vf(ob,o,!1,V),g=W.vf(fi,o,!1,V)),e){for(var i=0,Q=R.length;Q>i;i++)R[i]=W._tryRemoveBezierPoints(R[i],e);W._12O(R,e)}else L&&R.forEach(function(F){if(x=F.length,x>0)for(v=F[0],q=1;x>q;q++)w=F[q],W.addV(L.vs,v,w),v=w});W._20Q(R),K||(L&&(L.ns=Oi(L.vs),Yd(L,"vs"),Yd(L,zo)),e&&(P&&(P.ns=Oi(P.vs),Yd(P,"vs"),Yd(P,zo)),F&&(F.ns=Oi(F.vs),Yd(F,"vs"),Yd(F,zo)),N&&(N.ns=Oi(N.vs),Yd(N,"vs"),Yd(N,zo)),p&&(p.ns=Oi(p.vs),Yd(p,"vs"),Yd(p,zo)),g&&(g.ns=Oi(g.vs),Yd(g,"vs"),Yd(g,zo))))}var M=W.mat=ge();Kl(M,Z),Pf(M,S.r3(),S.getRotationMode());var l=S.getScale3d(),b=S._dynamicScale3d;b&&(l[0]*=b[0],l[1]*=b[1],l[2]*=b[2]),Ef(M,l),Kl(M,wq(Z)),K&&(Fe(W,M,K,m),W.clear())},_20Q:function(_){var z,U,e,G,c,v,E,j=this,M=j.front,m=j.back,p=j.top,H=j.bottom,l=M?M.tuv:T,y=m?m.tuv:T,b=p?p.tuv:T,N=H?H.tuv:T,J=0;(l||y||b||N)&&(z=j.s(si)||iq(_)||1,_.forEach(function(N){if(U=N.length,U>0)for(v=N[0],e=1;U>e;e++)E=N[e],G=J/z,J+=de(v,E),c=J/z,j._14O(M,G,c),j._14O(m,1-c,1-G),j._14O(p,G,c),j._14O(H,G,c),v=E}))},_14O:function(l,X,m){if(l){var P=l.uv,V=l.tuv;if(V){if(P)var v=P[0]+(P[6]-P[0])*X,U=P[1]+(P[7]-P[1])*X,p=P[2]+(P[4]-P[2])*X,E=P[3]+(P[5]-P[3])*X,z=P[2]+(P[4]-P[2])*m,q=P[3]+(P[5]-P[3])*m,w=P[0]+(P[6]-P[0])*m,i=P[1]+(P[7]-P[1])*m;else v=X,U=0,p=X,E=1,z=m,q=1,w=m,i=0;V.push(p,E,z,q,w,i,w,i,v,U,p,E)}}},_13O:function(g){var X=g.uv,H=g.tuv;H&&(X?H.push(X[2],X[3],X[4],X[5],X[6],X[7],X[6],X[7],X[0],X[1],X[2],X[3]):H.push(0,1,1,1,1,0,1,0,0,0,0,1))},_tryRemoveBezierPoints:function(V,o){var $=V.length;if(4>$)return V;var q,H,M,c,P,I,m=!1,h=function(s){return V[s]},T=function(S){return V[$-1-S]};for(P=0;1>=P;P++)for(I=P?T:h,H=I(0),M=I(1),q=2;$-1>q;q++)if(c=I(q),!c.remove)if(c.b){var J=cc(H,M,c,o);J.adjust?(c.remove=!0,m=!0):(H=M,M=c)}else H=M,M=c;if(!m)return V;var Y=[];for(q=0;$>q;q++)V[q].remove||Y.push(V[q]);return Y},_12O:function(z,K){var u,s,Q,B,U,m=this;z.forEach(function(G){if(U=G.length,U>0)for(u={p:G[0],n:!0},B=1;U>B;B++)s=G[B],Q=U-1>B?G[B+1]:T,m.addPoint(u,s,Q,K,G)})},addPoint:function(B,H,O,L,x){var p,F,I,R,l,b,r,N,J,n=this,a=B.p,A=B.f,y=B.b,d=n.s("shape3d.side")||Bi,e=n.s("shape3d.start.angle"),P=n.s("shape3d.sweep.angle"),$=n.shapeModel,V=n.data.isClosePath();if(B.n&&(B.n=!1,A=V&&x.length>2?cc(x[x.length-2],a,H,L):cc(T,a,H,L),y=en(a,A),$?$.top_vs&&n._10O(y,A,d,e,P,$.top_vs,$.top_uv):(p=n.left)&&(n.addV(p.vs,y,A),n._13O(p))),F=O?cc(a,H,O,L):V&&x.length>2?cc(a,H,x[1],L):cc(a,H,T,L),I=en(H,F),$){var Q,W,c=$.vs,U=$.uv,K=$.sum;for(U&&(Q=$.len/K,$.len+=de(a,H),W=$.len/K),b=n._9O(y,A,d,e,P),r=n._9O(I,F,d,e,P),N=0;d>N;N++)J=N+1,qj(c,b[J]),qj(c,r[N]),qj(c,b[N]),qj(c,r[N]),qj(c,b[J]),qj(c,r[J]),U&&(R=N/d,l=J/d,U.push(Q,l,W,R,Q,R,W,R,Q,l,W,l));!O&&$.bottom_vs&&n._10O(I,F,d,e,P,$.bottom_vs,$.bottom_uv,!0)}else!O&&(p=n.right)&&(n.addV(p.vs,F,I),n._13O(p)),(p=n.front)&&n.addV(p.vs,A,F),(p=n.back)&&n.addV(p.vs,I,y),(p=n.top)&&n.addH(p.vs,A,F,I,y,!0),(p=n.bottom)&&n.addH(p.vs,y,I,F,A);B.p=H,B.f=F,B.b=I},_10O:function(a,B,l,m,Z,O,N,Y){var $,M,G=this,_=G.data,b=G._9O(a,B,l,m,Z),D=(a.x+B.x)/2,z=(a.y+B.y)/2,U=_.getShapeElevation(),j=0;for(j=0;l>j;j++)Y?(qj(O,b[j]),qj(O,b[j+1])):(qj(O,b[j+1]),qj(O,b[j])),qj(O,[D,U,z]),N&&(Y?($=u*(j+1)/l+m,M=u*j/l+m):($=u*j/l+m,M=u*(j+1)/l+m),N.push(.5-.5*A(M),.5-.5*L(M),.5-.5*A($),.5-.5*L($),.5,.5))},_9O:function(c,P,C,R,X){var V,o,g=this,z=g.data,H=[],S=(c.x+P.x)/2,v=(c.y+P.y)/2,K=z.getTall()/2,N=z.getShapeElevation(),J=0;for(X=X||u;C>=J;J++)V=X*J/C+R,o=A(V),H.push([S+(c.x-S)*o,N+K*L(V),v+(c.y-v)*o]);return H},addV:function(k,A,y){var B=A.x,Q=A.y,n=y.x,G=y.y,W=this.data,o=W.getShapeElevation(),$=W.getTall()/2;k.push(B,o-$,Q,n,o-$,G,n,o+$,G,n,o+$,G,B,o+$,Q,B,o-$,Q)},addH:function(M,T,Z,E,t,H){var s=this.data,q=s.getTall()/2,w=s.getShapeElevation()+(H?q:-q);M.push(T.x,w,T.y,Z.x,w,Z.y,E.x,w,E.y,E.x,w,E.y,t.x,w,t.y,T.x,w,T.y)},vf:function(b,X,D,k){var M,K=this,S=K.gv.getFaceVisible(K.data,b);return(D||S)&&(M=kg(K,b,k),M.vs=[],M.tuv=S&&(M.texture||X)?[]:T,M.visible=S),M}});var qk=function(X,W){fk(qk,this,[X,W])};gb(qk,Kp,{_25Q:1,validate:function(x){var u=this,g=u.data,U=u.s,K=g.getPoints(),$=K.size();if(u.shapeModel=u.info=T,$>1){var f=u.info={},a=g.getSegments(),m=g.getThickness(),C=qf(K.get(0)),k=qf(K.get($-1)),o=$%2;0===o?(f.c1=qf(K.get($/2-1)),f.c2=qf(K.get($/2))):f.p3=qf(K.get(($-o)/2)),f.s1=C,f.s2=qf(K.get(1)),f.t1=qf(K.get($-2)),f.t2=k,f.list=U(Po)===cs?u.createTubeModel(K,a,m/2,x):u.createLineModel(K,a,m,"shape.border","shape.dash")}var j=g.p3(),W=u.mat=ge();Kl(W,j),Pf(W,g.r3(),g.getRotationMode());var e=g.getScale3d(),F=g._dynamicScale3d;F&&(e[0]*=F[0],e[1]*=F[1],e[2]*=F[2]),Ef(W,e),Kl(W,wq(j))},_80o:function(p,c,K){var d=this,J=d.shapeModel;if(J){var F=d.gv;Ep(F,d.mat),_l(F,d.data,J,d,d.getBodyColor(),K),Eg(F)}}});var vl=X.graph3d.VR=function(Q){var m=this;m.gv=Q,m.controller=new Xl(m),m.switch=new ms(m),m._enable=!1,m._defaultCallLater=X.Default.callLater,"undefined"!=typeof k&&"VRFrameData"in k&&(m._frameData=new k.VRFrameData),m.measureOflength=1,m.eyesOffset=[0,0,0]};gb(vl,o,{_42:function(D,K,A,C){var F=this,O=F.gv,Y=F._device;if(Y){var l=F._scaleFactor;if(Y.depthNear=O.getNear()/l,Y.depthFar=O.getFar()/l,Y.isPresenting===!1)return O.iv(),!1;var h=F._frameData;Y.getFrameData(h);var d=h.pose.position;if(d){var l=F._scaleFactor,S=F._eyesOffset;O.setEye([d[0]*l+S[0],d[1]*l+S[1],d[2]*l+S[2]])}return D.viewport(0,0,K/2,A),F._viewMatrix=F._copyViewMatrix(h.leftViewMatrix),F._projectMatrix=F._copyProjectMatrix(h.leftProjectionMatrix),C(),D.viewport(K/2,0,K/2,A),F._viewMatrix=F._copyViewMatrix(h.rightViewMatrix),F._projectMatrix=F._copyProjectMatrix(h.rightProjectionMatrix),C(),F._lastViewMatrix=F._viewMatrix,F._lastProjectMatrix=F._projectMatrix,F._viewMatrix=null,F._projectMatrix=null,F.submitFrame(),!0}},_copyViewMatrix:function(h){var S=this.dup(h),_=this._scaleFactor;S[12]*=_,S[13]*=_,S[14]*=_;var e=this._eyesOffset;if(e&&(e[0]||e[1]||e[2])){var b=e[0],X=e[1],g=e[2];S[12]-=S[0]*b+S[4]*X+S[8]*g,S[13]-=S[1]*b+S[5]*X+S[9]*g,S[14]-=S[2]*b+S[6]*X+S[10]*g}return S},shutdown:function(){var k=this._device;k&&k.isPresenting&&k.exitPresent()},isPresenting:function(){var e=this._device;return e&&e.isPresenting},_copyProjectMatrix:function(w){var M=this.dup(w),s=this._scaleFactor;return M[14]*=s,M},dup:function(q,U){for(var k=q.length,i=U||new Array(k);k--;)i[k]=q[k];return i},getViewMatrix:function(T){var V=this._viewMatrix;return V?this.dup(V,T):void 0},getProjectMatrix:function(){var t=this._projectMatrix;return t?this.dup(t):void 0},submitFrame:function(){var J=this;if(J._enable&&J._deviceInAction){var y=J._device;y&&y.isPresenting&&(y.submitFrame(),J.gv.iv())}},setDevice:function(g){var R=this;R._device=g},_injectCallLaterFunc:function(y){var w=this;if(!y)return gc=X.Default.callLater=w._defaultCallLater,void 0;var w=this;gc=X.Default.callLater=function(R,F,B,h){var k=w._device;return k&&k.isPresenting?h?e(function(){gc(R,F,B)},h):k.requestAnimationFrame(function(){w._deviceInAction=!0,R.apply(F,B),w._deviceInAction=!1}):(w._defaultCallLater(R,F,B,B),void 0)}}}),o.defineProperties(vl.prototype,{enable:{get:function(){return this._enable},set:function(y){var G=this;G._enable!==y&&(G._enable=y,y?(G.switch.showButton(),G._injectCallLaterFunc(!0)):(G.shutdown(),G.switch.hideButton(),G._injectCallLaterFunc(!1)))}},measureOflength:{get:function(){return this._measureOflength},set:function(u){this._measureOflength=u,this._scaleFactor=1/u}},eyesOffset:{get:function(){return this._eyesOffset},set:function(V){this._eyesOffset=V}}});var Xl=function(N){this.vr=N};gb(Xl,o,{}),o.defineProperties(Xl.prototype,{});var ms=function(F){this.vr=F,this._button=null};gb(ms,o,{showButton:function(){var n=this.assureButton();if(!n.parentNode){var w=this.vr.gv,F=w.getView();w._79O?F.insertBefore(n,w._79O):F.appendChild(n)}},hideButton:function(){var W=this._button;W&&W.parentNode&&W.parentNode.removeChild(W)},assureButton:function(){var c=this._button;return c?c:this._button=this.createButton(this.vr.gv)},createButton:function(d){function S(S,e){S.textContent=e&&e.isPresenting?"关闭 VR 显示":"开启 VR 显示"}function G(N){A.style.display="",A.style.cursor="pointer",A.style.left="calc(50% - 50px)",A.style.width="100px",S(A,N),A.onmouseenter=function(){A.style.opacity="1.0"},A.onmouseleave=function(){A.style.opacity="0.5"},A.onclick=function(){N.isPresenting?N.exitPresent():N.requestPresent([{source:d.getCanvas()}])},d.vr.setDevice(N)}function b(){A.style.display="",A.style.cursor="auto",A.style.left="calc(50% - 75px)",A.style.width="150px",S(A,null),A.onmouseenter=null,A.onmouseleave=null,A.onclick=null,d.vr.setDevice(null)}function F(w){w.style.position="absolute",w.style.bottom="20px",w.style.padding="12px 6px",w.style.border="1px solid #fff",w.style.borderRadius="4px",w.style.color="#000",w.style.font="normal 13px sans-serif",w.style.textAlign="center",w.style.opacity="0.5",w.style.outline="none",w.style.zIndex="999"}if("getVRDisplays"in navigator){var A=this._button=M.createElement("button");return A.style.display="none",F(A),k.addEventListener("vrdisplayconnect",function(h){G(h.display)},!1),k.addEventListener("vrdisplaydisconnect",function(){b()},!1),k.addEventListener("vrdisplaypresentchange",function(L){S(A,L.display)},!1),navigator.getVRDisplays().then(function(d){d.length>0?G(d[0]):b()}),A}var J=M.createElement("a");return J.href="https://webvr.info",J.innerHTML="当前不支持 webvr",J.style.left="calc(50% - 90px)",J.style.width="180px",J.style.textDecoration="none",F(J),J}}),o.defineProperties(ms.prototype,{}),Rl(j,{accordionViewExpandIcon:ef(Hg),accordionViewCollapseIcon:ef(Hg,!0),accordionViewLabelColor:Ph,accordionViewLabelFont:Bk,accordionViewTitleBackground:Ai,accordionViewSelectBackground:tp,accordionViewSelectWidth:3,accordionViewSeparatorColor:p,splitViewDividerSize:1,splitViewDividerBackground:Ai,splitViewDragOpacity:.5,splitViewToggleIcon:{width:16,height:16,comps:[{type:pn,rect:[2,2,12,12],background:Hg}]},propertyViewLabelColor:aq,propertyViewLabelSelectColor:Ph,propertyViewLabelFont:Bk,propertyViewExpandIcon:ef(Eb),propertyViewCollapseIcon:ef(Eb,!0),propertyViewBackground:Bf,propertyViewRowLineVisible:!0,propertyViewColumnLineVisible:!0,propertyViewRowLineColor:Jk,propertyViewColumnLineColor:Jk,propertyViewSelectBackground:tp,listViewLabelColor:aq,listViewLabelSelectColor:Ph,listViewLabelFont:Bk,listViewRowLineVisible:!1,listViewRowLineColor:Jk,listViewSelectBackground:tp,treeViewLabelColor:aq,treeViewLabelSelectColor:Ph,treeViewLabelFont:Bk,treeViewExpandIcon:ef(Il),treeViewCollapseIcon:ef(Il,!0),treeViewRowLineVisible:!1,treeViewRowLineColor:Jk,treeViewSelectBackground:tp,treeViewDoubleClickToToggle:!0,tableViewLabelColor:aq,tableViewLabelSelectColor:Ph,tableViewLabelFont:Bk,tableViewRowLineVisible:!0,tableViewColumnLineVisible:!0,tableViewRowLineColor:Jk,tableViewColumnLineColor:Jk,tableViewSelectBackground:tp,treeTableViewLabelColor:aq,treeTableViewLabelSelectColor:Ph,treeTableViewLabelFont:Bk,treeTableViewExpandIcon:ef(Il),treeTableViewCollapseIcon:ef(Il,!0),treeTableViewRowLineVisible:!0,treeTableViewColumnLineVisible:!0,treeTableViewRowLineColor:Jk,treeTableViewColumnLineColor:Jk,treeTableViewSelectBackground:tp,tableHeaderLabelColor:aq,tableHeaderLabelFont:Bk,tableHeaderColumnLineVisible:!0,tableHeaderColumnLineColor:$d,tableHeaderBackground:Bf,tableHeaderMoveBackground:go,tableHeaderInsertColor:tp,tableHeaderSortDescIcon:pp(Eb,!0),tableHeaderSortAscIcon:pp(Eb),tabViewTabGap:1,tabViewLabelColor:Ph,tabViewLabelFont:Bk,tabViewTabBackground:Ai,tabViewSelectWidth:3,tabViewSelectBackground:tp,tabViewMoveBackground:go,tabViewInsertColor:tp,toolbarLabelColor:aq,toolbarLabelSelectColor:Ph,toolbarLabelFont:Bk,toolbarBackground:Bf,toolbarSelectBackground:tp,toolbarItemGap:8,toolbarSeparatorColor:xn},!0);var jp={translateX:1,sortColumn:1},Dn={sortable:1,sortOrder:1,sortFunc:1},sk={focusData:1},aj={dataModel:1,sortColumn:1,sortFunc:1,visibleFunc:1,rootData:1,rootVisible:1},xg={dataModel:1,sortFunc:1,visibleFunc:1,categorizable:1},zi=function(E,m){m.add(E),E.hasChildren()&&E.eachChild(function(J){zi(J,m)})},an=function(B,y,c,W,P,d,J,m,k,u,f){var g,v=c.getValueType(u),U=c.getAlign(u);if(c.getEnumValues(u)){var M=c.toEnumLabel(y,u),z=zh||0,A=0,_=d,Y=j.getTextSize(W,M).width;return g=dq(c.toEnumIcon(y,u)),g&&(A=d+zh/2,"center"===U?A+=(m-(z+Y))/2:"right"===U&&(A=A+m-(z+Y)),Oh(B,g,A,J+k/2,u,f),_=A+zh/2),M!=T&&(g?ko(B,M,W,P,_,J,m-(_-d),k):ko(B,M,W,P,d,J,m,k,U)),void 0}return y=c.formatValue(y),y!=T?v===sm?(eo(B,d,J,m,k,y),void 0):v===Gk||!v&&uc(y)?(g=dq(y?dm:vj),Oh(B,g,d+m/2,J+k/2,u,f),void 0):(ko(B,y,W,P,d,J,m,k,U),void 0):void 0},Ud=function(L,s){var e=s.view,H=Vb(L),h=s.column||s.property;e.getDataModel().beginTransaction(),s.editor=L,L.info=s,e.setCurrentEditor(L),e.getView().insertBefore(H,e._79O),yj(L,s.editorRect),L.setFocus?L.setFocus():Gf(L),L.commitValue=function(E,D){L._17Q&&(L=L._17Q),D||e.setValue(s.data,h,L.getValue?L.getValue():L.value),L.close&&L.close(),ss(H)
},h.onEditorCreated&&h.onEditorCreated(s)},ns=function(C,s,z,A,o){var G=zc(C,z),L=s.value,Q=s.view,c=o.getValueType(s.data);return G.onblur=G.onchange=function(){Q.endEditing()},"input"===C?(L=o.formatValue(L),L!=T&&(G.value=L),G.onkeydown=function(B){Cd(B)?Q.endEditing():Rd(B)&&Q.endEditing(!0)},(c===Zd||c===Ak)&&G.addEventListener(sf,j.numberListener,!1)):C===Pm&&A.forEach(function(X){var V=M.createElement("option");V.innerHTML=o.toEnumLabel(X),V.value=X,o.isEnumEqual(L,X)&&(V.selected=!0),Pb(G,V)}),Ud(G,s),G},dg=X.widget={},hj=function(q,V,H){gb(G+".widget."+q,V,H)};Rl(Vl,{ms_value:function(T){T.getValue=function(S){var g=this.getItemById(S),Q=g.element;return Td(Q)?Q:Q?Q.getValue?Q.getValue():Q.value:g.selected},T.setValue=function(X,$){var f=this.getItemById(X);if(f){var s=f.element;s&&!Td(s)?s.setValue?s.setValue($):s.value=$:uc($)?(f.selected=$,this.iv()):(f.element=$,this.iv())}},T.v=function(N,q){var f=this;if(2===arguments.length)f.setValue(N,q);else{if(!Tf(N))return f.getValue(N);for(var u in N)f.setValue(u,N[u])}return f}},_46o:function(j){j._icon=T,j._accessType=T,j._valueType=T,j._editable=!1,j._batchEditable=!0,j._align=ud,j._nullable=!0,j._emptiable=!1,j.setParent=cr,j.formatValue=function(y){var Z=this,N=Z._valueType;return Z.getEnumValues()?Z.toEnumLabel(y):N===Gk?!!y:y!=T&&N===Zd?_(y):y},j.setEnum=function(w,y,Y,$,f,g,N){var M=this;w&&!Lq(w)&&w.values&&($=w.editable,Y=w.icons,y=w.labels,f=w.strict,g=w.maxHeight,N=w.dropDownWidth,w=w.values),um(w)&&(w=w._as),um(y)&&(y=y._as),um(Y)&&(Y=Y._as),M._enumValues=w,M._enumLabels=y,M._enumIcons=Y,M._enumEditable=$,M._enumStrict=f==T?!0:f,M._enumMaxHeight=g,M._enumDropDownWidth=N,w&&w.length&&wi(w[0])&&(M._valueType=Ak),M.fp("enum",!1,!0)},j.getEnumDropDownWidth=function(){return this._enumDropDownWidth},j.getEnumMaxHeight=function(){return this._enumMaxHeight},j.isEnumEditable=function(){return this._enumEditable},j.getEnumValues=function(){return this._enumValues},j.getEnumLabels=function(){return this._enumLabels},j.getEnumIcons=function(){return this._enumIcons},j.isEnumStrict=function(){return this._enumStrict},j.isEnumEqual=function(o,D){return this._enumStrict?o===D:o==D},j.toEnumLabel=function(R,Z){var u=this,m=u.getEnumValues(Z),N=u.getEnumLabels(Z);if(m&&N)for(var b=0;b<m.length;b++)if(u.isEnumEqual(R,m[b]))return N[b];return R},j.toEnumIcon=function(f,k){var S=this,G=S.getEnumValues(k),o=S.getEnumIcons(k);if(G&&o)for(var r=0;r<G.length;r++)if(S.isEnumEqual(f,G[r]))return o[r];return p}},_45o:function(e){e._87o=function(Y,S,k,V,B,C){if(Y){var i=this,P=i._90I,v=rs(1);i._columnLineVisible&&(B-=1),i._rowLineVisible&&(C-=1),0>=B||0>=C||(i._90I||(P=i._90I={}),P[S]||(P[S]=new ep),yj(v,i.tx()+k,i.ty()+V,B,C),Pb(v,Y),i._view.insertBefore(v,i._79O),Y.onParentAdded&&Y.onParentAdded(v),P[S].add(v))}},e._76o=function(){var e=this,p=e._90I;if(p){for(var s in p)p[s].each(function($){ss($)});delete e._90I}},e._77o=function(X){var Q=this;if(Q._90I){var k=Q._90I[X];k&&(k.each(function(Q){ss(Q)}),delete Q._90I[X])}}},_47o:function(Y){Y.getValue=function(Z,r){return r.getValue?r.getValue(Z,r,this):Rn(Z,r.getAccessType(),r.getName())},Y.setValue=function(q,m,k){if(m.isEmptiable(q)||""!==k||(k=p),m.isNullable(q)||k!=T){var G=this,f=m.getName(q),n=m.getAccessType(q),P=m.getValueType(q);P===Zd&&Td(k)?k=O(k):P===Ak&&Td(k)?k=parseFloat(k):P===Gk&&Td(k)&&(k="true"===k),G._batchEditable&&m._batchEditable&&G.isSelected(q)?G.sm().each(function(M){m.setValue?m.setValue(M,m,k,G):pm(M,n,f,k)}):m.setValue?m.setValue(q,m,k,G):pm(q,n,f,k)}},Y.setCurrentEditor=function(p){this.endEditing(),this._currentEditor=p,this.redraw()},Y.isEditing=function(L,i){var y=this,Q=y._currentEditor;if(!Q)return!1;if(i){var x=Q.info;return x?(x.column||x.property)===i&&x.data===L:!1}return!0},Y.endEditing=function(_){var T=this,y=T._currentEditor;y&&(delete T._currentEditor,y.commitValue&&y.commitValue(y.info,_),T.redraw(),T.getDataModel().endTransaction())},Y.beginEditing=function(P){this.endEditing();var w=this,L=P.column||P.property;if(L.beginEditing)L.beginEditing(P);else{var c=P.data,Y=P.value,o=w.getSelectBackground(c),E=L.getEnumValues(c),N=L.getSlider(c),q=L.getColorPicker(c);if(N){var j=Fd(dg.Slider,N);return j.setValue(Y),j.getView().onblur=function(){w.endEditing()},j.isInstant()&&(j.onValueChanged=function(){w.setValue(c,L,j.getValue())}),Ud(j,P),void 0}if(q||L.getValueType(c)===sm){var Z=Fd(dg.ColorPicker,q);return Z.setValue(Y),Z.onClosed=function(){w.endEditing()},Z.isInstant()&&(Z.onValueChanged=function($,S){w.setValue(c,L,S)}),Ud(Z,P),Z.open(),void 0}if(E){if(dg.ComboBox){var C=new dg.ComboBox;C.setValue(Y),C.setValues(E),C.setLabels(L.getEnumLabels(c)),C.setIcons(L.getEnumIcons(c)),C.setEditable(L.isEnumEditable(c)),C.setStrict(L.isEnumStrict(c)),C.setMaxHeight(L.getEnumMaxHeight(c)),C.setDropDownWidth(L.getEnumDropDownWidth(c)),C.onClosed=function(){w.endEditing()},Ud(C,P),C.open()}else ns(Pm,P,o,E,L);return}var J=L.getValueType(c);if(J===Gk||uc(Y))return w.setValue(c,L,!Y),void 0;if(L.getItemEditor(c)){var S=nb(L.getItemEditor(c)),z=new S(c,L,w,P),Q=z.getView();return Q._17Q=z,z.setValue(Y),yl(Q),Ud(Q,P),z.editBeginning&&z.editBeginning(),void 0}ns("input",P,o,T,L)}}},_44o:function(Y){Y.init=function(S){var F=this,t=F.th=new Fn(S),w=F._view=tm(1,F);F.tv=F._tableView=S,Pb(w,t.getView()),Pb(w,S.getView()),t.mp(function(o){o.property===Zf&&F.iv()}),F.iv()},Y.getTableView=function(){return this.tv},Y.getTableHeader=function(){return this.th},Y.getDataModel=function(){return this.tv.dm()},Y.getColumnModel=function(){return this.tv.getColumnModel()},Y.setColumns=function(d){this.tv.setColumns(d)},Y.addColumns=function(h){this.tv.addColumns(h)},Y.endEditing=function(){this.tv.endEditing()},Y.validateImpl=function(){var g=this,L=g.th,U=Zg(L),T={x:0,y:0,width:g.getWidth(),height:U};yj(L,T),T.y=U,T.height=x(0,g.getHeight()-U),yj(g.tv,T)}},ms_vs:function(U){U._41o=function(){return this._29I.height<this._59I},U._43o=function(){var j=this;j._41o()&&(j._58I||(e(function(){j._94O()},Uj),j.iv()),j._58I=new Date)},U._94O=function(){var l=this;if(l._58I){var R=new Date;R.getTime()-l._58I.getTime()>=Uj?(delete l._58I,l.iv()):e(function(){l._94O()},Uj)}},U._93I=function(){var e=this,F=e._27I;if(e._58I||!e._autoHideScrollBar){F||Pb(e._79O,F=e._27I=rs());var U=e._29I,m=U.height,B=e._59I,k=e.getScrollBarSize(),j=U.width-k-2,p=m*(-e.ty()/B),a=m*(m/B),W=F.style;B>m?(mf>a&&(p=p+a/2-mf/2,0>p&&(p=0),p+mf>m&&(p=m-mf),a=mf),W.visibility=Sp,W.background=e.getScrollBarColor(),W.borderRadius=k/2+Gj,yj(F,j,p,k,a)):W.visibility=Qp}else F&&(F.style.visibility=Qp)}},ms_hs:function(m){m._40o=function(){return this._29I.width<this._91I},m._42o=function(){var t=this;t._40o()&&(t._95O||(e(function(){t._94I()},Uj),t.iv()),t._95O=new Date)},m._94I=function(){var a=this;if(a._95O){var M=new Date;M.getTime()-a._95O.getTime()>=Uj?(delete a._95O,a.iv()):e(function(){a._94I()},Uj)}},m._92I=function(){var u=this,l=u._28I;if(u._95O||!u._autoHideScrollBar){l||Pb(u._79O,l=u._28I=rs());var J=u._29I,B=J.width,_=u._91I,F=u.getScrollBarSize(),h=J.height-F-2,v=B*(-u.tx()/_),W=B*(B/_),R=l.style;_>B?(mf>W&&(v=v+W/2-mf/2,0>v&&(v=0),v+mf>B&&(v=B-mf),W=mf),R.visibility=Sp,R.background=u.getScrollBarColor(),R.borderRadius=F/2+Gj,yj(l,v,h,W,F)):R.visibility=Qp}else l&&(l.style.visibility=Qp)}}}),Yk(dm,On(16,16,[{type:Lj,rect:[1,1,14,14],background:tp},{type:Yf,rect:[1,1,14,14],width:1,color:Wj},{type:Gg,points:[13,3,7,12,4,8],borderWidth:2,borderColor:"#FFF"}])),Yk(vj,On(16,16,{type:Yf,rect:[1,1,14,14],width:1,color:Wj})),Yk(So,On(16,16,[{type:yb,rect:[2,2,12,12],borderWidth:1,borderColor:Wj,background:"#FFF"},{type:yb,rect:[4,4,8,8],background:tp}])),Yk(Sh,On(16,16,{type:yb,rect:[2,2,12,12],borderWidth:1,borderColor:Wj})),Vl._15Q=function($){$._29I=_n,$._59I=0,$._91I=0,$._5o=function(K){var Z=this;Z._30I=new ep,Z._rows=new ep,Z._rowMap={},Z._31I=0,Z._14I=0,Z._view=tm(1,Z),Z._canvas=im(Z._view),Pb(Z._view,Z._79O=rs()),Z.dm(K?K:new ih)},$.getCheckIcon=function(i){var l=this.sm(),Y=l.co(i);return l.sg()?dq(Y?So:Sh):dq(Y?dm:vj)},$.checkData=function(Z){var V=this.sm(),s=V.co(Z);V.sg()&&s||(this._32o=1,s?V.rs(Z):V.as(Z),delete this._32o)},$.getDataAt=function(u){u.target&&(u=this.lp(u));var k=I(u.y/this._rowHeight),e=this._rows;return 0>k||k>=e.size()?T:e.get(k)},$.onDataDoubleClicked=function(){},$.onDataClicked=function(){},$.adjustTranslateX=function(){return 0},$.adjustTranslateY=function(e){var O=this.getHeight()-this._59I;return O>e&&(e=O),e>0?0:_(e)},$.onPropertyChanged=function(J){var O=this,l=J.property;aj[l]?O.ivm():sk[l]||O.redraw(),l===Fp?O._42o():l===Qi&&O._43o()},$.getLabel=function(r){return r.toLabel()},$.getLabelFont=function(){return this._labelFont},$.getLabelColor=function(m){var _=this;if(_.isCheckMode()){if(_._focusData===m)return _._labelSelectColor}else if(_.isSelected(m))return _._labelSelectColor;return _._labelColor},$.getStartRowIndex=function(){return this._31I},$.getEndRowIndex=function(){return this._14I},$.getRowDatas=function(){return this._rows},$.getRowIndex=function(V){return this._rowMap[V._id]},$.getRowSize=function(){return this._rows.size()},$.getViewRect=function(){return tq(this._29I)},$.isVisible=function(l){return this._visibleFunc?this._visibleFunc(l):!0},$.getCurrentSortFunc=function(){return this._sortFunc},$.setDataModel=function(f){var j=this,S=j._dataModel,V=j._selectionModel;S!==f&&(S&&(S.umm(j.handleDataModelChange,j),S.umd(j.handleDataPropertyChange,j),S.umh(j.handleHierarchyChange,j),V||S.sm().ums(j.handleSelectionChange,j)),j._dataModel=f,f.mm(j.handleDataModelChange,j),f.md(j.handleDataPropertyChange,j),f.mh(j.handleHierarchyChange,j),V?V._21I(f):f.sm().ms(j.handleSelectionChange,j),j.fp("dataModel",S,f))},$.validateModel=function(){var K=this;K._rows.clear(),K._rowMap={},K.buildChildren(K._dataModel._roots);var s=K._rows=K._rows.toList(K.isVisible,K),y=0,Z=K.getCurrentSortFunc(),N=s.size();for(Z&&s.sort(Z);N>y;y++)K._rowMap[s.get(y)._id]=y},$.buildChildren=function(Y){var I=this;Y.each(function(b){I._rows.add(b),I.buildChildren(b._children)})},$.handleDataModelChange=function(){this.ivm()},$.handleDataPropertyChange=function(e){"parent"===e.property?this.ivm():this.invalidateData(e.data)},$.handleHierarchyChange=function(){this.ivm()},$.handleSelectionChange=function(b){b.datas.each(this.invalidateData,this),this.onSelectionChanged(b)},$.onSelectionChanged=function(g){var H=this,i=H.sm();!H.isAutoMakeVisible()||1!==i.size()||"set"!==g.kind&&"append"!==g.kind||H._32o||H.makeVisible(i.ld())},$.handleBackgroundClick=function(t){Mf(t)&&!this.isCheckMode()&&this.sm().cs()},$.makeVisible=function(X){X&&(this._23I=X,this.iv())},$.scrollToIndex=function(T){var A=this,Q=A._29I,K=Q.height,s=A._rowHeight,r=s*T;T>=0&&T<A._rows.size()&&K>0&&(r+s>Q.y+K?A.ty(-r+K-s):r<Q.y&&A.ty(-r))},$.autoScroll=function(z,W){var M=this,f=M._rowHeight,w=f,g=f/4,H=M._29I,h=M.lp(z),r={x:M.tx(),y:M.ty()};return f>0&&H&&(h.x-H.x<w?M.translate(g,0):H.x+H.width-h.x<w&&M.translate(-g,0),h.y-H.y<w?M.translate(0,g):H.y+H.height-h.y<w&&M.translate(0,-g)),r.x=M.tx()-r.x,r.y=M.ty()-r.y,W&&(W.x+=r.x,W.y+=r.y),r},$.getTopRowOrderSelection=function(){var U=this.sm().getTopSelection(),r={},i=new ep;return U.each(function(b){r[b._id]=b}),this._rows.each(function(D){r[D._id]&&i.add(D)}),i},$.getRowOrderSelection=function(){var N=new ep;return this._rows.each(function(G){this.isSelected(G)&&N.add(G)},this),N},$.ivm=function(){this.invalidateModel()},$.invalidateModel=function(){var B=this;B._96I||(B._96I=1,B._32I=1,delete B._24I),B.iv()},$.redraw=function(){var L=this;L._32I||(L._32I=1,delete L._24I,L.iv())},$.invalidateData=function(R){var O=this;t?O.redraw():O._32I||(O._24I||(O._24I={}),O._24I[R._id]=R,O.iv())},$.getFocusData=function(){return this._focusData},$.setFocusDataById=function(Q){this.setFocusData(this.dm().getDataById(Q))},$.setFocusData=function(d){var G=this,V=G._focusData;V!==d&&(G._focusData=d,G.fp("focusData",V,d),V&&G.invalidateData(V),d&&(G.invalidateData(d),G.isAutoMakeVisible()&&G.makeVisible(d)))},$.drawRowBackground=function(Q,f,q,l,$,R,L){var V=this,p=V.isCheckMode();(f===V._focusData&&p||q&&!p)&&eo(Q,l,$,R,L,V.getSelectBackground(f))},$.drawData=function(Z,f,a){var i=this,q=i._rowHeight,w=q*a,G=i._29I,_=G.x,u=G.width;Z.save(),Z.beginPath(),Z.rect(_,w,u,q),Z.clip(),i._87o(i.drawRow(Z,f,i.isSelected(f),_,w,u,q),a,_,w,u,q),Z.restore(),i._rowLineVisible&&eo(Z,_,w+q-1,u,1,i._rowLineColor)},$._12I=function(N){var Q=this,z=Q._31I,L=Q._29I,l=L.x,M=L.y,y=L.width,S=L.height;for(N.beginPath(),N.rect(l,M,y,S),N.clip(),N.clearRect(l,M,y,S),Q._76o(),Q._93db(N);z<Q._14I;z++)Q.drawData(N,Q._rows.get(z),z);Q._92db(N)},$._13I=function(B){for(var V,q=this,o=q._rowHeight,k=q._29I,E=k.x,b=k.width,S=q._31I,K=q._30I;S<q._14I;S++)V=q._rows.get(S),q._24I[V._id]&&K.add({data:V,index:S});K.isEmpty()||(B.beginPath(),K.each(function(P){B.rect(E,P.index*o,b,o)}),B.clip(),K.each(function(D){B.clearRect(E,D.index*o,b,o)}),K.each(function(m){q._77o(m.index)}),q._93db(B),K.each(function(f){q.drawData(B,f.data,f.index)}),q._92db(B),K.clear())},$.validateImpl=function(){var $=this,y=$._canvas,j=$.getWidth(),b=$.getHeight(),Q=$._rowHeight,v=$._32I;(j!==y.clientWidth||b!==y.clientHeight)&&(Df(y,j,b),v=1);var U=V&&!W;$._96I&&!U&&$.validateModel();var X=$._29I,m={x:-$.tx(),y:-$.ty(),width:j,height:b},F=$._rows.size(),f=nd(y),e=$._23I;v||es(m,X)||(v=1),$._29I=m,$._59I=F*Q,$._31I=I(m.y/Q),$._14I=D((m.y+m.height)/Q),$._31I<0&&($._31I=0),$._14I>F&&($._14I=F),$._99I&&v&&$._99I(),vb(f,$.tx(),$.ty(),1),v?$._12I(f):$._24I&&$._13I(f),$._93I(),$._92I(),f.restore(),$._32I=$._24I=$._96I=T,e&&($.scrollToIndex($.getRowIndex(e)),delete $._23I),$.tx($.tx()),$.ty($.ty())}},Vl._48o=function(k){k._rootVisible=!0,k._rootData=T,k._35o=function(){this._expandMap={},this._levelMap={}},k.validateModel=function(){var Q=this,$=Q._rootData;Q._rows.clear(),Q._levelMap={},Q._rowMap={},Q._currentLevel=0,$?Q._rootVisible?Q.isVisible($)&&Q.buildData($):Q.buildChildren($):Q.buildChildren(),delete Q._currentLevel},k.buildData=function(g){var d=this,i=g._id,M=d._rows;d._rowMap[i]=M.size(),M.add(g),d._levelMap[i]=d._currentLevel,d.isExpanded(g)&&(d._currentLevel++,d.buildChildren(g),d._currentLevel--)},k.buildChildren=function(r){var I=this,N=r?r._children:I._dataModel._roots,Y=I.getCurrentSortFunc();Y&&I.isChildrenSortable(r)?N.toList(I.isVisible,I).sort(Y).each(I.buildData,I):N.each(function(U){I.isVisible(U)&&I.buildData(U)})},k.getLevel=function(X){return this._levelMap[X._id]},k.getToggleIcon=function(o){var z=this,c=z._loader,u=z._collapseIcon;return c&&!c.isLoaded(o)?u:o.hasChildren()?z.isExpanded(o)?z._expandIcon:u:T},k.isCheckMode=function(){return this._checkMode!=T},k.isChildrenSortable=function(){return!0},k.handleDataModelChange=function(I){var r=this;I.kind===ym?delete r._expandMap[I.data._id]:I.kind===Sb&&(r._expandMap={}),r.ivm()},k.toggle=function(r){var C=this;C.isExpanded(r)?C.collapse(r):C.expand(r)},k.isExpanded=function(S){return 1===this._expandMap[S._id]},k.expand=function(W){var y=this,A=y._loader;y.isExpanded(W)||(A&&!A.isLoaded(W)&&A.load(W),y._expandMap[W._id]=1,y.ivm(),y.onExpanded(W))},k.onExpanded=function(){},k.collapse=function(l){var Z=this;Z.isExpanded(l)&&(delete Z._expandMap[l._id],Z.ivm(),Z.onCollapsed(l))},k.onCollapsed=function(){},k.expandAll=function(v){if(v)this.expand(v),v.eachChild(function(V){this.expandAll(V)},this);else{var H=this;H._dataModel.each(function(F){F.hasChildren()&&(H._expandMap[F._id]=1)}),H.ivm()}},k.collapseAll=function(){this._expandMap={},this.ivm()},k.makeVisible=function(t){if(t){var r=this;if(!r._rootData||t.isDescendantOf(r._rootData)){for(var T=t._parent;T;)r.expand(T),T=T._parent;r._23I=t,r.iv()}}},k.checkData=function(d){var s,u=this,H=u._checkMode,r=u.sm(),z=r.co(d);if(!r.sg()||!z){if(u._32o=1,H===ce)z?r.rs(d):r.as(d);else if(H===Eq)s=new ep(d),s.addAll(d._children);else if("descendant"===H)s=new ep,zi(d,s);else if("all"===H&&(s=new ep,zi(d,s),!z))for(var G=d._parent;G;)s.add(G),G=G._parent;s&&(z?r.rs(s):r.as(s)),delete u._32o}},k._97I=function(D,_,c,e,R,b,g){var F=this,l=F._indent,Y=F._levelMap[_._id],j=F.getIconWidth(_),Z=dq(F.getToggleIcon(_));Z?(e+=l*Y,Oh(D,Z,e+l/2,R+g/2,_,F),e+=l):e+=l*(Y+1),F._checkMode&&(Oh(D,F.getCheckIcon(_),e+l/2,R+g/2,_,F),e+=l),F.drawIcon(D,_,e,R,j,g),F.drawLabel(D,_,e+j,R,g)}},Vl._14Q=function(M){M.getIcon=function(j){return j.getIcon()},M.getIconWidth=function(g){return this.getIcon(g)?this._indent:0},M.drawIcon=function(E,d,s,c,A,n){if(A){var y=this,f=y.getBodyColor(d),e=dq(y.getIcon(d),f);e&&(n-=y.isRowLineVisible()?1:0,hh(E,e,Gm,s,c,A,n,d,y,f),Jd(E,y.getBorderColor(d),s,c,A,n))}},M.drawLabel=function(t,M,d,Y,_){var E=this;ko(t,E.getLabel(M),E.getLabelFont(M),E.getLabelColor(M),d,Y,0,_)}},Vl._50o=function(N){N._98I=function(){var j=this,x=j._39o=new ih;j._60I=new ep,x.mm(j._17o,j),x.md(j._18o,j),x.mh(j._19o,j)},N.setColumns=function(u){this._39o.clear(),this.addColumns(u)},N.addColumns=function(i){var R=this._39o;i.forEach(function(G){if(!(G instanceof mj)){var y=nb(G.className);G=Fd(y?y:mj,G)}R.add(G)})},N.onColumnClicked=function(){},N.onCheckColumnClicked=function(){},N._3Q=function(y){for(var F,p=0,a=this._60I,$=a.size();$>p;p++)if(F=a.get(p),F.column===y)return F;return T},N.getColumnAt=function(F){var _=this._4Q(F);return _?_.column:T},N._4Q=function(A){for(var f=this,n=A.target?f.lp(A).x:A.x,U=f._60I,w=0;w<U.size();w++){var C=U.get(w),p=C.startX;if(n>=p&&n<p+C.column.getWidth())return C}return T},N.getToolTip=function(F){var t=this,x=t.getDataAt(F),C=t.getColumnAt(F);return x&&C?C.getToolTip(x,t):T},N.adjustTranslateX=function(r){var e=this.getWidth()-this._91I;return e>r&&(r=e),r>0?0:_(r)},N._99I=function(){var q=this,f=q._29I,I=q._60I;I.clear(),q._91I=0,q._39o._roots.each(function(M){if(M.isVisible()){var G=q._91I+M.getWidth();q._91I<=f.x+f.width&&G>=f.x&&I.add({column:M,startX:q._91I}),q._91I=G}})},N.drawData=function(B,S,E){var d=this,I=d._rowHeight,q=I*E,Q=d.isSelected(S),g=d._29I,x=g.x,u=g.width;d.drawRowBackground(B,S,Q,x,q,u,I),d._60I.each(function(f){var k=f.column,m=f.startX,K=k.getWidth();K>0&&!d.isEditing(S,k)&&(B.save(),B.beginPath(),B.rect(m,q,K,I),B.clip(),d._87o(d.drawCell(B,S,Q,k,m,q,K,I),E,m,q,K,I),d._columnLineVisible&&eo(B,m+K-1,q,1,I,d._columnLineColor),B.restore())}),d._rowLineVisible&&eo(B,x,q+I-1,u,1,d._rowLineColor)},N.drawCell=function($,e,E,N,I,l,y,P){var k=this;if(N.drawCell)return N.drawCell($,e,E,N,I,l,y,P,k);var p=k.getValue(e,N);an($,p,N,k.getLabelFont(e,N,p),k.getLabelColor(e,N,p),I,l,y,P,e,k)},N.getColumnModel=function(){return this._39o},N._17o=function(){this.redraw()},N._18o=function(O){var y=this;O.data===y._sortColumn&&Dn[O.property]?y.ivm():(y._42o(),y.redraw())},N._19o=function(){this.redraw()},N.getCurrentSortFunc=function(){var G=this,K=G._sortColumn;if(K&&K.isSortable()){var t=K.getSortFunc(),J=qc===K.getSortOrder()?1:-1;return t||(t=vq),function(B,f){return t.call(G,G.getValue(B,K),G.getValue(f,K),B,f)*J}}return G._sortFunc},N.isCellEditable=function(x,u,g){return(!this.isCheckMode()&&this.isSelected(x)||this.isCheckMode()&&x===this._focusData)&&u.isEditable()&&this.isEditable()?u.isCellEditable?u.isCellEditable(x,u,g,this):!0:!1},N._37O=function(T,U){if(Mf(U))for(var B=this,N=B.lp(U),V=B._60I,S=B._rowHeight,C=B._29I,$=C.x,z=C.y,D=C.width,e=C.height,Y=0;Y<V.size();Y++){var P=V.get(Y),p=P.startX,A=P.column,l=A.getWidth();if(A!==B._31o&&A!==B._4o&&N.x>=p&&N.x<p+l&&B.isCellEditable(T,A,U)){var i={x:p,y:B.getRowIndex(T)*S,width:l,height:S},b={x:i.x+B.tx(),y:i.y+B.ty(),width:i.width,height:i.height},j=0,y=0;return i.x<$?j=i.x-$:i.x+i.width>$+D&&(j=i.x+i.width-$-D),j&&(B.tx(B.tx()-j),b.x-=j),i.y<z?y=i.y-z:i.y+S>z+e&&(y=i.y+S-z-e),y&&(B.ty(B.ty()-y),b.y-=y),B.beginEditing({data:T,column:A,value:B.getValue(T,A),event:U,rect:i,editorRect:b,view:B}),void 0}}}},dg.BaseItemEditor=function(G,p,X,h){this._data=G,this._column=p,this._master=X,this._editInfo=h},hj("BaseItemEditor",o,{ms_ac:["data","column","master","editInfo"],editBeginning:function(){},getView:function(){},getValue:function(){},setValue:function(){}});var zl=X.Tab=function(){fk(zl,this)};zq("Tab",Vk,{ms_ac:["view","closable","disabled"],_icon:T,_closable:!1,_disabled:!1,setParent:cr});var mj=X.Column=function(){fk(mj,this)};zq("Column",Vk,{_46o:1,ms_ac:["accessType","valueType",Sp,kd,yr,Pn,"align",sm,"sortOrder",Ad,"sortable","clickable","nullable","emptiable","slider","colorPicker","itemEditor"],_visible:!0,_width:80,_sortOrder:qc,_sortFunc:T,_sortable:!0,_clickable:!0,setWidth:function(k){16>k&&(k=16);var u=this._width;this._width=k,this.fp(Pn,u,k)},getToolTip:function(f,r){return this.formatValue(r.getValue(f,this))}});var Fk=X.Property=function(){fk(Fk,this)};zq("Property",Vk,{_46o:1,ms_ac:["accessType","valueType",kd,yr,"categoryName",sm,"align","nullable","emptiable","slider","itemEditor","colorPicker"],_categoryName:T,getToolTip:function(Z,v,T){var n=this;return v?n.formatValue(T.getValue(Z,n)):T.getPropertyName(n)}}),dg.AccordionView=function(){var K=this;K._20o={},K._21o=new ep,K._10o=T,K._9o=T,K._11o=T,K._view=tm(0,K),K.iv()},hj("AccordionView",o,{ms_v:1,ms_fire:1,ms_ac:[Vh,Dq,"titleHeight",Ar,Wm,"titleBackground","selectWidth",ak,"orientation","separatorColor"],_expandIcon:j.accordionViewExpandIcon,_collapseIcon:j.accordionViewCollapseIcon,_titleHeight:lr,_labelColor:j.accordionViewLabelColor,_labelFont:j.accordionViewLabelFont,_titleBackground:j.accordionViewTitleBackground,_selectBackground:j.accordionViewSelectBackground,_selectWidth:j.accordionViewSelectWidth,_orientation:"v",_separatorColor:j.accordionViewSeparatorColor,onPropertyChanged:function(){this.iv()},getView:function(){return this._view},getTitles:function(){return this._21o},getCurrentTitle:function(){return this._10o},add:function(m,z,V,w){var S=this,B=rs();if(S._20o[m])throw m+" already exists";B.onmousedown=Gp,B.style.cursor=Jr,B.addEventListener(Rp?Dr:Uq,function(l){Gp(l)},!1),B.addEventListener(Rp?Hc:mi,function(v){Gp(v),Mf(v)&&(S._10o===m?S.collapse():S.expand(m))},!1),Pb(S._view,B),S._20o[m]={content:z,div:B,canvas:im(B),icon:w},S._21o.add(m),V&&S.expand(m),S.iv()},remove:function(T){var I=this,P=I._20o[T];P&&(ss(P.div),delete I._20o[T],I._21o.remove(T),I.iv())},clear:function(){var J=this;J._20o={},J._21o.clear(),J.iv()},isExpanded:function(n){return this._10o===n},expand:function(Q){var m=this;m._20o[Q]&&m._10o!==Q&&(m._10o=Q,m.onExpanded(Q),m.iv())},onExpanded:function(){},collapse:function(){var U=this;U._10o&&(U.onCollapsed(U._10o),delete U._10o,U.iv())},onCollapsed:function(){},initCanvas:function(W,q,i){Df(W,q,i);var E=nd(W);return vb(E,0,0,1),E.clearRect(0,0,q,i),E},drawTitle:function(D,M,K,s,Z){var U=this,L=dq(Z.icon),O=U.isExpanded(M),G=U._titleHeight,g=U._titleBackground,S=U._selectWidth,d=U._separatorColor,a=dq(O?U._expandIcon:U._collapseIcon),n=S+4;eo(D,0,0,K,s,g),O&&S&&eo(D,0,0,S,s,U._selectBackground),(O||U._21o.get(U._21o.size()-1)!==M)&&eo(D,0,s-1,K,1,d?d:ac(g)),L&&(Oh(D,L,n+mc(L)/2,G/2),n+=mc(L)+2),ko(D,M,U.getLabelFont(M),U.getLabelColor(M),n,0,0,G),a&&Oh(D,a,K-mc(a)/2-4,G/2)},validateImpl:function(){var r=this,P=r._view,v=0,T=0,d=r.getWidth(),k=r.getHeight(),w=r._titleHeight,t=r._21o.size()*w,X=r._11o,S=r._9o;delete r._11o,delete r._9o,r._21o.each(function(q){var K,m,H=r._20o[q],e=H.content,l=r._10o===q;fd(r)?(yj(H.div,v,0,w,k),K=r.initCanvas(H.canvas,w,k),Pc(K,0,k),js(K,-f),r.drawTitle(K,q,k,w,H),K.restore(),l?(m=x(0,d-t),e&&(r._11o=e,r._9o=Vb(e),yj(e,v+w,0,m,k)),v+=w+m):v+=w):(yj(H.div,0,T,d,w),K=r.initCanvas(H.canvas,d,w),r.drawTitle(K,q,d,w,H),K.restore(),l?(m=x(0,k-t),e&&(r._11o=e,r._9o=Vb(e),yj(e,0,T+w,d,m)),T+=w+m):T+=w)});var J=r._9o;X&&X!==r._11o&&X.endEditing&&X.endEditing(),J&&J!==S&&Pb(P,J),S&&S!==J&&ss(S)}}),dg.SplitView=function(F,a,x,j){var u=this,A=u._dividerDiv=rs(),d=u._60O=im(),w=u._61O=im(),X=d.style,M=w.style;u._view=tm(1,u),Pb(u._view,A),X.msTouchAction=Ag,X.pointerEvents=Ag,X.cursor=Jr,M.msTouchAction=Ag,M.pointerEvents=Ag,M.cursor=Jr,F&&u.setLeftView(F),a&&u.setRightView(a),x&&u.setOrientation(x),j!=T&&u.setPosition(j),u.setStatus($e),new Jl(u)},hj("SplitView",o,{ms_v:1,ms_fire:1,ms_ac:["continuousLayout","dividerSize","dividerBackground","toggleIcon","togglable","dragOpacity","orientation","draggable","status"],_continuousLayout:!1,_position:.5,_togglable:!0,_orientation:"h",_draggable:!0,_dividerSize:j.splitViewDividerSize,_dividerBackground:j.splitViewDividerBackground,_dragOpacity:j.splitViewDragOpacity,_toggleIcon:j.splitViewToggleIcon,onPropertyChanged:function(){this.iv()},getDividerDiv:function(){return this._dividerDiv},getPosition:function(){return this._position},setPosition:function(E,W){var $=this,r=$._position;isNaN(E)||(W||($._82O=0>E?-1:E>1?1:0),$._position=E,$.fp(Qo,r,E))},getLeftView:function(){return this._leftView},setLeftView:function(g){var i=this,c=i._leftView,O=i._view;if(i._leftView!==g){if(c&&c!==i._rightView){var U=Vb(c);U.parentNode===O&&ss(U)}if(i._leftView=g,g){var v=Vb(g);v.parentNode!==O&&O.insertBefore(v,i._dividerDiv)}i.fp("leftView",c,g)}},getRightView:function(){return this._rightView},setRightView:function(P){var S=this,p=S._rightView,k=S._view;if(S._rightView!==P){if(p&&p!==S._leftView){var $=Vb(p);$.parentNode===k&&ss($)}if(S._rightView=P,P){var A=Vb(P);A.parentNode!==k&&k.insertBefore(A,S._dividerDiv)}S.fp("rightView",p,P)}},validateImpl:function(){var n=this,j=n._draggable,m=n._position,G=n.getWidth(),M=n.getHeight(),F=n._dividerSize,Z=n._dividerBackground,g=Rp?18:8,y=n._dividerDiv,q=n._82O,C=n._60O,R=n._61O,J=n._toggleIcon,b=n._status,c=y.style,E=null,k=Rp?20:4,L=J.comps[0];F>=g||0===F?n._coverDiv&&(ss(n._coverDiv),delete n._coverDiv):n._coverDiv||(n._coverDiv=rs(),w&&(n._coverDiv.style.background=Zj),Pb(y,n._coverDiv)),n._togglable?C.parentNode||(Pb(y,C),Pb(y,R)):(ss(C),ss(R));var z=n._coverDiv,$=n._leftView,U=n._rightView;if(fd(n)){if(F>G&&(F=G),b===$e)if(1===q)var s=d(m,G),P=x(0,G-F-s);else-1===q?(P=d(-m,G),s=x(0,G-F-P)):(s=_((G-F)*m),P=x(0,G-F-s));else"cl"===b?(s=0,P=x(0,G-F)):"cr"===b&&(P=0,s=x(0,G-F));$&&yj($,0,0,s,M),U&&yj(U,s+F,0,P,M),yj(y,s,0,F,M),n._22o=s,z&&(yj(z,F/2-g/2,0,g,M),z.style.cursor=j?pq:""),y.style.cursor=j?pq:"";var N=y.clientHeight/2,V=y.clientWidth;Df(C,V,V),yj(C,0,N-V-k,V,V),E=nd(C),vb(E,0,0,1),L.rotation=-f,$f(E,J,0,0,V,V),E.restore(),Df(R,V,V),yj(R,0,N+k,V,V),E=nd(R),vb(E,0,0,1),L.rotation=f,$f(E,J,0,0,V,V),E.restore()}else{if(F>M&&(F=M),b===$e)if(1===q)var O=d(m,M),t=x(0,M-F-O);else-1===q?(t=d(-m,M),O=x(0,M-F-t)):(O=_((M-F)*m),t=x(0,M-F-O));else"cl"===b?(O=0,t=x(0,M-F)):"cr"===b&&(t=0,O=x(0,M-F));$&&yj($,0,0,G,O),U&&yj(U,0,O+F,G,t),yj(y,0,O,G,F),n._22o=O,z&&(yj(z,0,F/2-g/2,G,g),z.style.cursor=j?Re:""),c.cursor=j?Re:"";var D=y.clientWidth/2,V=y.clientHeight;Df(C,V,V),yj(C,D-V-k,0,V,V),E=nd(C),vb(E,0,0,1),L.rotation=0,$f(E,J,0,0,V,V),E.restore(),Df(R,V,V),yj(R,D+k,0,V,V),E=nd(R),vb(E,0,0,1),L.rotation=B,$f(E,J,0,0,V,V),E.restore()}c.background=Z}});var Jl=function(X){this.sv=X,this.addListeners()};gb(Jl,o,{ms_listener:1,getView:function(){return this.sv.getView()},handle_touchstart:function(b){var h=this,u=h.sv,i=u._dividerDiv,G=u._60O,v=u._61O,x=u._status,A=b.target;if(A===G)x===$e?u.setStatus("cl"):"cr"===x&&u.setStatus($e);else if(A===v)x===$e?u.setStatus("cr"):"cl"===x&&u.setStatus($e);else if($b(b)&&(A===i||A===u._coverDiv)&&(Gp(b),u.isDraggable())){u.getLeftView(),u.getRightView();var _=h.maskDiv=rs();if(_.style.left=0,_.style.top=0,_.style.width=u.getWidth()+"px",_.style.height=u.getHeight()+"px",u.getView().appendChild(_),!u.isContinuousLayout()){var Z=h.resizeDiv=rs();Z.style.left=i.style.left,Z.style.top=i.style.top,Z.style.width=i.style.width,Z.style.height=i.style.height,Z.style.opacity=u.getDragOpacity(),Z.style.background=u.getDividerBackground(),Pb(h.getView(),Z)}h._lastAbsPosition=u._22o,h._86o=fd(u)?yq(b).x:yq(b).y,rf(h,b)}},handleWindowTouchMove:function(V){$b(V)&&this.update(V,this.sv.isContinuousLayout())},handleWindowTouchEnd:function(S){var Z=this;Z.update(S,!0),Z.sv.setStatus($e),Z.maskDiv&&ss(Z.maskDiv),Z.resizeDiv&&ss(Z.resizeDiv),Z.maskDiv=Z.resizeDiv=T},handle_mousedown:function(a){Mf(a)&&this.handle_touchstart(a)},handleWindowMouseMove:function(n){this.handleWindowTouchMove(n)},handleWindowMouseUp:function(p){this.handleWindowTouchEnd(p)},update:function(t,V){var F=this,w=F.sv,q=fd(w)?w.getWidth():w.getHeight(),R=w._dividerSize,p=F._lastAbsPosition-F._86o;fd(w)?(p+=yq(t).x,p>q-R&&(p=q-R),0>p&&(p=0),F.resizeDiv&&(F.resizeDiv.style.left=p+Gj)):(p+=yq(t).y,p>q-R&&(p=q-R),0>p&&(p=0),F.resizeDiv&&(F.resizeDiv.style.top=p+Gj)),V&&q!==R&&(1===w._82O?w.setPosition(p,1):-1===w._82O?w.setPosition(p-q+R,1):w.setPosition(p/(q-R),1))}}),dg.TabView=function(){var L=this,n=L._view=tm(1,L),G=L._91O=rs(1),N=L._tabModel=new ih,z=N.sm(),T=L.invalidate;L._7o=new ep,L._canvas=im(G),Pb(n,G),Pb(n,L._92O=rs(1)),z.setSelectionMode(Hm),z.ms(T,L),N.mm(T,L),N.md(T,L),N.mh(T,L),new Jm(L),L.iv()},hj("TabView",o,{ms_v:1,ms_fire:1,ms_tx:1,ms_ty:1,ms_lp:1,ms_ac:["movable","tabGap","tabHeight","tabPosition",Ar,Wm,"tabBackground","selectWidth",ak,"moveBackground","insertColor"],_tabPosition:ob,_tabHeight:lr,_tabGap:j.tabViewTabGap,_labelColor:j.tabViewLabelColor,_labelFont:j.tabViewLabelFont,_tabBackground:j.tabViewTabBackground,_selectWidth:j.tabViewSelectWidth,_selectBackground:j.tabViewSelectBackground,_moveBackground:j.tabViewMoveBackground,_insertColor:j.tabViewInsertColor,_movable:!0,getContentDiv:function(){return this._92O},getTitleDiv:function(){return this._91O},getTabModel:function(){return this._tabModel},add:function(N,y,B){var o=new zl,S=this._tabModel;return o.setName(N),o.setView(y),S.add(o),B&&S.sm().ss(o),o},getLabel:function(R){return R.toLabel()},onPropertyChanged:function(){this.iv()},_7Q:function(R){this._23o=R,this.iv()},get:function(f){var n=this,W=n._tabModel;if(wi(f))return W._roots.get(f);if(Td(f)){var h;return W.each(function(S){f===n.getLabel(S)&&(h=S)}),h}return f instanceof zl?f:T},select:function(N){this._tabModel.sm().ss(this.get(N))},remove:function(c){var i=this;if(c=i.get(c)){var k=i._tabModel,B=k._roots.indexOf(c);i._tabModel.remove(c),i._12Q(--B)}},getCurrentTab:function(){return this._8o},hideTabView:function(X,F){F.parentNode===this._92O&&(Zh(F)?(F.style.display=$r,F._tab_=X):ss(F),Tp())},showTabView:function(r,X){Zh(X)&&(X.style.display="block",X._tab_=r),X.parentNode!==this._92O&&(Pb(this._92O,X),Tp())},_24o:function(){var r,t=this,Z=t._8o,s=t._9o,L=t._tabModel.sm().ld();L&&(r=Vb(L.getView())),r!==s&&(s&&(Z.getView()&&Z.getView().endEditing&&Z.getView().endEditing(),t.hideTabView(Z,s)),r&&t.showTabView(L,r)),t._8o=L,t._9o=r,Z!==L&&t.onTabChanged(Z,L)},onTabClosing:function(){return!0},onTabChanged:function(){},onTabClosed:function(h,e){this._12Q(--e)},_12Q:function(I){var X=this,m=X._tabModel,v=m.size();if(v&&!m.sm().ld()){I==T&&(I=0),I>=v&&(I=v-1),0>I&&(I=0);for(var G=I;G>=0;G--){var b=X.get(G);if(!b.isDisabled())return X.select(b),b}for(G=I+1;v>G;G++)if(b=X.get(G),!b.isDisabled())return X.select(b),b}},getTabWidth:function(D){var b=4,_=dq(D.getIcon());_&&(b+=mc(_,D)+4);var U=this.getLabel(D);return U&&(b+=Ql(this.getLabelFont(D),U).width+4),D.isClosable()&&(b+=10),b},drawTab:function(y,C,w,N,I,l,q){var K,d=this,V=d._tabPosition,k=w+4,H=d._selectWidth,U=dq(C.getIcon()),F=C.isDisabled(),m=d.getLabelColor(C),s=d.getLabelFont(C),W=d.getLabel(C),r=d._selectBackground,E=V===ud+"-vertical",X=V===Ij+"-vertical";(E||X)&&(k=N+4),F&&(y.globalAlpha=Vj),eo(y,w,N,I,l,q),C===d._8o&&H&&(V===ob?eo(y,w,N+l-H,I,H,r):V===ud?eo(y,w+I-H,N,H,l,r):V===Ij?eo(y,w,N,H,l,r):E?eo(y,w+I-H,N,H,l,r):X?eo(y,w,N,H,l,r):eo(y,w,N,I,H,r));var Q=I/2;if(E&&(Pc(y,Q,N+l/2),js(y,B),Pc(y,-Q,-N-l/2)),U){var R=lh(U,C),c=mc(U,C);if(E||X){var O=w+I/2,i=k+R/2;Pc(y,O,i),js(y,f),Pc(y,-O,-i),Oh(y,U,w+I/2,k+R/2,C,d),Pc(y,O,i),js(y,-f),Pc(y,-O,-i),k+=R+4}else Oh(y,U,k+c/2,N+l/2,C,d),k+=c+4}return E||X?(Pc(y,I/2,k+I/2),js(y,f),Pc(y,-I/2,-k-I/2),ko(y,W,s,m,w,k,l,I),Pc(y,I/2,k+I/2),js(y,-f),Pc(y,-I/2,-k-I/2)):ko(y,W,s,m,k,N,I,l),E&&(Pc(y,Q,N+l/2),js(y,-B),Pc(y,-Q,-N-l/2)),C.isClosable()&&(K=X?{x:w+I-12,y:N+l-12,width:12,height:12}:{x:w+I-12,y:N+2,width:12,height:12},this.drawCloseIcon(C,y,m,K)),F&&(y.globalAlpha=1),K
},drawCloseIcon:function(D,A,d,X){var Y=X.x,W=X.y;A.strokeStyle=d,A.lineWidth=1,A.beginPath(),A.moveTo(Y+2,W+8),A.lineTo(Y+8,W+2),A.moveTo(Y+8,W+8),A.lineTo(Y+2,W+2),A.stroke()},validateImpl:function(){var S=this;S._24o();var K,M=S._canvas,G=S._tabPosition,d=S._91O,B=S._92O,b=S._tabModel,F=S.getWidth(),P=S.getHeight(),V=S._tabHeight,k=S._7o,v=S._tabGap,$=G===ob,R=G===ud,A=G===Ij,c=G===ud+"-vertical",W=G===Ij+"-vertical",I=S._23o,g=0;if((R||A)&&b._roots.each(function(J){g=x(S.getTabWidth(J),g)}),$?(yj(d,0,0,F,V),K={x:0,y:V,width:F,height:x(0,P-V)}):R?(yj(d,0,0,g,P),K={x:g,y:0,width:x(0,F-g),height:P}):A?(yj(d,F-g,0,g,P),K={x:0,y:0,width:x(0,F-g),height:P}):c?(yj(d,0,0,V,P),K={x:V,y:0,width:x(0,F-V),height:P}):W?(yj(d,F-V,0,V,P),K={x:0,y:0,width:x(0,F-V),height:P}):(yj(d,0,P-V,F,V),K={x:0,y:0,width:F,height:x(0,P-V)}),yj(B,K),c||W){S._9o&&(K.x=0,yj(S._8o.getView(),K)),Df(M,V,P);var m=nd(M),q=0;if(vb(m,0,S.ty(),1),m.clearRect(0,0,V,P),k.clear(),b._roots.each(function(H){var O,N=S.getTabWidth(H);I&&I.tab===H||(O=S.drawTab(m,H,0,q,V,N,S._tabBackground)),k.add({_75o:O,tab:H,startY:q,endY:q+N,height:N}),q+=N+v}),S._23Q=x(0,q-v),I){var f=I.position;S.drawTab(m,I.tab,0,I.startY,V,I.height,S._moveBackground),eo(m,0,f,V,1,S._insertColor)}m.restore(),S.ty(S.ty())}else if(R||A){S._9o&&(K.x=0,yj(S._8o.getView(),K)),Df(M,g,P);var m=nd(M),q=0;if(vb(m,0,S.ty(),1),m.clearRect(0,0,g,P),k.clear(),b._roots.each(function(M){var x;I&&I.tab===M||(x=S.drawTab(m,M,0,q,g,V,S._tabBackground)),k.add({_75o:x,tab:M,startY:q,endY:q+V,height:V}),q+=V+v}),S._23Q=x(0,q-v),I){var f=I.position;S.drawTab(m,I.tab,0,I.startY,g,I.height,S._moveBackground),eo(m,0,f,g,1,S._insertColor)}m.restore(),S.ty(S.ty())}else{S._9o&&(K.y=0,yj(S._8o.getView(),K)),Df(M,F,V);var m=nd(M),L=0;if(vb(m,S.tx(),0,1),m.clearRect(0,0,F,V),k.clear(),b._roots.each(function(y){var N,M=S.getTabWidth(y);I&&I.tab===y||(N=S.drawTab(m,y,L,0,M,V,S._tabBackground)),k.add({_75o:N,tab:y,startX:L,endX:L+M,width:M}),L+=M+v}),S._64I=x(0,L-v),I){var f=I.position;S.drawTab(m,I.tab,I.startX,0,I.width,V,S._moveBackground),Vr(m,S._insertColor,f,0,V)}m.restore(),S.tx(S.tx())}for(var Y=[],E=B.children,h=0;h<E.length;h++){var z=E[h],t=z._tab_;t&&!b.contains(t)&&Y.push(z)}Y.forEach(function(i){B.removeChild(i)})}});var Jm=function(u){this.tv=u,this.addListeners()};gb(Jm,o,{ms_listener:1,getView:function(){return this.tv._91O},handle_mousewheel:function(C){this.handleScroll(C,10*(C.wheelDelta/40))},handle_DOMMouseScroll:function(j){this.handleScroll(j,10*-j.detail)},handleScroll:function(P,m){Gp(P);var e=this.tv,I=e._tabPosition;!e._40o()||I!==ob&&I!==fi||e.tx(this.tv.tx()+m),!e._41o()||I!==ud&&I!==Ij&&I!==ud+"-vertical"&&I!==Ij+"-vertical"||e.ty(this.tv.ty()+m)},_8Q:function(w){var a,W,g=this.tv,u=g._tabPosition,A=g._7o;if(u===ob||u===fi){var X=g.lp(w).x;for(a=0;a<A.size();a++)if(W=A.get(a),W.startX<=X&&X<=W.endX)return W}else if(u===ud||u===Ij||u===ud+"-vertical"||u===Ij+"-vertical"){var S=g.lp(w).y;for(a=0;a<A.size();a++)if(W=A.get(a),W.startY<=S&&S<=W.endY)return W}return T},isClickable:function(d){var C=this.tv,S=C._tabPosition,V=this._73o=this._8Q(d);return!C._40o()||S!==ob&&S!==fi?!C._41o()||S!==ud&&S!==Ij&&S!==ud+"-vertical"&&S!==Ij+"-vertical"?V&&(!V.tab.isDisabled()||C.isMovable()):!0:!0},handle_mousemove:function(I){var M=this;Zk?M._74o=M._8Q(I):M.getView().style.cursor=M.isClickable(I)?Jr:""},handle_mousedown:function(I){this.handle_mousemove(I),this.handle_touchstart(I)},handle_touchstart:function(n){var P=this,Y=P.tv,t=Y._tabPosition;Gp(n),Mf(n)&&P.isClickable(n)&&(t===ob||t===fi?(P.x=yq(n).x,P.lp=Y.lp(n),P.tx=Y.tx()):(P.y=yq(n).y,P.lp=Y.lp(n),P.ty=Y.ty()),rf(P,n))},handleWindowMouseMove:function(c){this.handleWindowTouchMove(c)},handleWindowTouchMove:function(h){var s,p=this,m=p.tv,a=m._tabPosition,E=p._73o;if(a===ob||a===fi){if(s=yq(h).x-p.x,!p._25o&&!p.moving&&J(s)>2&&(m._40o()&&!Jf(h)?p._25o=1:E&&m.isMovable()&&(p.moving=1)),p._25o)m.tx(p.tx+s);else if(p.moving){var j=p.lp.x+s,g=m._tabGap/2;m._7o.each(function(c){var o=c.endX,R=j-c.startX<o-j;j>=c.startX&&o>=j&&m._7Q({tab:E.tab,startX:E.startX+s,width:E.width,front:R,insertTab:c.tab,position:R?x(0,c.startX-g):d(m._64I,o+g)})})}}else if(s=yq(h).y-p.y,!p._25o&&!p.moving&&J(s)>2&&(m._41o()&&!Jf(h)?p._25o=1:E&&m.isMovable()&&(p.moving=1)),p._25o)m.ty(p.ty+s);else if(p.moving){var F=p.lp.y+s,g=m._tabGap/2;m._7o.each(function(D){var P=D.endY,o=F-D.startY<P-F;F>=D.startY&&P>=F&&m._7Q({tab:E.tab,startY:E.startY+s,height:E.height,front:o,insertTab:D.tab,position:o?x(0,D.startY-g):d(m._23Q,P+g)})})}},handleWindowMouseUp:function(G){this.handleWindowTouchEnd(G)},handleWindowTouchEnd:function(){var h=this,I=h.tv,$=I._tabPosition,_=I.getTabModel(),u=_._roots,P=h._73o;if(h.moving){var i=I._23o;if(i&&i.insertTab!==i.tab){var R=i.tab,g=u.remove(R),j=u.indexOf(i.insertTab);j>=0&&(i.front||j++,j<=u.size()&&(u.add(R,j),_._38I(R,g,j)))}I._7Q(T),delete h.moving}else if(!h._25o&&P){R=P.tab;var d=h._74o;if(!d||d.tab===R)if(!R.isDisabled()&&Co(P._75o,h.lp)){var K=function(){var r=u.indexOf(R);_.remove(R),I.onTabClosed(R,r)};I.onTabClosing(R,K)&&K()}else R.isDisabled()||I._8o===R||_.sm().ss(R)}h._25o=h._73o=h._74o=$===ob||$===fi?h.x=h.lp=h.tx=T:h.y=h.lp=h.ty=T}}),dg.PropertyView=function(r){var q=this;q._view=tm(1,q),q._canvas=im(q._view),Pb(q._view,q._79O=rs()),q._rows=new ep,q._28o=new ep,q._26o={},q._26Q={};var E=q._propertyModel=new ih,V=q.ivm;E.mm(V,q),E.md(V,q),E.mh(V,q),q.dm(r?r:new ih),new nm(q)},hj("PropertyView",o,{ms_ac:[Ar,ae,Wm,kd,yr,"categorizable",Bl,Ad,Vo,Vh,Dq,Li,Iq,di,"selectRowIndex",ak,"background",Lr,Qj,rg,Mh,rq],ms_v:1,ms_dm:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,_45o:1,_47o:1,ms_tip:1,_29I:_n,_59I:0,_9I:0,_selectRowIndex:-1,_editable:!0,_batchEditable:!0,_categorizable:!0,_indent:zh,_background:j.propertyViewBackground,_expandIcon:j.propertyViewExpandIcon,_collapseIcon:j.propertyViewCollapseIcon,_scrollBarColor:Pe,_scrollBarSize:cg,_autoHideScrollBar:Lf,_selectBackground:j.propertyViewSelectBackground,_rowHeight:Ye,_rowLineVisible:j.propertyViewRowLineVisible,_rowLineColor:j.propertyViewRowLineColor,_10I:.5,_columnLineVisible:j.propertyViewColumnLineVisible,_columnLineColor:j.propertyViewColumnLineColor,_labelColor:j.propertyViewLabelColor,_labelSelectColor:j.propertyViewLabelSelectColor,_labelFont:j.propertyViewLabelFont,getRows:function(){return this._rows},getColumnPosition:function(){return this._10I},setColumnPosition:function(L){0>L&&(L=0),L>1&&(L=1);var V=this,u=V._10I;V._10I=L,V.fp("columnPosition",u,L)},getPropertyName:function(a){return a.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(l,W,J){return J===this._selectRowIndex?this._labelSelectColor:this._labelColor},getPropertyFont:function(){return this._labelFont},getPropertyColor:function(y,F){return F===this._selectRowIndex?this._labelSelectColor:y.getColor()||this._labelColor},getCategoryFont:function(){return this._labelFont},getCategoryColor:function(){return this._labelColor},adjustTranslateX:function(){return 0},adjustTranslateY:function(D){var e=this.getHeight()-this._59I;return e>D&&(D=e),D>0?0:_(D)},isExpanded:function(E){if(!E)return!0;var M=this._26o[E];return M?M.isExpanded:!(this._26Q[E]===!1)},toggle:function(h){var n=this;n.isExpanded(h)?n.collapse(h):n.expand(h)},expandAll:function(){this.validate();for(var E in this._26o)this.expand(E)},expand:function(X){if(X&&X!==$r){var A=this,Q=A._26o[X];Q&&!Q.isExpanded&&(Q.isExpanded=!0,A.onExpanded(X),A.ivm())}},onExpanded:function(){},collapseAll:function(){this.validate();for(var l in this._26o)this.collapse(l)},collapse:function(W){if(W&&W!==$r){var N=this,B=N._26o[W];B&&B.isExpanded&&(B.isExpanded=!1,N.onCollapsed(W),N.ivm())}},onCollapsed:function(){},getCategoryName:function(k){if(!this.isCategorizable())return $r;var c=k.getCategoryName();return c?c:$r},getPropertyModel:function(){return this._propertyModel},handleSelectionChange:function(){this.ivm()},setDataModel:function(O){var $=this,s=$._dataModel;s!==O&&(s&&(s.umd($.handlePropertyChange,$),$._selectionModel||s.sm().ums($.handleSelectionChange,$)),$._dataModel=O,O.md($.handlePropertyChange,$),$._selectionModel?$._selectionModel._21I(O):O.sm().ms($.handleSelectionChange,$),$.fp(Uo,s,O))},isVisible:function(P){return this._visibleFunc?this._visibleFunc(P):!0},onPropertyChanged:function(w){var f=this,s=w.property;xg[s]?f.ivm():f.iv(),s===Qi&&f._43o()},getCurrentData:function(){return this._27o},updateCurrentData:function(){this._27o=this.sm().ld()},getRawProperties:function(){return this._27o?this._propertyModel._roots:_c},handlePropertyChange:function(i){this._27o===i.data&&this.iv()},ivm:function(){this.invalidateModel()},invalidateModel:function(){var v=this;v._96I||(v.setSelectRowIndex(-1),v._96I=1,v.iv())},redraw:function(){this.iv()},validateModel:function(){var N=this,j=N._rows,C=N._28o,b={},H=new ep,B=N._27o;N.updateCurrentData(),B!==N._27o&&N.endEditing(),j.clear(),C.clear(),N.getRawProperties().each(function(j){if(N.isVisible(j)){H.add(j);var M=N.getCategoryName(j);b[M]||(C.add(M,M===$r?0:p),b[M]={isExpanded:N.isExpanded(M),properties:new ep})}}),N._sortFunc&&H.sort(N._sortFunc);for(var k in N._26o)N._26Q[k]=N.isExpanded(k);N._26o=b,C.each(function(m){m!==$r&&j.add(m);var O=b[m];O.isExpanded&&H.each(function(M){N.getCategoryName(M)===m&&(O.properties.add(M),j.add({property:M,data:N._27o}))},N)})},validateImpl:function(){var u=this;u._76o(),u._96I&&(u.validateModel(),delete u._96I);var k=u._canvas,U=u.getWidth(),s=u.getHeight(),n=-u.ty(),l=u._rowHeight,j=u._indent,t=U-j,g=u._rows,Q=g.size(),f=u._9I=j+t*u._10I,F=u._59I=Q*l;Df(k,U,s),u._29I={x:0,y:n,width:U,height:s},u._31I=I(n/l),u._14I=D((n+s)/l),u._31I<0&&(u._31I=0),u._14I>Q&&(u._14I=Q);var m,x=nd(k),K=u._background;vb(x,0,-n,1),x.beginPath(),x.rect(0,n,U,s),x.clip(),x.clearRect(0,n,U,s),u._93db(x),K&&eo(x,0,0,j,F,K);for(var c=u._31I;c<u._14I;c++){var q=g.get(c),n=l*c;if(Td(q))K&&eo(x,j,n,t,l,K),m=dq(u.isExpanded(q)?u._expandIcon:u._collapseIcon),m&&hh(x,m,Gm,0,n,j,l),x.save(),x.beginPath(),x.rect(j,n,t,l),x.clip(),u.drawCategoryName(x,q,c,j,n,t,l),x.restore();else{var Y=q.property,h=q.data,m=dq(Y.getIcon()),E=u._selectRowIndex===c?u.getSelectBackground():T;if(m&&hh(x,m,Gm,0,n,j,l),E&&eo(x,j,n,t,l,E),x.save(),x.beginPath(),x.rect(j,n,f-j,l),x.clip(),u.drawPropertyName(x,Y,c,j,n,f-j,l),x.restore(),!u.isEditing(h,Y)){var B=f+1,y=U-f-1;x.save(),x.beginPath(),x.rect(B,n,y,l),x.clip(),u._87o(u.drawPropertyValue(x,Y,u.getValue(h,Y),c,B,n,y,l,h),c,B,n,y,l),x.restore()}}u._rowLineVisible&&eo(x,j,n+l-1,t,1,u._rowLineColor)}u._columnLineVisible&&(eo(x,f,0,1,F,u._columnLineColor),eo(x,U-1,0,1,F)),u._92db(x),u._93I(),x.restore(),u.ty(u.ty())},drawCategoryName:function(u,$,W,e,V,D,j){ko(u,$,this.getCategoryFont($),this.getCategoryColor($),e,V,D,j)},drawPropertyName:function(B,q,u,D,h,K,R){return q.drawPropertyName?(q.drawPropertyName(B,q,u,D,h,K,R,this),void 0):(ko(B,this.getPropertyName(q),this.getPropertyFont(q,u),this.getPropertyColor(q,u),D,h,K,R),void 0)},drawPropertyValue:function(u,S,v,P,x,W,R,E,X){return S.drawPropertyValue?S.drawPropertyValue(u,S,v,P,x,W,R,E,X,this):(an(u,v,S,this.getLabelFont(S,v,P),this.getLabelColor(S,v,P),x,W,R,E,X,this),void 0)},isPropertyEditable:function(A){return A.isEditable()&&this.isEditable()},setProperties:function(r){this._propertyModel.clear(),this.addProperties(r)},addProperties:function(W){if(W){var g=this._propertyModel;W.forEach(function(B){if(!(B instanceof Fk)){var E=nb(B.className);B=Fd(E?E:Fk,B)}g.add(B)})}},getRowIndexAt:function(c){var V=this,u=I(V.lp(c).y/V._rowHeight);return u>=0&&u<V._rows.size()?u:-1},getPropertyAt:function(e){var g=this,c=g.getRowIndexAt(e);return c>=0?g._rows.get(c).property:T},getToolTip:function(m){var h=this,w=h.getPropertyAt(m),H=h._27o;return w&&H?w.getToolTip(H,h._9I<h.lp(m).x,h):T}});var nm=function(g){this.pv=g,this.addListeners()};gb(nm,o,{ms_listener:1,getView:function(){return this.pv._view},setCursor:function(L){this.getView().style.cursor=L},clear:function(){var g=this;g._62O=g.cp=g.ty=g.p=T,g.setCursor(ce)},handle_mousedown:function(R){this.handle_touchstart(R)},handle_touchstart:function(m){var A=this,X=A.pv;Gp(m),X.setFocus(m)&&(Mf(m)?(A.cp=yq(m),A.ty=X.ty(),A.p=X.getColumnPosition(),A.handle_touchmove(m)):X.setSelectRowIndex(X.getRowIndexAt(m)))},handleWindowMouseUp:function(){this.clear()},handleWindowTouchEnd:function(){this.clear()},handle_mouseup:function(r){this.handle_touchend(r)},handle_touchend:function(c){var _=this;if(_.cp&&!_._62O){var R=_.pv,K=R.lp(c),U=K.x,T=K.y,O=R._indent,y=R.getRowIndexAt(c),Y=R._9I;if(y>=0){var S=R._rowHeight,m=S*y,s=R._rows.get(y),V=s.property;if(Td(s))dq(R.isExpanded(s)?R._expandIcon:R._collapseIcon)&&U>=0&&O>=U&&T>=m&&m+S>=T?R.toggle(s):Lg(c)&&R.toggle(s);else if(U>Y&&R.isPropertyEditable(V,c)){var Q={x:Y+1,y:m,width:R.getWidth()-Y-1,height:S},l={x:Q.x+R.tx(),y:Q.y+R.ty(),width:Q.width,height:Q.height},t=0,F=R._29I;Q.y<F.y?t=Q.y-F.y:Q.y+S>F.y+F.height&&(t=Q.y+S-F.y-F.height),t&&(R.ty(R.ty()-t),l.y-=t),R.beginEditing({data:s.data,property:V,value:R.getValue(s.data,V),event:c,rect:Q,editorRect:l,view:R})}}R.setSelectRowIndex(y)}_.clear()},handleWindowMouseMove:function(L){this.handleWindowTouchMove(L)},handleWindowTouchMove:function(v){var B=this,Q=B.pv,n=B.ty,t=B.cp,i=yq(v),I=B._62O;if("p"===I)Q.setTranslateY(n+i.y-t.y);else if("c"===I){var w=Q.getWidth()-Q._indent;if(w>16){var P=B.p-(t.x-i.x)/w,o=16/w;o>P&&(P=o),P>1-o&&(P=1-o),Q.setColumnPosition(P)}}else"s"===I&&Q.setTranslateY(n+(t.y-i.y)*Q._59I/Q._29I.height)},handle_mousemove:function(G){this.handle_touchmove(G)},handle_touchmove:function(s){if(!Zk&&Mf(s)){var $=this,N=$.pv,T=J(N.lp(s).x-N._9I)<=(Rp?8:3);$.cp?$._62O||(T?($._62O="c",rf($)):J(yq(s).y-$.cp.y)>=2&&($._62O=$.isV(s)?"s":"p",rf($))):(T?$.setCursor(pq):$.setCursor(ce),$.isV(s)&&N._43o())}},isV:function(B){var n=this.pv,D=n._29I;return n._41o()&&D.x+D.width-n.lp(B).x<Pr},handle_mousewheel:function(I){this.handleScroll(I,I.wheelDelta/40)},handle_DOMMouseScroll:function(h){2===h.axis&&this.handleScroll(h,-h.detail)},handleScroll:function(c,H){var i=this.pv;Gp(c),i.endEditing(),i.translate(0,H*i.getRowHeight())},handle_keydown:function(I){var y=this.pv,k=y._rows.size(),h=y._selectRowIndex+(ig(I)?-1:1);(ig(I)||We(I))&&(0>h&&(h=0),h>=k&&(h=k-1),y.setSelectRowIndex(h))}}),dg.ListView=function(O){this._5o(O),new Wi(this)},hj("ListView",o,{ms_ac:[Ar,ae,Wm,Lr,Bl,Qj,rg,Ad,Vo,Li,Iq,di,ri,ak],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,_14Q:1,ms_dm:1,_45o:1,_checkMode:!1,_indent:zh,_rowHeight:Ye,_rowLineVisible:j.listViewRowLineVisible,_rowLineColor:j.listViewRowLineColor,_scrollBarColor:Pe,_scrollBarSize:cg,_autoMakeVisible:sl,_autoHideScrollBar:Lf,_selectBackground:j.listViewSelectBackground,_labelColor:j.listViewLabelColor,_labelSelectColor:j.listViewLabelSelectColor,_labelFont:j.listViewLabelFont,isCheckMode:function(){return this._checkMode},setCheckMode:function(P){var R=this,p=R._checkMode;R._checkMode=P,R.fp(ui,p,P)},drawRow:function(F,D,L,o,d,O,q){var $=this,p=0,Q=$._indent,U=$.getIconWidth(D);$.drawRowBackground(F,D,L,o,d,O,q),$._checkMode&&(Oh(F,dq($.getCheckIcon(D)),p+Q/2,d+q/2,D,$),p+=Q),$.drawIcon(F,D,p,d,U,q),$.drawLabel(F,D,p+U,d,q)}});var Wi=function(p){this.list=p,this._lastSelectDataTime=hk(),this.addListeners()};gb(Wi,o,{ms_listener:1,getView:function(){return this.list._view},clear:function(y){var h=this,J=h.list;y&&"d"===h._62O&&!h.dragCancel&&J.handleDragAndDrop(y,"end"),J.draggingData&&(J.draggingData=null,J.redraw()),h.dragCancel=h._62O=h._isV=h._isH=h.cp=h.tx=h.ty=T},handle_mousedown:function(u){this.handle_touchstart(u)},handle_touchstart:function(z){var O=this,m=O.list;if(Gp(z),m.setFocus(z)){var l=m.getDataAt(z);O.cp=yq(z),O.tx=m.tx(),O.ty=m.ty(),Mf(z)?l&&m.handleDragAndDrop&&!O.isV(z)&&!O.isH(z)&&(m.draggingData=l,m.redraw(),m.handleDragAndDrop(z,"prepare")):(l&&O._33o(z,l),O.clear(z))}},handleWindowMouseUp:function(A){this.clear(A)},handleWindowTouchEnd:function(q){this.clear(q)},handle_mouseup:function(c){this.handle_touchend(c)},handle_touchend:function(i){var y=this,v=y.list;if(!y._isV&&!y._isH&&y.cp&&!y._62O){var s=v.getDataAt(i);s?(v.isCheckMode()?y._34o(i,s):y._33o(i,s),Lg(i)?v.onDataDoubleClicked(s,i):v.onDataClicked(s,i)):v.handleBackgroundClick(i)}y.clear(i)},handleWindowMouseMove:function(G){this.handleWindowTouchMove(G)},handleWindowTouchMove:function(W){var H=this,O=H.list,z=H._62O,A=H.tx,C=H.ty,n=H.cp,k=yq(W),j=O._29I;"p"===z?O.setTranslate(A+k.x-n.x,C+k.y-n.y):"v"===z?O.ty(C+(n.y-k.y)*O._59I/j.height):"h"===z?O.tx(A+(n.x-k.x)*O._91I/j.width):"d"===z&&(H.dragCancel||O.handleDragAndDrop(W,"between"))},handle_mousemove:function(l){this.handle_touchmove(l)},handle_touchmove:function(p){if(!Zk&&Mf(p)){var d=this,l=d.list;if(d._isV=d.isV(p),d._isH=d.isH(p),d.cp){if(!d._62O){if(de(yq(p),d.cp)<2)return;d._isV?d._62O="v":d._isH?d._62O="h":l.draggingData&&!this.dragCancel?(d._62O="d",l.handleDragAndDrop(p,"begin")):d._62O="p",d._62O&&"d"!==d._62O&&l.draggingData&&(l.draggingData=null,l.redraw()),rf(d)}}else d._isV&&l._43o(),d._isH&&l._42o()}},isV:function(G){var Q=this.list,k=Q._29I;return Q._41o()&&k.x+k.width-Q.lp(G).x<Pr},isH:function(r){var X=this.list,e=X._29I;return X._40o()&&e.y+e.height-X.lp(r).y<Pr},handle_mousewheel:function(I){this.handleScroll(I,I.wheelDelta/40,I.wheelDelta!==I.wheelDeltaX)},handle_DOMMouseScroll:function(q){this.handleScroll(q,-q.detail,1)},handleScroll:function(B,o,V){var S=this.list;Gp(B),S.endEditing&&S.endEditing(),V&&S._41o()?S.translate(0,o*S.getRowHeight()):S._40o()&&S.translate(10*o,0)},handle_keydown:function(L){if(!j.isInput(L.target)){var u,G=this.list,F=G.sm(),$=G._rows,i=$.size();if(mq(L))G.selectAll();else if(vc(L))G.handleDelete&&G.handleDelete(L);else if(Rd(L))"d"!==this._62O||this.dragCancel||(G.handleDragAndDrop(L,"cancel"),this.dragCancel=!0);else if(ir(L))G.isCheckMode()&&(u=G.getFocusData(),u&&G.checkData(u));else if(ig(L)||We(L)){var n=G.isCheckMode();if(u=n?G.getFocusData():F.ld()){var C=G.getRowIndex(u);C>=0&&(ig(L)?0!==C&&(u=$.get(C-1),n?G.setFocusData(u):F.ss(u)):C!==i-1&&(u=$.get(C+1),n?G.setFocusData(u):F.ss(u)))}else i>0&&(u=$.get(0),n?G.setFocusData(u):F.ss(u))}}},_34o:function(p,N){var l=this.list,h=l.lp(p).x;return h>=0&&h<=l._indent?(l.checkData(N),void 0):(l.setFocusData(N),void 0)},_33o:function(m,b){var B=this.list,Q=B.sm(),W=Q.ld();if(Jf(m))B.isSelected(b)?Q.rs(b):Q.as(b);else if(wc(m))if(W)for(var i=B.getRowIndex(W),c=B.getRowIndex(b);i!==c;)i+=c>i?1:-1,Q.as(B._rows.get(i));else Q.ss(b);else if(Mf(m)){var U=hk();if(Q.contains(b)){var y=U-this._lastSelectDataTime;B.handleDataDoubleSelect&&y>500&&1500>y&&B.handleDataDoubleSelect(m,b)}Q.ss(b),this._lastSelectDataTime=U}else Q.contains(b)||Q.ss(b)}}),dg.TreeView=function(t){var w=this;w._35o(),w._5o(t),new Jp(w)},hj("TreeView",o,{ms_ac:[Ar,ae,Wm,"rootVisible",ui,"rootData",Ad,Vo,Li,Iq,di,Bl,Lr,Qj,rg,Vh,Dq,ri,ak,"loader","doubleClickToToggle"],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,_48o:1,_14Q:1,_45o:1,_checkMode:T,_indent:zh,_rowHeight:Ye,_rowLineVisible:j.treeViewRowLineVisible,_rowLineColor:j.treeViewRowLineColor,_scrollBarColor:Pe,_scrollBarSize:cg,_autoHideScrollBar:Lf,_expandIcon:j.treeViewExpandIcon,_collapseIcon:j.treeViewCollapseIcon,_autoMakeVisible:sl,_selectBackground:j.treeViewSelectBackground,_labelColor:j.treeViewLabelColor,_labelSelectColor:j.treeViewLabelSelectColor,_labelFont:j.treeViewLabelFont,_doubleClickToToggle:j.treeViewDoubleClickToToggle,drawRow:function(h,f,U,q,T,Q,P){var F=this;F.drawRowBackground(h,f,U,q,T,Q,P),F._97I(h,f,U,0,T,Q,P)},isOnToggleIcon:function(G){var T=this.getDataAt(G);if(T){var Y=this.getIndent(),S=this.lp(G).x;if(dq(this.getToggleIcon(T))){var A=Y*this.getLevel(T);if(S>=A&&A+Y>=S)return!0}}return!1}});var Jp=function(M){fk(Jp,this,[M])};gb(Jp,Wi,{toggle:function(i,y,f,M){var x=this.list,e=x.lp(i).x;if(dq(x.getToggleIcon(y))){var p=f*M;if(e>=p&&p+f>=e)return x.toggle(y),!0}return x.isDoubleClickToToggle()&&Lg(i)?(x.toggle(y),!0):!1},_34o:function(P,J){var F=this.list,K=F.lp(P).x,I=F._levelMap[J._id],x=F._indent,o=x*(I+1);return K>=o&&o+x>=K?(F.checkData(J),void 0):(this.toggle(P,J,x,I)||F.setFocusData(J),void 0)},_33o:function(O,M){var I=this,W=I.list;I.toggle(O,M,W._indent,W.getLevel(M))||Jp.superClass._33o.call(I,O,M)},handle_keydown:function(K){if(Ip(K)||Xk(K)){var j=this.list,o=j._rows,W=j.isCheckMode(),M=j.sm(),g=W?j.getFocusData():M.ld();g?g.hasChildren()&&(Ip(K)?j.collapse(g):j.expand(g)):o.size()>0&&(g=o.get(0),W?j.setFocusData(g):M.ss(g))}else Jp.superClass.handle_keydown.call(this,K)}});var Nj=dg.TableView=function(Q){this._98I(),this._5o(Q),new ml(this)};hj("TableView",o,{ms_ac:[Ar,ae,Wm,"sortMode",kd,yr,Lr,Qj,rg,Mh,rq,"sortColumn",Ad,Vo,Li,Iq,di,ri,ak],ms_v:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_45o:1,_47o:1,_sortMode:Uh,_editable:!0,_batchEditable:!1,_rowHeight:Ye,_rowLineVisible:j.tableViewRowLineVisible,_rowLineColor:j.tableViewRowLineColor,_columnLineVisible:j.tableViewColumnLineVisible,_columnLineColor:j.tableViewColumnLineColor,_scrollBarColor:Pe,_scrollBarSize:cg,_autoHideScrollBar:Lf,_autoMakeVisible:sl,_selectBackground:j.tableViewSelectBackground,_labelColor:j.tableViewLabelColor,_labelSelectColor:j.tableViewLabelSelectColor,_labelFont:j.tableViewLabelFont,getCheckColumn:function(){var $=this;if(!$._31o){var k=$._31o=new mj;k.setEditable(!0),k.setWidth(40),k.getValue=$.getCheckColumValue,k.drawCell=$.drawCheckColumnCell}return $._31o},isCheckMode:function(){return this._39o.contains(this._31o)},setCheckMode:function(P){var j=this,n=j._39o,I=j.getCheckColumn();P!==j.isCheckMode()&&(P?n.add(I,0):n.remove(I),j.fp(ui,!P,P))},getCheckColumValue:function(b,s,i){return i.isSelected(b)},drawCheckColumnCell:function(g,q,i,z,V,C,Z,c,t){Oh(g,t.getCheckIcon(q),V+Z/2,C+c/2,q,t)}});var ml=function(q){fk(ml,this,[q])};gb(ml,Wi,{_34o:function(k,t){var b=this.list,f=b._31o;if(b.isCellEditable(t,f,k)){var j=b._3Q(f),F=b.lp(k).x;if(j&&F>=j.startX&&F<j.startX+f.getWidth())return b.checkData(t),void 0}b._37O(t,k),b.setFocusData(t)},_33o:function(y,Y){this.list._37O(Y,y),ml.superClass._33o.apply(this,arguments)}});var Pq=dg.TreeTableView=function(Y){var $=this,R=$._4o=new mj;$._35o(),$._98I(),$._5o(Y),R.setDisplayName("Name"),R.setEditable(!0),R.setWidth(180),R.drawCell=Ji,R.getValue=Mb,$._39o.add(R),new Pg($)},Ji=function(F,G,P,O,v,X,B,E,k){k._97I(F,G,P,v,X,B,E)},Mb=function(X,$,l){return l.getLabel(X)};hj("TreeTableView",o,{ms_ac:[Ar,ae,Wm,"sortMode",kd,yr,Bl,ui,"rootData","rootVisible",Ad,Vo,"sortColumn",Vh,Dq,Li,Iq,di,ri,rg,Lr,Qj,Mh,rq,ak,"loader"],ms_v:1,ms_bnb:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_48o:1,_14Q:1,_45o:1,_47o:1,_sortMode:Uh,_checkMode:T,_editable:!0,_batchEditable:!1,_indent:zh,_rowHeight:Ye,_rowLineVisible:j.treeTableViewRowLineVisible,_rowLineColor:j.treeTableViewRowLineColor,_columnLineVisible:j.treeTableViewColumnLineVisible,_columnLineColor:j.treeTableViewColumnLineColor,_expandIcon:j.treeTableViewExpandIcon,_collapseIcon:j.treeTableViewCollapseIcon,_scrollBarColor:Pe,_scrollBarSize:cg,_autoHideScrollBar:Lf,_autoMakeVisible:sl,_selectBackground:j.treeTableViewSelectBackground,_labelColor:j.treeTableViewLabelColor,_labelSelectColor:j.treeTableViewLabelSelectColor,_labelFont:j.treeTableViewLabelFont,getTreeColumn:function(){return this._4o}});var Pg=function(y){fk(Pg,this,[y])};gb(Pg,Wi,{_34o:function(v,T){var j=this.list,l=j._4o,Q=j._3Q(l),F=j.lp(v).x;if(Q){var d=j._indent,w=Q.startX+d*j.getLevel(T);if(dq(j.getToggleIcon(T))&&F>=w&&w+d>=F)return j.toggle(T),void 0;if(j.isCellEditable(T,l)&&(w+=d,F>=w&&w+d>=F))return j.checkData(T),void 0}j._37O(T,v),j.setFocusData(T)},_33o:function(z,i){var A=this.list,E=A.lp(z).x;if(dq(A.getToggleIcon(i))){var e=A._3Q(A._4o);if(e){var v=A._indent,L=e.startX+v*A.getLevel(i);if(E>=L&&L+v>=E)return A.toggle(i),void 0}}A._37O(i,z),Pg.superClass._33o.apply(this,arguments)}});var Fn=dg.TableHeader=function(q){var Z=this,a=Z._view=tm(1,Z),I=Z._39o=q.getColumnModel(),G=Z.iv;Z.tv=Z._tableView=q,Z._60I=new ep,Z._canvas=im(a),a.style.background=j.tableHeaderBackground||"",a.style.height=Jn+Gj,I.mm(G,Z),I.md(G,Z),I.mh(G,Z),q.mp(function(e){jp[e.property]&&Z.iv()},Z),new Fr(Z),Z.iv()};hj("TableHeader",o,{ms_v:1,ms_lp:1,ms_fire:1,ms_ac:["checkIcon","sortDescIcon","sortAscIcon",Ar,Wm,Bl,"moveBackground","insertColor",Mh,rq,"resizable","movable"],_checkIcon:vj,_movable:!0,_resizable:!0,_labelColor:j.tableHeaderLabelColor,_labelFont:j.tableHeaderLabelFont,_columnLineColor:j.tableHeaderColumnLineColor,_columnLineVisible:j.tableHeaderColumnLineVisible,_sortDescIcon:j.tableHeaderSortDescIcon,_sortAscIcon:j.tableHeaderSortAscIcon,_moveBackground:j.tableHeaderMoveBackground,_insertColor:j.tableHeaderInsertColor,_indent:zh,getCheckIcon:function(){return this._checkIcon},getTableView:function(){return this.tv},getLabel:function(y){return y.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(U){return U.getColor()||this._labelColor},getLabelAlign:function(D){return D._align},onPropertyChanged:function(){this.iv()},_5Q:function(U){this._61I=U,this.iv()},getLogicalPoint:function(W){return ag(W,this._canvas,this.tv.tx())},validateImpl:function(){var f=this,r=f._canvas,a=f.getWidth(),F=f.getHeight(),G=f.tv,j=f._60I,v=f._61I,E=-G.tx(),y=0;(a!==r.clientWidth||F!==r.clientHeight)&&Df(r,a,F),j.clear(),f._39o._roots.each(function(K){if(K.isVisible()){var J=y+K.getWidth();E+a>=y&&J>=E&&j.add({column:K,startX:y}),y=J}});var L=nd(r);if(vb(L,-E,0,1),L.beginPath(),L.rect(E,0,a,F),L.clip(),L.clearRect(E,0,a,F),j.each(function(Z){var N=Z.column,e=Z.startX,x=N.getWidth();x>0&&(L.save(),L.beginPath(),L.rect(e,0,x,F),L.clip(),v&&v.column===N||f.drawColumn(L,N,e,0,x,F),f._columnLineVisible&&eo(L,e+x-1,0,1,F,f._columnLineColor),L.restore())}),v){var k=v.column,y=v.startX,V=v.position,P=k.getWidth();L.save(),L.beginPath(),L.rect(y,0,P,F),L.clip(),L.fillStyle=f._moveBackground,L.fill(),f.drawColumn(L,k,y,0,P,F),L.restore(),Vr(L,f._insertColor,V,0,F)}L.restore()},_6Q:function(u){var s=this.tv;return s._31o===u&&s.sm().getSelectionMode()===so},drawColumn:function(x,a,X,u,g,O){var A=this,Z=A.tv,D=dq(a.getIcon()),q=A.getLabelAlign(a);if(A._6Q(a)){var $=dq(A._checkIcon);Oh(x,$,X+g/2,u+O/2,a,A)}else{var L=A.getLabel(a),r=A.getLabelFont(a),Q=A.getLabelColor(a),S=Ql(r,L).width,C=D?A._indent:0;q===ud?(D&&hh(x,D,Gm,X,u,C,O),ko(x,L,r,Q,X+C,u,g,O,ud)):q===Ij?(D&&hh(x,D,Gm,X+g-S-C,u,C,O),ko(x,L,r,Q,X,u,g,O,Ij)):(D&&hh(x,D,Gm,X+(g-S-C)/2,u,C,O),ko(x,L,r,Q,X+(g-S+C)/2,u,0,O,ud))}if(a.isSortable()&&Z.getSortColumn()===a&&(D=dq(a.getSortOrder()===qc?A._sortAscIcon:A._sortDescIcon))){var f=mc(D,a)/2+2;Oh(x,D,q===Ij?X+f:X+g-f,u+O/2,a,Z)}}});var Fr=function(f){var Q=this;Q.th=f,Q.tv=f._tableView,Q.addListeners()};gb(Fr,o,{ms_listener:1,getView:function(){return this.th.getView()},setCursor:function(b){this.getView().style.cursor=b},handle_mousemove:function(S){if(!Zk){var m=this;delete m._29o,m.setCursor(ce);for(var T=m.th,G=T._60I,Z=T.lp(S).x,o=G.size()-1;o>=0;o--){var q=G.get(o),R=q.column,K=q.startX+R.getWidth();if(T.isResizable()&&J(K-Z)<=(Rp?10:3))return m._29o=q,m.setCursor(pq),void 0;Z>q.startX&&K>Z&&(m._29o=q),(R.isClickable()||R.isSortable()||T.isMovable()||m.tv.getCheckColumn&&R===m.tv.getCheckColumn())&&Z>q.startX&&K>Z&&m.setCursor(Jr)}}},handle_mousedown:function(J){this.handle_touchstart(J)},handle_touchstart:function(s){var f=this;Gp(s),f.tv.endEditing(),f.handle_mousemove(s),f._29o&&(f.x=yq(s).x,f.lx=f.th.lp(s).x,f.w=f._29o.column.getWidth(),rf(f,s))},handleWindowMouseMove:function(q){this.handleWindowTouchMove(q)},handleWindowTouchMove:function(h){var C=this,P=C.th,$=C.getView().style.cursor,k=C._29o,B=yq(h).x-C.x;if(C.resizing||C.moving||($===pq?C.resizing=1:P.isMovable()&&$===Jr&&J(B)>2&&(C.moving=1)),C.resizing)k.column.setWidth(C.w+B);else if(C.moving){var V=C.lx+B;P._60I.each(function(A){var x=A.startX,y=x+A.column.getWidth();if(V>=x&&y>=V){var b={column:k.column,startX:k.startX+B,front:y-V>V-x,insertColumn:A.column};b.position=b.front?x:y,P._5Q(b)}})}},_16Q:function(P,m){var f=this,V=f.tv,c=f.th,$=c._checkIcon;if(c._6Q(P)){var b=dq($),j=f.lx,w=P.getWidth(),u=mc(b,P);if(j>=m+w/2-u&&m+w/2+u>=j){c.setCheckIcon($===dm?vj:dm);var g=V.sm(),J=V._rows;return $===dm?g.rs(J):g.ss(J),V.onCheckColumnClicked(P),!0}}return!1},handleWindowMouseUp:function(C){this.handleWindowTouchEnd(C)},handleWindowTouchEnd:function(R){var m=this,Q=m.tv,Y=m.th,N=m._29o;if(m.moving){var x=Y._61I;if(x&&x.insertColumn!==x.column){var k=x.column,B=Q.getColumnModel()._roots,A=B.remove(k),S=B.indexOf(x.insertColumn);S>=0&&(x.front||S++,S<=B.size()&&(B.add(k,S),Q.getColumnModel()._38I(k,A,S)))}Y._5Q(T),delete m.moving}else if(!m.resizing&&N){k=N.column;var W=Y.lp(R).x,Z=N.startX,b=!0;if(Y.onColumnClicked){var h=Y.onColumnClicked(k,R,Z);h===!1&&(b=!1)}if(b&&W>=Z&&W<=Z+k.getWidth()&&!m._16Q(k,Z)){if(k.isSortable()){var d=Q.getSortMode(),O=k.getSortOrder();d===Uh?Q.getSortColumn()===k?(O===Th&&Q.setSortColumn(T),k.setSortOrder(O===qc?Th:qc)):Q.setSortColumn(k):"bistate"===d&&(Q.getSortColumn()===k?k.setSortOrder(O===qc?Th:qc):Q.setSortColumn(k))}Q.onColumnClicked(k,R,Z)}}m._29o=m.resizing=m.x=m.lx=m.w=T}}),dg.TablePane=function(W){this.init(new Nj(W))},hj("TablePane",o,{ms_v:1,_44o:1}),dg.TreeTablePane=function(e){this.init(new Pq(e))},hj("TreeTablePane",o,{ms_v:1,_44o:1}),dg.Toolbar=function(Z){var O=this,l=O._view=tm(1,O),n=l.style;n.background=j.toolbarBackground||"",n.height=lr+Gj,O._canvas=im(l),O._30o=new ep,O._90I=new ep,O.setItems(Z||[]),l.handleGroupSelectedChanged=function(S){if(S.isSelected()){var h=S.getGroupId();null!=h&&O._items.forEach(function(N){var y=N.element;y&&y!==S&&y.setSelected&&y.getGroupId&&y.getGroupId()===h&&y.setSelected(!1)})}},new _m(O)},hj("Toolbar",o,{ms_v:1,ms_fire:1,ms_tx:1,ms_lp:1,ms_tip:1,ms_value:1,ms_ac:[hi,Ar,Wm,ae,ak,"itemGap","separatorColor","currentItem","stickToRight"],_labelColor:j.toolbarLabelColor,_labelSelectColor:j.toolbarLabelSelectColor,_labelFont:j.toolbarLabelFont,_selectBackground:j.toolbarSelectBackground,_itemGap:j.toolbarItemGap,_separatorColor:j.toolbarSeparatorColor,_stickToRight:!1,getSumWidth:function(){return this._64I},getToolTip:function(F){var H=this.getItemInfoAt(F);return H?H.item.toolTip:T},getLabelColor:function(I){return I&&I.selected&&I.type!==dm&&I.type!==Bd?this._labelSelectColor:this._labelColor},onPropertyChanged:function(O){this.iv(),O.property===hi&&this._items.forEach(function(X){em(X)})},redraw:function(){this.iv()},addItem:function(F,Z){var l=this._items;Z==T?l.push(F):l.splice(Z,0,F),this.fp(hi,T,l)},removeItem:function(B){if(B)for(var b=this._items,N=0;N<b.length;N++)B===b[N]&&(b.splice(N,1),this.fp(hi,T,b))},removeItemById:function(R){if(R!=T)for(var Z=this._items,S=0;S<Z.length;S++)if(R===Z[S].id){var m=Z.splice(S,1)[0];return this.fp(hi,T,Z),m}},getItemById:function(o){if(o!=T)for(var Q=this._items,f=0;f<Q.length;f++){var C=Q[f];if(o===C.id)return C}},setItemVisible:function(I,D){var K=this.getItemById(I);K&&(K.visible=D)},getItemInfos:function(){return this._30o},getItemInfoAt:function(u){var U=this,o=0,k=U._30o,Z=U.lp(u),_=Z.x,A=Z.y;if(A>=0&&A<=U.getHeight())for(;o<k.size();o++){var K=k.get(o);if(K.startX<=_&&_<=K.endX)return K}return T},drawItem:function(X,L,D,T,Z){if(L.visible===!1)return 0;if(zj(L.visible)&&!L.visible())return 0;var _=this,J=L.disabled;J&&(X.globalAlpha=Vj);var b=_.drawItemImpl(X,L,D,T,Z),C=_._itemGap;return J&&(X.globalAlpha=1),this._currentItem!==L||"separator"===L||L.separator===!0||L.unfocusable||Jd(X,_._separatorColor,D-C/2,0,b+C,T),b},drawItemImpl:function(Q,m,W,c,C){var K=this,n=K._view,z=K._itemGap,X=c/2,J=m.type,f=m.element,N=m.label;Td(f)&&(N=f,f=T);var B,$=K.getLabelFont(m),p=K.getLabelColor(m),e=m.selected,A=dq(m.icon),_=mc(A,m),t=0,L=_+(N?Ql($,N).width:0);if("separator"===m||m.separator===!0)return Vr(Q,K._separatorColor,W,c/4,X),1;
if(f){A&&Oh(Q,A,W+_/2,X,m,K),ko(Q,N,$,p,W+_,0,0,c);var E=Vb(f);C||K._90I.add(E),E.parentNode!==n&&Pb(n,E),f.iv&&f.iv(),f.validate&&f.validate();var h=E.getBoundingClientRect(),R=h.width,O=E.style;return yl(E),O.left=K.tx()+W+L+Gj,O.top=(c-h.height)/2+Gj,L+R}return J===Bd?B=dq(e?So:Sh):J===dm&&(B=dq(e?dm:vj)),B?(t=mc(B,m),Oh(Q,B,W+t/2,X,m,K),W+=t,L+=t):e&&eo(Q,W-z/2,0,L+z,c,K.getSelectBackground(m)),A&&Oh(Q,A,W+_/2,X,m,K),ko(Q,N,$,p,W+_,0,0,c),L},validateImpl:function(){var f=this,e=f._canvas,q=f.getWidth(),V=f.getHeight(),v=f._30o,P=f._items;Df(e,q,V);var l=nd(e),S=f._itemGap,I=S/2;vb(l,f.tx(),0,1),l.clearRect(0,0,q,V);var j=f._90I;f._90I=new ep,v.clear(),P.forEach(function(r){var t=f.drawItem(l,r,I,V);v.add({item:r,startX:I,endX:I+t,width:t}),t&&(I+=t+S)}),j.each(function(W){f._90I.contains(W)||ss(W)});var O=f._64I;f._64I=x(0,I),l.restore(),f._stickToRight?(f._65O=0,l=nd(e),I=q-f._64I+S,vb(l,0,0,1),l.clearRect(0,0,q,V),v.clear(),P.forEach(function(z){var h=f.drawItem(l,z,I,V,!0);v.add({item:z,startX:I,endX:I+h,width:h}),h&&(I+=h+S)}),l.restore()):f.tx(f.tx()),O!==f._64I&&f.onSumWidthChanged(O,f._64I)},onSumWidthChanged:function(){},handleClick:function(F,K){var P=this,D=F.type,A=F.action,c=F.groupId,B=F.selected;F.disabled||(c!=T?B||(F.selected=!0,this._items.forEach(function(Q){Q.groupId===c&&F!==Q&&(Q.selected=!1)}),A&&F.action(F,P,K)):D===dm||"toggle"===D?(F.selected=!B,A&&F.action(F,P,K)):A&&F.action(F,P,K)),Tp(),P.iv()}});var _m=function(w){this.tb=w,this.addListeners()};gb(_m,o,{ms_listener:1,getView:function(){return this.tb._view},handle_mousewheel:function(R){this.handleScroll(R,10*(R.wheelDelta/40))},handle_DOMMouseScroll:function(M){this.handleScroll(M,10*-M.detail)},handleScroll:function(a,e){Gp(a);var t=this.tb;t.isScrollable()&&!t._stickToRight&&(t.tx(t.tx()+e),Hp())},handle_mousemove:function(e){var U=this;Zk||U.setItem(e)},handle_mouseout:function(e){var n=this;e.target===n.getView()?n.tb.setCurrentItem(T):n.handle_mousemove(e)},handle_mousedown:function(R){this.handle_mousemove(R),this.handle_touchstart(R)},handle_touchstart:function(j){var Q=this,E=Q.tb,t=j.target;Mf(j)&&(t===Q.getView()||t===E._canvas)&&(Gp(j),E.setFocus(j)&&(this.setItem(j,!0),(E.isScrollable()||Q.info&&!Q.info.item.disabled)&&(Q.x=yq(j).x,Q.tx=E.tx(),rf(Q,j))))},handleWindowMouseMove:function(X){this.handleWindowTouchMove(X)},handleWindowTouchMove:function(W){var z=this,v=z.tb;if(!v._stickToRight){var F=yq(W).x-z.x;!z._25o&&J(F)>2&&v.isScrollable()&&(z._25o=1),z._25o&&v.tx(z.tx+F)}},handleWindowMouseUp:function(o){this.handleWindowTouchEnd(o)},handleWindowTouchEnd:function(i){var n=this,K=n.tb,e=n.info,l=n.tb.getItemInfoAt(i);if(!n._25o&&e){var q=e.item;l&&l.item===q&&K.handleClick(q,i)}n._25o=n.x=n.tx=T,n.setItem()},setItem:function(S,D){var V=this,v=V.tb,l=V.info=S?v.getItemInfoAt(S):T,_=l?l.item:T;v.setCurrentItem(_),D&&_&&zj(_.onDown)&&_.onDown(S)}}),dg.BorderPane=function(){this._view=tm(1,this),this.iv()},hj("BorderPane",o,{ms_v:1,ms_ac:["topHeight","bottomHeight","leftWidth","rightWidth"],ms_fire:1,getLeftView:function(){return this._leftView},setLeftView:function(n,z){this._12o("leftView",n),z!=T&&this.setLeftWidth(z)},getRightView:function(){return this._rightView},setRightView:function(v,y){this._12o("rightView",v),y!=T&&this.setRightWidth(y)},getTopView:function(){return this._topView},setTopView:function(S,P){this._12o("topView",S),P!=T&&this.setTopHeight(P)},getBottomView:function(){return this._bottomView},setBottomView:function(Z,s){this._12o("bottomView",Z),s!=T&&this.setBottomHeight(s)},getCenterView:function(){return this._centerView},setCenterView:function(f){this._12o("centerView",f)},_12o:function(T,L){var f=this,t="_"+T,$=f._view,C=f[t];C!==L&&(C&&(C.getView?ss(C.getView()):ss(C)),f[t]=L,L&&(L.getView?Pb($,L.getView(),1):Pb($,L,1)),f.fp(T,C,L))},onPropertyChanged:function(){this.iv()},validateImpl:function(){var i=this,u=i._topView,z=i._bottomView,Y=i._leftView,K=i._rightView,_=i._centerView,j=i.getWidth(),f=i.getHeight(),t=0,J=0,O=j,g=f,e=0,V=0,R=0,c=0;u&&(e=i._topHeight==T?Zg(u):i._topHeight,J=e),z&&(V=i._bottomHeight==T?Zg(z):i._bottomHeight,g=f-V),Y&&(R=i._leftWidth==T?$g(Y):i._leftWidth,t=R),K&&(c=i._rightWidth==T?$g(K):i._rightWidth,O=j-c);var P=x(0,O-t),X=x(0,g-J);u&&yj(u,0,0,j,e),z&&yj(z,0,g,j,V),Y&&yj(Y,0,J,R,X),K&&yj(K,O,J,c,X),_&&yj(_,t,J,P,X)}})}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);